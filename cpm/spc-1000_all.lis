;Z80-Assembler		Release 1.6				Page 1
;Source file: spc-1000_all.asm
;Title:       

;SOURCE CODE   LOC   OBJECT CODE   
                                        ;                       1      1 ;
                                        ;                       2      2 ; IOCS
                                        ;                       3      3 ;
                                        ;                       4      4 ; SAMSUNG 8bit Personal Computer SPC-1000
                                        ;                       5      5 ; Old ROM Assembler Source 
                                        ;                       6      6 ; Reconstructed by Miso Kim
                                        ;                       7      7 ;
                                        ;                       8      8 ; 2014.04.16 1st Released
                                        ;                       9      9 ; 
        ORG 0                           ;                      10     10 
ENTRY   EQU 0FB00H                      ;fb00                  11     11 
BOOT:                                   ;                      12     12 
JT1:    JP  ENTRY                       ;0000  c3 00 fb        13     13 
JT2:    JP  INPUTF                      ;0003  c3 a4 06        14     14 
JT3:    JP  CR1                         ;0006  c3 43 08        15     15 
JT4:    JP  CR2                         ;0009  c3 23 08        16     16 
JT5:    JP  SPPRT                       ;000c  c3 62 08        17     17 
JT6:    JP  TABPRT                      ;000f  c3 02 08        18     18 
JT7:    JP  ACCPRT                      ;0012  c3 64 08        19     19 
JT8:    JP  DEPRT                       ;0015  c3 f3 07        20     20 
JT9:    JP  DEPRT                       ;0018  c3 f3 07        21     21 
JT10:   JP  ASCGET                      ;001b  c3 62 0c        22     22 
JT11:   JP  BRKEY                       ;001e  c3 5b 0c        23     23 ;ZERO=1 RET
JT12:   JP  FSAVE                       ;0021  c3 80 00        24     24 
JT13:   JP  MSAVE                       ;0024  c3 b6 00        25     25 
JT14:   JP  FLOAD                       ;0027  c3 14 01        26     26 
JT15:   JP  MLOAD                       ;002a  c3 34 01        27     27 
JT16:   JP  MVRFY                       ;002d  c3 b9 01        28     28 
JT17:   JP  MUSIC                       ;0030  c3 cd 0e        29     29 ;MELDY
JT18:   JP  NOPRET                      ;0033  c3 61 00        30     30 ;CLKSET
TICONT: DEFW    17                      ;0036  11 00           31     31 
JT19:   JP  COUNTR                      ;0038  c3 74 00        32     32 
JT20:   JP  NOPRET                      ;003b  c3 61 00        33     33 ;CLKRD
JT21:   JP  BELL                        ;003e  c3 ca 06        34     34 ;BELL
JT22:   JP  XTEMPO                      ;0041  c3 95 10        35     35 ;TEMPO
JT23:   JP  SOUNDS                      ;0044  c3 99 10        36     36 ;MSTA
JT24:   JP  SOUNDS                      ;0047  c3 99 10        37     37 ;MSTAS
                                        ;                      38     38 ;004A
MAIN:   LD  SP,00000h                   ;004a  31 00 00        39     39 
    IM  1                               ;004d  ed 56           40     40 
    EI                                  ;004f  fb              41     41 
    CALL    INITSB                      ;0050  cd 56 00        42     42 
    JP  $BASIC                          ;0053  c3 18 14        43     43 
                                        ;                      44     44 ;
INITSB: LD  A,0                         ;0056  3e 00           45     45 
    CALL    IO20SB                      ;0058  cd 62 00        46     46 
    CALL    IO60SB                      ;005b  cd 6b 00        47     47 
    CALL    CLR2                        ;005e  cd d5 0a        48     48 
NOPRET: RET                             ;0061  c9              49     49 
                                        ;                      50     50 ;
IO20SB: LD  BC,02000h                   ;0062  01 00 20        51     51 
    OUT (C),A                           ;0065  ed 79           52     52 
    LD  (IO2000),A                      ;0067  32 ea 11        53     53 
    RET                                 ;006a  c9              54     54 
                                        ;                      55     55 ;
IO60SB: LD  BC,06000h                   ;006b  01 00 60        56     56 
    OUT (C),A                           ;006e  ed 79           57     57 
    LD  (IO6000),A                      ;0070  32 e9 11        58     58 
    RET                                 ;0073  c9              59     59 
                                        ;                      60     60 ;
                                        ;                      61     61 ;
COUNTR: PUSH    HL                      ;0074  e5              62     62 
    LD  HL,(TICONT)                     ;0075  2a 36 00        63     63 
    INC HL                              ;0078  23              64     64 
    LD  (TICONT),HL                     ;0079  22 36 00        65     65 
    POP HL                              ;007c  e1              66     66 
    EI                                  ;007d  fb              67     67 
    RETI                                ;007e  ed 4d           68     68 
                                        ;                      69     69 ;
                                        ;                      70     70 ;
                                        ;                      71     71 ;
                                        ;                      72     72 ; FILE INFORMATION SAVE
                                        ;                      73     73 ;
                                        ;                      74     74 ; START ADR=FILMOD
                                        ;                      75     75 ; LENGTH   =128 BYTES
                                        ;                      76     76 ;   CARRY FLAG: BREAK KEY IN
                                        ;                      77     77 ;
FSAVE:  DI                              ;0080  f3              78     78 
    PUSH    DE                          ;0081  d5              79     79 
    PUSH    BC                          ;0082  c5              80     80 
    PUSH    HL                          ;0083  e5              81     81 
    LD  D,0D7h                          ;0084  16 d7           82     82 
    LD  E,0CCh                          ;0086  1e cc           83     83 
    LD  HL,FILMOD                       ;0088  21 96 13        84     84 
    LD  BC,00080H                       ;008b  01 80 00        85     85 
                                        ;                      86     86 ;
FSAVE0: CALL    CKSUM                   ;008e  cd 9e 03        87     87 
    CALL    MOTON                       ;0091  cd e0 02        88     88 
    JP  C,CLOAD4                        ;0094  da 9d 01        89     89 
    LD  A,E                             ;0097  7b              90     90 
    CP  0CCh                            ;0098  fe cc           91     91 
    JR  NZ,FSAVE1                       ;009a  20 11           92     92 
    CALL    CR2                         ;009c  cd 23 08        93     93 
    PUSH    DE                          ;009f  d5              94     94 
    LD  DE,WRITEM                       ;00a0  11 75 03        95     95 
    CALL    DEPRT                       ;00a3  cd f3 07        96     96 ;'WRITING '
    LD  DE,FILNAM                       ;00a6  11 97 13        97     97 
    CALL    DEPRT                       ;00a9  cd f3 07        98     98 ;FILE NAME
    POP DE                              ;00ac  d1              99     99 
                                        ;                     100    100 ;
FSAVE1: CALL    WRMRK                   ;00ad  cd 22 04       101    101 ;GAP
    CALL    SAVE                        ;00b0  cd ce 00       102    102 ;STADR=HL/LEN=BC
    JP  CLOAD4                          ;00b3  c3 9d 01       103    103 
                                        ;                     104    104 ;
                                        ;                     105    105 ;
                                        ;                     106    106 ;
                                        ;                     107    107 ; BODY SAVE
                                        ;                     108    108 ; START ADR	= (MTADRS=13AAH)
                                        ;                     109    109 ; LENGTH	= (MTBYTE=13A8H)
                                        ;                     110    110 ; CARRY FLAG	= 0... OK
                                        ;                     111    111 ; CARRY FLAG	= 1... BREAK IN
                                        ;                     112    112 ;
MSAVE:  DI                              ;00b6  f3             113    113 
    PUSH    DE                          ;00b7  d5             114    114 
    PUSH    BC                          ;00b8  c5             115    115 
    PUSH    HL                          ;00b9  e5             116    116 
    LD  D,0D7h                          ;00ba  16 d7          117    117 
    LD  E,053h                          ;00bc  1e 53          118    118 
    LD  HL,(MTBYTE)                     ;00be  2a a8 13       119    119 
    PUSH    HL                          ;00c1  e5             120    120 
    POP BC                              ;00c2  c1             121    121 
    LD  HL,(MTADRS)                     ;00c3  2a aa 13       122    122 
    LD  A,B                             ;00c6  78             123    123 
    OR  C                               ;00c7  b1             124    124 
    JP  Z,SAVE4                         ;00c8  ca 10 01       125    125 
    JP  FSAVE0                          ;00cb  c3 8e 00       126    126 
                                        ;                     127    127 ;
SAVE:   PUSH    DE                      ;00ce  d5             128    128 
    PUSH    BC                          ;00cf  c5             129    129 
    PUSH    HL                          ;00d0  e5             130    130 
    LD  D,002h                          ;00d1  16 02          131    131 ;원래값은 002h
SAVE1:  LD  A,(HL)                      ;00d3  7e             132    132 ;~
    CALL    WRACC                       ;00d4  cd 0f 04       133    133 ;1BYTE WRITE
    LD  A,080h                          ;00d7  3e 80          134    134 ;8000H
    IN  A,(000h)                        ;00d9  db 00          135    135 
    AND 012h                            ;00db  e6 12          136    136 ;BREAK+SHIFT
    JR  NZ,SAVE0                        ;00dd  20 04          137    137 
    SCF                                 ;00df  37             138    138 
    JP  SAVE4                           ;00e0  c3 10 01       139    139 
                                        ;                     140    140 ;
SAVE0:  INC HL                          ;00e3  23             141    141 
    DEC BC                              ;00e4  0b             142    142 ;BC BYTES CHECK
    LD  A,B                             ;00e5  78             143    143 
    OR  C                               ;00e6  b1             144    144 
    JP  NZ,SAVE1                        ;00e7  c2 d3 00       145    145 
    LD  HL,(CKSMF1)                     ;00ea  2a e3 11       146    146 ;CHECK SUM WRITE
    LD  A,H                             ;00ed  7c             147    147 
    CALL    WRACC                       ;00ee  cd 0f 04       148    148 
    LD  A,L                             ;00f1  7d             149    149 
    CALL    WRACC                       ;00f2  cd 0f 04       150    150 
    CALL    WRITEL                      ;00f5  cd ed 03       151    151 ;BIT 1 WRITE
    DEC D                               ;00f8  15             152    152 
    JP  NZ,SAVE2                        ;00f9  c2 00 01       153    153 
    OR  A                               ;00fc  b7             154    154 
    JP  SAVE4                           ;00fd  c3 10 01       155    155 
                                        ;                     156    156 ;
SAVE2:  LD  B,000h                      ;0100  06 00          157    157 
SAVE3:  CALL    WRITES                  ;0102  cd cb 03       158    158 
    DEC B                               ;0105  05             159    159 
    JP  NZ,SAVE3                        ;0106  c2 02 01       160    160 
    POP HL                              ;0109  e1             161    161 
    POP BC                              ;010a  c1             162    162 
    PUSH    BC                          ;010b  c5             163    163 
    PUSH    HL                          ;010c  e5             164    164 
    JP  SAVE1                           ;010d  c3 d3 00       165    165 
                                        ;                     166    166 ;
SAVE4:  POP HL                          ;0110  e1             167    167 
    POP BC                              ;0111  c1             168    168 
    POP DE                              ;0112  d1             169    169 
    RET                                 ;0113  c9             170    170 
                                        ;                     171    171 ;
FLOAD:  DI                              ;0114  f3             172    172 
    PUSH    DE                          ;0115  d5             173    173 
    PUSH    BC                          ;0116  c5             174    174 
    PUSH    HL                          ;0117  e5             175    175 
    LD  D,0D2h                          ;0118  16 d2          176    176 
    LD  E,0CCh                          ;011a  1e cc          177    177 
    LD  BC,FSAVE                        ;011c  01 80 00       178    178 
    LD  HL,FILMOD                       ;011f  21 96 13       179    179 
                                        ;                     180    180 ;
FLOAD1: CALL    MOTON                   ;0122  cd e0 02       181    181 
    JP  C,CLOAD5                        ;0125  da b3 01       182    182 
    CALL    MKRD                        ;0128  cd 91 02       183    183 
    JP  C,CLOAD5                        ;012b  da b3 01       184    184 
    CALL    CLOAD                       ;012e  cd 4c 01       185    185 
    JP  CLOAD4                          ;0131  c3 9d 01       186    186 
                                        ;                     187    187 ;
MLOAD:  DI                              ;0134  f3             188    188 
    PUSH    DE                          ;0135  d5             189    189 
    PUSH    BC                          ;0136  c5             190    190 
    PUSH    HL                          ;0137  e5             191    191 
    LD  D,0D2h                          ;0138  16 d2          192    192 
    LD  E,053h                          ;013a  1e 53          193    193 
    LD  HL,(MTBYTE)                     ;013c  2a a8 13       194    194 
    PUSH    HL                          ;013f  e5             195    195 
    POP BC                              ;0140  c1             196    196 
    LD  HL,(MTADRS)                     ;0141  2a aa 13       197    197 
    LD  A,B                             ;0144  78             198    198 
    OR  C                               ;0145  b1             199    199 
    JP  Z,CLOAD4                        ;0146  ca 9d 01       200    200 
    JP  FLOAD1                          ;0149  c3 22 01       201    201 
                                        ;                     202    202 ;
CLOAD:  PUSH    DE                      ;014c  d5             203    203 
    PUSH    BC                          ;014d  c5             204    204 
    PUSH    HL                          ;014e  e5             205    205 
    LD  H,002h                          ;014f  26 02          206    206 ;원래값은 002h - 소스 수정
                                        ;                     207    207 ;
CLOAD7: LD  BC,04000h                   ;0151  01 00 40       208    208 
    LD  A,14                            ;0154  3e 0e          209    209 
    OUT (C),A                           ;0156  ed 79          210    210 
                                        ;                     211    211 ;
CLOAD0: CALL    EDGE                    ;0158  cd 30 02       212    212 
    JP  C,CLOAD5                        ;015b  da b3 01       213    213 
    CALL    WAITR                       ;015e  cd c4 03       214    214 
    LD  A,040h                          ;0161  3e 40          215    215 
    IN  A,(1)                           ;0163  db 01          216    216 ;IN A,(4001H)
    AND 080h                            ;0165  e6 80          217    217 
    JP  Z,CLOAD0                        ;0167  ca 58 01       218    218 
    LD  D,H                             ;016a  54             219    219 
    LD  HL,00000h                       ;016b  21 00 00       220    220 
    LD  (CKSMF1),HL                     ;016e  22 e3 11       221    221 
    POP HL                              ;0171  e1             222    222 
    POP BC                              ;0172  c1             223    223 
    PUSH    BC                          ;0173  c5             224    224 
    PUSH    HL                          ;0174  e5             225    225 
                                        ;                     226    226 ;
CLOAD1: CALL    VBLOAD                  ;0175  cd 59 02       227    227 
    JP  C,CLOAD5                        ;0178  da b3 01       228    228 
    LD  (HL),A                          ;017b  77             229    229 
    INC HL                              ;017c  23             230    230 
    DEC BC                              ;017d  0b             231    231 
    LD  A,B                             ;017e  78             232    232 
    OR  C                               ;017f  b1             233    233 
    JP  NZ,CLOAD1                       ;0180  c2 75 01       234    234 
    LD  HL,(CKSMF1)                     ;0183  2a e3 11       235    235 
    CALL    VBLOAD                      ;0186  cd 59 02       236    236 
    JP  C,CLOAD5                        ;0189  da b3 01       237    237 
    LD  E,A                             ;018c  5f             238    238 
    CALL    VBLOAD                      ;018d  cd 59 02       239    239 
    JP  C,CLOAD5                        ;0190  da b3 01       240    240 
    CP  L                               ;0193  bd             241    241 
    JP  NZ,CLOAD2                       ;0194  c2 a5 01       242    242 
    LD  A,E                             ;0197  7b             243    243 
    CP  H                               ;0198  bc             244    244 
    JP  NZ,CLOAD2                       ;0199  c2 a5 01       245    245 
                                        ;                     246    246 ;
CLOAD8: XOR A                           ;019c  af             247    247 
                                        ;                     248    248 ;
CLOAD4: POP HL                          ;019d  e1             249    249 
    POP BC                              ;019e  c1             250    250 
    POP DE                              ;019f  d1             251    251 
    CALL    MOTCH                       ;01a0  cd 44 03       252    252 
    EI                                  ;01a3  fb             253    253 
    RET                                 ;01a4  c9             254    254 
                                        ;                     255    255 ;
CLOAD2: DEC D                           ;01a5  15             256    256 
    JP  Z,CLOAD3                        ;01a6  ca ad 01       257    257 
    LD  H,D                             ;01a9  62             258    258 
    JP  CLOAD7                          ;01aa  c3 51 01       259    259 
                                        ;                     260    260 ;
CLOAD3: LD  A,001h                      ;01ad  3e 01          261    261 
    SCF                                 ;01af  37             262    262 
    JP  CLOAD4                          ;01b0  c3 9d 01       263    263 
                                        ;                     264    264 ;
CLOAD5: LD  A,002h                      ;01b3  3e 02          265    265 
    SCF                                 ;01b5  37             266    266 
    JP  CLOAD4                          ;01b6  c3 9d 01       267    267 
                                        ;                     268    268 ;
MVRFY:  DI                              ;01b9  f3             269    269 
    PUSH    DE                          ;01ba  d5             270    270 
    PUSH    BC                          ;01bb  c5             271    271 
    PUSH    HL                          ;01bc  e5             272    272 
    LD  HL,(MTBYTE)                     ;01bd  2a a8 13       273    273 
    PUSH    HL                          ;01c0  e5             274    274 
    POP BC                              ;01c1  c1             275    275 
    LD  HL,(MTADRS)                     ;01c2  2a aa 13       276    276 
    LD  D,0D2h                          ;01c5  16 d2          277    277 
    LD  E,053h                          ;01c7  1e 53          278    278 
    LD  A,B                             ;01c9  78             279    279 
    OR  C                               ;01ca  b1             280    280 
    JP  Z,CLOAD4                        ;01cb  ca 9d 01       281    281 
    CALL    CKSUM                       ;01ce  cd 9e 03       282    282 
    CALL    MOTON                       ;01d1  cd e0 02       283    283 
    JP  C,CLOAD5                        ;01d4  da b3 01       284    284 
    CALL    MKRD                        ;01d7  cd 91 02       285    285 
    JP  C,CLOAD5                        ;01da  da b3 01       286    286 
    CALL    MVRFY1                      ;01dd  cd e3 01       287    287 
    JP  CLOAD4                          ;01e0  c3 9d 01       288    288 
                                        ;                     289    289 ;
MVRFY1: PUSH    DE                      ;01e3  d5             290    290 
    PUSH    BC                          ;01e4  c5             291    291 
    PUSH    HL                          ;01e5  e5             292    292 
    LD  H,002h                          ;01e6  26 02          293    293 
                                        ;                     294    294 ;
MVRFYN: LD  BC,04000h                   ;01e8  01 00 40       295    295 
    LD  A,14                            ;01eb  3e 0e          296    296 
    OUT (C),A                           ;01ed  ed 79          297    297 
                                        ;                     298    298 ;
MVRFY2: CALL    EDGE                    ;01ef  cd 30 02       299    299 
    JP  C,CLOAD5                        ;01f2  da b3 01       300    300 
    CALL    WAITR                       ;01f5  cd c4 03       301    301 
    LD  A,040h                          ;01f8  3e 40          302    302 
    IN  A,(1)                           ;01fa  db 01          303    303 
    AND 080h                            ;01fc  e6 80          304    304 
    JP  Z,MVRFY2                        ;01fe  ca ef 01       305    305 
    LD  D,H                             ;0201  54             306    306 
    POP HL                              ;0202  e1             307    307 
    POP BC                              ;0203  c1             308    308 
    PUSH    BC                          ;0204  c5             309    309 
    PUSH    HL                          ;0205  e5             310    310 
                                        ;                     311    311 ;
MVRFY3: CALL    VBLOAD                  ;0206  cd 59 02       312    312 
    JP  C,CLOAD5                        ;0209  da b3 01       313    313 
    CP  (HL)                            ;020c  be             314    314 
    JP  NZ,CLOAD3                       ;020d  c2 ad 01       315    315 
    INC HL                              ;0210  23             316    316 
    DEC BC                              ;0211  0b             317    317 
    LD  A,B                             ;0212  78             318    318 
    OR  C                               ;0213  b1             319    319 
    JP  NZ,MVRFY3                       ;0214  c2 06 02       320    320 
    LD  HL,(CKSMF2)                     ;0217  2a e5 11       321    321 
    CALL    VBLOAD                      ;021a  cd 59 02       322    322 
    CP  H                               ;021d  bc             323    323 
    JP  NZ,CLOAD3                       ;021e  c2 ad 01       324    324 
    CALL    VBLOAD                      ;0221  cd 59 02       325    325 
    CP  L                               ;0224  bd             326    326 
    JP  NZ,CLOAD3                       ;0225  c2 ad 01       327    327 
    DEC D                               ;0228  15             328    328 
    JP  Z,CLOAD8                        ;0229  ca 9c 01       329    329 
    LD  H,D                             ;022c  62             330    330 
    JP  MVRFYN                          ;022d  c3 e8 01       331    331 
                                        ;                     332    332 ;
EDGE:                                   ;                     333    333 
MVRFY4: LD  A,080h                      ;0230  3e 80          334    334 
    IN  A,(0)                           ;0232  db 00          335    335 ;IN A,(8000H)
    AND 012h                            ;0234  e6 12          336    336 
    JP  NZ,MVRFY5                       ;0236  c2 3b 02       337    337 
    SCF                                 ;0239  37             338    338 
    RET                                 ;023a  c9             339    339 
                                        ;                     340    340 ;
MVRFY5: LD  A,040h                      ;023b  3e 40          341    341 
    IN  A,(1)                           ;023d  db 01          342    342 ;IN A,(4001H)
    AND 080h                            ;023f  e6 80          343    343 
    JP  NZ,MVRFY4                       ;0241  c2 30 02       344    344 
                                        ;                     345    345 ;
MVRFY6: LD  A,080h                      ;0244  3e 80          346    346 
    IN  A,(0)                           ;0246  db 00          347    347 ;IN A,(8001H)
    AND 012h                            ;0248  e6 12          348    348 
    JP  NZ,MVRFY7                       ;024a  c2 4f 02       349    349 
    SCF                                 ;024d  37             350    350 
    RET                                 ;024e  c9             351    351 
                                        ;                     352    352 ;
MVRFY7: LD  A,040h                      ;024f  3e 40          353    353 
    IN  A,(1)                           ;0251  db 01          354    354 ;IN A,(4001H)
    AND 080h                            ;0253  e6 80          355    355 
    JP  Z,MVRFY6                        ;0255  ca 44 02       356    356 
    RET                                 ;0258  c9             357    357 
                                        ;                     358    358 ;
VBLOAD: PUSH    BC                      ;0259  c5             359    359 
    PUSH    DE                          ;025a  d5             360    360 
    PUSH    HL                          ;025b  e5             361    361 
    LD  HL,00800h                       ;025c  21 00 08       362    362 
    LD  BC,04000h                       ;025f  01 00 40       363    363 
    LD  A,14                            ;0262  3e 0e          364    364 
    OUT (C),A                           ;0264  ed 79          365    365 
VBLOD1: CALL    EDGE                    ;0266  cd 30 02       366    366 
    JP  C,VBLOD3                        ;0269  da 8d 02       367    367 
    CALL    WAITR                       ;026c  cd c4 03       368    368 
    LD  A,040h                          ;026f  3e 40          369    369 
    IN  A,(1)                           ;0271  db 01          370    370 ;IN A,(4001H)
    AND 080h                            ;0273  e6 80          371    371 
    JP  Z,VBLOD2                        ;0275  ca 82 02       372    372 
    PUSH    HL                          ;0278  e5             373    373 
    LD  HL,(CKSMF1)                     ;0279  2a e3 11       374    374 
    INC HL                              ;027c  23             375    375 
    LD  (CKSMF1),HL                     ;027d  22 e3 11       376    376 
    POP HL                              ;0280  e1             377    377 
    SCF                                 ;0281  37             378    378 
                                        ;                     379    379 ;
VBLOD2: LD  A,L                         ;0282  7d             380    380 
    RLA                                 ;0283  17             381    381 
    LD  L,A                             ;0284  6f             382    382 
    DEC H                               ;0285  25             383    383 
    JP  NZ,VBLOD1                       ;0286  c2 66 02       384    384 
    CALL    EDGE                        ;0289  cd 30 02       385    385 
    LD  A,L                             ;028c  7d             386    386 
                                        ;                     387    387 ;
VBLOD3: POP HL                          ;028d  e1             388    388 
    POP DE                              ;028e  d1             389    389 
    POP BC                              ;028f  c1             390    390 
    RET                                 ;0290  c9             391    391 
                                        ;                     392    392 ;
MKRD:   PUSH    BC                      ;0291  c5             393    393 
    PUSH    DE                          ;0292  d5             394    394 
    PUSH    HL                          ;0293  e5             395    395 
    LD  HL,02828h                       ;0294  21 28 28       396    396 
    LD  A,E                             ;0297  7b             397    397 
    CP  0CCh                            ;0298  fe cc          398    398 
    JP  Z,MKRD1                         ;029a  ca a0 02       399    399 
    LD  HL,01414h                       ;029d  21 14 14       400    400 
                                        ;                     401    401 ;
MKRD1:  LD  (MKLEN),HL                  ;02a0  22 e7 11       402    402 
    LD  BC,04000h                       ;02a3  01 00 40       403    403 
    LD  A,14                            ;02a6  3e 0e          404    404 
    OUT (C),A                           ;02a8  ed 79          405    405 
MKRD4:  LD  HL,(MKLEN)                  ;02aa  2a e7 11       406    406 
                                        ;                     407    407 ;
MKRD5:  CALL    EDGE                    ;02ad  cd 30 02       408    408 
    JP  C,MKRD3                         ;02b0  da dc 02       409    409 
    CALL    WAITR                       ;02b3  cd c4 03       410    410 
    LD  A,040h                          ;02b6  3e 40          411    411 
    IN  A,(1)                           ;02b8  db 01          412    412 ;IN A,(4001H)
    AND 080h                            ;02ba  e6 80          413    413 
    JP  Z,MKRD4                         ;02bc  ca aa 02       414    414 
    DEC H                               ;02bf  25             415    415 
    JP  NZ,MKRD5                        ;02c0  c2 ad 02       416    416 
                                        ;                     417    417 ;
MKRD2:  CALL    EDGE                    ;02c3  cd 30 02       418    418 
    JP  C,MKRD3                         ;02c6  da dc 02       419    419 
    CALL    WAITR                       ;02c9  cd c4 03       420    420 
    LD  A,040h                          ;02cc  3e 40          421    421 
    IN  A,(1)                           ;02ce  db 01          422    422 ;IN A,(4001H)
    AND 080h                            ;02d0  e6 80          423    423 
    JP  NZ,MKRD4                        ;02d2  c2 aa 02       424    424 
    DEC L                               ;02d5  2d             425    425 
    JP  NZ,MKRD2                        ;02d6  c2 c3 02       426    426 
    CALL    EDGE                        ;02d9  cd 30 02       427    427 
                                        ;                     428    428 ;
MKRD3:  POP HL                          ;02dc  e1             429    429 
    POP DE                              ;02dd  d1             430    430 
    POP BC                              ;02de  c1             431    431 
    RET                                 ;02df  c9             432    432 
                                        ;                     433    433 ;
MOTON:  PUSH    BC                      ;02e0  c5             434    434 
    PUSH    DE                          ;02e1  d5             435    435 
    PUSH    HL                          ;02e2  e5             436    436 
    LD  BC,04000h                       ;02e3  01 00 40       437    437 
    LD  A,14                            ;02e6  3e 0e          438    438 ;A PORT SELECT
    OUT (C),A                           ;02e8  ed 79          439    439 
    LD  L,00Ah                          ;02ea  2e 0a          440    440 
    LD  BC,06000h                       ;02ec  01 00 60       441    441 
MOTON1: LD  A,040h                      ;02ef  3e 40          442    442 
    IN  A,(1)                           ;02f1  db 01          443    443 ;IN A,(4001H)
    AND 040h                            ;02f3  e6 40          444    444 
    JP  NZ,MOTON5                       ;02f5  c2 fd 02       445    445 
                                        ;                     446    446 ;
MOTON6: XOR A                           ;02f8  af             447    447 
                                        ;                     448    448 ;
MOTON4: POP HL                          ;02f9  e1             449    449 
    POP DE                              ;02fa  d1             450    450 
    POP BC                              ;02fb  c1             451    451 
    RET                                 ;02fc  c9             452    452 
                                        ;                     453    453 ;
MOTON5: LD  A,(IO6000)                  ;02fd  3a e9 11       454    454 
    RES 1,A                             ;0300  cb 8f          455    455 
    OUT (C),A                           ;0302  ed 79          456    456 
    SET 1,A                             ;0304  cb cf          457    457 
    OUT (C),A                           ;0306  ed 79          458    458 
    LD  (IO6000),A                      ;0308  32 e9 11       459    459 
    DEC L                               ;030b  2d             460    460 
    JP  NZ,MOTON1                       ;030c  c2 ef 02       461    461 
    CALL    CR2                         ;030f  cd 23 08       462    462 
    LD  A,D                             ;0312  7a             463    463 
    CP  0D7h                            ;0313  fe d7          464    464 
    JR  Z,MOTON2                        ;0315  28 08          465    465 
    LD  DE,MBUF6                        ;0317  11 7e 03       466    466 
    CALL    DEPRT                       ;031a  cd f3 07       467    467 
    JR  MOTON3                          ;031d  18 0c          468    468 
                                        ;                     469    469 ;
MOTON2: LD  DE,MBUF7                    ;031f  11 8f 03       470    470 
    CALL    DEPRT                       ;0322  cd f3 07       471    471 
    LD  DE,MBUF6A                       ;0325  11 83 03       472    472 
    CALL    DEPRT                       ;0328  cd f3 07       473    473 
                                        ;                     474    474 ;
MOTON3: CALL    CR2                     ;032b  cd 23 08       475    475 
    LD  A,040h                          ;032e  3e 40          476    476 
    IN  A,(1)                           ;0330  db 01          477    477 ;IN A,(4001H)
    AND 040h                            ;0332  e6 40          478    478 
    JP  Z,MOTON6                        ;0334  ca f8 02       479    479 
    LD  A,080h                          ;0337  3e 80          480    480 
    IN  A,(0)                           ;0339  db 00          481    481 ;IN A,(8000H)
    AND 012h                            ;033b  e6 12          482    482 
    JP  NZ,MOTON3                       ;033d  c2 2b 03       483    483 
    SCF                                 ;0340  37             484    484 
    JP  MOTON4                          ;0341  c3 f9 02       485    485 
                                        ;                     486    486 ;
MOTCH:  PUSH    AF                      ;0344  f5             487    487 
    PUSH    BC                          ;0345  c5             488    488 
    PUSH    DE                          ;0346  d5             489    489 
    LD  D,00Ah                          ;0347  16 0a          490    490 
    LD  BC,04000h                       ;0349  01 00 40       491    491 
    LD  A,14                            ;034c  3e 0e          492    492 
    OUT (C),A                           ;034e  ed 79          493    493 
    LD  BC,06000h                       ;0350  01 00 60       494    494 
MOTCH1: LD  A,040h                      ;0353  3e 40          495    495 
    IN  A,(1)                           ;0355  db 01          496    496 ;IN A,(4001H)
    AND 040h                            ;0357  e6 40          497    497 
    JR  Z,MOTCH2                        ;0359  28 04          498    498 
    POP DE                              ;035b  d1             499    499 
    POP BC                              ;035c  c1             500    500 
    POP AF                              ;035d  f1             501    501 
    RET                                 ;035e  c9             502    502 
                                        ;                     503    503 ;
MOTCH2: LD  A,(IO6000)                  ;035f  3a e9 11       504    504 
    RES 1,A                             ;0362  cb 8f          505    505 
    OUT (C),A                           ;0364  ed 79          506    506 
    SET 1,A                             ;0366  cb cf          507    507 
    OUT (C),A                           ;0368  ed 79          508    508 
    LD  (IO6000),A                      ;036a  32 e9 11       509    509 
    DEC D                               ;036d  15             510    510 
    JP  NZ,MOTCH1                       ;036e  c2 53 03       511    511 
    POP DE                              ;0371  d1             512    512 
    POP BC                              ;0372  c1             513    513 
    POP AF                              ;0373  f1             514    514 
    RET                                 ;0374  c9             515    515 
                                        ;                     516    516 ;
                                        ;                     517    517 ;
WRITEM: DEFM    'WRITING '              ;0375  57 52 49 54    518    518 
                                        ;0379  49 4e 47 20    518    519
    DEFB    0                           ;037d  00             519    520 
                                        ;                     520    521 ;
MBUF6:  DEFM    'PUSH '                 ;037e  50 55 53 48    521    522 
                                        ;0382  20             521    523
MBUF6A: DEFM    'PLAY BUTTON'           ;0383  50 4c 41 59    522    524 
                                        ;0387  20 42 55 54    522    525
                                        ;038b  54 4f 4e       522    526
    DEFB    0                           ;038e  00             523    527 
                                        ;                     524    528 ;
MBUF7:  DEFM    'PUSH '                 ;038f  50 55 53 48    525    529 
                                        ;0393  20             525    530
    DEFM    'RECORD & '                 ;0394  52 45 43 4f    526    531 
                                        ;0398  52 44 20 26    526    532
                                        ;039c  20             526    533
                                        ;                     527    534 
    DEFB    0                           ;039d  00             528    535 
                                        ;                     529    536 ;
CKSUM:  PUSH    BC                      ;039e  c5             530    537 
    PUSH    DE                          ;039f  d5             531    538 
    PUSH    HL                          ;03a0  e5             532    539 
    LD  DE,00000h                       ;03a1  11 00 00       533    540 
                                        ;                     534    541 ;
SUM1:   LD  A,B                         ;03a4  78             535    542 
    OR  C                               ;03a5  b1             536    543 
    JR  NZ,SUM2                         ;03a6  20 0b          537    544 
    EX  DE,HL                           ;03a8  eb             538    545 
    LD  (CKSMF1),HL                     ;03a9  22 e3 11       539    546 
    LD  (CKSMF2),HL                     ;03ac  22 e5 11       540    547 
    POP HL                              ;03af  e1             541    548 
    POP DE                              ;03b0  d1             542    549 
    POP BC                              ;03b1  c1             543    550 
    RET                                 ;03b2  c9             544    551 
                                        ;                     545    552 ;
SUM2:   LD  A,(HL)                      ;03b3  7e             546    553 
    PUSH    HL                          ;03b4  e5             547    554 
    LD  H,008h                          ;03b5  26 08          548    555 
                                        ;                     549    556 ;
SUM3:   RLCA                            ;03b7  07             550    557 
    JR  NC,SUM4                         ;03b8  30 01          551    558 
    INC DE                              ;03ba  13             552    559 
                                        ;                     553    560 ;
SUM4:   DEC H                           ;03bb  25             554    561 
    JR  NZ,SUM3                         ;03bc  20 f9          555    562 
    POP HL                              ;03be  e1             556    563 
    INC HL                              ;03bf  23             557    564 
    DEC BC                              ;03c0  0b             558    565 
    JP  SUM1                            ;03c1  c3 a4 03       559    566 
                                        ;                     560    567 ;
                                        ;                     561    568 ;
                                        ;                     562    569 ;WAITR:	RET			;★원래는 이 자리가 3E
                                        ;                     563    570 ;	LD	E,D			;★원래는 LD A,90
WAITR:                                  ;                     564    571 
    LD  A,90                            ;03c4  3e 5a          565    572 ; 원래는 90
WAIT2:  DEC A                           ;03c6  3d             566    573 
    JP  NZ,WAIT2                        ;03c7  c2 c6 03       567    574 
    RET                                 ;03ca  c9             568    575 
                                        ;                     569    576 ;
WRITES: PUSH    AF                      ;03cb  f5             570    577 
    PUSH    BC                          ;03cc  c5             571    578 
    LD  BC,06000h                       ;03cd  01 00 60       572    579 
    LD  A,(IO6000)                      ;03d0  3a e9 11       573    580 
    SET 0,A                             ;03d3  cb c7          574    581 
    OUT (C),A                           ;03d5  ed 79          575    582 
    PUSH    AF                          ;03d7  f5             576    583 
    LD  A,60                            ;03d8  3e 3c          577    584 ;MSX는 38
    CALL    WAIT2                       ;03da  cd c6 03       578    585 
    POP AF                              ;03dd  f1             579    586 
    RES 0,A                             ;03de  cb 87          580    587 
    OUT (C),A                           ;03e0  ed 79          581    588 
    LD  (IO6000),A                      ;03e2  32 e9 11       582    589 
    LD  A,55                            ;03e5  3e 37          583    590 ;MSX는 45
    CALL    WAIT2                       ;03e7  cd c6 03       584    591 
    POP BC                              ;03ea  c1             585    592 
    POP AF                              ;03eb  f1             586    593 
    RET                                 ;03ec  c9             587    594 
                                        ;                     588    595 ;
WRITEL: PUSH    AF                      ;03ed  f5             589    596 
    PUSH    BC                          ;03ee  c5             590    597 
    LD  BC,06000h                       ;03ef  01 00 60       591    598 
    LD  A,(IO6000)                      ;03f2  3a e9 11       592    599 
    SET 0,A                             ;03f5  cb c7          593    600 
    OUT (C),A                           ;03f7  ed 79          594    601 
    PUSH    AF                          ;03f9  f5             595    602 
    LD  A,120                           ;03fa  3e 78          596    603 ;MSX는 83
    CALL    WAIT2                       ;03fc  cd c6 03       597    604 
    POP AF                              ;03ff  f1             598    605 
    RES 0,A                             ;0400  cb 87          599    606 
    OUT (C),A                           ;0402  ed 79          600    607 
    LD  (IO6000),A                      ;0404  32 e9 11       601    608 
    LD  A,115                           ;0407  3e 73          602    609 ;MSX는 92
    CALL    WAIT2                       ;0409  cd c6 03       603    610 
    POP BC                              ;040c  c1             604    611 
    POP AF                              ;040d  f1             605    612 
    RET                                 ;040e  c9             606    613 
                                        ;                     607    614 ;
WRACC:  PUSH    BC                      ;040f  c5             608    615 
    LD  B,008h                          ;0410  06 08          609    616 
    CALL    WRITEL                      ;0412  cd ed 03       610    617 ;BIT 1 WRITE
                                        ;                     611    618 ;
WRACC1: RLCA                            ;0415  07             612    619 
    CALL    C,WRITEL                    ;0416  dc ed 03       613    620 
    CALL    NC,WRITES                   ;0419  d4 cb 03       614    621 
    DEC B                               ;041c  05             615    622 
    JP  NZ,WRACC1                       ;041d  c2 15 04       616    623 
    POP BC                              ;0420  c1             617    624 
    RET                                 ;0421  c9             618    625 
                                        ;                     619    626 ;
WRMRK:  PUSH    BC                      ;0422  c5             620    627 
    PUSH    DE                          ;0423  d5             621    628 
    LD  A,E                             ;0424  7b             622    629 
    LD  BC,055F0h                       ;0425  01 f0 55       623    630 
    LD  DE,02828h                       ;0428  11 28 28       624    631 
    CP  0CCh                            ;042b  fe cc          625    632 
    JP  Z,WMRK1                         ;042d  ca 36 04       626    633 
    LD  BC,02AF8h                       ;0430  01 f8 2a       627    634 
    LD  DE,01414h                       ;0433  11 14 14       628    635 
                                        ;                     629    636 ;
WMRK1:  CALL    WRITES                  ;0436  cd cb 03       630    637 
    DEC BC                              ;0439  0b             631    638 
    LD  A,B                             ;043a  78             632    639 
    OR  C                               ;043b  b1             633    640 
    JR  NZ,WMRK1                        ;043c  20 f8          634    641 
                                        ;                     635    642 ;
WMRK2:  CALL    WRITEL                  ;043e  cd ed 03       636    643 
    DEC D                               ;0441  15             637    644 
    JR  NZ,WMRK2                        ;0442  20 fa          638    645 
                                        ;                     639    646 ;
WMRK3:  CALL    WRITES                  ;0444  cd cb 03       640    647 
    DEC E                               ;0447  1d             641    648 
    JR  NZ,WMRK3                        ;0448  20 fa          642    649 
    CALL    WRITEL                      ;044a  cd ed 03       643    650 
    POP DE                              ;044d  d1             644    651 
    POP BC                              ;044e  c1             645    652 
    RET                                 ;044f  c9             646    653 
                                        ;                     647    654 ;
                                        ;                     648    655 ;    MON (MONITOR)
                                        ;                     649    656 ;
                                        ;                     650    657 ;
MONOP:  PUSH    HL                      ;0450  e5             651    658 
    LD  (MONSTK),SP                     ;0451  ed 73 83 04    652    659 
MONCOM: CALL    CR2                     ;0455  cd 23 08       653    660 
    LD  A,'*'                           ;0458  3e 2a          654    661 ;02AH
    CALL    ACCPRT                      ;045a  cd 64 08       655    662 
MONINP: CALL    MONEDT                  ;045d  cd e1 04       656    663 
    JR  NC,MONINP                       ;0460  30 fb          657    664 
    LD  BC,MONCOM                       ;0462  01 55 04       658    665 
    PUSH    BC                          ;0465  c5             659    666 
    LD  A,(DE)                          ;0466  1a             660    667 
    INC DE                              ;0467  13             661    668 
    CP  '*'                             ;0468  fe 2a          662    669 ;02AH
    RET NZ                              ;046a  c0             663    670 
    CALL    DESMAL                      ;046b  cd 53 05       664    671 
    CP  'G'                             ;046e  fe 47          665    672 ;047H
    JR  Z,CALLAD                        ;0470  28 2c          666    673 ;★원래는 ADJUMP
    CP  'D'                             ;0472  fe 44          667    674 ;044H
    JR  Z,MEMDMP                        ;0474  28 2d          668    675 
    CP  'M'                             ;0476  fe 4d          669    676 ;04DH
    JR  Z,MEMWRT                        ;0478  28 0d          670    677 
    CP  'S'                             ;047a  fe 53          671    678 ;053H
    JP  Z,MONSAH                        ;047c  ca 8e 05       672    679 
    CP  'R'                             ;047f  fe 52          673    680 ;052H
    RET NZ                              ;0481  c0             674    681 
    DEFB    031h                        ;0482  31             675    682 ;LD SP,HHHH
MONSTK: DEFW    00000h                  ;0483  00 00          676    683 
    POP HL                              ;0485  e1             677    684 
    RET                                 ;0486  c9             678    685 
                                        ;                     679    686 ;
MEMWRT: CALL    HLSET                   ;0487  cd 09 05       680    687 
WRTLP:  CALL    CRHLDS                  ;048a  cd 80 05       681    688 
    CALL    HLINDS                      ;048d  cd 5e 05       682    689 
    PUSH    HL                          ;0490  e5             683    690 
    CALL    LEFT                        ;0491  cd 48 0b       684    691 
    CALL    LEFT                        ;0494  cd 48 0b       685    692 
    POP HL                              ;0497  e1             686    693 
    CALL    MONEDT                      ;0498  cd e1 04       687    694 
    JR  NC,WRTLP                        ;049b  30 ed          688    695 
    RET                                 ;049d  c9             689    696 
                                        ;                     690    697 ;
CALLAD: CALL    HLSET                   ;049e  cd 09 05       691    698 ;★원래는 ADJUMP
    RET C                               ;04a1  d8             692    699 
    JP  (HL)                            ;04a2  e9             693    700 
                                        ;                     694    701 ;
                                        ;                     695    702 ;
MEMDMP: CALL    HLSET                   ;04a3  cd 09 05       696    703 
    PUSH    HL                          ;04a6  e5             697    704 
    CALL    HLSET                       ;04a7  cd 09 05       698    705 
    JR  NC,HLSTOK                       ;04aa  30 06          699    706 
    POP HL                              ;04ac  e1             700    707 
    PUSH    HL                          ;04ad  e5             701    708 
    LD  BC,0003Fh                       ;04ae  01 3f 00       702    709 
    ADD HL,BC                           ;04b1  09             703    710 
HLSTOK: LD  (HLEND),HL                  ;04b2  22 bb 04       704    711 
    POP HL                              ;04b5  e1             705    712 
MEMDPL: CALL    DMPSUB                  ;04b6  cd c8 04       706    713 
    RET Z                               ;04b9  c8             707    714 
    DEFB    011h                        ;04ba  11             708    715 ;LD DE,HHHH
HLEND:  DEFW    0FFFFh                  ;04bb  ff ff          709    716 ;★원래는 0000H
    EX  DE,HL                           ;04bd  eb             710    717 
    OR  A                               ;04be  b7             711    718 
    SBC HL,DE                           ;04bf  ed 52          712    719 
    EX  DE,HL                           ;04c1  eb             713    720 
    JR  NC,MEMDPL                       ;04c2  30 f2          714    721 
    RET                                 ;04c4  c9             715    722 
                                        ;                     716    723 ;
                                        ;                     717    724 ;
MONDPS: LD  B,C                         ;04c5  41             718    725 
    JR  DMPSB2                          ;04c6  18 02          719    726 
DMPSUB: DEFB    006h                    ;04c8  06             720    727 ;LD B,008H
LINCNT: DEFB    008h                    ;04c9  08             721    728 
DMPSB2: CALL    CRHLDS                  ;04ca  cd 80 05       722    729 
MEMLP2: CALL    HLINDS                  ;04cd  cd 5e 05       723    730 
    INC HL                              ;04d0  23             724    731 
    DJNZ    MEMLP2                      ;04d1  10 fa          725    732 
SPCSTP: LD  A,080h                      ;04d3  3e 80          726    733 
    IN  A,(001h)                        ;04d5  db 01          727    734 
    AND 004h                            ;04d7  e6 04          728    735 
    JR  Z,SPCSTP                        ;04d9  28 f8          729    736 
    CALL    CR2                         ;04db  cd 23 08       730    737 
    JP  BRKEY                           ;04de  c3 5b 0c       731    738 
                                        ;                     732    739 ;
MONEDT: LD  DE,KEYBUF                   ;04e1  11 4f 7a       733    740 
    CALL    INPUTF                      ;04e4  cd a4 06       734    741 
    CALL    HLSET                       ;04e7  cd 09 05       735    742 
    RET C                               ;04ea  d8             736    743 
    INC DE                              ;04eb  13             737    744 
DATAST: INC DE                          ;04ec  13             738    745 
    CALL    ACCSET                      ;04ed  cd f6 04       739    746 
    CCF                                 ;04f0  3f             740    747 
    RET NC                              ;04f1  d0             741    748 
    LD  (HL),A                          ;04f2  77             742    749 
    INC HL                              ;04f3  23             743    750 
    JR  DATAST                          ;04f4  18 f6          744    751 
                                        ;                     745    752 ;
ACCSET: LD  A,(DE)                      ;04f6  1a             746    753 
    CP  '                               ;04f7  fe 3b          747    754 ;'		;03BH
    JR  NZ,AHEXIN                       ;04f9  20 05          748    755 
    INC DE                              ;04fb  13             749    756 
    LD  A,(DE)                          ;04fc  1a             750    757 
    INC DE                              ;04fd  13             751    758 
    OR  A                               ;04fe  b7             752    759 
    RET                                 ;04ff  c9             753    760 
AHEXIN: PUSH    DE                      ;0500  d5             754    761 
    CALL    HEX2IN                      ;0501  cd 2c 05       755    762 ;★원래는 2HEXIN인데 라벨이 숫자부터 시작이 가능했었나보다.
    POP DE                              ;0504  d1             756    763 
    RET C                               ;0505  d8             757    764 
    INC DE                              ;0506  13             758    765 
    INC DE                              ;0507  13             759    766 
    RET                                 ;0508  c9             760    767 
                                        ;                     761    768 ;
HLSET:  LD  A,(DE)                      ;0509  1a             762    769 
    INC DE                              ;050a  13             763    770 
    CP  020h                            ;050b  fe 20          764    771 
    JR  Z,HLSET                         ;050d  28 fa          765    772 
    DEC DE                              ;050f  1b             766    773 
    PUSH    HL                          ;0510  e5             767    774 
    CALL    HEX4IN                      ;0511  cd 1f 05       768    775 ;★원래는 4HEXIN인데 라벨이 숫자부터 시작이 가능했었나보다.
    JR  C,HLHOLD                        ;0514  38 07          769    776 
    POP AF                              ;0516  f1             770    777 
    INC DE                              ;0517  13             771    778 
    INC DE                              ;0518  13             772    779 
    INC DE                              ;0519  13             773    780 
    INC DE                              ;051a  13             774    781 
    OR  A                               ;051b  b7             775    782 
    RET                                 ;051c  c9             776    783 
HLHOLD: POP HL                          ;051d  e1             777    784 
    RET                                 ;051e  c9             778    785 
                                        ;                     779    786 ;
HEX4IN: PUSH    DE                      ;051f  d5             780    787 
    CALL    HEX2IN                      ;0520  cd 2c 05       781    788 
    JR  C,HEX4ER                        ;0523  38 05          782    789 ;★원래는 4HEXER인데 라벨이 숫자부터 시작이 가능했었나보다.
    LD  H,A                             ;0525  67             783    790 
    CALL    HEX2IN                      ;0526  cd 2c 05       784    791 
    LD  L,A                             ;0529  6f             785    792 
HEX4ER: POP DE                          ;052a  d1             786    793 
    RET                                 ;052b  c9             787    794 
                                        ;                     788    795 ;
HEX2IN: CALL    BHEXIN                  ;052c  cd 40 05       789    796 
    RET C                               ;052f  d8             790    797 
    PUSH    BC                          ;0530  c5             791    798 
    RLCA                                ;0531  07             792    799 
    RLCA                                ;0532  07             793    800 
    RLCA                                ;0533  07             794    801 
    RLCA                                ;0534  07             795    802 
    LD  C,A                             ;0535  4f             796    803 
    CALL    BHEXIN                      ;0536  cd 40 05       797    804 
    PUSH    AF                          ;0539  f5             798    805 
    OR  C                               ;053a  b1             799    806 
    LD  C,A                             ;053b  4f             800    807 
    POP AF                              ;053c  f1             801    808 
    LD  A,C                             ;053d  79             802    809 
    POP BC                              ;053e  c1             803    810 
    RET                                 ;053f  c9             804    811 
                                        ;                     805    812 ;
BHEXIN: CALL    DESMAL                  ;0540  cd 53 05       806    813 
    SUB 030h                            ;0543  d6 30          807    814 
    RET C                               ;0545  d8             808    815 
    CP  00Ah                            ;0546  fe 0a          809    816 
    CCF                                 ;0548  3f             810    817 
    RET NC                              ;0549  d0             811    818 
    CP  011h                            ;054a  fe 11          812    819 
    RET C                               ;054c  d8             813    820 
    SUB 007h                            ;054d  d6 07          814    821 
    CP  010h                            ;054f  fe 10          815    822 
    CCF                                 ;0551  3f             816    823 
    RET                                 ;0552  c9             817    824 
                                        ;                     818    825 ;
DESMAL: LD  A,(DE)                      ;0553  1a             819    826 
    INC DE                              ;0554  13             820    827 
    CP  'a'                             ;0555  fe 61          821    828 ;061h
    RET C                               ;0557  d8             822    829 
    CP  'z'+1                           ;0558  fe 7b          823    830 ;07Bh
    RET NC                              ;055a  d0             824    831 
    SUB ' '                             ;055b  d6 20          825    832 ;020h
    RET                                 ;055d  c9             826    833 
                                        ;                     827    834 ;
                                        ;                     828    835 ;
                                        ;                     829    836 ;
HLINDS: CALL    SPPRT                   ;055e  cd 62 08       830    837 
    LD  A,(HL)                          ;0561  7e             831    838 
HEX2PR: PUSH    AF                      ;0562  f5             832    839 ;★원래는 2HEXPR인데 라벨이 숫자부터 시작이 가능했었나보다.
    AND 0F0h                            ;0563  e6 f0          833    840 
    RRCA                                ;0565  0f             834    841 
    RRCA                                ;0566  0f             835    842 
    RRCA                                ;0567  0f             836    843 
    RRCA                                ;0568  0f             837    844 
    CALL    ASCSET                      ;0569  cd 78 05       838    845 
    CALL    ACCPRT                      ;056c  cd 64 08       839    846 
    POP AF                              ;056f  f1             840    847 
    AND 00Fh                            ;0570  e6 0f          841    848 
    CALL    ASCSET                      ;0572  cd 78 05       842    849 
    JP  ACCPRT                          ;0575  c3 64 08       843    850 
ASCSET: ADD A,'0'                       ;0578  c6 30          844    851 ;030h
    CP  '9'+1                           ;057a  fe 3a          845    852 ;03Ah
    RET C                               ;057c  d8             846    853 
    ADD A,007h                          ;057d  c6 07          847    854 
    RET                                 ;057f  c9             848    855 
                                        ;                     849    856 ;
CRHLDS: CALL    CR2                     ;0580  cd 23 08       850    857 
    LD  A,H                             ;0583  7c             851    858 
    CALL    HEX2PR                      ;0584  cd 62 05       852    859 
    LD  A,L                             ;0587  7d             853    860 
    CALL    HEX2PR                      ;0588  cd 62 05       854    861 
    JP  SPPRT                           ;058b  c3 62 08       855    862 
MONSAH: CALL    HLSET                   ;058e  cd 09 05       856    863 
    RET C                               ;0591  d8             857    864 
    PUSH    HL                          ;0592  e5             858    865 
    CALL    HLSET                       ;0593  cd 09 05       859    866 
    POP BC                              ;0596  c1             860    867 
    RET C                               ;0597  d8             861    868 
    PUSH    HL                          ;0598  e5             862    869 
    PUSH    BC                          ;0599  c5             863    870 
    LD  HL,KEYBUF                       ;059a  21 4f 7a       864    871 
    CALL    DATAST                      ;059d  cd ec 04       865    872 
    LD  DE,KEYBUF                       ;05a0  11 4f 7a       866    873 
    OR  A                               ;05a3  b7             867    874 
    SBC HL,DE                           ;05a4  ed 52          868    875 
    LD  C,L                             ;05a6  4d             869    876 
    POP HL                              ;05a7  e1             870    877 
    PUSH    HL                          ;05a8  e5             871    878 
    EXX                                 ;05a9  d9             872    879 
    POP HL                              ;05aa  e1             873    880 
    POP DE                              ;05ab  d1             874    881 
    EXX                                 ;05ac  d9             875    882 
    RET Z                               ;05ad  c8             876    883 
MNSHLP: CALL    HLDECK                  ;05ae  cd c2 05       877    884 
    CALL    Z,MONDPS                    ;05b1  cc c5 04       878    885 
    RET Z                               ;05b4  c8             879    886 
    EXX                                 ;05b5  d9             880    887 
    INC HL                              ;05b6  23             881    888 
    PUSH    HL                          ;05b7  e5             882    889 
    SCF                                 ;05b8  37             883    890 
    SBC HL,DE                           ;05b9  ed 52          884    891 
    POP HL                              ;05bb  e1             885    892 
    RET NC                              ;05bc  d0             886    893 
    PUSH    HL                          ;05bd  e5             887    894 
    EXX                                 ;05be  d9             888    895 
    POP HL                              ;05bf  e1             889    896 
    JR  MNSHLP                          ;05c0  18 ec          890    897 
                                        ;                     891    898 ;
HLDECK: LD  A,(DE)                      ;05c2  1a             892    899 
    CP  (HL)                            ;05c3  be             893    900 
    RET NZ                              ;05c4  c0             894    901 
    PUSH    BC                          ;05c5  c5             895    902 
    PUSH    DE                          ;05c6  d5             896    903 
    PUSH    HL                          ;05c7  e5             897    904 
    LD  B,C                             ;05c8  41             898    905 
HLDEC1: LD  A,(DE)                      ;05c9  1a             899    906 
    CP  (HL)                            ;05ca  be             900    907 
    JR  NZ,HLDEC2                       ;05cb  20 05          901    908 
    INC DE                              ;05cd  13             902    909 
    INC HL                              ;05ce  23             903    910 
    DJNZ    HLDEC1                      ;05cf  10 f8          904    911 
    XOR A                               ;05d1  af             905    912 
HLDEC2: POP HL                          ;05d2  e1             906    913 
    POP DE                              ;05d3  d1             907    914 
    POP BC                              ;05d4  c1             908    915 
    RET                                 ;05d5  c9             909    916 
                                        ;                     910    917 ;
SCRNBC: LD  A,C                         ;05d6  79             911    918 ;SCREEN B,C
    CP  5                               ;05d7  fe 05          912    919 
    RET NC                              ;05d9  d0             913    920 
    OR  A                               ;05da  b7             914    921 
    LD  HL,SCRN00                       ;05db  21 68 06       915    922 
    JR  Z,SCRNS0                        ;05de  28 13          916    923 
    LD  A,B                             ;05e0  78             917    924 
    LD  B,0                             ;05e1  06 00          918    925 
    DEC C                               ;05e3  0d             919    926 
    LD  HL,SCRNTB                       ;05e4  21 60 06       920    927 
    RL  C                               ;05e7  cb 11          921    928 
    ADD HL,BC                           ;05e9  09             922    929 
    LD  E,(HL)                          ;05ea  5e             923    930 
    INC HL                              ;05eb  23             924    931 
    LD  D,(HL)                          ;05ec  56             925    932 
    EX  DE,HL                           ;05ed  eb             926    933 
    DEC A                               ;05ee  3d             927    934 
    RLCA                                ;05ef  07             928    935 
    RLCA                                ;05f0  07             929    936 
    RLCA                                ;05f1  07             930    937 
    RLCA                                ;05f2  07             931    938 
SCRNS0: LD  E,A                         ;05f3  5f             932    939 
    LD  A,(IO2000)                      ;05f4  3a ea 11       933    940 
    AND 0CFh                            ;05f7  e6 cf          934    941 
    OR  E                               ;05f9  b3             935    942 
    CALL    IO20SB                      ;05fa  cd 62 00       936    943 
    LD  E,(HL)                          ;05fd  5e             937    944 
    INC HL                              ;05fe  23             938    945 
    LD  D,(HL)                          ;05ff  56             939    946 
    INC HL                              ;0600  23             940    947 
    EX  DE,HL                           ;0601  eb             941    948 
    LD  (LINEFR),HL                     ;0602  22 fa 0a       942    949 
    EX  DE,HL                           ;0605  eb             943    950 
    LD  E,(HL)                          ;0606  5e             944    951 
    INC HL                              ;0607  23             945    952 
    LD  D,(HL)                          ;0608  56             946    953 
    INC HL                              ;0609  23             947    954 
    EX  DE,HL                           ;060a  eb             948    955 
    LD  (PAGE16+1),HL                   ;060b  22 02 0a       949    956 
    EX  DE,HL                           ;060e  eb             950    957 
    LD  E,(HL)                          ;060f  5e             951    958 
    INC HL                              ;0610  23             952    959 
    LD  D,(HL)                          ;0611  56             953    960 
    INC HL                              ;0612  23             954    961 
    EX  DE,HL                           ;0613  eb             955    962 
    LD  (PAGE11+1),HL                   ;0614  22 b3 09       956    963 
    LD  (PAGE17+1),HL                   ;0617  22 08 0a       957    964 
    LD  BC,2                            ;061a  01 02 00       958    965 ;★이 2줄 4바이트는
    ADD HL,BC                           ;061d  09             959    966 ;INC HL 두 번 2바이트면 가능하다.
    LD  A,L                             ;061e  7d             960    967 
    LD  (PAGE23+1),A                    ;061f  32 fd 0a       961    968 
    EX  DE,HL                           ;0622  eb             962    969 
    LD  E,(HL)                          ;0623  5e             963    970 
    INC HL                              ;0624  23             964    971 
    LD  D,(HL)                          ;0625  56             965    972 
    INC HL                              ;0626  23             966    973 
    EX  DE,HL                           ;0627  eb             967    974 
    LD  (CHRSTA),HL                     ;0628  22 d6 0a       968    975 
    LD  (PAGE05+1),HL                   ;062b  22 47 09       969    976 
    PUSH    HL                          ;062e  e5             970    977 
    SET 3,H                             ;062f  cb dc          971    978 
    LD  (ATRSTA),HL                     ;0631  22 e6 0a       972    979 
    EX  DE,HL                           ;0634  eb             973    980 
    LD  E,(HL)                          ;0635  5e             974    981 
    INC HL                              ;0636  23             975    982 
    LD  D,(HL)                          ;0637  56             976    983 
    INC HL                              ;0638  23             977    984 
    EX  DE,HL                           ;0639  eb             978    985 
    LD  (CHRLEN),HL                     ;063a  22 e9 0a       979    986 
    LD  BC,0FFE0h                       ;063d  01 e0 ff       980    987 
    ADD HL,BC                           ;0640  09             981    988 
    LD  (CHRLE2),HL                     ;0641  22 fc 09       982    989 
    POP BC                              ;0644  c1             983    990 
    ADD HL,BC                           ;0645  09             984    991 
    LD  BC,0001Fh                       ;0646  01 1f 00       985    992 
    ADD HL,BC                           ;0649  09             986    993 
    LD  (PAGE12+1),HL                   ;064a  22 ef 09       987    994 
    SET 3,H                             ;064d  cb dc          988    995 
    LD  (PAGE14+1),HL                   ;064f  22 f9 09       989    996 
    EX  DE,HL                           ;0652  eb             990    997 
    LD  E,(HL)                          ;0653  5e             991    998 
    INC HL                              ;0654  23             992    999 
    LD  D,(HL)                          ;0655  56             993   1000 
    EX  DE,HL                           ;0656  eb             994   1001 
    LD  (PAGE02+1),HL                   ;0657  22 09 09       995   1002 
    SET 3,H                             ;065a  cb dc          996   1003 
    LD  (PAGE04+1),HL                   ;065c  22 16 09       997   1004 
    RET                                 ;065f  c9             998   1005 
                                        ;                     999   1006 ;
                                        ;                    1000   1007 ;
                                        ;                    1001   1008 ;
SCRNTB: DEFW    SCRN01                  ;0660  74 06         1002   1009 
    DEFW    SCRN02                      ;0662  80 06         1003   1010 
    DEFW    SCRN03                      ;0664  8c 06         1004   1011 
    DEFW    SCRN04                      ;0666  98 06         1005   1012 
                                        ;                    1006   1013 ;
SCRN00: DEFW    LINEF                   ;0668  a2 11         1007   1014 ;LINEFR
    DEFW    LINEF+63                    ;066a  e1 11         1008   1015 ;PAGE16
    DEFW    63                          ;066c  3f 00         1009   1016 ;PAGE11
    DEFW    00000h                      ;066e  00 00         1010   1017 ;CHRSTA
    DEFW    00800h                      ;0670  00 08         1011   1018 ;CHRLEN
    DEFW    00200h                      ;0672  00 02         1012   1019 ;PAGE02
                                        ;                    1013   1020 ;
SCRN01: DEFW    LINEF                   ;0674  a2 11         1014   1021 ;LINEFR
    DEFW    LINEF+15                    ;0676  b1 11         1015   1022 ;PAGE16
    DEFW    15                          ;0678  0f 00         1016   1023 ;PAGE11
    DEFW    00000h                      ;067a  00 00         1017   1024 ;CHRSTA
    DEFW    00200h                      ;067c  00 02         1018   1025 ;CHRLEN
    DEFW    00000h                      ;067e  00 00         1019   1026 ;PAGE02
                                        ;                    1020   1027 ;
SCRN02: DEFW    LINEF+16                ;0680  b2 11         1021   1028 ;LINEFR
    DEFW    LINEF+31                    ;0682  c1 11         1022   1029 ;PAGE16
    DEFW    15                          ;0684  0f 00         1023   1030 ;PAGE11
    DEFW    00200h                      ;0686  00 02         1024   1031 ;CHRSTA
    DEFW    00200h                      ;0688  00 02         1025   1032 ;CHRLEN
    DEFW    00200h                      ;068a  00 02         1026   1033 ;PAGE02
                                        ;                    1027   1034 ;
SCRN03: DEFW    LINEF+32                ;068c  c2 11         1028   1035 ;LINEFR
    DEFW    LINEF+47                    ;068e  d1 11         1029   1036 ;PAGE16
    DEFW    015                         ;0690  0f 00         1030   1037 ;PAGE11
    DEFW    00400h                      ;0692  00 04         1031   1038 ;CHRSTA
    DEFW    00200h                      ;0694  00 02         1032   1039 ;CHRLEN
    DEFW    00400h                      ;0696  00 04         1033   1040 ;PAGE02
                                        ;                    1034   1041 ;
SCRN04: DEFW    LINEF+48                ;0698  d2 11         1035   1042 ;LINEFR
    DEFW    LINEF+63                    ;069a  e1 11         1036   1043 ;PAGE16
    DEFW    015                         ;069c  0f 00         1037   1044 ;PAGE11
    DEFW    00600h                      ;069e  00 06         1038   1045 ;CHRSTA
    DEFW    00200h                      ;06a0  00 02         1039   1046 ;CHRLEN
    DEFW    00600h                      ;06a2  00 06         1040   1047 ;PAGE02
                                        ;                    1041   1048 ;DE INPUT ASCII(END=0D 00)
INPUTF: PUSH    AF                      ;06a4  f5            1042   1049 
    PUSH    BC                          ;06a5  c5            1043   1050 
    PUSH    HL                          ;06a6  e5            1044   1051 
    PUSH    DE                          ;06a7  d5            1045   1052 
    LD  A,1                             ;06a8  3e 01         1046   1053 
    LD  (FLASHF),A                      ;06aa  32 7f 0c      1047   1054 
INKYLP: LD  HL,INKYLP                   ;06ad  21 ad 06      1048   1055 
    PUSH    HL                          ;06b0  e5            1049   1056 
    CALL    ASCGET                      ;06b1  cd 62 0c      1050   1057 
    PUSH    AF                          ;06b4  f5            1051   1058 
    LD  A,(BELLFG)                      ;06b5  3a 7f 11      1052   1059 
    OR  A                               ;06b8  b7            1053   1060 
    CALL    NZ,BELL2                    ;06b9  c4 d2 06      1054   1061 
    POP AF                              ;06bc  f1            1055   1062 
    DEFB    0FEh                        ;06bd  fe            1056   1063 ;CP 03H
BREAKI: DEFB    003h                    ;06be  03            1057   1064 
    JP  Z,BRKJOB                        ;06bf  ca 4c 07      1058   1065 
    CP  00Dh                            ;06c2  fe 0d         1059   1066 
    JP  Z,CRJOB                         ;06c4  ca 5f 07      1060   1067 
    JP  ACCOUT                          ;06c7  c3 d9 08      1061   1068 
                                        ;                    1062   1069 ;
BELL:   LD  DE,BELLT2                   ;06ca  11 48 07      1063   1070 
    LD  HL,01000h                       ;06cd  21 00 10      1064   1071 
    JR  BELL3                           ;06d0  18 06         1065   1072 
                                        ;                    1066   1073 ;
BELL2:  LD  DE,BELLTB                   ;06d2  11 44 07      1067   1074 
    LD  HL,000C0h                       ;06d5  21 c0 00      1068   1075 
BELL3:  LD  BC,04000h                   ;06d8  01 00 40      1069   1076 
    PUSH    HL                          ;06db  e5            1070   1077 
    LD  HL,BELLBF                       ;06dc  21 40 07      1071   1078 
    XOR A                               ;06df  af            1072   1079 
    OUT (C),A                           ;06e0  ed 79         1073   1080 
    INC C                               ;06e2  0c            1074   1081 
    IN  A,(C)                           ;06e3  ed 78         1075   1082 
    LD  (HL),A                          ;06e5  77            1076   1083 
    LD  A,(DE)                          ;06e6  1a            1077   1084 
    OUT (C),A                           ;06e7  ed 79         1078   1085 
    DEC C                               ;06e9  0d            1079   1086 
    INC DE                              ;06ea  13            1080   1087 
    INC HL                              ;06eb  23            1081   1088 
    LD  A,1                             ;06ec  3e 01         1082   1089 
    OUT (C),A                           ;06ee  ed 79         1083   1090 
    INC C                               ;06f0  0c            1084   1091 
    IN  A,(C)                           ;06f1  ed 78         1085   1092 
    LD  (HL),A                          ;06f3  77            1086   1093 
    LD  A,(DE)                          ;06f4  1a            1087   1094 
    OUT (C),A                           ;06f5  ed 79         1088   1095 
    DEC C                               ;06f7  0d            1089   1096 
    INC DE                              ;06f8  13            1090   1097 
    INC HL                              ;06f9  23            1091   1098 
    LD  A,8                             ;06fa  3e 08         1092   1099 
    OUT (C),A                           ;06fc  ed 79         1093   1100 
    INC C                               ;06fe  0c            1094   1101 
    IN  A,(C)                           ;06ff  ed 78         1095   1102 
    LD  (HL),A                          ;0701  77            1096   1103 
    LD  A,(DE)                          ;0702  1a            1097   1104 
    OUT (C),A                           ;0703  ed 79         1098   1105 
    DEC C                               ;0705  0d            1099   1106 
    INC DE                              ;0706  13            1100   1107 
    INC HL                              ;0707  23            1101   1108 
    LD  A,7                             ;0708  3e 07         1102   1109 
    OUT (C),A                           ;070a  ed 79         1103   1110 
    INC C                               ;070c  0c            1104   1111 
    IN  A,(C)                           ;070d  ed 78         1105   1112 
    LD  (HL),A                          ;070f  77            1106   1113 
    LD  A,(DE)                          ;0710  1a            1107   1114 
    OUT (C),A                           ;0711  ed 79         1108   1115 
    DEC C                               ;0713  0d            1109   1116 
    POP DE                              ;0714  d1            1110   1117 
L0715:  DEC DE                          ;0715  1b            1111   1118 
    LD  A,D                             ;0716  7a            1112   1119 
    OR  E                               ;0717  b3            1113   1120 
    JR  NZ,L0715                        ;0718  20 fb         1114   1121 
    LD  A,7                             ;071a  3e 07         1115   1122 
    OUT (C),A                           ;071c  ed 79         1116   1123 
    INC C                               ;071e  0c            1117   1124 
    LD  A,(HL)                          ;071f  7e            1118   1125 
    OUT (C),A                           ;0720  ed 79         1119   1126 
    DEC C                               ;0722  0d            1120   1127 
    DEC HL                              ;0723  2b            1121   1128 
    LD  A,8                             ;0724  3e 08         1122   1129 
    OUT (C),A                           ;0726  ed 79         1123   1130 
    INC C                               ;0728  0c            1124   1131 
    LD  A,(HL)                          ;0729  7e            1125   1132 
    OUT (C),A                           ;072a  ed 79         1126   1133 
    DEC C                               ;072c  0d            1127   1134 
    DEC HL                              ;072d  2b            1128   1135 
    LD  A,1                             ;072e  3e 01         1129   1136 
    OUT (C),A                           ;0730  ed 79         1130   1137 
    INC C                               ;0732  0c            1131   1138 
    LD  A,(HL)                          ;0733  7e            1132   1139 
    OUT (C),A                           ;0734  ed 79         1133   1140 
    DEC C                               ;0736  0d            1134   1141 
    DEC HL                              ;0737  2b            1135   1142 
    XOR A                               ;0738  af            1136   1143 
    OUT (C),A                           ;0739  ed 79         1137   1144 
    INC C                               ;073b  0c            1138   1145 
    LD  A,(HL)                          ;073c  7e            1139   1146 
    OUT (C),A                           ;073d  ed 79         1140   1147 
    RET                                 ;073f  c9            1141   1148 
                                        ;                    1142   1149 ;
BELLBF: DEFS    4                       ;0740                1143   1150 
BELLTB: DEFB    208                     ;0744  d0            1144   1151 
    DEFB    0                           ;0745  00            1145   1152 
    DEFB    00Ch                        ;0746  0c            1146   1153 
    DEFB    07Eh                        ;0747  7e            1147   1154 
                                        ;                    1148   1155 ;
BELLT2: DEFW    0007Fh                  ;0748  7f 00         1149   1156 
    DEFB    00Fh                        ;074a  0f            1150   1157 
    DEFB    07Eh                        ;074b  7e            1151   1158 
                                        ;                    1152   1159 ;
BRKJOB: POP AF                          ;074c  f1            1153   1160 
    POP HL                              ;074d  e1            1154   1161 
    PUSH    HL                          ;074e  e5            1155   1162 
    LD  (HL),003h                       ;074f  36 03         1156   1163 
CRJOB2: INC HL                          ;0751  23            1157   1164 
    LD  (HL),00Dh                       ;0752  36 0d         1158   1165 
    INC HL                              ;0754  23            1159   1166 
    LD  (HL),000h                       ;0755  36 00         1160   1167 
INPEND: CALL    CTRLM                   ;0757  cd 62 0b      1161   1168 
ACCEND: POP DE                          ;075a  d1            1162   1169 
    POP HL                              ;075b  e1            1163   1170 
    POP BC                              ;075c  c1            1164   1171 
    POP AF                              ;075d  f1            1165   1172 
    RET                                 ;075e  c9            1166   1173 
                                        ;                    1167   1174 ;
CRJOB:  POP AF                          ;075f  f1            1168   1175 
    CALL    BCUYST                      ;0760  cd ba 07      1169   1176 
    PUSH    DE                          ;0763  d5            1170   1177 
    CALL    ECUYS2                      ;0764  cd c8 07      1171   1178 
    LD  A,E                             ;0767  7b            1172   1179 
    POP DE                              ;0768  d1            1173   1180 
    SUB E                               ;0769  93            1174   1181 
    CP  8                               ;076a  fe 08         1175   1182 
    JR  C,L0770                         ;076c  38 02         1176   1183 
    LD  A,7                             ;076e  3e 07         1177   1184 
L0770:  RLCA                            ;0770  07            1178   1185 
    RLCA                                ;0771  07            1179   1186 
    RLCA                                ;0772  07            1180   1187 
    RLCA                                ;0773  07            1181   1188 
    RLCA                                ;0774  07            1182   1189 
    LD  D,A                             ;0775  57            1183   1190 
    LD  H,E                             ;0776  63            1184   1191 
    LD  L,0                             ;0777  2e 00         1185   1192 
    CALL    ADRCA2                      ;0779  cd 3b 09      1186   1193 
    POP HL                              ;077c  e1            1187   1194 
    PUSH    HL                          ;077d  e5            1188   1195 
CRJOBL: CALL    AINBC                   ;077e  cd 94 07      1189   1196 
    OR  A                               ;0781  b7            1190   1197 
    JR  NZ,L0786                        ;0782  20 02         1191   1198 
    LD  A,020h                          ;0784  3e 20         1192   1199 
L0786:  LD  (HL),A                      ;0786  77            1193   1200 
    INC HL                              ;0787  23            1194   1201 
    INC BC                              ;0788  03            1195   1202 
    DEC D                               ;0789  15            1196   1203 
    JR  NZ,CRJOBL                       ;078a  20 f2         1197   1204 
    LD  A,020h                          ;078c  3e 20         1198   1205 
CRJOBP: DEC HL                          ;078e  2b            1199   1206 
    CP  (HL)                            ;078f  be            1200   1207 
    JR  Z,CRJOBP                        ;0790  28 fc         1201   1208 
    JR  CRJOB2                          ;0792  18 bd         1202   1209 
                                        ;                    1203   1210 ;
AINBC:  PUSH    BC                      ;0794  c5            1204   1211 ;INSERT키가 눌리면 그 라인의 TEXT 끝부터 32번
    IN  A,(C)                           ;0795  ed 78         1205   1212 ;COLUMN 사이에 BLANK가 있는지 확인
    AND 07Fh                            ;0797  e6 7f         1206   1213 
    SET 3,B                             ;0799  cb d8         1207   1214 
    IN  C,(C)                           ;079b  ed 48         1208   1215 
    BIT 2,C                             ;079d  cb 51         1209   1216 
    JR  Z,ALPHA                         ;079f  28 0a         1210   1217 
    BIT 3,C                             ;07a1  cb 59         1211   1218 
    JR  NZ,SEMI6                        ;07a3  20 12         1212   1219 
    AND 00Fh                            ;07a5  e6 0f         1213   1220 
    ADD A,0E0h                          ;07a7  c6 e0         1214   1221 
    JR  AINOK                           ;07a9  18 0a         1215   1222 
ALPHA:  BIT 3,C                         ;07ab  cb 59         1216   1223 
    JR  Z,AINOK                         ;07ad  28 06         1217   1224 
    CP  060h                            ;07af  fe 60         1218   1225 
    JR  NC,AINOK                        ;07b1  30 02         1219   1226 
    ADD A,080h                          ;07b3  c6 80         1220   1227 
AINOK:  POP BC                          ;07b5  c1            1221   1228 
    RET                                 ;07b6  c9            1222   1229 
SEMI6:  POP BC                          ;07b7  c1            1223   1230 
    XOR A                               ;07b8  af            1224   1231 
    RET                                 ;07b9  c9            1225   1232 
                                        ;                    1226   1233 ;
BCUYST: CALL    CUTBHL                  ;07ba  cd d3 07      1227   1234 
    XOR A                               ;07bd  af            1228   1235 
LPBNST: CP  (HL)                        ;07be  be            1229   1236 
    RET Z                               ;07bf  c8            1230   1237 
    DEC HL                              ;07c0  2b            1231   1238 
    DEC E                               ;07c1  1d            1232   1239 
    JR  NZ,LPBNST                       ;07c2  20 fa         1233   1240 
    RET                                 ;07c4  c9            1234   1241 
                                        ;                    1235   1242 ;
ECUYST: CALL    CUTBHL                  ;07c5  cd d3 07      1236   1243 
ECUYS2: INC HL                          ;07c8  23            1237   1244 
    INC E                               ;07c9  1c            1238   1245 
    LD  A,E                             ;07ca  7b            1239   1246 
    CP  16                              ;07cb  fe 10         1240   1247 ;16라인(1페이지)를 통과했는지 체크
    RET NC                              ;07cd  d0            1241   1248 
    XOR A                               ;07ce  af            1242   1249 
    CP  (HL)                            ;07cf  be            1243   1250 
    JR  NZ,ECUYS2                       ;07d0  20 f6         1244   1251 
    RET                                 ;07d2  c9            1245   1252 
                                        ;                    1246   1253 ;
CUTBHL: LD  A,(CURY)                    ;07d3  3a ee 11      1247   1254 
ATBHL:  LD  E,A                         ;07d6  5f            1248   1255 
    LD  D,0                             ;07d7  16 00         1249   1256 
    LD  HL,(LINEFR)                     ;07d9  2a fa 0a      1250   1257 
    ADD HL,DE                           ;07dc  19            1251   1258 ;CURY+LINEFR(01 OR 00)
    RET                                 ;07dd  c9            1252   1259 
                                        ;                    1253   1260 ;
                                        ;                    1254   1261 ; OUTPUT
CR1DEP: CALL    CR1                     ;07de  cd 43 08      1255   1262 
                                        ;                    1256   1263 ;
PRTSDC: PUSH    AF                      ;07e1  f5            1257   1264 
    PUSH    BC                          ;07e2  c5            1258   1265 
    PUSH    DE                          ;07e3  d5            1259   1266 
    LD  A,B                             ;07e4  78            1260   1267 
    OR  A                               ;07e5  b7            1261   1268 
    JR  Z,PRTSDE                        ;07e6  28 07         1262   1269 
PRTSDL: LD  A,(DE)                      ;07e8  1a            1263   1270 
    INC DE                              ;07e9  13            1264   1271 
    CALL    ACCPRT                      ;07ea  cd 64 08      1265   1272 
    DJNZ    PRTSDL                      ;07ed  10 f9         1266   1273 
PRTSDE: POP DE                          ;07ef  d1            1267   1274 
    POP BC                              ;07f0  c1            1268   1275 
    POP AF                              ;07f1  f1            1269   1276 
    RET                                 ;07f2  c9            1270   1277 
                                        ;                    1271   1278 ;
DEPRT:  PUSH    AF                      ;07f3  f5            1272   1279 
    PUSH    DE                          ;07f4  d5            1273   1280 
DEPRTL: LD  A,(DE)                      ;07f5  1a            1274   1281 
    OR  A                               ;07f6  b7            1275   1282 
    JR  Z,DEPRTR                        ;07f7  28 06         1276   1283 
    CALL    ACCPRT                      ;07f9  cd 64 08      1277   1284 
    INC DE                              ;07fc  13            1278   1285 
    JR  DEPRTL                          ;07fd  18 f6         1279   1286 
DEPRTR: POP DE                          ;07ff  d1            1280   1287 
    POP AF                              ;0800  f1            1281   1288 
    RET                                 ;0801  c9            1282   1289 
                                        ;                    1283   1290 ;
                                        ;                    1284   1291 ;
TABPRT: PUSH    HL                      ;0802  e5            1285   1292 
    LD  A,(DISFLG)                      ;0803  3a eb 11      1286   1293 
    CP  2                               ;0806  fe 02         1287   1294 
    LD  HL,CURX                         ;0808  21 ed 11      1288   1295 
    JR  C,TABPRL                        ;080b  38 0c         1289   1296 
    LD  HL,PRINTN                       ;080d  21 ec 11      1290   1297 
    JR  Z,TABPRL                        ;0810  28 07         1291   1298 
    LD  A,','                           ;0812  3e 2c         1292   1299 ;02Ch
    CALL    ACCPRT                      ;0814  cd 64 08      1293   1300 
    POP HL                              ;0817  e1            1294   1301 
    RET                                 ;0818  c9            1295   1302 
                                        ;                    1296   1303 ;
TABPRL: CALL    SPPRT                   ;0819  cd 62 08      1297   1304 
    LD  A,(HL)                          ;081c  7e            1298   1305 
    AND 7                               ;081d  e6 07         1299   1306 
    JR  NZ,TABPRL                       ;081f  20 f8         1300   1307 
    POP HL                              ;0821  e1            1301   1308 
    RET                                 ;0822  c9            1302   1309 
                                        ;                    1303   1310 ;
CR2:    LD  A,(DISFLG)                  ;0823  3a eb 11      1304   1311 
    CP  2                               ;0826  fe 02         1305   1312 
    JR  C,CCR2                          ;0828  38 09         1306   1313 
    JR  NZ,CR1                          ;082a  20 17         1307   1314 
    LD  A,(PRINTN)                      ;082c  3a ec 11      1308   1315 
    OR  A                               ;082f  b7            1309   1316 
    RET Z                               ;0830  c8            1310   1317 
    JR  CR1                             ;0831  18 10         1311   1318 
CCR2:   LD  A,(CURX)                    ;0833  3a ed 11      1312   1319 
    OR  A                               ;0836  b7            1313   1320 
    JR  NZ,CR1                          ;0837  20 0a         1314   1321 
    PUSH    HL                          ;0839  e5            1315   1322 
    PUSH    DE                          ;083a  d5            1316   1323 
    CALL    CUTBHL                      ;083b  cd d3 07      1317   1324 
    LD  A,(HL)                          ;083e  7e            1318   1325 
    POP DE                              ;083f  d1            1319   1326 
    POP HL                              ;0840  e1            1320   1327 
    OR  A                               ;0841  b7            1321   1328 
    RET Z                               ;0842  c8            1322   1329 
                                        ;                    1323   1330 ;
CR1:    LD  A,(DISFLG)                  ;0843  3a eb 11      1324   1331 
    OR  A                               ;0846  b7            1325   1332 
    JR  Z,CR1CTM                        ;0847  28 0f         1326   1333 
    CP  2                               ;0849  fe 02         1327   1334 
    LD  A,00Dh                          ;084b  3e 0d         1328   1335 
    JR  NZ,ACCPRT                       ;084d  20 15         1329   1336 
    LD  A,0FFh                          ;084f  3e ff         1330   1337 
    LD  (PRINTN),A                      ;0851  32 ec 11      1331   1338 
    LD  A,00Ah                          ;0854  3e 0a         1332   1339 
    JR  ACCPRT                          ;0856  18 0c         1333   1340 
                                        ;                    1334   1341 ;
CR1CTM: PUSH    BC                      ;0858  c5            1335   1342 
    PUSH    DE                          ;0859  d5            1336   1343 
    PUSH    HL                          ;085a  e5            1337   1344 
    CALL    CTRLM                       ;085b  cd 62 0b      1338   1345 
    POP HL                              ;085e  e1            1339   1346 
    POP DE                              ;085f  d1            1340   1347 
    POP BC                              ;0860  c1            1341   1348 
    RET                                 ;0861  c9            1342   1349 
                                        ;                    1343   1350 ;
SPPRT:  LD  A,' '                       ;0862  3e 20         1344   1351 ;020h
                                        ;                    1345   1352 ;
ACCPRT: PUSH    AF                      ;0864  f5            1346   1353 
    PUSH    BC                          ;0865  c5            1347   1354 
    PUSH    DE                          ;0866  d5            1348   1355 
    PUSH    HL                          ;0867  e5            1349   1356 
    CALL    ACCOUS                      ;0868  cd 70 08      1350   1357 
    POP HL                              ;086b  e1            1351   1358 
    POP DE                              ;086c  d1            1352   1359 
    POP BC                              ;086d  c1            1353   1360 
    POP AF                              ;086e  f1            1354   1361 
    RET                                 ;086f  c9            1355   1362 
                                        ;                    1356   1363 ;
ACCOUS: LD  HL,(DISFLG)                 ;0870  2a eb 11      1357   1364 
    INC L                               ;0873  2c            1358   1365 
    DEC L                               ;0874  2d            1359   1366 
    JP  Z,ACCDIS                        ;0875  ca de 08      1360   1367 
    DEC L                               ;0878  2d            1361   1368 
    JP  Z,ACCOUT                        ;0879  ca d9 08      1362   1369 
    DEC L                               ;087c  2d            1363   1370 
    JP  NZ,CTOUT                        ;087d  c2 58 45      1364   1371 
    LD  HL,(PRINTN)                     ;0880  2a ec 11      1365   1372 
    INC L                               ;0883  2c            1366   1373 
    LD  (PRINTN),HL                     ;0884  22 ec 11      1367   1374 
                                        ;                    1368   1375 ;
PRINTR: PUSH    AF                      ;0887  f5            1369   1376 
    CALL    PSGST                       ;0888  cd a9 08      1370   1377 
    LD  E,000h                          ;088b  1e 00         1371   1378 
    CALL    PRTRDY                      ;088d  cd bb 08      1372   1379 
    LD  A,15                            ;0890  3e 0f         1373   1380 
    OUT (C),A                           ;0892  ed 79         1374   1381 
    INC C                               ;0894  0c            1375   1382 
    POP AF                              ;0895  f1            1376   1383 
    OUT (C),A                           ;0896  ed 79         1377   1384 
    DEC C                               ;0898  0d            1378   1385 
    LD  A,(IO6000)                      ;0899  3a e9 11      1379   1386 
    OR  004h                            ;089c  f6 04         1380   1387 
    CALL    IO60SB                      ;089e  cd 6b 00      1381   1388 
    LD  A,(IO6000)                      ;08a1  3a e9 11      1382   1389 
    AND 0FBh                            ;08a4  e6 fb         1383   1390 
    JP  IO60SB                          ;08a6  c3 6b 00      1384   1391 
                                        ;                    1385   1392 ;
PSGST:  LD  BC,04000h                   ;08a9  01 00 40      1386   1393 
    LD  A,7                             ;08ac  3e 07         1387   1394 
    OUT (C),A                           ;08ae  ed 79         1388   1395 
    INC C                               ;08b0  0c            1389   1396 
    IN  A,(C)                           ;08b1  ed 78         1390   1397 
    AND 03Fh                            ;08b3  e6 3f         1391   1398 
    OR  080h                            ;08b5  f6 80         1392   1399 
    OUT (C),A                           ;08b7  ed 79         1393   1400 
    DEC C                               ;08b9  0d            1394   1401 
    RET                                 ;08ba  c9            1395   1402 
                                        ;                    1396   1403 ;
PRTRDY: LD  HL,01000h                   ;08bb  21 00 10      1397   1404 
    LD  D,0                             ;08be  16 00         1398   1405 
    LD  A,14                            ;08c0  3e 0e         1399   1406 
    OUT (C),A                           ;08c2  ed 79         1400   1407 
WAITLP: INC C                           ;08c4  0c            1401   1408 
    IN  A,(C)                           ;08c5  ed 78         1402   1409 
    DEC C                               ;08c7  0d            1403   1410 
    AND 020h                            ;08c8  e6 20         1404   1411 
    CP  E                               ;08ca  bb            1405   1412 
    RET Z                               ;08cb  c8            1406   1413 
    DEC D                               ;08cc  15            1407   1414 
    JR  NZ,WAITLP                       ;08cd  20 f5         1408   1415 
    DEC HL                              ;08cf  2b            1409   1416 
    LD  A,H                             ;08d0  7c            1410   1417 
    OR  L                               ;08d1  b5            1411   1418 
    JR  NZ,WAITLP                       ;08d2  20 f0         1412   1419 
    LD  A,28                            ;08d4  3e 1c         1413   1420 
    JP  ERROR                           ;08d6  c3 96 21      1414   1421 
                                        ;                    1415   1422 ;
ACCOUT: CP  ' '                         ;08d9  fe 20         1416   1423 ;020h
    JP  C,CTRLSB                        ;08db  da 81 0a      1417   1424 
ACCDIS: PUSH    AF                      ;08de  f5            1418   1425 
    LD  A,(GMODEF)                      ;08df  3a 06 1c      1419   1426 ;GMODEF 2,3 X
    CP  2                               ;08e2  fe 02         1420   1427 
    JR  C,ACCOL1                        ;08e4  38 09         1421   1428 
    CP  4                               ;08e6  fe 04         1422   1429 
    POP BC                              ;08e8  c1            1423   1430 
    RET C                               ;08e9  d8            1424   1431 
    CALL    GACPRT                      ;08ea  cd 4f 09      1425   1432 
    JR  ACCOL2                          ;08ed  18 07         1426   1433 
ACCOL1: CALL    ADRCAL                  ;08ef  cd 38 09      1427   1434 
    POP AF                              ;08f2  f1            1428   1435 
    CALL    BCOUTA                      ;08f3  cd 3f 0a      1429   1436 ; 0a3fh
ACCOL2: LD  HL,(CURX)                   ;08f6  2a ed 11      1430   1437 
    INC L                               ;08f9  2c            1431   1438 
    LD  A,L                             ;08fa  7d            1432   1439 
    CP  020h                            ;08fb  fe 20         1433   1440 ;다음줄 체크
    JR  C,CURSET                        ;08fd  38 35         1434   1441 
    INC H                               ;08ff  24            1435   1442 
    LD  B,1                             ;0900  06 01         1436   1443 
CTRLM?: LD  A,H                         ;0902  7c            1437   1444 
    CP  16                              ;0903  fe 10         1438   1445 
    JR  C,CURSE?                        ;0905  38 24         1439   1446 
    PUSH    BC                          ;0907  c5            1440   1447 ;16줄(1페이지) 체크
PAGE02: LD  BC,00200h                   ;0908  01 00 02      1441   1448 ;CLR CHR
    LD  A,000h                          ;090b  3e 00         1442   1449 ; 소스는 020h
    LD  D,020h                          ;090d  16 20         1443   1450 
SCRLC1: OUT (C),A                       ;090f  ed 79         1444   1451 
    INC BC                              ;0911  03            1445   1452 
    DEC D                               ;0912  15            1446   1453 
    JR  NZ,SCRLC1                       ;0913  20 fa         1447   1454 
PAGE04: LD  BC,00A00h                   ;0915  01 00 0a      1448   1455 
    LD  A,(COLORF)                      ;0918  3a 80 11      1449   1456 
    AND 003h                            ;091b  e6 03         1450   1457 
    LD  D,020h                          ;091d  16 20         1451   1458 
SCRLC2: OUT (C),A                       ;091f  ed 79         1452   1459 
    INC BC                              ;0921  03            1453   1460 
    DEC D                               ;0922  15            1454   1461 
    JR  NZ,SCRLC2                       ;0923  20 fa         1455   1462 
    CALL    SCRLUP                      ;0925  cd 91 09      1456   1463 
    LD  H,15                            ;0928  26 0f         1457   1464 
    POP BC                              ;092a  c1            1458   1465 
CURSE?: LD  A,H                         ;092b  7c            1459   1466 
    PUSH    HL                          ;092c  e5            1460   1467 
    CALL    ATBHL                       ;092d  cd d6 07      1461   1468 
    LD  (HL),B                          ;0930  70            1462   1469 
    POP HL                              ;0931  e1            1463   1470 
    LD  L,0                             ;0932  2e 00         1464   1471 
CURSET: LD  (CURX),HL                   ;0934  22 ed 11      1465   1472 
    RET                                 ;0937  c9            1466   1473 
                                        ;                    1467   1474 ;
                                        ;                    1468   1475 ; VIDEO RAM ADDRESS CALCULATION
ADRCAL: LD  HL,(CURX)                   ;0938  2a ed 11      1469   1476 
ADRCA2: XOR A                           ;093b  af            1470   1477 
    SRL H                               ;093c  cb 3c         1471   1478 
    RRA                                 ;093e  1f            1472   1479 
    SRL H                               ;093f  cb 3c         1473   1480 
    RRA                                 ;0941  1f            1474   1481 
    SRL H                               ;0942  cb 3c         1475   1482 
    RRA                                 ;0944  1f            1476   1483 
    OR  L                               ;0945  b5            1477   1484 
PAGE05: LD  BC,0                        ;0946  01 00 00      1478   1485 ;OFSET
    ADD A,C                             ;0949  81            1479   1486 
    LD  C,A                             ;094a  4f            1480   1487 
    LD  A,B                             ;094b  78            1481   1488 
    ADC A,H                             ;094c  8c            1482   1489 
    LD  B,A                             ;094d  47            1483   1490 
    RET                                 ;094e  c9            1484   1491 
                                        ;                    1485   1492 ;
                                        ;                    1486   1493 ;SEMI GRAPHIC
GACPRT: LD  A,B                         ;094f  78            1487   1494 
    CP  060h                            ;0950  fe 60         1488   1495 
    JR  C,ROMACP                        ;0952  38 07         1489   1496 
    AND 07Fh                            ;0954  e6 7f         1490   1497 
    LD  DE,$CGBUF                       ;0956  11 4a 55      1491   1498 ;LD DE,0554Ah
    JR  GACPR1                          ;0959  18 05         1492   1499 
ROMACP: SUB ' '                         ;095b  d6 20         1493   1500 ;020h
    LD  DE,CGCHR                        ;095d  11 4a 52      1494   1501 ;LD DE,0524Ah
GACPR1: LD  L,A                         ;0960  6f            1495   1502 
    LD  H,0                             ;0961  26 00         1496   1503 
    ADD HL,HL                           ;0963  29            1497   1504 
    ADD HL,HL                           ;0964  29            1498   1505 
    LD  C,L                             ;0965  4d            1499   1506 ;BC=A*4
    LD  B,H                             ;0966  44            1500   1507 
    ADD HL,HL                           ;0967  29            1501   1508 ;HL=A*8
    ADD HL,BC                           ;0968  09            1502   1509 ;HL=A*12
    ADD HL,DE                           ;0969  19            1503   1510 ;HL=A*12+BASE
    EX  DE,HL                           ;096a  eb            1504   1511 ;DE=A*12+BASE
    LD  HL,(CURX)                       ;096b  2a ed 11      1505   1512 
    LD  A,L                             ;096e  7d            1506   1513 
    LD  L,0                             ;096f  2e 00         1507   1514 
    LD  C,L                             ;0971  4d            1508   1515 
    LD  B,H                             ;0972  44            1509   1516 
    SRL B                               ;0973  cb 38         1510   1517 
    RR  C                               ;0975  cb 19         1511   1518 
    ADD HL,BC                           ;0977  09            1512   1519 
    LD  C,A                             ;0978  4f            1513   1520 
    LD  B,0                             ;0979  06 00         1514   1521 
    ADD HL,BC                           ;097b  09            1515   1522 
    LD  C,L                             ;097c  4d            1516   1523 
    LD  B,H                             ;097d  44            1517   1524 
    EX  DE,HL                           ;097e  eb            1518   1525 
    LD  E,12                            ;097f  1e 0c         1519   1526 
GACPRL: LD  D,(HL)                      ;0981  56            1520   1527 
    OUT (C),D                           ;0982  ed 51         1521   1528 
    INC HL                              ;0984  23            1522   1529 
    LD  A,020h                          ;0985  3e 20         1523   1530 
    ADD A,C                             ;0987  81            1524   1531 
    LD  C,A                             ;0988  4f            1525   1532 
    LD  A,0                             ;0989  3e 00         1526   1533 
    ADC A,B                             ;098b  88            1527   1534 
    LD  B,A                             ;098c  47            1528   1535 
    DEC E                               ;098d  1d            1529   1536 
    JR  NZ,GACPRL                       ;098e  20 f1         1530   1537 
    RET                                 ;0990  c9            1531   1538 
                                        ;                    1532   1539 ;
                                        ;                    1533   1540 ;
SCRLUP: EXX                             ;0991  d9            1534   1541 
    PUSH    BC                          ;0992  c5            1535   1542 
    PUSH    DE                          ;0993  d5            1536   1543 
    PUSH    HL                          ;0994  e5            1537   1544 
    LD  BC,(CHRSTA)                     ;0995  ed 4b d6 0a   1538   1545 
    LD  DE,(CHRLE2)                     ;0999  ed 5b fc 09   1539   1546 
    CALL    BCLDIR                      ;099d  cd be 09      1540   1547 
    LD  BC,(ATRSTA)                     ;09a0  ed 4b e6 0a   1541   1548 
    LD  DE,(CHRLE2)                     ;09a4  ed 5b fc 09   1542   1549 
    CALL    BCLDIR                      ;09a8  cd be 09      1543   1550 
                                        ;                    1544   1551 ;LINE FLG SCROLL
    LD  DE,(LINEFR)                     ;09ab  ed 5b fa 0a   1545   1552 
    LD  H,D                             ;09af  62            1546   1553 
    LD  L,E                             ;09b0  6b            1547   1554 
    INC HL                              ;09b1  23            1548   1555 
PAGE11: LD  BC,63                       ;09b2  01 3f 00      1549   1556 
    LD  A,(DE)                          ;09b5  1a            1550   1557 
    LDIR                                ;09b6  ed b0         1551   1558 
    LD  (DE),A                          ;09b8  12            1552   1559 
    POP HL                              ;09b9  e1            1553   1560 
    POP DE                              ;09ba  d1            1554   1561 
    POP BC                              ;09bb  c1            1555   1562 
    EXX                                 ;09bc  d9            1556   1563 
    RET                                 ;09bd  c9            1557   1564 
                                        ;                    1558   1565 ;
BCLDIR: PUSH    BC                      ;09be  c5            1559   1566 
    EXX                                 ;09bf  d9            1560   1567 
    POP BC                              ;09c0  c1            1561   1568 
    LD  HL,SCRLBF                       ;09c1  21 82 11      1562   1569 
    LD  E,020h                          ;09c4  1e 20         1563   1570 
BCLDL1: IN  A,(C)                       ;09c6  ed 78         1564   1571 
    LD  (HL),A                          ;09c8  77            1565   1572 
    INC BC                              ;09c9  03            1566   1573 
    INC HL                              ;09ca  23            1567   1574 
    DEC E                               ;09cb  1d            1568   1575 
    JR  NZ,BCLDL1                       ;09cc  20 f8         1569   1576 
BCLDL2: IN  A,(C)                       ;09ce  ed 78         1570   1577 
    INC BC                              ;09d0  03            1571   1578 
    EXX                                 ;09d1  d9            1572   1579 
    OUT (C),A                           ;09d2  ed 79         1573   1580 
    INC BC                              ;09d4  03            1574   1581 
    DEC DE                              ;09d5  1b            1575   1582 
    LD  A,D                             ;09d6  7a            1576   1583 
    OR  E                               ;09d7  b3            1577   1584 
    EXX                                 ;09d8  d9            1578   1585 
    JR  NZ,BCLDL2                       ;09d9  20 f3         1579   1586 
    EXX                                 ;09db  d9            1580   1587 
    LD  HL,SCRLBF                       ;09dc  21 82 11      1581   1588 
    LD  E,020h                          ;09df  1e 20         1582   1589 
BCLDL3: LD  A,(HL)                      ;09e1  7e            1583   1590 
    OUT (C),A                           ;09e2  ed 79         1584   1591 
    INC HL                              ;09e4  23            1585   1592 
    INC BC                              ;09e5  03            1586   1593 
    DEC E                               ;09e6  1d            1587   1594 
    JR  NZ,BCLDL3                       ;09e7  20 f8         1588   1595 
    RET                                 ;09e9  c9            1589   1596 
                                        ;                    1590   1597 ;
                                        ;                    1591   1598 ;
                                        ;                    1592   1599 ;SCROLL DOWN
SCRLDW: EXX                             ;09ea  d9            1593   1600 
    PUSH    BC                          ;09eb  c5            1594   1601 
    PUSH    DE                          ;09ec  d5            1595   1602 
    PUSH    HL                          ;09ed  e5            1596   1603 
PAGE12: LD  BC,007FFh                   ;09ee  01 ff 07      1597   1604 ;★원래는 DEPRTR
    LD  DE,(CHRLE2)                     ;09f1  ed 5b fc 09   1598   1605 
    CALL    BCLDDR                      ;09f5  cd 13 0a      1599   1606 
PAGE14: LD  BC,00FFFh                   ;09f8  01 ff 0f      1600   1607 
    DEFB    11h                         ;09fb  11            1601   1608 ; LD DE,
CHRLE2: DEFW    007E0h                  ;09fc  e0 07         1602   1609 
    CALL    BCLDDR                      ;09fe  cd 13 0a      1603   1610 
                                        ;                    1604   1611 ;LINE FLG SCROLL
PAGE16: LD  DE,LINEF+63                 ;0a01  11 e1 11      1605   1612 
    LD  L,E                             ;0a04  6b            1606   1613 
    LD  H,D                             ;0a05  62            1607   1614 
    DEC HL                              ;0a06  2b            1608   1615 
PAGE17: LD  BC,63                       ;0a07  01 3f 00      1609   1616 
    LD  A,(DE)                          ;0a0a  1a            1610   1617 
    LDDR                                ;0a0b  ed b8         1611   1618 
    LD  (DE),A                          ;0a0d  12            1612   1619 
    POP HL                              ;0a0e  e1            1613   1620 
    POP DE                              ;0a0f  d1            1614   1621 
    POP BC                              ;0a10  c1            1615   1622 
    EXX                                 ;0a11  d9            1616   1623 
    RET                                 ;0a12  c9            1617   1624 
                                        ;                    1618   1625 ;
BCLDDR: PUSH    BC                      ;0a13  c5            1619   1626 
    EXX                                 ;0a14  d9            1620   1627 
    POP BC                              ;0a15  c1            1621   1628 
    LD  HL,SCRLBF+01Fh                  ;0a16  21 a1 11      1622   1629 
    LD  E,020h                          ;0a19  1e 20         1623   1630 
BCLDD1: IN  A,(C)                       ;0a1b  ed 78         1624   1631 
    LD  (HL),A                          ;0a1d  77            1625   1632 
    DEC BC                              ;0a1e  0b            1626   1633 
    DEC HL                              ;0a1f  2b            1627   1634 
    DEC E                               ;0a20  1d            1628   1635 
    JR  NZ,BCLDD1                       ;0a21  20 f8         1629   1636 
BCLDD2: IN  A,(C)                       ;0a23  ed 78         1630   1637 
    DEC BC                              ;0a25  0b            1631   1638 
    EXX                                 ;0a26  d9            1632   1639 
    OUT (C),A                           ;0a27  ed 79         1633   1640 
    DEC BC                              ;0a29  0b            1634   1641 
    DEC DE                              ;0a2a  1b            1635   1642 
    LD  A,D                             ;0a2b  7a            1636   1643 
    OR  E                               ;0a2c  b3            1637   1644 
    EXX                                 ;0a2d  d9            1638   1645 
    JR  NZ,BCLDD2                       ;0a2e  20 f3         1639   1646 
    EXX                                 ;0a30  d9            1640   1647 
    LD  HL,SCRLBF+01Fh                  ;0a31  21 a1 11      1641   1648 
    LD  E,020h                          ;0a34  1e 20         1642   1649 
BCLDD3: LD  A,(HL)                      ;0a36  7e            1643   1650 
    OUT (C),A                           ;0a37  ed 79         1644   1651 
    DEC HL                              ;0a39  2b            1645   1652 
    DEC BC                              ;0a3a  0b            1646   1653 
    DEC E                               ;0a3b  1d            1647   1654 
    JR  NZ,BCLDD3                       ;0a3c  20 f8         1648   1655 
    RET                                 ;0a3e  c9            1649   1656 
                                        ;                    1650   1657 ;
                                        ;                    1651   1658 ; 화면에 문자 출력
BCOUTA: CP  'a'-1                       ;0a3f  fe 60         1652   1659 ;060h
    JR  C,BCOTOK                        ;0a41  38 14         1653   1660 
    CP  0E0h                            ;0a43  fe e0         1654   1661 
    JR  NC,SEMIOT                       ;0a45  30 1c         1655   1662 
    AND 07Fh                            ;0a47  e6 7f         1656   1663 
    OUT (C),A                           ;0a49  ed 79         1657   1664 
    SET 3,B                             ;0a4b  cb d8         1658   1665 
    LD  A,(COLORF)                      ;0a4d  3a 80 11      1659   1666 
    AND 3                               ;0a50  e6 03         1660   1667 
    OR  8                               ;0a52  f6 08         1661   1668 
    OUT (C),A                           ;0a54  ed 79         1662   1669 
    RET                                 ;0a56  c9            1663   1670 
                                        ;                    1664   1671 ;
BCOTOK: OUT (C),A                       ;0a57  ed 79         1665   1672 
    SET 3,B                             ;0a59  cb d8         1666   1673 
    LD  A,(COLORF)                      ;0a5b  3a 80 11      1667   1674 
    AND 3                               ;0a5e  e6 03         1668   1675 
    OUT (C),A                           ;0a60  ed 79         1669   1676 
    RET                                 ;0a62  c9            1670   1677 
                                        ;                    1671   1678 ;
SEMIOT: AND 00Fh                        ;0a63  e6 0f         1672   1679 
    PUSH    DE                          ;0a65  d5            1673   1680 
    LD  D,A                             ;0a66  57            1674   1681 
    LD  A,(COLORF)                      ;0a67  3a 80 11      1675   1682 
    DEC A                               ;0a6a  3d            1676   1683 
    AND 7                               ;0a6b  e6 07         1677   1684 
    RLCA                                ;0a6d  07            1678   1685 
    RLCA                                ;0a6e  07            1679   1686 
    RLCA                                ;0a6f  07            1680   1687 
    RLCA                                ;0a70  07            1681   1688 
    OR  D                               ;0a71  b2            1682   1689 
    POP DE                              ;0a72  d1            1683   1690 
    OUT (C),A                           ;0a73  ed 79         1684   1691 
    SET 3,B                             ;0a75  cb d8         1685   1692 
    LD  A,(COLORF)                      ;0a77  3a 80 11      1686   1693 
    AND 3                               ;0a7a  e6 03         1687   1694 
    OR  4                               ;0a7c  f6 04         1688   1695 
    OUT (C),A                           ;0a7e  ed 79         1689   1696 
    RET                                 ;0a80  c9            1690   1697 
                                        ;                    1691   1698 ;
CTRLSB: LD  L,A                         ;0a81  6f            1692   1699 
    LD  H,0                             ;0a82  26 00         1693   1700 
    ADD HL,HL                           ;0a84  29            1694   1701 
    LD  BC,CTRLTB                       ;0a85  01 3f 11      1695   1702 
    ADD HL,BC                           ;0a88  09            1696   1703 
    LD  A,(HL)                          ;0a89  7e            1697   1704 
    INC HL                              ;0a8a  23            1698   1705 
    LD  H,(HL)                          ;0a8b  66            1699   1706 
    LD  L,A                             ;0a8c  6f            1700   1707 
    JP  (HL)                            ;0a8d  e9            1701   1708 
                                        ;                    1702   1709 ;
DELETE: CALL    ADRCAL                  ;0a8e  cd 38 09      1703   1710 
    PUSH    BC                          ;0a91  c5            1704   1711 
    CALL    ECUYST                      ;0a92  cd c5 07      1705   1712 
    LD  H,E                             ;0a95  63            1706   1713 
    LD  L,0                             ;0a96  2e 00         1707   1714 
    CALL    ADRCA2                      ;0a98  cd 3b 09      1708   1715 
    POP DE                              ;0a9b  d1            1709   1716 
    LD  L,C                             ;0a9c  69            1710   1717 
    LD  H,B                             ;0a9d  60            1711   1718 
    OR  A                               ;0a9e  b7            1712   1719 
    SBC HL,DE                           ;0a9f  ed 52         1713   1720 
    LD  D,000h                          ;0aa1  16 00         1714   1721 ;★구버전,신버전 00H,20H ???
    LD  A,(COLORF)                      ;0aa3  3a 80 11      1715   1722 
    AND 3                               ;0aa6  e6 03         1716   1723 
    LD  E,A                             ;0aa8  5f            1717   1724 
DELLP1: DEC BC                          ;0aa9  0b            1718   1725 
    IN  A,(C)                           ;0aaa  ed 78         1719   1726 
    OUT (C),D                           ;0aac  ed 51         1720   1727 
    LD  D,A                             ;0aae  57            1721   1728 
    SET 3,B                             ;0aaf  cb d8         1722   1729 
    IN  A,(C)                           ;0ab1  ed 78         1723   1730 
    OUT (C),E                           ;0ab3  ed 59         1724   1731 
    LD  E,A                             ;0ab5  5f            1725   1732 
    RES 3,B                             ;0ab6  cb 98         1726   1733 
    DEC HL                              ;0ab8  2b            1727   1734 
    LD  A,H                             ;0ab9  7c            1728   1735 
    OR  L                               ;0aba  b5            1729   1736 
    JR  NZ,DELLP1                       ;0abb  20 ec         1730   1737 
    LD  A,(CURX)                        ;0abd  3a ed 11      1731   1738 
    OR  A                               ;0ac0  b7            1732   1739 
    JR  NZ,DELLP2                       ;0ac1  20 08         1733   1740 
    PUSH    DE                          ;0ac3  d5            1734   1741 
    CALL    CUTBHL                      ;0ac4  cd d3 07      1735   1742 
    LD  A,(HL)                          ;0ac7  7e            1736   1743 
    POP DE                              ;0ac8  d1            1737   1744 
    OR  A                               ;0ac9  b7            1738   1745 
    RET Z                               ;0aca  c8            1739   1746 
DELLP2: DEC BC                          ;0acb  0b            1740   1747 
    OUT (C),D                           ;0acc  ed 51         1741   1748 
    SET 3,B                             ;0ace  cb d8         1742   1749 
    OUT (C),E                           ;0ad0  ed 59         1743   1750 
    JP  LEFT                            ;0ad2  c3 48 0b      1744   1751 
                                        ;                    1745   1752 ;
CLR2:   DEFB    001h                    ;0ad5  01            1746   1753 ;LD BC,(CHRSTA)
CHRSTA: DEFW    00000h                  ;0ad6  00 00         1747   1754 ;SEMIGRAPHIC ADR.+
    LD  HL,(CHRLEN)                     ;0ad8  2a e9 0a      1748   1755 
    LD  D,000h                          ;0adb  16 00         1749   1756 ;★구버전,신버전 00H,20H ???
CLRLP:  OUT (C),D                       ;0add  ed 51         1750   1757 
    INC BC                              ;0adf  03            1751   1758 
    DEC HL                              ;0ae0  2b            1752   1759 
    LD  A,H                             ;0ae1  7c            1753   1760 
    OR  L                               ;0ae2  b5            1754   1761 
    JR  NZ,CLRLP                        ;0ae3  20 f8         1755   1762 
    DEFB    001h                        ;0ae5  01            1756   1763 ;LD BC,(ATRSTA)
ATRSTA: DEFW    00800h                  ;0ae6  00 08         1757   1764 
    DEFB    021h                        ;0ae8  21            1758   1765 ;LD HL,(CHRLEN)
CHRLEN: DEFW    00800h                  ;0ae9  00 08         1759   1766 
    LD  A,(COLORF)                      ;0aeb  3a 80 11      1760   1767 
    AND 3                               ;0aee  e6 03         1761   1768 
    LD  D,A                             ;0af0  57            1762   1769 
ATRCLS: OUT (C),D                       ;0af1  ed 51         1763   1770 
    INC BC                              ;0af3  03            1764   1771 
    DEC HL                              ;0af4  2b            1765   1772 
    LD  A,H                             ;0af5  7c            1766   1773 
    OR  L                               ;0af6  b5            1767   1774 
    JR  NZ,ATRCLS                       ;0af7  20 f8         1768   1775 
    DEFB    021h                        ;0af9  21            1769   1776 ;LD HL,(LINEFR)
LINEFR: DEFW    LINEF                   ;0afa  a2 11         1770   1777 
PAGE23: LD  B,65                        ;0afc  06 41         1771   1778 
LINCLS: LD  (HL),0                      ;0afe  36 00         1772   1779 
    INC HL                              ;0b00  23            1773   1780 
    DJNZ    LINCLS                      ;0b01  10 fb         1774   1781 
HOME:   LD  HL,0                        ;0b03  21 00 00      1775   1782 
    JP  CURST2                          ;0b06  c3 83 0b      1776   1783 
                                        ;                    1777   1784 ;
INST:   CALL    ECUYST                  ;0b09  cd c5 07      1778   1785 
    LD  H,E                             ;0b0c  63            1779   1786 
    LD  L,0                             ;0b0d  2e 00         1780   1787 
    CALL    ADRCA2                      ;0b0f  cd 3b 09      1781   1788 
    DEC BC                              ;0b12  0b            1782   1789 
    CALL    AINBC                       ;0b13  cd 94 07      1783   1790 
    CP  021h                            ;0b16  fe 21         1784   1791 
    RET NC                              ;0b18  d0            1785   1792 
    PUSH    BC                          ;0b19  c5            1786   1793 
    CALL    ADRCAL                      ;0b1a  cd 38 09      1787   1794 
    POP HL                              ;0b1d  e1            1788   1795 
    OR  A                               ;0b1e  b7            1789   1796 
    SBC HL,BC                           ;0b1f  ed 42         1790   1797 
    LD  D,000h                          ;0b21  16 00         1791   1798 ;★구버전,신버전 00H,20H ???
    LD  A,(COLORF)                      ;0b23  3a 80 11      1792   1799 
    AND 3                               ;0b26  e6 03         1793   1800 
    LD  E,A                             ;0b28  5f            1794   1801 
    INC HL                              ;0b29  23            1795   1802 
INSTL1: IN  A,(C)                       ;0b2a  ed 78         1796   1803 
    OUT (C),D                           ;0b2c  ed 51         1797   1804 
    LD  D,A                             ;0b2e  57            1798   1805 
    SET 3,B                             ;0b2f  cb d8         1799   1806 
    IN  A,(C)                           ;0b31  ed 78         1800   1807 
    OUT (C),E                           ;0b33  ed 59         1801   1808 
    LD  E,A                             ;0b35  5f            1802   1809 
    RES 3,B                             ;0b36  cb 98         1803   1810 
    INC BC                              ;0b38  03            1804   1811 
    DEC HL                              ;0b39  2b            1805   1812 
    LD  A,H                             ;0b3a  7c            1806   1813 
    OR  L                               ;0b3b  b5            1807   1814 
    JR  NZ,INSTL1                       ;0b3c  20 ec         1808   1815 
    RET                                 ;0b3e  c9            1809   1816 
                                        ;                    1810   1817 ;
LOCK:   LD  A,1                         ;0b3f  3e 01         1811   1818 
LOCKST: LD  (LOCKMD),A                  ;0b41  32 03 12      1812   1819 
    RET                                 ;0b44  c9            1813   1820 
                                        ;                    1814   1821 ;
UNLOCK: XOR A                           ;0b45  af            1815   1822 
    JR  LOCKST                          ;0b46  18 f9         1816   1823 
                                        ;                    1817   1824 ;
LEFT:   LD  HL,(CURX)                   ;0b48  2a ed 11      1818   1825 
    DEC L                               ;0b4b  2d            1819   1826 
    LD  A,L                             ;0b4c  7d            1820   1827 
    CP  0FFh                            ;0b4d  fe ff         1821   1828 
    JR  NZ,CURST2                       ;0b4f  20 32         1822   1829 
    LD  L,01Fh                          ;0b51  2e 1f         1823   1830 
UPCUR:  DEC H                           ;0b53  25            1824   1831 
    LD  A,H                             ;0b54  7c            1825   1832 
    CP  0FFh                            ;0b55  fe ff         1826   1833 
    JR  NZ,CURST2                       ;0b57  20 2a         1827   1834 
    PUSH    HL                          ;0b59  e5            1828   1835 
    CALL    SCRLDW                      ;0b5a  cd ea 09      1829   1836 
    POP HL                              ;0b5d  e1            1830   1837 
    LD  H,0                             ;0b5e  26 00         1831   1838 
    JR  CURST2                          ;0b60  18 21         1832   1839 
                                        ;                    1833   1840 ;
CTRLM:  CALL    ECUYST                  ;0b62  cd c5 07      1834   1841 
    LD  H,E                             ;0b65  63            1835   1842 
    LD  B,0                             ;0b66  06 00         1836   1843 
    JP  CTRLM?                          ;0b68  c3 02 09      1837   1844 
                                        ;                    1838   1845 ;
RIGHT:  LD  HL,(CURX)                   ;0b6b  2a ed 11      1839   1846 
    INC L                               ;0b6e  2c            1840   1847 
    LD  A,L                             ;0b6f  7d            1841   1848 
    CP  020h                            ;0b70  fe 20         1842   1849 
    JR  C,CURST2                        ;0b72  38 0f         1843   1850 
    LD  L,0                             ;0b74  2e 00         1844   1851 
DOWNLB: INC H                           ;0b76  24            1845   1852 
    LD  A,H                             ;0b77  7c            1846   1853 
    CP  16                              ;0b78  fe 10         1847   1854 
    JR  C,CURST2                        ;0b7a  38 07         1848   1855 
    PUSH    HL                          ;0b7c  e5            1849   1856 
    CALL    SCRLUP                      ;0b7d  cd 91 09      1850   1857 
    POP HL                              ;0b80  e1            1851   1858 
    LD  H,15                            ;0b81  26 0f         1852   1859 
CURST2: LD  (CURX),HL                   ;0b83  22 ed 11      1853   1860 
    RET                                 ;0b86  c9            1854   1861 
                                        ;                    1855   1862 ;
UP: LD  HL,(CURX)                       ;0b87  2a ed 11      1856   1863 
    JR  UPCUR                           ;0b8a  18 c7         1857   1864 
                                        ;                    1858   1865 ;
DOWN:   LD  HL,(CURX)                   ;0b8c  2a ed 11      1859   1866 
    JR  DOWNLB                          ;0b8f  18 e5         1860   1867 
                                        ;                    1861   1868 ;
CTRLG:  LD  A,(BELLFG)                  ;0b91  3a 7f 11      1862   1869 
    XOR 1                               ;0b94  ee 01         1863   1870 
    LD  (BELLFG),A                      ;0b96  32 7f 11      1864   1871 
    JP  BELL                            ;0b99  c3 ca 06      1865   1872 
                                        ;                    1866   1873 ;
CTRLB:  LD  DE,00000h                   ;0b9c  11 00 00      1867   1874 
    LD  HL,LEFT                         ;0b9f  21 48 0b      1868   1875 
    LD  (CTRLBF+1),HL                   ;0ba2  22 d3 0b      1869   1876 
CTRLB1: CALL    CBFCEK                  ;0ba5  cd ca 0b      1870   1877 
    RET Z                               ;0ba8  c8            1871   1878 
    JR  C,CTRLB1                        ;0ba9  38 fa         1872   1879 
CTRLB2: CALL    CBFCEK                  ;0bab  cd ca 0b      1873   1880 
    RET Z                               ;0bae  c8            1874   1881 
    JR  NC,CTRLB2                       ;0baf  30 fa         1875   1882 
    JP  RIGHT                           ;0bb1  c3 6b 0b      1876   1883 
                                        ;                    1877   1884 ;
CTRLF:  LD  DE,00F1Fh                   ;0bb4  11 1f 0f      1878   1885 
    LD  HL,RIGHT                        ;0bb7  21 6b 0b      1879   1886 
    LD  (CTRLBF+1),HL                   ;0bba  22 d3 0b      1880   1887 
CTRLF1: CALL    CBFCEK                  ;0bbd  cd ca 0b      1881   1888 
    RET Z                               ;0bc0  c8            1882   1889 
    JR  NC,CTRLF1                       ;0bc1  30 fa         1883   1890 
CTRLF2: CALL    CBFCEK                  ;0bc3  cd ca 0b      1884   1891 
    RET Z                               ;0bc6  c8            1885   1892 
    JR  C,CTRLF2                        ;0bc7  38 fa         1886   1893 
    RET                                 ;0bc9  c9            1887   1894 
                                        ;                    1888   1895 ;
CBFCEK: LD  HL,(CURX)                   ;0bca  2a ed 11      1889   1896 
    OR  A                               ;0bcd  b7            1890   1897 
    SBC HL,DE                           ;0bce  ed 52         1891   1898 
    RET Z                               ;0bd0  c8            1892   1899 
    PUSH    DE                          ;0bd1  d5            1893   1900 
CTRLBF: CALL    RIGHT                   ;0bd2  cd 6b 0b      1894   1901 
    CALL    ADRCAL                      ;0bd5  cd 38 09      1895   1902 
    CALL    AINBC                       ;0bd8  cd 94 07      1896   1903 
    POP DE                              ;0bdb  d1            1897   1904 
    CP  '0'                             ;0bdc  fe 30         1898   1905 ;030h
    RET C                               ;0bde  d8            1899   1906 
    CP  '9'+1                           ;0bdf  fe 3a         1900   1907 ;03Ah
    CCF                                 ;0be1  3f            1901   1908 
    RET NC                              ;0be2  d0            1902   1909 
    CP  'A'                             ;0be3  fe 41         1903   1910 ;041h
    RET C                               ;0be5  d8            1904   1911 
    CP  080h                            ;0be6  fe 80         1905   1912 
    JR  C,L0BEC                         ;0be8  38 02         1906   1913 
    OR  A                               ;0bea  b7            1907   1914 
    RET                                 ;0beb  c9            1908   1915 
L0BEC:  AND 01Fh                        ;0bec  e6 1f         1909   1916 
    JR  Z,L0BF4                         ;0bee  28 04         1910   1917 
    CP  01Bh                            ;0bf0  fe 1b         1911   1918 
    CCF                                 ;0bf2  3f            1912   1919 
    RET NC                              ;0bf3  d0            1913   1920 
L0BF4:  AND 1                           ;0bf4  e6 01         1914   1921 
    RET                                 ;0bf6  c9            1915   1922 
                                        ;                    1916   1923 ;
CTRLY:  LD  D,0                         ;0bf7  16 00         1917   1924 ;★라벨이 빠져있었음
    JR  CTRLYT                          ;0bf9  18 02         1918   1925 
                                        ;                    1919   1926 ;
CTRLT:  LD  D,1                         ;0bfb  16 01         1920   1927 
CTRLYT: LD  HL,(CURX)                   ;0bfd  2a ed 11      1921   1928 
    LD  H,0                             ;0c00  26 00         1922   1929 
    LD  BC,TABBUF                       ;0c02  01 46 12      1923   1930 
    ADD HL,BC                           ;0c05  09            1924   1931 
    LD  (HL),D                          ;0c06  72            1925   1932 
    RET                                 ;0c07  c9            1926   1933 
                                        ;                    1927   1934 ;
CTRLI:  CALL    RIGHT                   ;0c08  cd 6b 0b      1928   1935 
    LD  A,(CURX)                        ;0c0b  3a ed 11      1929   1936 
    CP  31                              ;0c0e  fe 1f         1930   1937 
    RET Z                               ;0c10  c8            1931   1938 
    LD  L,A                             ;0c11  6f            1932   1939 
    LD  H,0                             ;0c12  26 00         1933   1940 
    LD  BC,TABBUF                       ;0c14  01 46 12      1934   1941 
    ADD HL,BC                           ;0c17  09            1935   1942 
    LD  A,(HL)                          ;0c18  7e            1936   1943 
    OR  A                               ;0c19  b7            1937   1944 
    JR  Z,CTRLI                         ;0c1a  28 ec         1938   1945 
    RET                                 ;0c1c  c9            1939   1946 
                                        ;                    1940   1947 ;
CTRLE:  CALL    ECUYST                  ;0c1d  cd c5 07      1941   1948 
    LD  H,E                             ;0c20  63            1942   1949 
    LD  L,0                             ;0c21  2e 00         1943   1950 
    JR  CTRLEZ                          ;0c23  18 10         1944   1951 
                                        ;                    1945   1952 ;
CTRLZ   CALL    CUTBHL                  ;0c25  cd d3 07      1946   1953 
    LD  A,16                            ;0c28  3e 10         1947   1954 
    SUB E                               ;0c2a  93            1948   1955 
    LD  B,A                             ;0c2b  47            1949   1956 
    INC HL                              ;0c2c  23            1950   1957 
CTRLZ1: LD  (HL),0                      ;0c2d  36 00         1951   1958 
    INC HL                              ;0c2f  23            1952   1959 
    DJNZ    CTRLZ1                      ;0c30  10 fb         1953   1960 
    LD  HL,01000h                       ;0c32  21 00 10      1954   1961 
CTRLEZ: CALL    ADRCA2                  ;0c35  cd 3b 09      1955   1962 
    DEC BC                              ;0c38  0b            1956   1963 
    PUSH    BC                          ;0c39  c5            1957   1964 
    CALL    ADRCAL                      ;0c3a  cd 38 09      1958   1965 
    POP HL                              ;0c3d  e1            1959   1966 
    LD  D,B                             ;0c3e  50            1960   1967 
    LD  E,C                             ;0c3f  59            1961   1968 
    OR  A                               ;0c40  b7            1962   1969 
    SBC HL,DE                           ;0c41  ed 52         1963   1970 
    INC HL                              ;0c43  23            1964   1971 
    LD  D,000h                          ;0c44  16 00         1965   1972 ;구버전,신버전
    LD  A,(COLORF)                      ;0c46  3a 80 11      1966   1973 
    AND 003h                            ;0c49  e6 03         1967   1974 
    LD  E,A                             ;0c4b  5f            1968   1975 
CTRLZE: OUT (C),D                       ;0c4c  ed 51         1969   1976 
    SET 3,B                             ;0c4e  cb d8         1970   1977 
    OUT (C),E                           ;0c50  ed 59         1971   1978 
    RES 3,B                             ;0c52  cb 98         1972   1979 
    INC BC                              ;0c54  03            1973   1980 
    DEC HL                              ;0c55  2b            1974   1981 
    LD  A,H                             ;0c56  7c            1975   1982 
    OR  L                               ;0c57  b5            1976   1983 
    JR  NZ,CTRLZE                       ;0c58  20 f2         1977   1984 
    RET                                 ;0c5a  c9            1978   1985 
                                        ;                    1979   1986 ;
                                        ;                    1980   1987 ; KEY GET
BRKEY:  LD  A,080h                      ;0c5b  3e 80         1981   1988 
    IN  A,(0)                           ;0c5d  db 00         1982   1989 
    AND 012h                            ;0c5f  e6 12         1983   1990 
    RET                                 ;0c61  c9            1984   1991 
                                        ;                    1985   1992 ;
ASCGET: PUSH    BC                      ;0c62  c5            1986   1993 
    PUSH    DE                          ;0c63  d5            1987   1994 
    PUSH    HL                          ;0c64  e5            1988   1995 
    LD  HL,(POINT1)                     ;0c65  2a 04 12      1989   1996 
    LD  A,L                             ;0c68  7d            1990   1997 
    CP  H                               ;0c69  bc            1991   1998 
    JR  Z,BUFSET                        ;0c6a  28 12         1992   1999 
BUFCEK: INC A                           ;0c6c  3c            1993   2000 
    AND 03Fh                            ;0c6d  e6 3f         1994   2001 
    LD  (POINT1),A                      ;0c6f  32 04 12      1995   2002 
    LD  L,A                             ;0c72  6f            1996   2003 
    LD  H,0                             ;0c73  26 00         1997   2004 
    LD  DE,INKYBF                       ;0c75  11 06 12      1998   2005 
    ADD HL,DE                           ;0c78  19            1999   2006 
    LD  A,(HL)                          ;0c79  7e            2000   2007 
GETRET: POP HL                          ;0c7a  e1            2001   2008 
    POP DE                              ;0c7b  d1            2002   2009 
    POP BC                              ;0c7c  c1            2003   2010 
    RET                                 ;0c7d  c9            2004   2011 
                                        ;                    2005   2012 ;
BUFSET: DEFB    03Eh                    ;0c7e  3e            2006   2013 ; LD A,
FLASHF: DEFB    001h                    ;0c7f  01            2007   2014 ;
    OR  A                               ;0c80  b7            2008   2015 
    JR  NZ,FLGET                        ;0c81  20 24         2009   2016 
    CALL    KEYSEN                      ;0c83  cd 7a 0d      2010   2017 
    CALL    BRKEY                       ;0c86  cd 5b 0c      2011   2018 
    JR  NZ,KEYGT                        ;0c89  20 07         2012   2019 
BRKGTR: CALL    NEWFLG                  ;0c8b  cd e1 0d      2013   2020 
    LD  A,3                             ;0c8e  3e 03         2014   2021 
    JR  GETRET                          ;0c90  18 e8         2015   2022 
KEYGT:  CALL    KEYSEN                  ;0c92  cd 7a 0d      2016   2023 
    JR  Z,ZERORT                        ;0c95  28 0a         2017   2024 
    CALL    NEWCEK                      ;0c97  cd bb 0d      2018   2025 
    JR  NZ,NEWKYS                       ;0c9a  20 29         2019   2026 
    CALL    SAMECK                      ;0c9c  cd d1 0d      2020   2027 
    JR  Z,REPETS                        ;0c9f  28 16         2021   2028 
ZERORT: CALL    NEWFLG                  ;0ca1  cd e1 0d      2022   2029 
ZEROR2: XOR A                           ;0ca4  af            2023   2030 
    JR  GETRET                          ;0ca5  18 d3         2024   2031 
FLGET:  CALL    FLSHGT                  ;0ca7  cd 3c 0d      2025   2032 
    LD  C,A                             ;0caa  4f            2026   2033 
    LD  A,080h                          ;0cab  3e 80         2027   2034 
    IN  A,(0)                           ;0cad  db 00         2028   2035 
    AND 012h                            ;0caf  e6 12         2029   2036 
    JR  Z,BRKGTR                        ;0cb1  28 d8         2030   2037 
    LD  A,C                             ;0cb3  79            2031   2038 
    OR  A                               ;0cb4  b7            2032   2039 
    JR  Z,NEWKYS                        ;0cb5  28 0e         2033   2040 
REPETS: CALL    NEWFLG                  ;0cb7  cd e1 0d      2034   2041 
    DEFB    021h                        ;0cba  21            2035   2042 ; LD HL,(KEYBFA)
KEYBFA: DEFW    0FFFEh                  ;0cbb  fe ff         2036   2043 ;
    DEFB    03Eh                        ;0cbd  3e            2037   2044 ; LD A,(KEYBFD)
KEYBFD: DEFB    000h                    ;0cbe  00            2038   2045 
    LD  (HL),A                          ;0cbf  77            2039   2046 
    LD  HL,30                           ;0cc0  21 1e 00      2040   2047 
    JR  KEYST2                          ;0cc3  18 06         2041   2048 
NEWKYS: CALL    NEWFLG                  ;0cc5  cd e1 0d      2042   2049 
    DEFB    021h                        ;0cc8  21            2043   2050 ; LD HL,300
REPTSW: DEFW    200                     ;0cc9  c8 00         2044   2051 ; auto repeat key duration
KEYST2: LD  (REPETF),HL                 ;0ccb  22 57 0d      2045   2052 
    LD  HL,NEWBUF                       ;0cce  21 f9 11      2046   2053 
    LD  D,0                             ;0cd1  16 00         2047   2054 
    LD  C,9                             ;0cd3  0e 09         2048   2055 
SETLP1: LD  B,8                         ;0cd5  06 08         2049   2056 
    LD  A,(HL)                          ;0cd7  7e            2050   2057 
    CPL                                 ;0cd8  2f            2051   2058 
    OR  A                               ;0cd9  b7            2052   2059 
    JR  Z,SETPL3                        ;0cda  28 09         2053   2060 
SETPL2: RRCA                            ;0cdc  0f            2054   2061 
    JP  C,KYBFST                        ;0cdd  da 35 0e      2055   2062 
    INC D                               ;0ce0  14            2056   2063 
    DJNZ    SETPL2                      ;0ce1  10 f9         2057   2064 
    JR  SETPL4                          ;0ce3  18 04         2058   2065 
SETPL3: LD  A,D                         ;0ce5  7a            2059   2066 
    ADD A,8                             ;0ce6  c6 08         2060   2067 
    LD  D,A                             ;0ce8  57            2061   2068 
SETPL4: INC HL                          ;0ce9  23            2062   2069 
    DEC C                               ;0cea  0d            2063   2070 
    JR  NZ,SETLP1                       ;0ceb  20 e8         2064   2071 
KYBFSR: LD  HL,(POINT1)                 ;0ced  2a 04 12      2065   2072 
    LD  A,L                             ;0cf0  7d            2066   2073 
    CP  H                               ;0cf1  bc            2067   2074 
    JP  Z,ZEROR2                        ;0cf2  ca a4 0c      2068   2075 
    JP  BUFCEK                          ;0cf5  c3 6c 0c      2069   2076 
                                        ;                    2070   2077 ;
FLASHS: CALL    ADRCAL                  ;0cf8  cd 38 09      2071   2078 
    SET 3,B                             ;0cfb  cb d8         2072   2079 
    LD  (FLASHA),BC                     ;0cfd  ed 43 15 0d   2073   2080 
    IN  A,(C)                           ;0d01  ed 78         2074   2081 
    LD  (FLASHD),A                      ;0d03  32 18 0d      2075   2082 
    OR  1                               ;0d06  f6 01         2076   2083 
    OUT (C),A                           ;0d08  ed 79         2077   2084 
    LD  (FLASHO),A                      ;0d0a  32 2a 0d      2078   2085 
    LD  A,(TICONT)                      ;0d0d  3a 36 00      2079   2086 
    LD  (FLASHC+1),A                    ;0d10  32 20 0d      2080   2087 ;★"+1"이 빠져있었음.
    RET                                 ;0d13  c9            2081   2088 ;
                                        ;                    2082   2089 ;
                                        ;                    2083   2090 ;
FLASHG: DEFB    001h                    ;0d14  01            2084   2091 
FLASHA: DEFW    0                       ;0d15  00 00         2085   2092 
    DEFB    03Eh                        ;0d17  3e            2086   2093 ; LD A,
FLASHD: DEFB    000h                    ;0d18  00            2087   2094 ;
    AND 0FEh                            ;0d19  e6 fe         2088   2095 
    LD  E,A                             ;0d1b  5f            2089   2096 
    LD  A,(TICONT)                      ;0d1c  3a 36 00      2090   2097 
FLASHC: SUB 0                           ;0d1f  d6 00         2091   2098 ; cursor blink time
    AND 010h                            ;0d21  e6 10         2092   2099 
    LD  A,001h                          ;0d23  3e 01         2093   2100 
    JR  Z,L0D28                         ;0d25  28 01         2094   2101 
    XOR A                               ;0d27  af            2095   2102 
L0D28:  OR  E                           ;0d28  b3            2096   2103 
    DEFB    0FEh                        ;0d29  fe            2097   2104 ;CP
FLASHO: DEFB    000h                    ;0d2a  00            2098   2105 
    RET Z                               ;0d2b  c8            2099   2106 
    OUT (C),A                           ;0d2c  ed 79         2100   2107 
    LD  (FLASHO),A                      ;0d2e  32 2a 0d      2101   2108 
    RET                                 ;0d31  c9            2102   2109 
                                        ;                    2103   2110 ;
FLASHE: LD  BC,(FLASHA)                 ;0d32  ed 4b 15 0d   2104   2111 
    LD  A,(FLASHD)                      ;0d36  3a 18 0d      2105   2112 
    OUT (C),A                           ;0d39  ed 79         2106   2113 
    RET                                 ;0d3b  c9            2107   2114 
                                        ;                    2108   2115 ;
                                        ;                    2109   2116 ;
FLSHGT: PUSH    BC                      ;0d3c  c5            2110   2117 
    PUSH    DE                          ;0d3d  d5            2111   2118 
    PUSH    HL                          ;0d3e  e5            2112   2119 
    CALL    FLASHS                      ;0d3f  cd f8 0c      2113   2120 
FLGTLP: CALL    FLASHG                  ;0d42  cd 14 0d      2114   2121 
    CALL    KEYSEN                      ;0d45  cd 7a 0d      2115   2122 
    JR  Z,FLSHL3                        ;0d48  28 1b         2116   2123 
    CALL    NEWCEK                      ;0d4a  cd bb 0d      2117   2124 
    LD  A,0                             ;0d4d  3e 00         2118   2125 
    JR  NZ,FLSHRT                       ;0d4f  20 20         2119   2126 
    CALL    SAMECK                      ;0d51  cd d1 0d      2120   2127 
    JR  NZ,FLGTLP                       ;0d54  20 ec         2121   2128 
    DEFB    021h                        ;0d56  21            2122   2129 ; LD HL,
REPETF: DEFW    00000h                  ;0d57  00 00         2123   2130 ;
    DEC HL                              ;0d59  2b            2124   2131 ;+
    LD  (REPETF),HL                     ;0d5a  22 57 0d      2125   2132 
    LD  A,H                             ;0d5d  7c            2126   2133 
    OR  L                               ;0d5e  b5            2127   2134 
    JR  NZ,FLGTLP                       ;0d5f  20 e1         2128   2135 
    LD  A,1                             ;0d61  3e 01         2129   2136 
    JR  FLSHRT                          ;0d63  18 0c         2130   2137 
FLSHL3: CALL    NEWFLG                  ;0d65  cd e1 0d      2131   2138 
FLGTL2: CALL    FLASHG                  ;0d68  cd 14 0d      2132   2139 
    CALL    KEYSEN                      ;0d6b  cd 7a 0d      2133   2140 
    JR  Z,FLGTL2                        ;0d6e  28 f8         2134   2141 
    XOR A                               ;0d70  af            2135   2142 
FLSHRT: PUSH    AF                      ;0d71  f5            2136   2143 
    CALL    FLASHE                      ;0d72  cd 32 0d      2137   2144 
    POP AF                              ;0d75  f1            2138   2145 
    POP HL                              ;0d76  e1            2139   2146 
    POP DE                              ;0d77  d1            2140   2147 
    POP BC                              ;0d78  c1            2141   2148 
    RET                                 ;0d79  c9            2142   2149 
                                        ;                    2143   2150 ;
                                        ;                    2144   2151 ;
                                        ;                    2145   2152 ;
KEYSEN: CALL    KEYSN2                  ;0d7a  cd 8c 0d      2146   2153 
KEYSN0: LD  B,4                         ;0d7d  06 04         2147   2154 
KEYSN1: CALL    KEYSN2                  ;0d7f  cd 8c 0d      2148   2155 
    BIT 1,E                             ;0d82  cb 4b         2149   2156 
    JR  NZ,KEYSN0                       ;0d84  20 f7         2150   2157 
    DJNZ    KEYSN1                      ;0d86  10 f7         2151   2158 
    LD  A,E                             ;0d88  7b            2152   2159 
    AND 1                               ;0d89  e6 01         2153   2160 
    RET                                 ;0d8b  c9            2154   2161 
                                        ;                    2155   2162 ;
KEYSN2: LD  HL,NEWBUF                   ;0d8c  21 f9 11      2156   2163 
    PUSH    BC                          ;0d8f  c5            2157   2164 
    LD  BC,08009h                       ;0d90  01 09 80      2158   2165 ;KEYIO
    LD  DE,00900h                       ;0d93  11 00 09      2159   2166 
KEYSN3: IN  A,(C)                       ;0d96  ed 78         2160   2167 
    XOR (HL)                            ;0d98  ae            2161   2168 
    JR  Z,L0D9D                         ;0d99  28 02         2162   2169 
    SET 1,E                             ;0d9b  cb cb         2163   2170 
L0D9D:  XOR (HL)                        ;0d9d  ae            2164   2171 
    LD  (HL),A                          ;0d9e  77            2165   2172 
    CPL                                 ;0d9f  2f            2166   2173 
    OR  A                               ;0da0  b7            2167   2174 
    JR  Z,L0DA5                         ;0da1  28 02         2168   2175 
    SET 0,E                             ;0da3  cb c3         2169   2176 
L0DA5:  INC HL                          ;0da5  23            2170   2177 
    DEC BC                              ;0da6  0b            2171   2178 
    DEC D                               ;0da7  15            2172   2179 
    JR  NZ,KEYSN3                       ;0da8  20 ec         2173   2180 
    IN  A,(C)                           ;0daa  ed 78         2174   2181 
    XOR (HL)                            ;0dac  ae            2175   2182 
    JR  Z,L0DB1                         ;0dad  28 02         2176   2183 
    SET 1,E                             ;0daf  cb cb         2177   2184 
L0DB1:  XOR (HL)                        ;0db1  ae            2178   2185 
    LD  (HL),A                          ;0db2  77            2179   2186 
    AND 012h                            ;0db3  e6 12         2180   2187 
    JR  NZ,L0DB9                        ;0db5  20 02         2181   2188 
    SET 0,E                             ;0db7  cb c3         2182   2189 
L0DB9:  POP BC                          ;0db9  c1            2183   2190 
    RET                                 ;0dba  c9            2184   2191 
                                        ;                    2185   2192 ;
NEWCEK: LD  HL,OLDBUF                   ;0dbb  21 ef 11      2186   2193 
    LD  DE,NEWBUF                       ;0dbe  11 f9 11      2187   2194 
    LD  B,9                             ;0dc1  06 09         2188   2195 
NEWPL1: LD  A,(DE)                      ;0dc3  1a            2189   2196 
    CPL                                 ;0dc4  2f            2190   2197 
    AND (HL)                            ;0dc5  a6            2191   2198 
    RET NZ                              ;0dc6  c0            2192   2199 
    INC DE                              ;0dc7  13            2193   2200 
    INC HL                              ;0dc8  23            2194   2201 
    DJNZ    NEWPL1                      ;0dc9  10 f8         2195   2202 
    LD  A,(DE)                          ;0dcb  1a            2196   2203 
    CPL                                 ;0dcc  2f            2197   2204 
    AND (HL)                            ;0dcd  a6            2198   2205 
    AND 010h                            ;0dce  e6 10         2199   2206 
    RET                                 ;0dd0  c9            2200   2207 
                                        ;                    2201   2208 ;
SAMECK: LD  HL,OLDBUF                   ;0dd1  21 ef 11      2202   2209 
    LD  DE,NEWBUF                       ;0dd4  11 f9 11      2203   2210 
    LD  B,10                            ;0dd7  06 0a         2204   2211 
SAMELP: LD  A,(DE)                      ;0dd9  1a            2205   2212 
    XOR (HL)                            ;0dda  ae            2206   2213 
    RET NZ                              ;0ddb  c0            2207   2214 
    INC DE                              ;0ddc  13            2208   2215 
    INC HL                              ;0ddd  23            2209   2216 
    DJNZ    SAMELP                      ;0dde  10 f9         2210   2217 
    RET                                 ;0de0  c9            2211   2218 
                                        ;                    2212   2219 ;
NEWFLG: LD  HL,NEWBUF                   ;0de1  21 f9 11      2213   2220 
    LD  DE,OLDBUF                       ;0de4  11 ef 11      2214   2221 
    LD  B,9                             ;0de7  06 09         2215   2222 
FLGLP1: LD  A,(DE)                      ;0de9  1a            2216   2223 
    CPL                                 ;0dea  2f            2217   2224 
    OR  (HL)                            ;0deb  b6            2218   2225 
    LD  C,(HL)                          ;0dec  4e            2219   2226 
    LD  (HL),A                          ;0ded  77            2220   2227 
    LD  A,C                             ;0dee  79            2221   2228 
    LD  (DE),A                          ;0def  12            2222   2229 
    INC DE                              ;0df0  13            2223   2230 
    INC HL                              ;0df1  23            2224   2231 
    DJNZ    FLGLP1                      ;0df2  10 f5         2225   2232 
    LD  A,(HL)                          ;0df4  7e            2226   2233 
    LD  (DE),A                          ;0df5  12            2227   2234 
    LD  DE,NEWBUF                       ;0df6  11 f9 11      2228   2235 
    LD  HL,OLDBUF                       ;0df9  21 ef 11      2229   2236 
    LD  BC,00900h                       ;0dfc  01 00 09      2230   2237 
FLGLP2: LD  A,(DE)                      ;0dff  1a            2231   2238 
    CPL                                 ;0e00  2f            2232   2239 
    OR  A                               ;0e01  b7            2233   2240 
    JR  Z,FLGLP3                        ;0e02  28 0a         2234   2241 
    DEC C                               ;0e04  0d            2235   2242 
    JR  NZ,FLGLP5                       ;0e05  20 0c         2236   2243 
    OR  (HL)                            ;0e07  b6            2237   2244 
    LD  (HL),A                          ;0e08  77            2238   2245 
    LD  A,0FFh                          ;0e09  3e ff         2239   2246 
    LD  (DE),A                          ;0e0b  12            2240   2247 
FLGLP4: LD  C,1                         ;0e0c  0e 01         2241   2248 
FLGLP3: INC DE                          ;0e0e  13            2242   2249 
    INC HL                              ;0e0f  23            2243   2250 
    DJNZ    FLGLP2                      ;0e10  10 ed         2244   2251 
    RET                                 ;0e12  c9            2245   2252 
FLGLP5: PUSH    BC                      ;0e13  c5            2246   2253 
    LD  BC,00801h                       ;0e14  01 01 08      2247   2254 
FLGLP6: RRCA                            ;0e17  0f            2248   2255 
    JR  C,FLGLP7                        ;0e18  38 0b         2249   2256 
    RLC C                               ;0e1a  cb 01         2250   2257 
    DJNZ    FLGLP6                      ;0e1c  10 f9         2251   2258 
    POP BC                              ;0e1e  c1            2252   2259 
    JR  FLGLP4                          ;0e1f  18 eb         2253   2260 
FLGLP9: RRCA                            ;0e21  0f            2254   2261 
    CALL    C,FLGLP8                    ;0e22  dc 2c 0e      2255   2262 
FLGLP7: RLC C                           ;0e25  cb 01         2256   2263 
    DJNZ    FLGLP9                      ;0e27  10 f8         2257   2264 
    POP BC                              ;0e29  c1            2258   2265 
    JR  FLGLP4                          ;0e2a  18 e0         2259   2266 
                                        ;                    2260   2267 ;
FLGLP8: PUSH    AF                      ;0e2c  f5            2261   2268 
    LD  A,C                             ;0e2d  79            2262   2269 
    OR  (HL)                            ;0e2e  b6            2263   2270 
    LD  (HL),A                          ;0e2f  77            2264   2271 
    LD  A,(DE)                          ;0e30  1a            2265   2272 
    OR  C                               ;0e31  b1            2266   2273 
    LD  (DE),A                          ;0e32  12            2267   2274 
    POP AF                              ;0e33  f1            2268   2275 
    RET                                 ;0e34  c9            2269   2276 
                                        ;                    2270   2277 ;
                                        ;                    2271   2278 ;
KYBFST: LD  A,(HL)                      ;0e35  7e            2272   2279 
    LD  (KEYBFA),HL                     ;0e36  22 bb 0c      2273   2280 
    LD  (KEYBFD),A                      ;0e39  32 be 0c      2274   2281 
    LD  C,D                             ;0e3c  4a            2275   2282 
    LD  B,0                             ;0e3d  06 00         2276   2283 
    LD  HL,KEYDT1                       ;0e3f  21 06 13      2277   2284 ;NORMAL DATA
    LD  A,(NEWMOD)                      ;0e42  3a 02 12      2278   2285 
    BIT 1,A                             ;0e45  cb 4f         2279   2286 
    JR  NZ,L0E4C                        ;0e47  20 03         2280   2287 
    LD  HL,KEYDT2                       ;0e49  21 4e 13      2281   2288 ;SHIFT DATA
L0E4C:  ADD HL,BC                       ;0e4c  09            2282   2289 
    LD  C,(HL)                          ;0e4d  4e            2283   2290 
    LD  B,A                             ;0e4e  47            2284   2291 
    BIT 2,B                             ;0e4f  cb 50         2285   2292 
    JR  NZ,CTRLNO                       ;0e51  20 09         2286   2293 
    LD  A,C                             ;0e53  79            2287   2294 
    SUB 040h                            ;0e54  d6 40         2288   2295 
    JR  C,NONKE?                        ;0e56  38 17         2289   2296 
    AND 01Fh                            ;0e58  e6 1f         2290   2297 
    JR  SETKY                           ;0e5a  18 0d         2291   2298 
CTRLNO: BIT 6,B                         ;0e5c  cb 70         2292   2299 
    JR  NZ,SETKY2                       ;0e5e  20 1a         2293   2300 
    LD  A,C                             ;0e60  79            2294   2301 
    SUB 040h                            ;0e61  d6 40         2295   2302 
    JR  C,NONKEY                        ;0e63  38 07         2296   2303 
    AND 01Fh                            ;0e65  e6 1f         2297   2304 
    ADD A,080h                          ;0e67  c6 80         2298   2305 
SETKY:  CALL    BFSTSB                  ;0e69  cd b1 0e      2299   2306 
NONKEY: JP  KYBFSR                      ;0e6c  c3 ed 0c      2300   2307 
NONKE?: ADD A,010h                      ;0e6f  c6 10         2301   2308 
    CP  004h                            ;0e71  fe 04         2302   2309 
    JR  NC,NONKEY                       ;0e73  30 f7         2303   2310 
    LD  (COLORF),A                      ;0e75  32 80 11      2304   2311 
    JR  NONKEY                          ;0e78  18 f2         2305   2312 
                                        ;                    2306   2313 ;
                                        ;                    2307   2314 ;
SETKY2: LD  A,C                         ;0e7a  79            2308   2315 
    CP  0F0h                            ;0e7b  fe f0         2309   2316 
    JR  NC,FUNCTN                       ;0e7d  30 16         2310   2317 
    LD  A,(LOCKMD)                      ;0e7f  3a 03 12      2311   2318 
    OR  A                               ;0e82  b7            2312   2319 
    LD  A,C                             ;0e83  79            2313   2320 
    JR  Z,SETKY                         ;0e84  28 e3         2314   2321 
    CP  041h                            ;0e86  fe 41         2315   2322 
    JR  C,SETKY                         ;0e88  38 df         2316   2323 
    AND 01Fh                            ;0e8a  e6 1f         2317   2324 
    CP  01Bh                            ;0e8c  fe 1b         2318   2325 
    LD  A,C                             ;0e8e  79            2319   2326 
    JR  NC,SETKY                        ;0e8f  30 d8         2320   2327 
    XOR 020h                            ;0e91  ee 20         2321   2328 
    JR  SETKY                           ;0e93  18 d4         2322   2329 
FUNCTN: SUB 0F1h                        ;0e95  d6 f1         2323   2330 
    LD  L,A                             ;0e97  6f            2324   2331 
    LD  H,0                             ;0e98  26 00         2325   2332 
    ADD HL,HL                           ;0e9a  29            2326   2333 
    ADD HL,HL                           ;0e9b  29            2327   2334 
    ADD HL,HL                           ;0e9c  29            2328   2335 
    ADD HL,HL                           ;0e9d  29            2329   2336 
    LD  BC,FUNBUF                       ;0e9e  01 66 12      2330   2337 
    ADD HL,BC                           ;0ea1  09            2331   2338 
    LD  B,(HL)                          ;0ea2  46            2332   2339 
    INC HL                              ;0ea3  23            2333   2340 
    LD  A,B                             ;0ea4  78            2334   2341 
    OR  A                               ;0ea5  b7            2335   2342 
    JR  Z,NONKEY                        ;0ea6  28 c4         2336   2343 
FUNCLP: LD  A,(HL)                      ;0ea8  7e            2337   2344 
    CALL    BFSTSB                      ;0ea9  cd b1 0e      2338   2345 
    INC HL                              ;0eac  23            2339   2346 
    DJNZ    FUNCLP                      ;0ead  10 f9         2340   2347 
    JR  NONKEY                          ;0eaf  18 bb         2341   2348 
BFSTSB: PUSH    HL                      ;0eb1  e5            2342   2349 
    PUSH    BC                          ;0eb2  c5            2343   2350 
    LD  C,A                             ;0eb3  4f            2344   2351 
    LD  HL,(POINT1)                     ;0eb4  2a 04 12      2345   2352 
    LD  A,H                             ;0eb7  7c            2346   2353 
    INC A                               ;0eb8  3c            2347   2354 
    AND 03Fh                            ;0eb9  e6 3f         2348   2355 
    CP  L                               ;0ebb  bd            2349   2356 
    JR  Z,NONSET                        ;0ebc  28 0c         2350   2357 
    LD  (POINT2),A                      ;0ebe  32 05 12      2351   2358 
    LD  L,A                             ;0ec1  6f            2352   2359 
    LD  H,0                             ;0ec2  26 00         2353   2360 
    LD  A,C                             ;0ec4  79            2354   2361 
    LD  BC,INKYBF                       ;0ec5  01 06 12      2355   2362 
    ADD HL,BC                           ;0ec8  09            2356   2363 
    LD  (HL),A                          ;0ec9  77            2357   2364 
NONSET: POP BC                          ;0eca  c1            2358   2365 
    POP HL                              ;0ecb  e1            2359   2366 
NORET:  RET                             ;0ecc  c9            2360   2367 
                                        ;                    2361   2368 ;
                                        ;                    2362   2369 ;
MUSIC:  PUSH    DE                      ;0ecd  d5            2363   2370 
MUSL1:  LD  A,(DE)                      ;0ece  1a            2364   2371 
    CP  ':'                             ;0ecf  fe 3a         2365   2372 ;03Ah
    INC DE                              ;0ed1  13            2366   2373 
    JR  Z,MUSL2                         ;0ed2  28 04         2367   2374 
    DJNZ    MUSL1                       ;0ed4  10 f8         2368   2375 
    JR  MUSL6                           ;0ed6  18 0e         2369   2376 
MUSL2:  LD  L,E                         ;0ed8  6b            2370   2377 
    LD  H,D                             ;0ed9  62            2371   2378 
MUSL4:  DJNZ    MUSL3                   ;0eda  10 02         2372   2379 
    JR  MUSL7                           ;0edc  18 0b         2373   2380 
MUSL3:  LD  A,(DE)                      ;0ede  1a            2374   2381 
    INC DE                              ;0edf  13            2375   2382 
    CP  ':'                             ;0ee0  fe 3a         2376   2383 ;03Ah
    JR  NZ,MUSL4                        ;0ee2  20 f6         2377   2384 
    JR  MUSL5                           ;0ee4  18 06         2378   2385 
MUSL6:  LD  HL,MUSNUL                   ;0ee6  21 00 11      2379   2386 
MUSL7:  LD  DE,MUSNUL                   ;0ee9  11 00 11      2380   2387 
MUSL5:  POP BC                          ;0eec  c1            2381   2388 
                                        ;                    2382   2389 ; BC=SOUND A
                                        ;                    2383   2390 ; HL=SOUND B
                                        ;                    2384   2391 ; DE=SOUND C
                                        ;                    2385   2392 ;
                                        ;                    2386   2393 
MUSLOP: PUSH    BC                      ;0eed  c5            2387   2394 
    EXX                                 ;0eee  d9            2388   2395 
    POP DE                              ;0eef  d1            2389   2396 
    LD  BC,LENG?A                       ;0ef0  01 11 11      2390   2397 
    CALL    SOUSET                      ;0ef3  cd 2e 0f      2391   2398 
    PUSH    DE                          ;0ef6  d5            2392   2399 
    EXX                                 ;0ef7  d9            2393   2400 
    POP BC                              ;0ef8  c1            2394   2401 
    PUSH    HL                          ;0ef9  e5            2395   2402 
    EXX                                 ;0efa  d9            2396   2403 
    POP DE                              ;0efb  d1            2397   2404 
    LD  BC,LENG?B                       ;0efc  01 19 11      2398   2405 
    CALL    SOUSET                      ;0eff  cd 2e 0f      2399   2406 
    PUSH    DE                          ;0f02  d5            2400   2407 
    EXX                                 ;0f03  d9            2401   2408 
    POP HL                              ;0f04  e1            2402   2409 
    PUSH    DE                          ;0f05  d5            2403   2410 
    EXX                                 ;0f06  d9            2404   2411 
    POP DE                              ;0f07  d1            2405   2412 
    LD  BC,LENG?C                       ;0f08  01 21 11      2406   2413 
    CALL    SOUSET                      ;0f0b  cd 2e 0f      2407   2414 
    PUSH    DE                          ;0f0e  d5            2408   2415 
    EXX                                 ;0f0f  d9            2409   2416 
    POP DE                              ;0f10  d1            2410   2417 
    EXX                                 ;0f11  d9            2411   2418 
                                        ;                    2412   2419 ;
    CALL    DELAYS                      ;0f12  cd 77 10      2413   2420 
                                        ;                    2414   2421 ;
    LD  BC,LENG?A                       ;0f15  01 11 11      2415   2422 
    CALL    SOUSTP                      ;0f18  cd 3b 10      2416   2423 
    LD  BC,LENG?B                       ;0f1b  01 19 11      2417   2424 
    CALL    SOUSTP                      ;0f1e  cd 3b 10      2418   2425 
    LD  BC,LENG?C                       ;0f21  01 21 11      2419   2426 
    CALL    SOUSTP                      ;0f24  cd 3b 10      2420   2427 
    EXX                                 ;0f27  d9            2421   2428 
                                        ;                    2422   2429 ;
    CALL    ENDCHK                      ;0f28  cd 52 10      2423   2430 
    JR  NZ,MUSLOP                       ;0f2b  20 c0         2424   2431 
    RET                                 ;0f2d  c9            2425   2432 
                                        ;                    2426   2433 ;
                                        ;                    2427   2434 ; SUB
SOUSET: LD  A,(BC)                      ;0f2e  0a            2428   2435 
    OR  A                               ;0f2f  b7            2429   2436 
    RET NZ                              ;0f30  c0            2430   2437 
    DEC BC                              ;0f31  0b            2431   2438 ;BC=OCT.A
                                        ;                    2432   2439 ;
SOUST2: LD  A,(DE)                      ;0f32  1a            2433   2440 
    CP  ':'                             ;0f33  fe 3a         2434   2441 ;03Ah
    RET Z                               ;0f35  c8            2435   2442 
                                        ;                    2436   2443 ;
    CP  'V'                             ;0f36  fe 56         2437   2444 ;056h VOLUME
    JR  NZ,VOLOK                        ;0f38  20 31         2438   2445 
    INC DE                              ;0f3a  13            2439   2446 
    LD  A,(DE)                          ;0f3b  1a            2440   2447 
    SUB '0'                             ;0f3c  d6 30         2441   2448 ;030h
    JR  C,SOUST2                        ;0f3e  38 f2         2442   2449 
    CP  10                              ;0f40  fe 0a         2443   2450 ;00Ah
    JR  NC,SOUST2                       ;0f42  30 ee         2444   2451 
    INC DE                              ;0f44  13            2445   2452 
    CP  1                               ;0f45  fe 01         2446   2453 
    JR  NZ,VOLST                        ;0f47  20 10         2447   2454 
    LD  A,(DE)                          ;0f49  1a            2448   2455 
    SUB '0'                             ;0f4a  d6 30         2449   2456 ;030h
    JR  C,VOLST2                        ;0f4c  38 09         2450   2457 
    CP  6                               ;0f4e  fe 06         2451   2458 
    JR  NC,VOLST2                       ;0f50  30 05         2452   2459 
    ADD A,10                            ;0f52  c6 0a         2453   2460 
    INC DE                              ;0f54  13            2454   2461 
    JR  VOLST                           ;0f55  18 02         2455   2462 
VOLST2: LD  A,1                         ;0f57  3e 01         2456   2463 
VOLST:  LD  L,A                         ;0f59  6f            2457   2464 
    INC BC                              ;0f5a  03            2458   2465 
    INC BC                              ;0f5b  03            2459   2466 
    LD  A,(BC)                          ;0f5c  0a            2460   2467 
    DEC BC                              ;0f5d  0b            2461   2468 
    DEC BC                              ;0f5e  0b            2462   2469 
    PUSH    BC                          ;0f5f  c5            2463   2470 
    LD  BC,04000h                       ;0f60  01 00 40      2464   2471 ;PSG ADR.
    OUT (C),A                           ;0f63  ed 79         2465   2472 
    INC C                               ;0f65  0c            2466   2473 ;PSG DATA AD.
    OUT (C),L                           ;0f66  ed 69         2467   2474 
    POP BC                              ;0f68  c1            2468   2475 
    JR  SOUST2                          ;0f69  18 c7         2469   2476 
                                        ;                    2470   2477 ;
VOLOK:  CP  'O'                         ;0f6b  fe 4f         2471   2478 ; OCTAVE
    JP  NZ,OCTOK                        ;0f6d  c2 7e 0f      2472   2479 
    INC DE                              ;0f70  13            2473   2480 
    LD  A,(DE)                          ;0f71  1a            2474   2481 
    SUB '1'                             ;0f72  d6 31         2475   2482 ;031h
    JR  C,SOUST2                        ;0f74  38 bc         2476   2483 
    CP  8                               ;0f76  fe 08         2477   2484 
    JR  NC,SOUST2                       ;0f78  30 b8         2478   2485 
    LD  (BC),A                          ;0f7a  02            2479   2486 ;OCT. SET
    INC DE                              ;0f7b  13            2480   2487 
    JR  SOUST2                          ;0f7c  18 b4         2481   2488 
                                        ;                    2482   2489 ;
OCTOK:  EX  AF,AF'                      ;0f7e  08            2483   2490 
    LD  A,(BC)                          ;0f7f  0a            2484   2491 ;OCT. READ
    EX  AF,AF'                          ;0f80  08            2485   2492 
OCTOK2: LD  A,(DE)                      ;0f81  1a            2486   2493 
    CP  '+'                             ;0f82  fe 2b         2487   2494 ;02Bh
    JR  NZ,OCTNOP                       ;0f84  20 0a         2488   2495 
    INC DE                              ;0f86  13            2489   2496 
    EX  AF,AF'                          ;0f87  08            2490   2497 
    CP  7                               ;0f88  fe 07         2491   2498 
    JR  Z,OCTNO                         ;0f8a  28 01         2492   2499 
    INC A                               ;0f8c  3c            2493   2500 
OCTNO:  EX  AF,AF'                      ;0f8d  08            2494   2501 
    JR  OCTOK2                          ;0f8e  18 f1         2495   2502 
OCTNOP: CP  '-'                         ;0f90  fe 2d         2496   2503 ;02Dh
    JR  NZ,OCTNOM                       ;0f92  20 08         2497   2504 
    INC DE                              ;0f94  13            2498   2505 
    EX  AF,AF'                          ;0f95  08            2499   2506 
    OR  A                               ;0f96  b7            2500   2507 
    JR  Z,L0F9A                         ;0f97  28 01         2501   2508 
    DEC A                               ;0f99  3d            2502   2509 
L0F9A:  JR  OCTNO                       ;0f9a  18 f1         2503   2510 
                                        ;                    2504   2511 ;
OCTNOM: LD  HL,NUMTBL                   ;0f9c  21 23 11      2505   2512 
    CP  '#'                             ;0f9f  fe 23         2506   2513 ;023h
    JR  NZ,NUMOK                        ;0fa1  20 05         2507   2514 
    INC DE                              ;0fa3  13            2508   2515 
    LD  HL,UPTBL                        ;0fa4  21 31 11      2509   2516 
    LD  A,(DE)                          ;0fa7  1a            2510   2517 
NUMOK:  INC DE                          ;0fa8  13            2511   2518 
    CP  'R'                             ;0fa9  fe 52         2512   2519 ;052h
    JR  Z,SOUOFF                        ;0fab  28 61         2513   2520 
    SUB 'A'                             ;0fad  d6 41         2514   2521 ;041h
    JP  C,SOUST2                        ;0faf  da 32 0f      2515   2522 
    CP  7                               ;0fb2  fe 07         2516   2523 
    JP  NC,SOUST2                       ;0fb4  d2 32 0f      2517   2524 
    PUSH    DE                          ;0fb7  d5            2518   2525 
    LD  E,A                             ;0fb8  5f            2519   2526 
    LD  D,0                             ;0fb9  16 00         2520   2527 
    EX  DE,HL                           ;0fbb  eb            2521   2528 
    ADD HL,HL                           ;0fbc  29            2522   2529 
    ADD HL,DE                           ;0fbd  19            2523   2530 
    DEC BC                              ;0fbe  0b            2524   2531 ;PSG DATA7
    DEC BC                              ;0fbf  0b            2525   2532 ;DATA HIGH
    LD  A,(HL)                          ;0fc0  7e            2526   2533 
    INC HL                              ;0fc1  23            2527   2534 
    LD  H,(HL)                          ;0fc2  66            2528   2535 
    LD  L,A                             ;0fc3  6f            2529   2536 
    EX  AF,AF'                          ;0fc4  08            2530   2537 
OCTDVL: OR  A                           ;0fc5  b7            2531   2538 
    JR  Z,OCTDIV                        ;0fc6  28 07         2532   2539 
    RR  H                               ;0fc8  cb 1c         2533   2540 
    RR  L                               ;0fca  cb 1d         2534   2541 
    DEC A                               ;0fcc  3d            2535   2542 
    JR  NZ,OCTDVL                       ;0fcd  20 f6         2536   2543 
OCTDIV: EX  DE,HL                       ;0fcf  eb            2537   2544 
    LD  L,C                             ;0fd0  69            2538   2545 
    LD  H,B                             ;0fd1  60            2539   2546 
    LD  (HL),D                          ;0fd2  72            2540   2547 
    DEC HL                              ;0fd3  2b            2541   2548 ;DATA LOW
    LD  (HL),E                          ;0fd4  73            2542   2549 
    DEC HL                              ;0fd5  2b            2543   2550 ;DATA ADR.
    DEC HL                              ;0fd6  2b            2544   2551 ;LEN.A
    POP DE                              ;0fd7  d1            2545   2552 
    LD  A,(DE)                          ;0fd8  1a            2546   2553 
    SUB '0'                             ;0fd9  d6 30         2547   2554 ;030h
    JR  C,SOUON                         ;0fdb  38 09         2548   2555 
    CP  10                              ;0fdd  fe 0a         2549   2556 ;
    JR  NC,SOUON                        ;0fdf  30 05         2550   2557 
    CALL    LENGSB                      ;0fe1  cd 88 10      2551   2558 
    INC DE                              ;0fe4  13            2552   2559 
    LD  (HL),A                          ;0fe5  77            2553   2560 
SOUON:  PUSH    DE                      ;0fe6  d5            2554   2561 
    LD  E,(HL)                          ;0fe7  5e            2555   2562 ;LENG.?
    INC HL                              ;0fe8  23            2556   2563 
    LD  D,(HL)                          ;0fe9  56            2557   2564 ;PSG ADR.
    INC HL                              ;0fea  23            2558   2565 
    LD  BC,04000h                       ;0feb  01 00 40      2559   2566 ;PSG ADR
    LD  A,(HL)                          ;0fee  7e            2560   2567 
    OUT (C),D                           ;0fef  ed 51         2561   2568 
    INC C                               ;0ff1  0c            2562   2569 
    OUT (C),A                           ;0ff2  ed 79         2563   2570 
    INC HL                              ;0ff4  23            2564   2571 
    DEC C                               ;0ff5  0d            2565   2572 
    INC D                               ;0ff6  14            2566   2573 
    LD  A,(HL)                          ;0ff7  7e            2567   2574 
    OUT (C),D                           ;0ff8  ed 51         2568   2575 
    INC C                               ;0ffa  0c            2569   2576 
    OUT (C),A                           ;0ffb  ed 79         2570   2577 
    INC HL                              ;0ffd  23            2571   2578 
    DEC C                               ;0ffe  0d            2572   2579 
    LD  D,7                             ;0fff  16 07         2573   2580 
    OUT (C),D                           ;1001  ed 51         2574   2581 
    INC C                               ;1003  0c            2575   2582 
    IN  A,(C)                           ;1004  ed 78         2576   2583 
    AND (HL)                            ;1006  a6            2577   2584 
    OUT (C),A                           ;1007  ed 79         2578   2585 
    INC HL                              ;1009  23            2579   2586 ;OCT.A
    INC HL                              ;100a  23            2580   2587 ;LENG.A
    LD  (HL),E                          ;100b  73            2581   2588 
    POP DE                              ;100c  d1            2582   2589 
    RET                                 ;100d  c9            2583   2590 
                                        ;                    2584   2591 ;
                                        ;                    2585   2592 ;
SOUOFF: DEC BC                          ;100e  0b            2586   2593 
    DEC BC                              ;100f  0b            2587   2594 
    DEC BC                              ;1010  0b            2588   2595 
    DEC BC                              ;1011  0b            2589   2596 
    DEC BC                              ;1012  0b            2590   2597 
    LD  A,(DE)                          ;1013  1a            2591   2598 
    SUB '0'                             ;1014  d6 30         2592   2599 ;030h
    JR  C,SOUOFE                        ;1016  38 09         2593   2600 
    CP  10                              ;1018  fe 0a         2594   2601 
    JR  NC,SOUOFE                       ;101a  30 05         2595   2602 
    CALL    LENGSB                      ;101c  cd 88 10      2596   2603 
    INC DE                              ;101f  13            2597   2604 
    LD  (BC),A                          ;1020  02            2598   2605 
SOUOFE: LD  A,(BC)                      ;1021  0a            2599   2606 
    INC BC                              ;1022  03            2600   2607 
    INC BC                              ;1023  03            2601   2608 
    INC BC                              ;1024  03            2602   2609 
    INC BC                              ;1025  03            2603   2610 
    INC BC                              ;1026  03            2604   2611 
    INC BC                              ;1027  03            2605   2612 
    LD  (BC),A                          ;1028  02            2606   2613 
SOUOFS: DEC BC                          ;1029  0b            2607   2614 
    DEC BC                              ;102a  0b            2608   2615 
    LD  A,(BC)                          ;102b  0a            2609   2616 
    CPL                                 ;102c  2f            2610   2617 
    LD  BC,04000h                       ;102d  01 00 40      2611   2618 ;PSG ADR.
    LD  L,7                             ;1030  2e 07         2612   2619 
    OUT (C),L                           ;1032  ed 69         2613   2620 
    INC C                               ;1034  0c            2614   2621 
    IN  H,(C)                           ;1035  ed 60         2615   2622 
    OR  H                               ;1037  b4            2616   2623 
    OUT (C),A                           ;1038  ed 79         2617   2624 
    RET                                 ;103a  c9            2618   2625 
                                        ;                    2619   2626 ;
SOUSTP: LD  A,(BC)                      ;103b  0a            2620   2627 
    OR  A                               ;103c  b7            2621   2628 
    JR  Z,SOUOFS                        ;103d  28 ea         2622   2629 
    DEC A                               ;103f  3d            2623   2630 
    LD  (BC),A                          ;1040  02            2624   2631 
    RET                                 ;1041  c9            2625   2632 
                                        ;                    2626   2633 ;
BRKRET: LD  BC,04000h                   ;1042  01 00 40      2627   2634 
    LD  L,7                             ;1045  2e 07         2628   2635 
    OUT (C),L                           ;1047  ed 69         2629   2636 
    INC C                               ;1049  0c            2630   2637 
    IN  A,(C)                           ;104a  ed 78         2631   2638 
    OR  7                               ;104c  f6 07         2632   2639 
    OUT (C),A                           ;104e  ed 79         2633   2640 
    XOR A                               ;1050  af            2634   2641 
    RET                                 ;1051  c9            2635   2642 
                                        ;                    2636   2643 ;
ENDCHK: LD  A,080h                      ;1052  3e 80         2637   2644 ;BREAK CHECK
    IN  A,(0)                           ;1054  db 00         2638   2645 
    AND 012h                            ;1056  e6 12         2639   2646 
    JR  Z,BRKRET                        ;1058  28 e8         2640   2647 
    LD  A,(BC)                          ;105a  0a            2641   2648 
    CP  ':'                             ;105b  fe 3a         2642   2649 
    RET NZ                              ;105d  c0            2643   2650 
    LD  A,(DE)                          ;105e  1a            2644   2651 
    CP  ':'                             ;105f  fe 3a         2645   2652 
    RET NZ                              ;1061  c0            2646   2653 
    LD  A,(HL)                          ;1062  7e            2647   2654 
    CP  ':'                             ;1063  fe 3a         2648   2655 
    RET NZ                              ;1065  c0            2649   2656 
    LD  A,(LENG?A)                      ;1066  3a 11 11      2650   2657 
    OR  A                               ;1069  b7            2651   2658 
    RET NZ                              ;106a  c0            2652   2659 
    LD  A,(LENG?B)                      ;106b  3a 19 11      2653   2660 
    OR  A                               ;106e  b7            2654   2661 
    RET NZ                              ;106f  c0            2655   2662 
    LD  A,(LENG?C)                      ;1070  3a 21 11      2656   2663 
    OR  A                               ;1073  b7            2657   2664 
    RET NZ                              ;1074  c0            2658   2665 
    JR  BRKRET                          ;1075  18 cb         2659   2666 
                                        ;                    2660   2667 ;
                                        ;                    2661   2668 ;
                                        ;                    2662   2669 ;
DELAYS: LD  HL,(MSDT32)                 ;1077  2a fe 10      2663   2670 
                                        ;                    2664   2671 ; DELAY1MS SUB
DELAY1: LD  DE,152                      ;107a  11 98 00      2665   2672 ;10
DELAY2: DEC DE                          ;107d  1b            2666   2673 ;6
    LD  A,D                             ;107e  7a            2667   2674 ;4
    OR  E                               ;107f  b3            2668   2675 ;4
    JR  NZ,DELAY2                       ;1080  20 fb         2669   2676 ;12
    DEC HL                              ;1082  2b            2670   2677 ;6
    LD  A,H                             ;1083  7c            2671   2678 ;4
    OR  L                               ;1084  b5            2672   2679 ;4
    JR  NZ,DELAY1                       ;1085  20 f3         2673   2680 ;12
    RET                                 ;1087  c9            2674   2681 
LENGSB: PUSH    BC                      ;1088  c5            2675   2682 
    PUSH    HL                          ;1089  e5            2676   2683 
    LD  C,A                             ;108a  4f            2677   2684 
    LD  B,0                             ;108b  06 00         2678   2685 
    LD  HL,LENGTB                       ;108d  21 01 11      2679   2686 
    ADD HL,BC                           ;1090  09            2680   2687 
    LD  A,(HL)                          ;1091  7e            2681   2688 
    POP HL                              ;1092  e1            2682   2689 
    POP BC                              ;1093  c1            2683   2690 
    RET                                 ;1094  c9            2684   2691 
                                        ;                    2685   2692 ;
                                        ;                    2686   2693 ;
XTEMPO: LD  (MSDT32),A                  ;1095  32 fe 10      2687   2694 
                                        ;                    2688   2695 ;
    RET                                 ;1098  c9            2689   2696 
                                        ;                    2690   2697 ;
                                        ;                    2691   2698 ;
SOUNDS: LD  A,E                         ;1099  7b            2692   2699 
    OR  A                               ;109a  b7            2693   2700 
    LD  HL,000FEh                       ;109b  21 fe 00      2694   2701 
    JR  Z,SOUND1                        ;109e  28 09         2695   2702 
    DEC A                               ;10a0  3d            2696   2703 
    LD  HL,002FDh                       ;10a1  21 fd 02      2697   2704 
    JR  Z,SOUND1                        ;10a4  28 03         2698   2705 
    LD  HL,004FBh                       ;10a6  21 fb 04      2699   2706 
SOUND1: LD  A,D                         ;10a9  7a            2700   2707 
    AND 7                               ;10aa  e6 07         2701   2708 
    JR  Z,SOUND2                        ;10ac  28 40         2702   2709 
    PUSH    HL                          ;10ae  e5            2703   2710 
    LD  BC,NUMTBL                       ;10af  01 23 11      2704   2711 
    BIT 3,D                             ;10b2  cb 5a         2705   2712 
    JR  Z,SOUND3                        ;10b4  28 03         2706   2713 
    LD  BC,UPTBL                        ;10b6  01 31 11      2707   2714 
SOUND3: DEC A                           ;10b9  3d            2708   2715 
    LD  L,A                             ;10ba  6f            2709   2716 
    LD  H,0                             ;10bb  26 00         2710   2717 
    ADD HL,HL                           ;10bd  29            2711   2718 
    ADD HL,BC                           ;10be  09            2712   2719 
    LD  A,D                             ;10bf  7a            2713   2720 
    LD  E,(HL)                          ;10c0  5e            2714   2721 
    INC HL                              ;10c1  23            2715   2722 
    LD  D,(HL)                          ;10c2  56            2716   2723 
    RRCA                                ;10c3  0f            2717   2724 
    RRCA                                ;10c4  0f            2718   2725 
    RRCA                                ;10c5  0f            2719   2726 
    RRCA                                ;10c6  0f            2720   2727 
    AND 00Fh                            ;10c7  e6 0f         2721   2728 
    JR  Z,SOUND4                        ;10c9  28 07         2722   2729 
SOUND5: SRL D                           ;10cb  cb 3a         2723   2730 
    RR  E                               ;10cd  cb 1b         2724   2731 
    DEC A                               ;10cf  3d            2725   2732 
    JR  NZ,SOUND5                       ;10d0  20 f9         2726   2733 
SOUND4: POP HL                          ;10d2  e1            2727   2734 
    LD  BC,04000h                       ;10d3  01 00 40      2728   2735 
    OUT (C),H                           ;10d6  ed 61         2729   2736 
    INC C                               ;10d8  0c            2730   2737 
    OUT (C),E                           ;10d9  ed 59         2731   2738 
    INC H                               ;10db  24            2732   2739 
    DEC C                               ;10dc  0d            2733   2740 
    OUT (C),H                           ;10dd  ed 61         2734   2741 
    INC C                               ;10df  0c            2735   2742 
    OUT (C),D                           ;10e0  ed 51         2736   2743 
    DEC C                               ;10e2  0d            2737   2744 
    LD  A,7                             ;10e3  3e 07         2738   2745 
    OUT (C),A                           ;10e5  ed 79         2739   2746 
    INC C                               ;10e7  0c            2740   2747 
    IN  A,(C)                           ;10e8  ed 78         2741   2748 
    AND L                               ;10ea  a5            2742   2749 
    OUT (C),A                           ;10eb  ed 79         2743   2750 
    RET                                 ;10ed  c9            2744   2751 
                                        ;                    2745   2752 ;
SOUND2: LD  BC,04000h                   ;10ee  01 00 40      2746   2753 
    LD  A,7                             ;10f1  3e 07         2747   2754 
    OUT (C),A                           ;10f3  ed 79         2748   2755 
    INC C                               ;10f5  0c            2749   2756 
    IN  H,(C)                           ;10f6  ed 60         2750   2757 
    LD  A,L                             ;10f8  7d            2751   2758 
    CPL                                 ;10f9  2f            2752   2759 
    OR  H                               ;10fa  b4            2753   2760 
    OUT (C),A                           ;10fb  ed 79         2754   2761 
    RET                                 ;10fd  c9            2755   2762 
                                        ;                    2756   2763 ;
                                        ;                    2757   2764 ;
                                        ;                    2758   2765 ; DATA TABLE
                                        ;                    2759   2766 ;
                                        ;                    2760   2767 ;
MSDT32: DEFW    62                      ;10fe  3e 00         2761   2768 
                                        ;                    2762   2769 ;
MUSNUL: DEFM    ':'                     ;1100  3a            2763   2770 ;:
                                        ;                    2764   2771 ;
LENGTB: DEFB    1                       ;1101  01            2765   2772 
    DEFB    2                           ;1102  02            2766   2773 
    DEFB    3                           ;1103  03            2767   2774 
    DEFB    4                           ;1104  04            2768   2775 
    DEFB    6                           ;1105  06            2769   2776 
    DEFB    8                           ;1106  08            2770   2777 
    DEFB    00CH                        ;1107  0c            2771   2778 
    DEFB    010h                        ;1108  10            2772   2779 
    DEFB    018h                        ;1109  18            2773   2780 
    DEFB    020h                        ;110a  20            2774   2781 
                                        ;                    2775   2782 ;
LEN?A:  DEFB    008h                    ;110b  08            2776   2783 ;R5
    DEFB    000h                        ;110c  00            2777   2784 
DATA?A: DEFW    00000h                  ;110d  00 00         2778   2785 
    DEFB    0FEh                        ;110f  fe            2779   2786 
OCT?A:  DEFB    003h                    ;1110  03            2780   2787 
LENG?A: DEFB    000h                    ;1111  00            2781   2788 
    DEFB    008h                        ;1112  08            2782   2789 
                                        ;                    2783   2790 ;
LEN?B:  DEFB    008h                    ;1113  08            2784   2791 
    DEFB    002h                        ;1114  02            2785   2792 
DATA?B: DEFW    00000h                  ;1115  00 00         2786   2793 
    DEFB    0FDh                        ;1117  fd            2787   2794 
OCT?B:  DEFB    3                       ;1118  03            2788   2795 
LENG?B: DEFB    0                       ;1119  00            2789   2796 
    DEFB    9                           ;111a  09            2790   2797 
                                        ;                    2791   2798 ;
LEN?C:  DEFB    8                       ;111b  08            2792   2799 
    DEFB    4                           ;111c  04            2793   2800 
DATA?C: DEFW    00000h                  ;111d  00 00         2794   2801 
    DEFB    0FBh                        ;111f  fb            2795   2802 
OCT?C:  DEFB    3                       ;1120  03            2796   2803 
LENG?C: DEFB    0                       ;1121  00            2797   2804 
    DEFB    10                          ;1122  0a            2798   2805 
                                        ;                    2799   2806 ;
                                        ;                    2800   2807 ;
NUMTBL: DEFW    007F2h                  ;1123  f2 07         2801   2808 ;A
    DEFW    00714h                      ;1125  14 07         2802   2809 ;B
    DEFW    00D5Dh                      ;1127  5d 0d         2803   2810 ;C
    DEFW    00BE7h                      ;1129  e7 0b         2804   2811 ;D
    DEFW    00A9Bh                      ;112b  9b 0a         2805   2812 ;E
    DEFW    00A02h                      ;112d  02 0a         2806   2813 ;F
    DEFW    008EBh                      ;112f  eb 08         2807   2814 ;G
                                        ;                    2808   2815 ;
UPTBL:  DEFW    00780h                  ;1131  80 07         2809   2816 ;A#
    DEFW    00714h                      ;1133  14 07         2810   2817 ;B
    DEFW    00C9Ch                      ;1135  9c 0c         2811   2818 ;C#
    DEFW    00B3Ch                      ;1137  3c 0b         2812   2819 ;D#
    DEFW    00A9Bh                      ;1139  9b 0a         2813   2820 ;E
    DEFW    00973h                      ;113b  73 09         2814   2821 ;F#
    DEFW    0086Bh                      ;113d  6b 08         2815   2822 ;G#
                                        ;                    2816   2823 ;
CTRLTB: DEFW    NORET                   ;113f  cc 0e         2817   2824 ;@
    DEFW    NORET                       ;1141  cc 0e         2818   2825 ;A
    DEFW    CTRLB                       ;1143  9c 0b         2819   2826 ;B
    DEFW    CTRLM                       ;1145  62 0b         2820   2827 ;C
    DEFW    SCRLDW                      ;1147  ea 09         2821   2828 ;D
    DEFW    CTRLE                       ;1149  1d 0c         2822   2829 ;E
    DEFW    CTRLF                       ;114b  b4 0b         2823   2830 ;F
    DEFW    CTRLG                       ;114d  91 0b         2824   2831 ;G
    DEFW    DELETE                      ;114f  8e 0a         2825   2832 ;H 315ah ?? 
    DEFW    CTRLI                       ;1151  08 0c         2826   2833 ;I
    DEFW    NORET                       ;1153  cc 0e         2827   2834 ;J
    DEFW    HOME                        ;1155  03 0b         2828   2835 ;K HOME
    DEFW    CLR2                        ;1157  d5 0a         2829   2836 ;L CLR
    DEFW    CTRLM                       ;1159  62 0b         2830   2837 ;M CR
    DEFW    NORET                       ;115b  cc 0e         2831   2838 ;N
    DEFW    NORET                       ;115d  cc 0e         2832   2839 ;O
    DEFW    NORET                       ;115f  cc 0e         2833   2840 ;P
    DEFW    NORET                       ;1161  cc 0e         2834   2841 ;Q
    DEFW    INST                        ;1163  09 0b         2835   2842 ;R INST
    DEFW    NORET                       ;1165  cc 0e         2836   2843 ;S
    DEFW    CTRLT                       ;1167  fb 0b         2837   2844 ;T
    DEFW    SCRLUP                      ;1169  91 09         2838   2845 ;U
    DEFW    LOCK                        ;116b  3f 0b         2839   2846 ;V LOCK
    DEFW    UNLOCK                      ;116d  45 0b         2840   2847 ;W UNLOCK
    DEFW    NORET                       ;116f  cc 0e         2841   2848 ;X
    DEFW    CTRLY                       ;1171  f7 0b         2842   2849 ;Y
    DEFW    CTRLZ                       ;1173  25 0c         2843   2850 ;Z
    DEFW    NORET                       ;1175  cc 0e         2844   2851 ;ESC
    DEFW    RIGHT                       ;1177  6b 0b         2845   2852 ;RIGHT
    DEFW    LEFT                        ;1179  48 0b         2846   2853 ;LEFT
    DEFW    UP                          ;117b  87 0b         2847   2854 ;UP
    DEFW    DOWN                        ;117d  8c 0b         2848   2855 ;DOWN
                                        ;                    2849   2856 
                                        ;                    2850   2857 
BELLFG: DEFB    0                       ;117f  00            2851   2858 ;CTRL-G
                                        ;                    2852   2859 ;
COLORF: DEFB    0                       ;1180  00            2853   2860 ; Color Flag
GCOLOR: DEFB    0                       ;1181  00            2854   2861 ; Graphic Color
SCRLBF: DEFS    020h                    ;1182                2855   2862 ; scroll buffer
LINEF:  DEFS    65                      ;11a2                2856   2863 ; line return flag
                                        ;                    2857   2864 ;
CKSMF1: DEFW    0                       ;11e3  00 00         2858   2865 ; checksum field
CKSMF2: DEFW    0                       ;11e5  00 00         2859   2866 ; checksum field
MKLEN:  DEFW    0                       ;11e7  00 00         2860   2867 
                                        ;                    2861   2868 ;
IO6000: DEFB    0                       ;11e9  00            2862   2869 ; 6000H I/O data
IO2000: DEFB    0                       ;11ea  00            2863   2870 ; 2000H I/O data
DISFLG: DEFB    1                       ;11eb  01            2864   2871 ; output flag (console=1, printer=2)
PRINTN: DEFB    0                       ;11ec  00            2865   2872 ; printer header
                                        ;                    2866   2873 ;
CURX:   DEFB    0                       ;11ed  00            2867   2874 ; cursor X
CURY:   DEFB    0                       ;11ee  00            2868   2875 ; cursor Y
OLDBUF: DEFS    10                      ;11ef                2869   2876 ; keyboard matrix old buffer
NEWBUF: DEFS    9                       ;11f9                2870   2877 ; keyboard matrix new buffer
NEWMOD: DEFB    0FFh                    ;1202  ff            2871   2878 ; keyboard matrix mode flag
                                        ;                    2872   2879 ;
LOCKMD: DEFB    0                       ;1203  00            2873   2880 ; LOCK mode
POINT1: DEFB    0                       ;1204  00            2874   2881 ; key input buffer 
POINT2: DEFB    0                       ;1205  00            2875   2882 ; key input buffer 
INKYBF: DEFS    040h                    ;1206                2876   2883 ; key input buffer
TABBUF: DEFS    32                      ;1246                2877   2884 ; TAB flag
                                        ;                    2878   2885 ;
                                        ;                    2879   2886 ;
FUNBUF: DEFB    5                       ;1266  05            2880   2887 ; function definition
    DEFM    'AUTO'                      ;1267  41 55 54 4f   2881   2888 
    DEFB    00Dh                        ;126b  0d            2882   2889 
    DEFS    10                          ;126c                2883   2890 
    DEFB    6                           ;1276  06            2884   2891 
    DEFM    'SCREEN'                    ;1277  53 43 52 45   2885   2892 
                                        ;127b  45 4e         2885   2893
                                        ;                    2886   2894 
    DEFB    0                           ;127d  00            2887   2895 
    DEFS    8                           ;127e                2888   2896 
    DEFB    3                           ;1286  03            2889   2897 
    DEFM    'KEY'                       ;1287  4b 45 59      2890   2898 
    DEFB    0                           ;128a  00            2891   2899 
    DEFS    11                          ;128b                2892   2900 
    DEFB    5                           ;1296  05            2893   2901 
    DEFM    'LIST'                      ;1297  4c 49 53 54   2894   2902 
    DEFB    00Dh                        ;129b  0d            2895   2903 
    DEFS    00Ah                        ;129c                2896   2904 
    DEFB    4                           ;12a6  04            2897   2905 
    DEFM    'RUN'                       ;12a7  52 55 4e      2898   2906 
    DEFB    00Dh                        ;12aa  0d            2899   2907 
    DEFS    11                          ;12ab                2900   2908 
    DEFB    5                           ;12b6  05            2901   2909 
    DEFM    'LOAD'                      ;12b7  4c 4f 41 44   2902   2910 
    DEFB    00Dh                        ;12bb  0d            2903   2911 
    DEFS    10                          ;12bc                2904   2912 
    DEFB    5                           ;12c6  05            2905   2913 
    DEFM    'BEEP'                      ;12c7  42 45 45 50   2906   2914 
    DEFB    00Dh                        ;12cb  0d            2907   2915 
    DEFS    10                          ;12cc                2908   2916 
    DEFB    5                           ;12d6  05            2909   2917 
    DEFM    'CHR$('                     ;12d7  43 48 52 24   2910   2918 
                                        ;12db  28            2910   2919
                                        ;                    2911   2920 
    DEFB    0                           ;12dc  00            2912   2921 
    DEFS    9                           ;12dd                2913   2922 
    DEFB    4                           ;12e6  04            2914   2923 
    DEFM    'EDIT'                      ;12e7  45 44 49 54   2915   2924 
    DEFB    0                           ;12eb  00            2916   2925 
    DEFS    10                          ;12ec                2917   2926 
    DEFB    5                           ;12f6  05            2918   2927 
    DEFM    'CONT'                      ;12f7  43 4f 4e 54   2919   2928 
    DEFB    00Dh                        ;12fb  0d            2920   2929 
    DEFS    10                          ;12fc                2921   2930 
                                        ;                    2922   2931 ;
KEYDT1: DEFW    0F500h                  ;1306  00 f5         2923   2932 ;8009  No Shift
    DEFM    '-0                         ;1308  2d 30 3b      2924   2933 ;'		;'
    DEFW    06F6Ch                      ;130b  6c 6f         2925   2934 ;LO
    DEFM    '9'                         ;130d  39            2926   2935 ;9
    DEFW    0F400h                      ;130e  00 f4         2927   2936 ;8008
    DEFB    01Fh                        ;1310  1f            2928   2937 
    DEFM    ':/'                        ;1311  3a 2f         2929   2938 ;/
    DEFW    0696Bh                      ;1313  6b 69         2930   2939 ;KI
    DEFM    '8'                         ;1315  38            2931   2940 
    DEFW    0F300h                      ;1316  00 f3         2932   2941 ;8007
    DEFW    0701Eh                      ;1318  1e 70         2933   2942 ;P
    DEFM    '.'                         ;131a  2e            2934   2943 ;★원래는3F(?)였음
    DEFW    0756Ah                      ;131b  6a 75         2935   2944 ;JU
    DEFM    '7'                         ;131d  37            2936   2945 
    DEFW    0F200h                      ;131e  00 f2         2937   2946 ;8006
    DEFW    07840h                      ;1320  40 78         2938   2947 ;X
    DEFM    ','                         ;1322  2c            2939   2948 
    DEFW    07968h                      ;1323  68 79         2940   2949 ;HV
    DEFM    '6'                         ;1325  36            2941   2950 
    DEFW    0F100h                      ;1326  00 f1         2942   2951 ;8005
    DEFW    05D1Dh                      ;1328  1d 5d         2943   2952 
    DEFW    0676Dh                      ;132a  6d 67         2944   2953 ;MG
    DEFW    03574h                      ;132c  74 35         2945   2954 ;T5
    DEFW    00000h                      ;132e  00 00         2946   2955 ;8004
    DEFW    07C1Ch                      ;1330  1c 7c         2947   2956 
    DEFW    0666Eh                      ;1332  6e 66         2948   2957 ;NF
    DEFW    03472h                      ;1334  72 34         2949   2958 ;R4
    DEFW    00008h                      ;1336  08 00         2950   2959 ;DEL ;8003
    DEFW    05B1Bh                      ;1338  1b 5b         2951   2960 
    DEFW    06462h                      ;133a  62 64         2952   2961 ;BD
    DEFW    03365h                      ;133c  65 33         2953   2962 ;E3
    DEFW    00016h                      ;133e  16 00         2954   2963 ;LOCK ;8002
    DEFW    05D7Ah                      ;1340  7a 5d         2955   2964 ;Z^
    DEFW    07376h                      ;1342  76 73         2956   2965 ;VS
    DEFW    03277h                      ;1344  77 32         2957   2966 ;W2
    DEFW    00B5Eh                      ;1346  5e 0b         2958   2967 ;HOME ;8001
    DEFW    00D20h                      ;1348  20 0d         2959   2968 
    DEFW    06163h                      ;134a  63 61         2960   2969 ;CA
    DEFW    03171h                      ;134c  71 31         2961   2970 ;Q1
                                        ;                    2962   2971 ;
                                        ;                    2963   2972 ;
                                        ;                    2964   2973 ;
KEYDT2: DEFW    0FA00h                  ;134e  00 fa         2965   2974 ; Shift
    DEFM    '=0+LO)'                    ;1350  3d 30 2b 4c   2966   2975 
                                        ;1354  4f 29         2966   2976
                                        ;                    2967   2977 
    DEFW    0F900h                      ;1356  00 f9         2968   2978 
    DEFB    01Fh                        ;1358  1f            2969   2979 
    DEFM    '*?KI('                     ;1359  2a 3f 4b 49   2970   2980 
                                        ;135d  28            2970   2981
                                        ;                    2971   2982 
    DEFW    0F800h                      ;135e  00 f8         2972   2983 
    DEFB    01Eh                        ;1360  1e            2973   2984 
    DEFM    'P>JU'                      ;1361  50 3e 4a 55   2974   2985 
    DEFB    027h                        ;1365  27            2975   2986 
    DEFW    0F700h                      ;1366  00 f7         2976   2987 
    DEFB    060h                        ;1368  60            2977   2988 
    DEFM    'X<HY&'                     ;1369  58 3c 48 59   2978   2989 
                                        ;136d  26            2978   2990
                                        ;                    2979   2991 
    DEFW    0F600h                      ;136e  00 f6         2980   2992 
    DEFW    07D1Dh                      ;1370  1d 7d         2981   2993 
    DEFM    'MGT%'                      ;1372  4d 47 54 25   2982   2994 
    DEFW    00000h                      ;1376  00 00         2983   2995 
    DEFW    07F1Ch                      ;1378  1c 7f         2984   2996 
    DEFM    'NFR$'                      ;137a  4e 46 52 24   2985   2997 
    DEFW    00012h                      ;137e  12 00         2986   2998 ;INST
    DEFW    07B1Bh                      ;1380  1b 7b         2987   2999 
    DEFM    'BDE#'                      ;1382  42 44 45 23   2988   3000 
    DEFW    00017h                      ;1386  17 00         2989   3001 ;LOCK
    DEFM    'Z'                         ;1388  5a            2990   3002 
    DEFB    07Dh                        ;1389  7d            2991   3003 
    DEFM    'VSW"'                      ;138a  56 53 57 22   2992   3004 
    DEFW    00C7Eh                      ;138e  7e 0c         2993   3005 ;CLR
    DEFW    00D20h                      ;1390  20 0d         2994   3006 
    DEFM    'CAQ!'                      ;1392  43 41 51 21   2995   3007 
                                        ;                    2996   3008 ;
                                        ;                    2997   3009 ; FILE
                                        ;                    2998   3010 ;  CONTROL
                                        ;                    2999   3011 ;   BLOCK
                                        ;                    3000   3012 ;
                                        ;                    3001   3013 ;
FILMOD: DEFB    0001h                   ;1396  01            3002   3014 ; 1=기계어, 2=베이직
FILNAM: DEFS    17                      ;1397                3003   3015 ; 프로그램 이름 17 BYTE
MTBYTE: DEFW    1                       ;13a8  01 00         3004   3016 ; 프로그램 크기
MTADRS: DEFW    0                       ;13aa  00 00         3005   3017 ; 프로그램 저장번지
MTEXEC: DEFW    0                       ;13ac  00 00         3006   3018 ; CP/M에서 시작번지
PROTCT: DEFW    0                       ;13ae  00 00         3007   3019 ; 3A 00 이 들어있으면 베이직 자동실행
    DEFS    01416h - $                  ;13b0                3008   3020 ; 102 BYTE
                                        ;                    3009   3021 
                                        ;                    3010   3022 ;
                                        ;                    3011   3023 ; HUDSON BASIC V1.0
                                        ;                    3012   3024 ;
                                        ;                    3013   3025 
                                        ;                    3014   3026 ;SPBUF   EQU  02232h
    JR  HOTENT                          ;1416  18 2e         3015   3027 
$BASIC:                                 ;                    3016   3028 
COLDST: LD  DE,KEYBUF                   ;1418  11 4f 7a      3017   3029 
    LD  B,64                            ;141b  06 40         3018   3030 
MESOFF: CALL    PRTSDC                  ;141d  cd e1 07      3019   3031 
    LD  A,001h                          ;1420  3e 01         3020   3032 
    LD  (MESOFF),A                      ;1422  32 1d 14      3021   3033 
    LD  HL,KEYBUF                       ;1425  21 4f 7a      3022   3034 
    LD  D,0FFh                          ;1428  16 ff         3023   3035 ;MEM.MAX
L0014:                                  ;                    3024   3036 
    XOR A                               ;142a  af            3025   3037 
    LD  (HL),A                          ;142b  77            3026   3038 
    CP  (HL)                            ;142c  be            3027   3039 
    JR  NZ,L001E                        ;142d  20 05         3028   3040 
    INC HL                              ;142f  23            3029   3041 
    LD  A,H                             ;1430  7c            3030   3042 
    CP  D                               ;1431  ba            3031   3043 
    JR  NZ,L0014                        ;1432  20 f6         3032   3044 
L001E:                                  ;                    3033   3045 
    LD  (MEMMAX),HL                     ;1434  22 49 7a      3034   3046 
    CALL    MEMSET                      ;1437  cd e9 33      3035   3047 
    CALL    GSAVES                      ;143a  cd ea 1b      3036   3048 ;PCG SET
START:  CALL    NEW                     ;143d  cd ac 39      3037   3049 
    LD  HL,00000h                       ;1440  21 00 00      3038   3050 
    LD  (PROTCT),HL                     ;1443  22 ae 13      3039   3051 ;CMT BUFF
HOTENT: CALL    CLR                     ;1446  cd 51 19      3040   3052 
    LD  SP,(STRTOP)                     ;1449  ed 7b 41 7a   3041   3053 
    LD  HL,0FFFFh                       ;144d  21 ff ff      3042   3054 
    PUSH    HL                          ;1450  e5            3043   3055 
    LD  (SPBUF),SP                      ;1451  ed 73 25 22   3044   3056 
    XOR A                               ;1455  af            3045   3057 
    LD  (CONTFG),A                      ;1456  32 08 22      3046   3058 
    LD  (ERRORF),A                      ;1459  32 50 22      3047   3059 
    LD  (FILEFG),A                      ;145c  32 83 33      3048   3060 
    CALL    TROFF                       ;145f  cd ea 32      3049   3061 
OK: CALL    CR2                         ;1462  cd 23 08      3050   3062 
    LD  A,1                             ;1465  3e 01         3051   3063 
    LD  (DISFLG),A                      ;1467  32 eb 11      3052   3064 
    LD  DE,OKMES                        ;146a  11 f7 21      3053   3065 
    LD  B,2                             ;146d  06 02         3054   3066 
    CALL    PRTSDC                      ;146f  cd e1 07      3055   3067 
    LD  B,020h                          ;1472  06 20         3056   3068 
    LD  A,(CONTFG)                      ;1474  3a 08 22      3057   3069 
    OR  A                               ;1477  b7            3058   3070 
    JR  Z,CONTDS                        ;1478  28 02         3059   3071 
    LD  B,02Eh                          ;147a  06 2e         3060   3072 
CONTDS: LD  A,B                         ;147c  78            3061   3073 
    CALL    ACCPRT                      ;147d  cd 64 08      3062   3074 
    LD  A,(GMODEF)                      ;1480  3a 06 1c      3063   3075 
    CP  2                               ;1483  fe 02         3064   3076 
    CALL    NC,GRAPHI                   ;1485  d4 93 1b      3065   3077 
                                        ;                    3066   3078 ;
NMESOK: CALL    CR2                     ;1488  cd 23 08      3067   3079 
AUTOBK: LD  SP,(SPBUF)                  ;148b  ed 7b 25 22   3068   3080 
    CALL    SETSSP                      ;148f  cd f9 21      3069   3081 
KEYINP: LD  HL,KEYINP                   ;1492  21 92 14      3070   3082 
    PUSH    HL                          ;1495  e5            3071   3083 
    CALL    AUTOVC                      ;1496  cd 37 22      3072   3084 
MERGEV: LD  DE,KEYBUF                   ;1499  11 4f 7a      3073   3085 
    DEFB    0CDH                        ;149c  cd            3074   3086 ;CALL
LODVEC: DEFW    LININP                  ;149d  93 15         3075   3087 
    JP  C,AUTOFF                        ;149f  da 2a 22      3076   3088 
BLNKSK: LD  A,(DE)                      ;14a2  1a            3077   3089 
    CP  020h                            ;14a3  fe 20         3078   3090 
    INC DE                              ;14a5  13            3079   3091 
    JR  Z,BLNKSK                        ;14a6  28 fa         3080   3092 
    DEC DE                              ;14a8  1b            3081   3093 
    OR  A                               ;14a9  b7            3082   3094 
    RET Z                               ;14aa  c8            3083   3095 
    CP  027h                            ;14ab  fe 27         3084   3096 
    RET Z                               ;14ad  c8            3085   3097 
    CP  030h                            ;14ae  fe 30         3086   3098 
    JR  NC,L00A5                        ;14b0  30 09         3087   3099 
    LD  HL,0FFFFh                       ;14b2  21 ff ff      3088   3100 
    LD  (LNOBUF),HL                     ;14b5  22 cc 16      3089   3101 
    JP  SERROR                          ;14b8  c3 3a 17      3090   3102 
L00A5:  CP  03Ah                        ;14bb  fe 3a         3091   3103 
    JP  C,EDITOR                        ;14bd  da f2 30      3092   3104 
    POP HL                              ;14c0  e1            3093   3105 
    LD  HL,IMDBUF                       ;14c1  21 4e 7b      3094   3106 
    PUSH    HL                          ;14c4  e5            3095   3107 
    CALL    CVIMTX                      ;14c5  cd 25 63      3096   3108 
    XOR A                               ;14c8  af            3097   3109 
    INC HL                              ;14c9  23            3098   3110 
    LD  (NXTLPT),HL                     ;14ca  22 12 16      3099   3111 
    LD  (HL),A                          ;14cd  77            3100   3112 
    INC HL                              ;14ce  23            3101   3113 
    LD  (HL),A                          ;14cf  77            3102   3114 
    INC A                               ;14d0  3c            3103   3115 
    LD  (DISFLG),A                      ;14d1  32 eb 11      3104   3116 
    LD  HL,0FFFFh                       ;14d4  21 ff ff      3105   3117 
    LD  (LNOBUF),HL                     ;14d7  22 cc 16      3106   3118 
    POP HL                              ;14da  e1            3107   3119 
ONELIN: LD  (SPBUF),SP                  ;14db  ed 73 25 22   3108   3120 
SPCCUT: LD  A,(HL)                      ;14df  7e            3109   3121 
    CP  020h                            ;14e0  fe 20         3110   3122 
    INC HL                              ;14e2  23            3111   3123 
    JR  Z,SPCCUT                        ;14e3  28 fa         3112   3124 
    CP  03Ah                            ;14e5  fe 3a         3113   3125 
    JR  Z,SPCCUT                        ;14e7  28 f6         3114   3126 
    OR  A                               ;14e9  b7            3115   3127 
    JP  Z,NXLINE                        ;14ea  ca 11 16      3116   3128 
    LD  (CURTXT),HL                     ;14ed  22 7b 21      3117   3129 
    LD  C,A                             ;14f0  4f            3118   3130 
    LD  A,080h                          ;14f1  3e 80         3119   3131 ;BREAK CHECK
    IN  A,(0)                           ;14f3  db 00         3120   3132 
    AND 012h                            ;14f5  e6 12         3121   3133 
BREAKJ: DEFB    0CAH                    ;14f7  ca            3122   3134 ;JP Z,?
    DEFW    BREAK                       ;14f8  a2 16         3123   3135 
PAUSEP: LD  A,C                         ;14fa  79            3124   3136 
    LD  DE,SPCCUT                       ;14fb  11 df 14      3125   3137 
    PUSH    DE                          ;14fe  d5            3126   3138 
LETDA': CP  027h                        ;14ff  fe 27         3127   3139 ;'
    JP  Z,REM                           ;1501  ca 3a 18      3128   3140 
    CP  081h                            ;1504  fe 81         3129   3141 
    JP  NC,STMNTS                       ;1506  d2 20 17      3130   3142 
    CP  041h                            ;1509  fe 41         3131   3143 
    JP  C,SERROR                        ;150b  da 3a 17      3132   3144 
LETDAI: LD  C,L                         ;150e  4d            3133   3145 
    LD  B,H                             ;150f  44            3134   3146 
    LD  DE,(INTFAC)                     ;1510  ed 5b 4b 7a   3135   3147 
DAINUE: CALL    GETVAR                  ;1514  cd da 1e      3136   3148 
    CP  003h                            ;1517  fe 03         3137   3149 
    JR  Z,DAISTR                        ;1519  28 2b         3138   3150 
DAINV': PUSH    AF                      ;151b  f5            3139   3151 
    CALL    BCFTCH                      ;151c  cd c4 25      3140   3152 
    CP  0F5h                            ;151f  fe f5         3141   3153 
    JP  NZ,SERROR                       ;1521  c2 3a 17      3142   3154 
    EX  (SP),HL                         ;1524  e3            3143   3155 
    PUSH    HL                          ;1525  e5            3144   3156 
    CALL    FLEXPR                      ;1526  cd 99 22      3145   3157 
    POP AF                              ;1529  f1            3146   3158 
    CP  002h                            ;152a  fe 02         3147   3159 
    JR  Z,INTDAI                        ;152c  28 0e         3148   3160 
    POP DE                              ;152e  d1            3149   3161 
DAIMID: PUSH    BC                      ;152f  c5            3150   3162 
    LD  B,A                             ;1530  47            3151   3163 
DAITRS: LD  A,(HL)                      ;1531  7e            3152   3164 
    LD  (DE),A                          ;1532  12            3153   3165 
    INC HL                              ;1533  23            3154   3166 
    INC DE                              ;1534  13            3155   3167 
    DJNZ    DAITRS                      ;1535  10 fa         3156   3168 
    POP BC                              ;1537  c1            3157   3169 
DAIRET: LD  L,C                         ;1538  69            3158   3170 
    LD  H,B                             ;1539  60            3159   3171 
    DEC HL                              ;153a  2b            3160   3172 
    RET                                 ;153b  c9            3161   3173 
                                        ;                    3162   3174 ;
INTDAI: CALL    HLFLTO                  ;153c  cd 97 2d      3163   3175 
    POP DE                              ;153f  d1            3164   3176 
    EX  DE,HL                           ;1540  eb            3165   3177 
    LD  (HL),E                          ;1541  73            3166   3178 
    INC HL                              ;1542  23            3167   3179 
    LD  (HL),D                          ;1543  72            3168   3180 
    JR  DAIRET                          ;1544  18 f2         3169   3181 
                                        ;                    3170   3182 ;
DAISTR: CALL    BCFTCH                  ;1546  cd c4 25      3171   3183 
    CP  0F5h                            ;1549  fe f5         3172   3184 
    JP  NZ,SERROR                       ;154b  c2 3a 17      3173   3185 
    PUSH    HL                          ;154e  e5            3174   3186 
    CALL    STEXPR                      ;154f  cd b2 22      3175   3187 
STRMDM: CALL    CONDMZ                  ;1552  cd f6 6b      3176   3188 
    CALL    CVDSAD                      ;1555  cd 0e 17      3177   3189 
    PUSH    BC                          ;1558  c5            3178   3190 
    PUSH    HL                          ;1559  e5            3179   3191 
    OR  A                               ;155a  b7            3180   3192 
    JR  Z,ESKTRS                        ;155b  28 11         3181   3193 
    LD  C,A                             ;155d  4f            3182   3194 
    LD  B,0                             ;155e  06 00         3183   3195 
    EX  DE,HL                           ;1560  eb            3184   3196 
    LD  DE,KEYBUF                       ;1561  11 4f 7a      3185   3197 
    PUSH    DE                          ;1564  d5            3186   3198 
    LDIR                                ;1565  ed b0         3187   3199 
    POP DE                              ;1567  d1            3188   3200 
    POP HL                              ;1568  e1            3189   3201 
    PUSH    HL                          ;1569  e5            3190   3202 
    INC HL                              ;156a  23            3191   3203 
    LD  (HL),E                          ;156b  73            3192   3204 
    INC HL                              ;156c  23            3193   3205 
    LD  (HL),D                          ;156d  72            3194   3206 
ESKTRS: POP HL                          ;156e  e1            3195   3207 
    POP BC                              ;156f  c1            3196   3208 
    POP DE                              ;1570  d1            3197   3209 
INPENT: PUSH    DE                      ;1571  d5            3198   3210 
    EX  DE,HL                           ;1572  eb            3199   3211 
    CALL    CONDM'                      ;1573  cd f2 6b      3200   3212 
    EX  DE,HL                           ;1576  eb            3201   3213 
    PUSH    HL                          ;1577  e5            3202   3214 
    INC HL                              ;1578  23            3203   3215 
    LD  E,(HL)                          ;1579  5e            3204   3216 
    INC HL                              ;157a  23            3205   3217 
    LD  D,(HL)                          ;157b  56            3206   3218 
    LD  HL,(STRTOP)                     ;157c  2a 41 7a      3207   3219 
    OR  A                               ;157f  b7            3208   3220 
    SBC HL,DE                           ;1580  ed 52         3209   3221 
    CCF                                 ;1582  3f            3210   3222 
    JR  NC,DAIMD'                       ;1583  30 05         3211   3223 
    LD  HL,TEXTST                       ;1585  21 4e 7c      3212   3224 
    SBC HL,DE                           ;1588  ed 52         3213   3225 
DAIMD': POP HL                          ;158a  e1            3214   3226 
    POP DE                              ;158b  d1            3215   3227 
    CALL    NC,GETSTR                   ;158c  d4 9e 2d      3216   3228 
    LD  A,003h                          ;158f  3e 03         3217   3229 
    JR  DAIMID                          ;1591  18 9c         3218   3230 
                                        ;                    3219   3231 ;
LININP: EI                              ;1593  fb            3220   3232 
    CALL    INPUTF                      ;1594  cd a4 06      3221   3233 
    LD  A,(DE)                          ;1597  1a            3222   3234 
    CP  3                               ;1598  fe 03         3223   3235 ;BREAK CODE
    SCF                                 ;159a  37            3224   3236 
    RET Z                               ;159b  c8            3225   3237 
    PUSH    DE                          ;159c  d5            3226   3238 
ZEROMK: LD  A,(DE)                      ;159d  1a            3227   3239 
    INC DE                              ;159e  13            3228   3240 
    CP  00Dh                            ;159f  fe 0d         3229   3241 
    JR  NZ,ZEROMK                       ;15a1  20 fa         3230   3242 
    DEC DE                              ;15a3  1b            3231   3243 
    XOR A                               ;15a4  af            3232   3244 
    PUSH    BC                          ;15a5  c5            3233   3245 
    LD  B,10                            ;15a6  06 0a         3234   3246 
KBCLLP: LD  (DE),A                      ;15a8  12            3235   3247 
    INC DE                              ;15a9  13            3236   3248 
    DJNZ    KBCLLP                      ;15aa  10 fc         3237   3249 
    POP BC                              ;15ac  c1            3238   3250 
    POP DE                              ;15ad  d1            3239   3251 
    RET                                 ;15ae  c9            3240   3252 
                                        ;                    3241   3253 ;
ENDTXT: LD  A,(ERRORF)                  ;15af  3a 50 22      3242   3254 
    OR  A                               ;15b2  b7            3243   3255 
OKFVC:  JP  Z,OK                        ;15b3  ca 62 14      3244   3256 
    LD  HL,(LNOBUF)                     ;15b6  2a cc 16      3245   3257 
    INC HL                              ;15b9  23            3246   3258 
    LD  A,L                             ;15ba  7d            3247   3259 
    OR  H                               ;15bb  b4            3248   3260 
    JR  Z,OKFVC                         ;15bc  28 f5         3249   3261 
    LD  A,19                            ;15be  3e 13         3250   3262 
    JP  ERROR                           ;15c0  c3 96 21      3251   3263 
                                        ;                    3252   3264 ;
RUN:    CALL    CLR                     ;15c3  cd 51 19      3253   3265 
    XOR A                               ;15c6  af            3254   3266 
    LD  (FILEFG),A                      ;15c7  32 83 33      3255   3267 
    LD  (CONTFG),A                      ;15ca  32 08 22      3256   3268 
    LD  (ERRCOD),A                      ;15cd  32 95 22      3257   3269 
    LD  (ERRORF),A                      ;15d0  32 50 22      3258   3270 
    PUSH    HL                          ;15d3  e5            3259   3271 
    LD  HL,TEXTST                       ;15d4  21 4e 7c      3260   3272 
    DEC HL                              ;15d7  2b            3261   3273 
    LD  (HL),A                          ;15d8  77            3262   3274 
    LD  (DATAPO),HL                     ;15d9  22 60 1c      3263   3275 
    LD  HL,LININP                       ;15dc  21 93 15      3264   3276 
    LD  (LODVEC),HL                     ;15df  22 9d 14      3265   3277 
    POP HL                              ;15e2  e1            3266   3278 
    LD  SP,(STRTOP)                     ;15e3  ed 7b 41 7a   3267   3279 
    PUSH    HL                          ;15e7  e5            3268   3280 
    LD  HL,0                            ;15e8  21 00 00      3269   3281 
    LD  (ERRLNO),HL                     ;15eb  22 65 22      3270   3282 
    LD  (ERRORV),HL                     ;15ee  22 83 21      3271   3283 
    DEC HL                              ;15f1  2b            3272   3284 
    EX  (SP),HL                         ;15f2  e3            3273   3285 
    LD  (SPBUF),SP                      ;15f3  ed 73 25 22   3274   3286 
    CALL    HLFTCH                      ;15f7  cd 87 29      3275   3287 
    CP  00Bh                            ;15fa  fe 0b         3276   3288 
    JR  NZ,RUNBOT                       ;15fc  20 0d         3277   3289 
    INC HL                              ;15fe  23            3278   3290 
    LD  E,(HL)                          ;15ff  5e            3279   3291 
    INC HL                              ;1600  23            3280   3292 
    LD  D,(HL)                          ;1601  56            3281   3293 
    EX  DE,HL                           ;1602  eb            3282   3294 
    CALL    LNOSER                      ;1603  cd 8e 3f      3283   3295 
    JP  C,UDFLNO                        ;1606  da dc 43      3284   3296 
    JR  RUNMID                          ;1609  18 03         3285   3297 
RUNBOT: LD  HL,TEXTST                   ;160b  21 4e 7c      3286   3298 
RUNMID: LD  (NXTLPT),HL                 ;160e  22 12 16      3287   3299 
NXLINE:                                 ;                    3288   3300 
    DEFB    021H                        ;1611  21            3289   3301 ;LD HL,?
NXTLPT: DEFS    2                       ;1612                3290   3302 
    LD  E,(HL)                          ;1614  5e            3291   3303 
    INC HL                              ;1615  23            3292   3304 
    LD  D,(HL)                          ;1616  56            3293   3305 
    INC HL                              ;1617  23            3294   3306 
    LD  A,D                             ;1618  7a            3295   3307 
    OR  E                               ;1619  b3            3296   3308 
    JR  Z,ENDTXT                        ;161a  28 93         3297   3309 
    LD  (NXTLPT),DE                     ;161c  ed 53 12 16   3298   3310 
    LD  E,(HL)                          ;1620  5e            3299   3311 
    INC HL                              ;1621  23            3300   3312 
    LD  D,(HL)                          ;1622  56            3301   3313 
    INC HL                              ;1623  23            3302   3314 
    LD  (LNOBUF),DE                     ;1624  ed 53 cc 16   3303   3315 
    DEFB    03EH                        ;1628  3e            3304   3316 ;LD A,?
TRACEF:DEFS 1                           ;1629                3305   3317 
    OR  A                               ;162a  b7            3306   3318 
    CALL    NZ,DEBUGR                   ;162b  c4 31 16      3307   3319 
    JP  ONELIN                          ;162e  c3 db 14      3308   3320 
                                        ;                    3309   3321 ;
DEBUGR: PUSH    AF                      ;1631  f5            3310   3322 
    XOR A                               ;1632  af            3311   3323 
    LD  (DISFLG),A                      ;1633  32 eb 11      3312   3324 
    LD  (DEBGHL),A                      ;1636  32 9f 16      3313   3325 
    POP AF                              ;1639  f1            3314   3326 
    RRCA                                ;163a  0f            3315   3327 
    JR  NC,NXSPL0                       ;163b  30 18         3316   3328 
    LD  C,L                             ;163d  4d            3317   3329 
    LD  B,H                             ;163e  44            3318   3330 
    PUSH    HL                          ;163f  e5            3319   3331 
    LD  HL,(CURX)                       ;1640  2a ed 11      3320   3332 
    PUSH    HL                          ;1643  e5            3321   3333 
    LD  HL,0                            ;1644  21 00 00      3322   3334 
    LD  (CURX),HL                       ;1647  22 ed 11      3323   3335 
    LD  L,C                             ;164a  69            3324   3336 
    LD  H,B                             ;164b  60            3325   3337 
    CALL    NXSPL0                      ;164c  cd 55 16      3326   3338 
    POP HL                              ;164f  e1            3327   3339 
    LD  (CURX),HL                       ;1650  22 ed 11      3328   3340 
    POP HL                              ;1653  e1            3329   3341 
    RET                                 ;1654  c9            3330   3342 
                                        ;                    3331   3343 ;
NXSPL0: PUSH    HL                      ;1655  e5            3332   3344 
    RRCA                                ;1656  0f            3333   3345 
    JR  NC,NXSPL1                       ;1657  30 0c         3334   3346 
    PUSH    AF                          ;1659  f5            3335   3347 
    LD  A,2                             ;165a  3e 02         3336   3348 
    LD  (DISFLG),A                      ;165c  32 eb 11      3337   3349 
    LD  A,023h                          ;165f  3e 23         3338   3350 
    LD  (DEBGHL),A                      ;1661  32 9f 16      3339   3351 
    POP AF                              ;1664  f1            3340   3352 
NXSPL1: RRCA                            ;1665  0f            3341   3353 
    JR  NC,NXSPL2                       ;1666  30 11         3342   3354 
    PUSH    AF                          ;1668  f5            3343   3355 
    LD  A,05Bh                          ;1669  3e 5b         3344   3356 
    CALL    ACCPRT                      ;166b  cd 64 08      3345   3357 
    EX  DE,HL                           ;166e  eb            3346   3358 
    CALL    FIVEPR                      ;166f  cd e5 16      3347   3359 
    EX  DE,HL                           ;1672  eb            3348   3360 
    LD  A,05Dh                          ;1673  3e 5d         3349   3361 
    CALL    ACCPRT                      ;1675  cd 64 08      3350   3362 
    POP AF                              ;1678  f1            3351   3363 
NXSPL2: RRCA                            ;1679  0f            3352   3364 
    JR  NC,NXSPL3                       ;167a  30 0f         3353   3365 
    POP HL                              ;167c  e1            3354   3366 
    PUSH    HL                          ;167d  e5            3355   3367 
    PUSH    AF                          ;167e  f5            3356   3368 
    CALL    ONELST                      ;167f  cd 28 41      3357   3369 
    LD  A,5                             ;1682  3e 05         3358   3370 
    CALL    ACCPRT                      ;1684  cd 64 08      3359   3371 
    CALL    CR1                         ;1687  cd 43 08      3360   3372 
    POP AF                              ;168a  f1            3361   3373 
NXSPL3: RRCA                            ;168b  0f            3362   3374 
    PUSH    AF                          ;168c  f5            3363   3375 
    CALL    C,FLSHGT                    ;168d  dc 3c 0d      3364   3376 
    POP AF                              ;1690  f1            3365   3377 
    RRCA                                ;1691  0f            3366   3378 
    LD  HL,DEBGHL                       ;1692  21 9f 16      3367   3379 
    CALL    C,DUMP                      ;1695  dc 2f 3d      3368   3380 
    LD  A,1                             ;1698  3e 01         3369   3381 
    LD  (DISFLG),A                      ;169a  32 eb 11      3370   3382 
    POP HL                              ;169d  e1            3371   3383 
    RET                                 ;169e  c9            3372   3384 
                                        ;                    3373   3385 ;
DEBGHL: DEFS    1                       ;169f                3374   3386 
                                        ;                    3375   3387 ;
                                        ;                    3376   3388 ;
BREAK$: POP BC                          ;16a0  c1            3377   3389 
    INC HL                              ;16a1  23            3378   3390 
BREAK:  DEC HL                          ;16a2  2b            3379   3391 
    LD  (BTEXTP),HL                     ;16a3  22 22 22      3380   3392 
    LD  HL,(LNOBUF)                     ;16a6  2a cc 16      3381   3393 
    LD  A,H                             ;16a9  7c            3382   3394 
    AND L                               ;16aa  a5            3383   3395 
    INC A                               ;16ab  3c            3384   3396 
    JR  Z,BRDRCT                        ;16ac  28 02         3385   3397 
    LD  A,1                             ;16ae  3e 01         3386   3398 
BRDRCT: LD  (BLNOBF),HL                 ;16b0  22 16 22      3387   3399 
    LD  (SPBUF),SP                      ;16b3  ed 73 25 22   3388   3400 
    LD  (CONTFG),A                      ;16b7  32 08 22      3389   3401 
    LD  HL,(NXTLPT)                     ;16ba  2a 12 16      3390   3402 
    LD  (BNXTLP),HL                     ;16bd  22 1c 22      3391   3403 
    CALL    CR2                         ;16c0  cd 23 08      3392   3404 
    LD  DE,BREAKM                       ;16c3  11 05 17      3393   3405 
    LD  B,5                             ;16c6  06 05         3394   3406 
    CALL    PRTSDC                      ;16c8  cd e1 07      3395   3407 
LNOPRT: DB  021H                        ;16cb  21            3396   3408 ;LD HL,?
LNOBUF: DEFS    2                       ;16cc                3397   3409 
    LD  A,H                             ;16ce  7c            3398   3410 
    AND L                               ;16cf  a5            3399   3411 
    INC A                               ;16d0  3c            3400   3412 
    JP  Z,OK                            ;16d1  ca 62 14      3401   3413 
    LD  (EDLINE),HL                     ;16d4  22 2a 37      3402   3414 
    LD  DE,INMES                        ;16d7  11 0a 17      3403   3415 
    LD  B,4                             ;16da  06 04         3404   3416 
    CALL    PRTSDC                      ;16dc  cd e1 07      3405   3417 
    CALL    FIVEPR                      ;16df  cd e5 16      3406   3418 
    JP  OK                              ;16e2  c3 62 14      3407   3419 
                                        ;                    3408   3420 ;
FIVEPR: PUSH    DE                      ;16e5  d5            3409   3421 
    LD  DE,KEYBUF                       ;16e6  11 4f 7a      3410   3422 
    CALL    ASCHL                       ;16e9  cd a8 62      3411   3423 
    LD  B,4                             ;16ec  06 04         3412   3424 
SKIPFZ: LD  A,(DE)                      ;16ee  1a            3413   3425 
    CP  030h                            ;16ef  fe 30         3414   3426 
    JR  NZ,PRTNUM                       ;16f1  20 09         3415   3427 
    INC DE                              ;16f3  13            3416   3428 
    DJNZ    SKIPFZ                      ;16f4  10 f8         3417   3429 
LSTODP: LD  A,(DE)                      ;16f6  1a            3418   3430 
    CALL    ACCPRT                      ;16f7  cd 64 08      3419   3431 
    POP DE                              ;16fa  d1            3420   3432 
    RET                                 ;16fb  c9            3421   3433 
                                        ;                    3422   3434 
PRTNUM: LD  A,(DE)                      ;16fc  1a            3423   3435 
    CALL    ACCPRT                      ;16fd  cd 64 08      3424   3436 
    INC DE                              ;1700  13            3425   3437 
    DJNZ    PRTNUM                      ;1701  10 f9         3426   3438 
    JR  LSTODP                          ;1703  18 f1         3427   3439 
                                        ;                    3428   3440 ;
BREAKM: DEFM    'BREAK'                 ;1705  42 52 45 41   3429   3441 
                                        ;1709  4b            3429   3442
                                        ;                    3430   3443 
INMES:  DEFM    ' IN '                  ;170a  20 49 4e 20   3431   3444 
                                        ;                    3432   3445 ;
CVDSAD: PUSH    HL                      ;170e  e5            3433   3446 
    CALL    INDRCT                      ;170f  cd a3 2a      3434   3447 
    LD  A,(HL)                          ;1712  7e            3435   3448 
    INC HL                              ;1713  23            3436   3449 
    LD  E,(HL)                          ;1714  5e            3437   3450 
    INC HL                              ;1715  23            3438   3451 
    LD  D,(HL)                          ;1716  56            3439   3452 
    POP HL                              ;1717  e1            3440   3453 
    LD  (HL),A                          ;1718  77            3441   3454 
    INC HL                              ;1719  23            3442   3455 
    LD  (HL),E                          ;171a  73            3443   3456 
    INC HL                              ;171b  23            3444   3457 
    LD  (HL),D                          ;171c  72            3445   3458 
    DEC HL                              ;171d  2b            3446   3459 
    DEC HL                              ;171e  2b            3447   3460 
    RET                                 ;171f  c9            3448   3461 
                                        ;                    3449   3462 ;
STMNTS: CP  0FFh                        ;1720  fe ff         3450   3463 
    JR  Z,FUNCTN1                       ;1722  28 1b         3451   3464 
    CP  0D0h                            ;1724  fe d0         3452   3465 
    JP  NC,SERROR                       ;1726  d2 3a 17      3453   3466 
    PUSH    HL                          ;1729  e5            3454   3467 
    LD  HL,SJPTBL                       ;172a  21 68 2f      3455   3468 
    CALL    GETJPA                      ;172d  cd 9f 28      3456   3469 
    EX  (SP),HL                         ;1730  e3            3457   3470 
    RET                                 ;1731  c9            3458   3471 
                                        ;                    3459   3472 ;
TYPEMS: LD  A,13                        ;1732  3e 0d         3460   3473 
    JR  ERJUMP                          ;1734  18 06         3461   3474 
                                        ;                    3462   3475 ;
IFCALL: LD  A,5                         ;1736  3e 05         3463   3476 
    JR  ERJUMP                          ;1738  18 02         3464   3477 
                                        ;                    3465   3478 ;
SERROR: LD  A,2                         ;173a  3e 02         3466   3479 
ERJUMP: JP  ERROR                       ;173c  c3 96 21      3467   3480 
                                        ;                    3468   3481 ;
FUNCTN1: LD A,(HL)                      ;173f  7e            3469   3482 
    CP  0B4h                            ;1740  fe b4         3470   3483 
    JP  Z,MIDDAI                        ;1742  ca 7e 17      3471   3484 
                                        ;                    3472   3485 ;
                                        ;                    3473   3486 ;	TIME$="00:00:00"
                                        ;                    3474   3487 ;
MEMDAI: CP  0B8h                        ;1745  fe b8         3475   3488 
MEMDSE: JP  NZ,SERROR                   ;1747  c2 3a 17      3476   3489 
    LD  C,L                             ;174a  4d            3477   3490 
    LD  B,H                             ;174b  44            3478   3491 
    INC BC                              ;174c  03            3479   3492 
    CALL    CH28H                       ;174d  cd 58 2d      3480   3493 
    CALL    IHLEXP                      ;1750  cd cc 22      3481   3494 
    PUSH    HL                          ;1753  e5            3482   3495 
    CALL    CH2CH                       ;1754  cd 61 2d      3483   3496 
    CALL    IHLEXP                      ;1757  cd cc 22      3484   3497 
    CALL    CH29H                       ;175a  cd 66 2d      3485   3498 
    CALL    HCHECK                      ;175d  cd d8 22      3486   3499 
    PUSH    AF                          ;1760  f5            3487   3500 
    CALL    BCFTCH                      ;1761  cd c4 25      3488   3501 
    CP  0F5h                            ;1764  fe f5         3489   3502 
    JR  NZ,MEMDSE                       ;1766  20 df         3490   3503 
    CALL    STREXX                      ;1768  cd 9d 45      3491   3504 
    DEC BC                              ;176b  0b            3492   3505 
    POP HL                              ;176c  e1            3493   3506 
    CP  H                               ;176d  bc            3494   3507 
    JR  C,SKMDAI                        ;176e  38 01         3495   3508 
    LD  A,H                             ;1770  7c            3496   3509 
SKMDAI: POP HL                          ;1771  e1            3497   3510 
    PUSH    BC                          ;1772  c5            3498   3511 
    OR  A                               ;1773  b7            3499   3512 
    JR  Z,NOMDAI                        ;1774  28 06         3500   3513 
    LD  C,A                             ;1776  4f            3501   3514 
    LD  B,0                             ;1777  06 00         3502   3515 
    EX  DE,HL                           ;1779  eb            3503   3516 
    LDIR                                ;177a  ed b0         3504   3517 
NOMDAI: POP HL                          ;177c  e1            3505   3518 
    RET                                 ;177d  c9            3506   3519 
                                        ;                    3507   3520 ;
MIDDAI: INC HL                          ;177e  23            3508   3521 
    LD  C,L                             ;177f  4d            3509   3522 
    LD  B,H                             ;1780  44            3510   3523 
    CALL    CH28H                       ;1781  cd 58 2d      3511   3524 
    LD  DE,(INTFAC)                     ;1784  ed 5b 4b 7a   3512   3525 
    CALL    GETVAB                      ;1788  cd d7 1e      3513   3526 
    CP  003h                            ;178b  fe 03         3514   3527 
    JP  NZ,TYPEMS                       ;178d  c2 32 17      3515   3528 
    PUSH    HL                          ;1790  e5            3516   3529 
    CALL    BCFTCH                      ;1791  cd c4 25      3517   3530 
    CALL    CH2CH                       ;1794  cd 61 2d      3518   3531 
    CALL    IHLEXP                      ;1797  cd cc 22      3519   3532 
    PUSH    AF                          ;179a  f5            3520   3533 
    CALL    HCHECK                      ;179b  cd d8 22      3521   3534 
    LD  D,A                             ;179e  57            3522   3535 
    LD  E,0FFh                          ;179f  1e ff         3523   3536 
    POP AF                              ;17a1  f1            3524   3537 
    CP  029h                            ;17a2  fe 29         3525   3538 
    JR  Z,MIDRAL                        ;17a4  28 0f         3526   3539 
    CALL    CH2CH                       ;17a6  cd 61 2d      3527   3540 
    PUSH    DE                          ;17a9  d5            3528   3541 
    CALL    IHLEXP                      ;17aa  cd cc 22      3529   3542 
    CALL    CH29H                       ;17ad  cd 66 2d      3530   3543 
    CALL    HCHECK                      ;17b0  cd d8 22      3531   3544 
    POP DE                              ;17b3  d1            3532   3545 
    LD  E,A                             ;17b4  5f            3533   3546 
MIDRAL: PUSH    DE                      ;17b5  d5            3534   3547 
    CALL    BCFTCH                      ;17b6  cd c4 25      3535   3548 
    CP  0F5h                            ;17b9  fe f5         3536   3549 
    JP  NZ,SERROR                       ;17bb  c2 3a 17      3537   3550 
    CALL    STREXX                      ;17be  cd 9d 45      3538   3551 
    EXX                                 ;17c1  d9            3539   3552 ; HL BC
    POP DE                              ;17c2  d1            3540   3553 ; D TO E
    POP HL                              ;17c3  e1            3541   3554 ; VAR DARD
    LD  A,(HL)                          ;17c4  7e            3542   3555 
    OR  A                               ;17c5  b7            3543   3556 
    LD  B,A                             ;17c6  47            3544   3557 
    LD  C,A                             ;17c7  4f            3545   3558 
    PUSH    HL                          ;17c8  e5            3546   3559 ; VAR ADRS
    JR  Z,NOEFT1                        ;17c9  28 56         3547   3560 
    PUSH    DE                          ;17cb  d5            3548   3561 ; D TO E
    INC HL                              ;17cc  23            3549   3562 
    CALL    INDRCT                      ;17cd  cd a3 2a      3550   3563 
    LD  DE,KEYBUF                       ;17d0  11 4f 7a      3551   3564 
    PUSH    DE                          ;17d3  d5            3552   3565 ; KEYBUF
MDTLLD: LD  A,(HL)                      ;17d4  7e            3553   3566 
    LD  (DE),A                          ;17d5  12            3554   3567 
    INC DE                              ;17d6  13            3555   3568 
    INC HL                              ;17d7  23            3556   3569 
    DJNZ    MDTLLD                      ;17d8  10 fa         3557   3570 
    POP HL                              ;17da  e1            3558   3571 ; KEYBUF
    POP DE                              ;17db  d1            3559   3572 ; D,E
    LD  A,D                             ;17dc  7a            3560   3573 
    DEC A                               ;17dd  3d            3561   3574 
    CP  C                               ;17de  b9            3562   3575 
    JR  NC,NOEFT1                       ;17df  30 40         3563   3576 
    ADD A,L                             ;17e1  85            3564   3577 
    LD  L,A                             ;17e2  6f            3565   3578 
    LD  A,000h                          ;17e3  3e 00         3566   3579 
    ADC A,H                             ;17e5  8c            3567   3580 
    LD  H,A                             ;17e6  67            3568   3581 ; HL <- REPLACE ADRS
    LD  A,C                             ;17e7  79            3569   3582 
    SUB D                               ;17e8  92            3570   3583 
    INC A                               ;17e9  3c            3571   3584 ; REPLACE LEN
    CP  E                               ;17ea  bb            3572   3585 
    JR  C,RPSTSW                        ;17eb  38 01         3573   3586 
    LD  A,E                             ;17ed  7b            3574   3587 
RPSTSW: LD  B,A                         ;17ee  47            3575   3588 
    PUSH    HL                          ;17ef  e5            3576   3589 
    PUSH    BC                          ;17f0  c5            3577   3590 
    EXX                                 ;17f1  d9            3578   3591 
    POP AF                              ;17f2  f1            3579   3592 ; B <- RP LEN
    POP DE                              ;17f3  d1            3580   3593 ; REPLACE ADRS
    PUSH    BC                          ;17f4  c5            3581   3594 ; TEXTPOINTER
    PUSH    AF                          ;17f5  f5            3582   3595 
    POP BC                              ;17f6  c1            3583   3596 ; B <- RP LEN
    LD  A,(HL)                          ;17f7  7e            3584   3597 
    CP  B                               ;17f8  b8            3585   3598 
    JR  NC,SKIOMR                       ;17f9  30 01         3586   3599 
    LD  B,A                             ;17fb  47            3587   3600 
SKIOMR: LD  A,B                         ;17fc  78            3588   3601 
    OR  A                               ;17fd  b7            3589   3602 
    JR  Z,NOEFT2                        ;17fe  28 1c         3590   3603 
    INC HL                              ;1800  23            3591   3604 
    CALL    INDRCT                      ;1801  cd a3 2a      3592   3605 
LSTRPL: LD  A,(HL)                      ;1804  7e            3593   3606 
    LD  (DE),A                          ;1805  12            3594   3607 
    INC HL                              ;1806  23            3595   3608 
    INC DE                              ;1807  13            3596   3609 
    DJNZ    LSTRPL                      ;1808  10 fa         3597   3610 
    LD  B,C                             ;180a  41            3598   3611 
    LD  DE,00008h                       ;180b  11 08 00      3599   3612 
    LD  HL,(INTFAC)                     ;180e  2a 4b 7a      3600   3613 
    ADD HL,DE                           ;1811  19            3601   3614 
    LD  DE,KEYBUF                       ;1812  11 4f 7a      3602   3615 
    CALL    ENTSTR                      ;1815  cd 1a 2b      3603   3616 
    POP BC                              ;1818  c1            3604   3617 
    JP  STRMDM                          ;1819  c3 52 15      3605   3618 
                                        ;                    3606   3619 ;
NOEFT2: POP BC                          ;181c  c1            3607   3620 
RETNOE: POP HL                          ;181d  e1            3608   3621 
    JP  RETIRQ                          ;181e  c3 39 1b      3609   3622 
                                        ;                    3610   3623 ;
NOEFT1: EXX                             ;1821  d9            3611   3624 
    JR  RETNOE                          ;1822  18 f9         3612   3625 
                                        ;                    3613   3626 ;
DFLTCL: PUSH    BC                      ;1824  c5            3614   3627 
    LD  A,004h                          ;1825  3e 04         3615   3628 
    LD  B,26                            ;1827  06 1a         3616   3629 
    LD  DE,DFTABL                       ;1829  11 88 30      3617   3630 
    CALL    FILL                        ;182c  cd 11 62      3618   3631 
    XOR A                               ;182f  af            3619   3632 
    LD  DE,USRTBL                       ;1830  11 a2 30      3620   3633 
    LD  B,20                            ;1833  06 14         3621   3634 
    CALL    FILL                        ;1835  cd 11 62      3622   3635 
    POP BC                              ;1838  c1            3623   3636 
    RET                                 ;1839  c9            3624   3637 
                                        ;                    3625   3638 ;
REM:    POP HL                          ;183a  e1            3626   3639 
    JP  NXLINE                          ;183b  c3 11 16      3627   3640 
                                        ;                    3628   3641 ;
FILEER: LD  A,31                        ;183e  3e 1f         3629   3642 
    JP  ERROR                           ;1840  c3 96 21      3630   3643 
                                        ;                    3631   3644 ;
PRTSTR: PUSH    BC                      ;1843  c5            3632   3645 
    CALL    CONDMZ                      ;1844  cd f6 6b      3633   3646 
    CALL    CVDSAD                      ;1847  cd 0e 17      3634   3647 
    LD  B,A                             ;184a  47            3635   3648 
    CALL    PRTSDC                      ;184b  cd e1 07      3636   3649 
    JP  SKIPP                           ;184e  c3 d6 18      3637   3650 
                                        ;                    3638   3651 ;
RGPRMT: PUSH    AF                      ;1851  f5            3639   3652 
    JP  RGPRM'                          ;1852  c3 ca 18      3640   3653 
                                        ;                    3641   3654 ;
PRINT:  LD  A,1                         ;1855  3e 01         3642   3655 
    LD  (DISFLG),A                      ;1857  32 eb 11      3643   3656 
    LD  C,L                             ;185a  4d            3644   3657 
    LD  B,H                             ;185b  44            3645   3658 
    CALL    BCFTCH                      ;185c  cd c4 25      3646   3659 
    CP  023h                            ;185f  fe 23         3647   3660 
    JR  NZ,PRINT'                       ;1861  20 2e         3648   3661 
    CALL    IHLEXP                      ;1863  cd cc 22      3649   3662 
    DEC BC                              ;1866  0b            3650   3663 
    OR  A                               ;1867  b7            3651   3664 
    JR  Z,PRDVSW                        ;1868  28 0a         3652   3665 
    CP  03Ah                            ;186a  fe 3a         3653   3666 
    JR  Z,PRDVSW                        ;186c  28 06         3654   3667 
    CP  02Ch                            ;186e  fe 2c         3655   3668 
    JP  NZ,SERROR                       ;1870  c2 3a 17      3656   3669 
    INC BC                              ;1873  03            3657   3670 
PRDVSW: LD  A,H                         ;1874  7c            3658   3671 
    OR  L                               ;1875  b5            3659   3672 
    JR  Z,PRSCRV                        ;1876  28 1b         3660   3673 
    INC HL                              ;1878  23            3661   3674 
    LD  A,H                             ;1879  7c            3662   3675 
    OR  L                               ;187a  b5            3663   3676 
    JR  NZ,PRTERM                       ;187b  20 0d         3664   3677 
    LD  A,(FILEFG)                      ;187d  3a 83 33      3665   3678 
    CP  2                               ;1880  fe 02         3666   3679 
    JR  NZ,FILEER                       ;1882  20 ba         3667   3680 
    INC A                               ;1884  3c            3668   3681 
    LD  (DISFLG),A                      ;1885  32 eb 11      3669   3682 
    JR  PRSCRV                          ;1888  18 09         3670   3683 
PRTERM: LD  A,2                         ;188a  3e 02         3671   3684 ; PRINTER
    LD  (DISFLG),A                      ;188c  32 eb 11      3672   3685 
    JR  PRSCRV                          ;188f  18 02         3673   3686 
                                        ;                    3674   3687 ;
                                        ;                    3675   3688 ;
PRINT': LD  C,L                         ;1891  4d            3676   3689 
    LD  B,H                             ;1892  44            3677   3690 
PRSCRV: CALL    SETSSP                  ;1893  cd f9 21      3678   3691 
    LD  (IY+0),0                        ;1896  fd 36 00 00   3679   3692 
    CALL    BCFTCH                      ;189a  cd c4 25      3680   3693 
    CP  0E2h                            ;189d  fe e2         3681   3694 
    JP  Z,USING                         ;189f  ca 10 34      3682   3695 
    OR  A                               ;18a2  b7            3683   3696 
    JR  Z,CRLFR'                        ;18a3  28 55         3684   3697 
    CP  03Ah                            ;18a5  fe 3a         3685   3698 
    JR  Z,CRLFR'                        ;18a7  28 51         3686   3699 
    CP  02Ch                            ;18a9  fe 2c         3687   3700 
    JP  Z,RGPRMT                        ;18ab  ca 51 18      3688   3701 
    CP  03Bh                            ;18ae  fe 3b         3689   3702 
    JP  Z,RGPRMT                        ;18b0  ca 51 18      3690   3703 
    CP  0E7h                            ;18b3  fe e7         3691   3704 
    JR  Z,TABOPR                        ;18b5  28 5b         3692   3705 
    CP  0E8h                            ;18b7  fe e8         3693   3706 
    JP  Z,SPCOPR                        ;18b9  ca 40 19      3694   3707 
    DEC BC                              ;18bc  0b            3695   3708 
    CALL    EXPRSN                      ;18bd  cd f2 22      3696   3709 
    PUSH    AF                          ;18c0  f5            3697   3710 
    LD  A,(IY+0)                        ;18c1  fd 7e 00      3698   3711 
    CP  003h                            ;18c4  fe 03         3699   3712 
    JP  Z,PRTSTR                        ;18c6  ca 43 18      3700   3713 
    OR  A                               ;18c9  b7            3701   3714 
RGPRM': PUSH    BC                      ;18ca  c5            3702   3715 
    JR  Z,SKIPP                         ;18cb  28 09         3703   3716 
    CALL    CVNMFL                      ;18cd  cd 58 5d      3704   3717 
    CALL    PRTSDC                      ;18d0  cd e1 07      3705   3718 
    CALL    SPPRT                       ;18d3  cd 62 08      3706   3719 
SKIPP:  POP HL                          ;18d6  e1            3707   3720 
    POP AF                              ;18d7  f1            3708   3721 
PRTYUI: OR  A                           ;18d8  b7            3709   3722 
    JR  Z,CRLFRT                        ;18d9  28 21         3710   3723 
    CP  03Ah                            ;18db  fe 3a         3711   3724 
    JR  Z,CRLFRT                        ;18dd  28 1d         3712   3725 
    CP  03Bh                            ;18df  fe 3b         3713   3726 
    JR  Z,SEMIS                         ;18e1  28 07         3714   3727 
    CP  02Ch                            ;18e3  fe 2c         3715   3728 
    JR  NZ,DECBCL                       ;18e5  20 1b         3716   3729 
    CALL    TABPRT                      ;18e7  cd 02 08      3717   3730 
SEMIS:  CALL    HLFTCH                  ;18ea  cd 87 29      3718   3731 
    OR  A                               ;18ed  b7            3719   3732 
    JR  Z,DISCLR                        ;18ee  28 04         3720   3733 
    CP  03Ah                            ;18f0  fe 3a         3721   3734 
    JR  NZ,PRINT'                       ;18f2  20 9d         3722   3735 
DISCLR: LD  A,1                         ;18f4  3e 01         3723   3736 
    LD  (DISFLG),A                      ;18f6  32 eb 11      3724   3737 
    RET                                 ;18f9  c9            3725   3738 
                                        ;                    3726   3739 ;
CRLFR': LD  H,B                         ;18fa  60            3727   3740 
    LD  L,C                             ;18fb  69            3728   3741 
CRLFRT: CALL    CR1                     ;18fc  cd 43 08      3729   3742 
    DEC HL                              ;18ff  2b            3730   3743 
    JR  DISCLR                          ;1900  18 f2         3731   3744 
DECBCL: DEC HL                          ;1902  2b            3732   3745 
    CP  022h                            ;1903  fe 22         3733   3746 
    JR  Z,PRINT'                        ;1905  28 8a         3734   3747 
    CP  041h                            ;1907  fe 41         3735   3748 
    JR  NC,PRINT'                       ;1909  30 86         3736   3749 
    CP  021h                            ;190b  fe 21         3737   3750 
    JR  C,PRINT'                        ;190d  38 82         3738   3751 
    JP  SERROR                          ;190f  c3 3a 17      3739   3752 
                                        ;                    3740   3753 ;
TABOPR: CALL    CH28H                   ;1912  cd 58 2d      3741   3754 
    CALL    IHLEXP                      ;1915  cd cc 22      3742   3755 
    CALL    CH29H                       ;1918  cd 66 2d      3743   3756 
    CALL    HCHECK                      ;191b  cd d8 22      3744   3757 
    LD  A,(DISFLG)                      ;191e  3a eb 11      3745   3758 
    CP  2                               ;1921  fe 02         3746   3759 
    JR  C,CRTTAS                        ;1923  38 05         3747   3760 
    LD  A,(PRINTN)                      ;1925  3a ec 11      3748   3761 
    JR  TSUBLS                          ;1928  18 03         3749   3762 
CRTTAS: LD  A,(CURX)                    ;192a  3a ed 11      3750   3763 
TSUBLS: SUB L                           ;192d  95            3751   3764 
    JR  NC,NOTABO                       ;192e  30 09         3752   3765 
    NEG                                 ;1930  ed 44         3753   3766 
TABPPP: LD  D,A                         ;1932  57            3754   3767 
TABPPT: CALL    SPPRT                   ;1933  cd 62 08      3755   3768 
    DEC D                               ;1936  15            3756   3769 
    JR  NZ,TABPPT                       ;1937  20 fa         3757   3770 
NOTABO: CALL    BCFTCH                  ;1939  cd c4 25      3758   3771 
    LD  L,C                             ;193c  69            3759   3772 
    LD  H,B                             ;193d  60            3760   3773 
    JR  PRTYUI                          ;193e  18 98         3761   3774 
                                        ;                    3762   3775 ;
SPCOPR: CALL    CH28H                   ;1940  cd 58 2d      3763   3776 
    CALL    IHLEXP                      ;1943  cd cc 22      3764   3777 
    CALL    CH29H                       ;1946  cd 66 2d      3765   3778 
    CALL    HCHECK                      ;1949  cd d8 22      3766   3779 
    OR  A                               ;194c  b7            3767   3780 
    JR  Z,NOTABO                        ;194d  28 ea         3768   3781 
    JR  TABPPP                          ;194f  18 e1         3769   3782 
                                        ;                    3770   3783 ;
CLR:    PUSH    HL                      ;1951  e5            3771   3784 
    PUSH    DE                          ;1952  d5            3772   3785 
    LD  HL,(VSTART)                     ;1953  2a 3b 7a      3773   3786 
    XOR A                               ;1956  af            3774   3787 
    LD  (HL),A                          ;1957  77            3775   3788 
    LD  (STKLMT),HL                     ;1958  22 3f 7a      3776   3789 
    LD  HL,(STRBTM)                     ;195b  2a 45 7a      3777   3790 
    LD  (STRPTR),HL                     ;195e  22 3d 7a      3778   3791 
    LD  DE,2000                         ;1961  11 d0 07      3779   3792 
    SBC HL,DE                           ;1964  ed 52         3780   3793 
    LD  (STRTOP),HL                     ;1966  22 41 7a      3781   3794 
    CALL    DFLTCL                      ;1969  cd 24 18      3782   3795 
    POP DE                              ;196c  d1            3783   3796 
    POP HL                              ;196d  e1            3784   3797 
    RET                                 ;196e  c9            3785   3798 
                                        ;                    3786   3799 ;
FOR:    POP BC                          ;196f  c1            3787   3800 
    LD  (FLJPVC),BC                     ;1970  ed 43 f9 19   3788   3801 
    LD  C,L                             ;1974  4d            3789   3802 
    LD  B,H                             ;1975  44            3790   3803 
    LD  DE,(INTFAC)                     ;1976  ed 5b 4b 7a   3791   3804 
    CALL    GETVAB                      ;197a  cd d7 1e      3792   3805 
    LD  (FVTYPE),A                      ;197d  32 f1 19      3793   3806 
    EX  DE,HL                           ;1980  eb            3794   3807 
    LD  HL,0                            ;1981  21 00 00      3795   3808 
    ADD HL,SP                           ;1984  39            3796   3809 
FTSKIP: LD  A,(HL)                      ;1985  7e            3797   3810 
    OR  A                               ;1986  b7            3798   3811 
    JR  NZ,FORPUS                       ;1987  20 24         3799   3812 
    PUSH    DE                          ;1989  d5            3800   3813 
    LD  DE,6                            ;198a  11 06 00      3801   3814 
    ADD HL,DE                           ;198d  19            3802   3815 
    POP DE                              ;198e  d1            3803   3816 
    PUSH    HL                          ;198f  e5            3804   3817 
    CALL    INDRCT                      ;1990  cd a3 2a      3805   3818 
    OR  A                               ;1993  b7            3806   3819 
    SBC HL,DE                           ;1994  ed 52         3807   3820 
    POP HL                              ;1996  e1            3808   3821 
    JR  NZ,NXTSFT                       ;1997  20 0c         3809   3822 
    PUSH    DE                          ;1999  d5            3810   3823 
    LD  DE,18                           ;199a  11 12 00      3811   3824 
    ADD HL,DE                           ;199d  19            3812   3825 
    POP DE                              ;199e  d1            3813   3826 
    LD  (SPBUF),HL                      ;199f  22 25 22      3814   3827 
    LD  SP,HL                           ;19a2  f9            3815   3828 
    JR  FORPUS                          ;19a3  18 08         3816   3829 
                                        ;                    3817   3830 ;
NXTSFT: PUSH    DE                      ;19a5  d5            3818   3831 
    LD  DE,16                           ;19a6  11 10 00      3819   3832 
    ADD HL,DE                           ;19a9  19            3820   3833 
    POP DE                              ;19aa  d1            3821   3834 
    JR  FTSKIP                          ;19ab  18 d8         3822   3835 
                                        ;                    3823   3836 ;
FORPUS: EX  DE,HL                       ;19ad  eb            3824   3837 
    PUSH    HL                          ;19ae  e5            3825   3838 
    LD  A,(FVTYPE)                      ;19af  3a f1 19      3826   3839 
    CALL    DAINV'                      ;19b2  cd 1b 15      3827   3840 
    LD  A,(HL)                          ;19b5  7e            3828   3841 
    CP  0DFh                            ;19b6  fe df         3829   3842 
    JP  NZ,SERROR                       ;19b8  c2 3a 17      3830   3843 
    INC HL                              ;19bb  23            3831   3844 
    LD  C,L                             ;19bc  4d            3832   3845 
    LD  B,H                             ;19bd  44            3833   3846 
    CALL    FLEXPR                      ;19be  cd 99 22      3834   3847 
    POP DE                              ;19c1  d1            3835   3848 
    PUSH    HL                          ;19c2  e5            3836   3849 
    EXX                                 ;19c3  d9            3837   3850 
    POP DE                              ;19c4  d1            3838   3851 
    LD  HL,0FFF8h                       ;19c5  21 f8 ff      3839   3852 
    ADD HL,SP                           ;19c8  39            3840   3853 
    LD  SP,HL                           ;19c9  f9            3841   3854 
    EX  DE,HL                           ;19ca  eb            3842   3855 
    CALL    LDIR8                       ;19cb  cd a6 73      3843   3856 
    EXX                                 ;19ce  d9            3844   3857 
    CP  0E0h                            ;19cf  fe e0         3845   3858 
    LD  HL,FLONE                        ;19d1  21 98 62      3846   3859 
    JR  NZ,STEPON                       ;19d4  20 05         3847   3860 
    PUSH    DE                          ;19d6  d5            3848   3861 
    CALL    FLEXPR                      ;19d7  cd 99 22      3849   3862 
    POP DE                              ;19da  d1            3850   3863 
STEPON: PUSH    HL                      ;19db  e5            3851   3864 
    EXX                                 ;19dc  d9            3852   3865 
    POP DE                              ;19dd  d1            3853   3866 
    LD  HL,0FFF8h                       ;19de  21 f8 ff      3854   3867 
    ADD HL,SP                           ;19e1  39            3855   3868 
    LD  SP,HL                           ;19e2  f9            3856   3869 
    EX  DE,HL                           ;19e3  eb            3857   3870 
    CALL    LDIR8                       ;19e4  cd a6 73      3858   3871 
    EXX                                 ;19e7  d9            3859   3872 
    PUSH    DE                          ;19e8  d5            3860   3873 
    DEC BC                              ;19e9  0b            3861   3874 
    PUSH    BC                          ;19ea  c5            3862   3875 
    LD  HL,(NXTLPT)                     ;19eb  2a 12 16      3863   3876 
    PUSH    HL                          ;19ee  e5            3864   3877 
    DEFB    021H                        ;19ef  21            3865   3878 ;LD HL,?
    DEFB    000H                        ;19f0  00            3866   3879 ;low
FVTYPE: DEFS    1                       ;19f1                3867   3880 ;high
                                        ;                    3868   3881 
    PUSH    HL                          ;19f2  e5            3869   3882 
    LD  L,C                             ;19f3  69            3870   3883 
    LD  H,B                             ;19f4  60            3871   3884 
    CALL    MEMCHK                      ;19f5  cd b0 1e      3872   3885 
    DEFB    0C3H                        ;19f8  c3            3873   3886 ; JP ?
FLJPVC: DEFS    2                       ;19f9                3874   3887 
                                        ;                    3875   3888 ;
NXFVAR: CALL    BCFTCH                  ;19fb  cd c4 25      3876   3889 
    OR  A                               ;19fe  b7            3877   3890 
    JR  Z,NXWFOR                        ;19ff  28 04         3878   3891 
    CP  03Ah                            ;1a01  fe 3a         3879   3892 
    JR  NZ,AGINCV                       ;1a03  20 16         3880   3893 
NXWFOR: LD  A,1                         ;1a05  3e 01         3881   3894 
    JP  ERROR                           ;1a07  c3 96 21      3882   3895 
                                        ;                    3883   3896 ;
NEXT:   CALL    HLFTCH                  ;1a0a  cd 87 29      3884   3897 
    OR  A                               ;1a0d  b7            3885   3898 
    JP  Z,DFLTNX                        ;1a0e  ca 62 1a      3886   3899 
    CP  03Ah                            ;1a11  fe 3a         3887   3900 
    JP  Z,DFLTNX                        ;1a13  ca 62 1a      3888   3901 
NEXTAG: LD  C,L                         ;1a16  4d            3889   3902 
    LD  B,H                             ;1a17  44            3890   3903 
    CALL    BCFTCH                      ;1a18  cd c4 25      3891   3904 
AGINCV: LD  DE,(INTFAC)                 ;1a1b  ed 5b 4b 7a   3892   3905 
    CALL    GETVAR                      ;1a1f  cd da 1e      3893   3906 
    EX  DE,HL                           ;1a22  eb            3894   3907 
    LD  HL,2                            ;1a23  21 02 00      3895   3908 
    ADD HL,SP                           ;1a26  39            3896   3909 
SKSTKS: LD  A,(HL)                      ;1a27  7e            3897   3910 
    OR  A                               ;1a28  b7            3898   3911 
    JR  NZ,NXFVAR                       ;1a29  20 d0         3899   3912 
    PUSH    DE                          ;1a2b  d5            3900   3913 
    LD  DE,6                            ;1a2c  11 06 00      3901   3914 
    ADD HL,DE                           ;1a2f  19            3902   3915 
    POP DE                              ;1a30  d1            3903   3916 
    PUSH    HL                          ;1a31  e5            3904   3917 
    CALL    INDRCT                      ;1a32  cd a3 2a      3905   3918 
    OR  A                               ;1a35  b7            3906   3919 
    SBC HL,DE                           ;1a36  ed 52         3907   3920 
    POP HL                              ;1a38  e1            3908   3921 
    JR  NZ,NXFPOR                       ;1a39  20 1f         3909   3922 
    LD  DE,6                            ;1a3b  11 06 00      3910   3923 
    OR  A                               ;1a3e  b7            3911   3924 
    SBC HL,DE                           ;1a3f  ed 52         3912   3925 
    POP DE                              ;1a41  d1            3913   3926 
    LD  SP,HL                           ;1a42  f9            3914   3927 
    LD  (NXTNXT),DE                     ;1a43  ed 53 4d 1a   3915   3928 
    LD  L,C                             ;1a47  69            3916   3929 
    LD  H,B                             ;1a48  60            3917   3930 
    CALL    DFLTNX                      ;1a49  cd 62 1a      3918   3931 
    DEFB    011H                        ;1a4c  11            3919   3932 ; LD DE,??
NXTNXT: DEFS    2                       ;1a4d                3920   3933 
    PUSH    DE                          ;1a4f  d5            3921   3934 
    RET NC                              ;1a50  d0            3922   3935 
    CALL    HLFTCH                      ;1a51  cd 87 29      3923   3936 
    CP  02Ch                            ;1a54  fe 2c         3924   3937 
    RET NZ                              ;1a56  c0            3925   3938 
    INC HL                              ;1a57  23            3926   3939 
    JR  NEXTAG                          ;1a58  18 bc         3927   3940 
                                        ;                    3928   3941 ;
NXFPOR: PUSH    DE                      ;1a5a  d5            3929   3942 
    LD  DE,012H                         ;1a5b  11 12 00      3930   3943 
    ADD HL,DE                           ;1a5e  19            3931   3944 
    POP DE                              ;1a5f  d1            3932   3945 
    JR  SKSTKS                          ;1a60  18 c5         3933   3946 
                                        ;                    3934   3947 ;
DFLTNX: PUSH    HL                      ;1a62  e5            3935   3948 
    LD  HL,00004h                       ;1a63  21 04 00      3936   3949 
    ADD HL,SP                           ;1a66  39            3937   3950 
    XOR A                               ;1a67  af            3938   3951 
    CP  (HL)                            ;1a68  be            3939   3952 
    JR  NZ,NXWFOR                       ;1a69  20 9a         3940   3953 
    INC HL                              ;1a6b  23            3941   3954 
    LD  A,0F0h                          ;1a6c  3e f0         3942   3955 
    AND (HL)                            ;1a6e  a6            3943   3956 
    JR  NZ,NXWFOR                       ;1a6f  20 94         3944   3957 
    LD  A,(HL)                          ;1a71  7e            3945   3958 
    INC HL                              ;1a72  23            3946   3959 
    LD  E,(HL)                          ;1a73  5e            3947   3960 
    INC HL                              ;1a74  23            3948   3961 
    LD  D,(HL)                          ;1a75  56            3949   3962 
    PUSH    DE                          ;1a76  d5            3950   3963 
    INC HL                              ;1a77  23            3951   3964 
    LD  E,(HL)                          ;1a78  5e            3952   3965 
    INC HL                              ;1a79  23            3953   3966 
    LD  D,(HL)                          ;1a7a  56            3954   3967 
    PUSH    DE                          ;1a7b  d5            3955   3968 
    INC HL                              ;1a7c  23            3956   3969 
    LD  E,(HL)                          ;1a7d  5e            3957   3970 
    INC HL                              ;1a7e  23            3958   3971 
    LD  D,(HL)                          ;1a7f  56            3959   3972 
    INC HL                              ;1a80  23            3960   3973 
    EX  DE,HL                           ;1a81  eb            3961   3974 
    CP  002h                            ;1a82  fe 02         3962   3975 
    JP  Z,INTFOR                        ;1a84  ca c1 1a      3963   3976 
    LD  (IY+0),A                        ;1a87  fd 77 00      3964   3977 
    CALL    ADD                         ;1a8a  cd a6 6c      3965   3978 
    INC DE                              ;1a8d  13            3966   3979 
    LD  A,(DE)                          ;1a8e  1a            3967   3980 
    DEC DE                              ;1a8f  1b            3968   3981 
    EX  AF,AF'                          ;1a90  08            3969   3982 
    PUSH    HL                          ;1a91  e5            3970   3983 
    LD  HL,00008h                       ;1a92  21 08 00      3971   3984 
    ADD HL,DE                           ;1a95  19            3972   3985 
    EX  DE,HL                           ;1a96  eb            3973   3986 
    POP HL                              ;1a97  e1            3974   3987 
    EX  AF,AF'                          ;1a98  08            3975   3988 
    RLCA                                ;1a99  07            3976   3989 
    JR  NC,FPCOMP                       ;1a9a  30 07         3977   3990 
    CALL    CMP                         ;1a9c  cd d6 61      3978   3991 
    JR  C,NEXTRT                        ;1a9f  38 12         3979   3992 
    JR  OMODED                          ;1aa1  18 07         3980   3993 
FPCOMP: CALL    CMP                     ;1aa3  cd d6 61      3981   3994 
    JR  Z,OMODED                        ;1aa6  28 02         3982   3995 
    JR  NC,NEXTRT                       ;1aa8  30 09         3983   3996 
OMODED: POP DE                          ;1aaa  d1            3984   3997 
    POP HL                              ;1aab  e1            3985   3998 
    LD  (NXTLPT),HL                     ;1aac  22 12 16      3986   3999 
    EX  DE,HL                           ;1aaf  eb            3987   4000 
    POP BC                              ;1ab0  c1            3988   4001 
    OR  A                               ;1ab1  b7            3989   4002 
    RET                                 ;1ab2  c9            3990   4003 
                                        ;                    3991   4004 ;
NEXTRT: LD  HL,00008h                   ;1ab3  21 08 00      3992   4005 
    ADD HL,DE                           ;1ab6  19            3993   4006 
    POP BC                              ;1ab7  c1            3994   4007 
    POP BC                              ;1ab8  c1            3995   4008 
    POP DE                              ;1ab9  d1            3996   4009 
    POP IX                              ;1aba  dd e1         3997   4010 
    LD  SP,HL                           ;1abc  f9            3998   4011 
    EX  DE,HL                           ;1abd  eb            3999   4012 
    SCF                                 ;1abe  37            4000   4013 
    JP  (IX)                            ;1abf  dd e9         4001   4014 
                                        ;                    4002   4015 ;
INTFOR: PUSH    DE                      ;1ac1  d5            4003   4016 ; STEP
    PUSH    HL                          ;1ac2  e5            4004   4017 ; VARADRS
    EX  DE,HL                           ;1ac3  eb            4005   4018 
    CALL    HLFLTO                      ;1ac4  cd 97 2d      4006   4019 ; STEP
    LD  A,H                             ;1ac7  7c            4007   4020 
    EX  AF,AF'                          ;1ac8  08            4008   4021 
    EX  DE,HL                           ;1ac9  eb            4009   4022 
    POP HL                              ;1aca  e1            4010   4023 
    PUSH    HL                          ;1acb  e5            4011   4024 
    CALL    INDRCT                      ;1acc  cd a3 2a      4012   4025 
    ADD HL,DE                           ;1acf  19            4013   4026 
    EX  DE,HL                           ;1ad0  eb            4014   4027 
    POP HL                              ;1ad1  e1            4015   4028 
    LD  (HL),E                          ;1ad2  73            4016   4029 
    INC HL                              ;1ad3  23            4017   4030 
    LD  (HL),D                          ;1ad4  72            4018   4031 
    POP HL                              ;1ad5  e1            4019   4032 
    LD  BC,00008h                       ;1ad6  01 08 00      4020   4033 
    ADD HL,BC                           ;1ad9  09            4021   4034 
    PUSH    HL                          ;1ada  e5            4022   4035 
    CALL    HLFLTO                      ;1adb  cd 97 2d      4023   4036 
    EX  AF,AF'                          ;1ade  08            4024   4037 
    RLCA                                ;1adf  07            4025   4038 
    JR  NC,MNIFOR                       ;1ae0  30 0a         4026   4039 
    CALL    INTCMP                      ;1ae2  cd f4 1a      4027   4040 
    POP DE                              ;1ae5  d1            4028   4041 
    JR  Z,OMODED                        ;1ae6  28 c2         4029   4042 
    JR  C,OMODED                        ;1ae8  38 c0         4030   4043 
    JR  NEXTRT                          ;1aea  18 c7         4031   4044 
                                        ;                    4032   4045 ;
MNIFOR: CALL    INTCMP                  ;1aec  cd f4 1a      4033   4046 
    POP DE                              ;1aef  d1            4034   4047 
    JR  NC,OMODED                       ;1af0  30 b8         4035   4048 
    JR  NEXTRT                          ;1af2  18 bf         4036   4049 
                                        ;                    4037   4050 ;
INTCMP: LD  A,H                         ;1af4  7c            4038   4051 
    RLCA                                ;1af5  07            4039   4052 
    JR  C,ICHMNS                        ;1af6  38 0c         4040   4053 
    LD  A,D                             ;1af8  7a            4041   4054 
    RLCA                                ;1af9  07            4042   4055 
    CCF                                 ;1afa  3f            4043   4056 
    JR  NC,NCICMT                       ;1afb  30 13         4044   4057 
INTCPM: OR  A                           ;1afd  b7            4045   4058 
    SBC HL,DE                           ;1afe  ed 52         4046   4059 
    RET C                               ;1b00  d8            4047   4060 
    LD  A,H                             ;1b01  7c            4048   4061 
    OR  L                               ;1b02  b5            4049   4062 
    RET                                 ;1b03  c9            4050   4063 
                                        ;                    4051   4064 ;
ICHMNS: LD  A,D                         ;1b04  7a            4052   4065 
    RLCA                                ;1b05  07            4053   4066 
    CCF                                 ;1b06  3f            4054   4067 
    JR  C,CPRTMY                        ;1b07  38 02         4055   4068 
    JR  INTCPM                          ;1b09  18 f2         4056   4069 
                                        ;                    4057   4070 ;
CPRTMY: LD  A,1                         ;1b0b  3e 01         4058   4071 
    OR  A                               ;1b0d  b7            4059   4072 
    SCF                                 ;1b0e  37            4060   4073 
    RET                                 ;1b0f  c9            4061   4074 
                                        ;                    4062   4075 ;
NCICMT: LD  A,1                         ;1b10  3e 01         4063   4076 
    OR  A                               ;1b12  b7            4064   4077 
    RET                                 ;1b13  c9            4065   4078 
                                        ;                    4066   4079 ;
ERTEST: LD  C,L                         ;1b14  4d            4067   4080 
    LD  B,H                             ;1b15  44            4068   4081 
    CALL    IBYTE                       ;1b16  cd df 22      4069   4082 
ERRTST: JP  ERROR                       ;1b19  c3 96 21      4070   4083 
                                        ;                    4071   4084 ;
LET:    CALL    HLFTCH                  ;1b1c  cd 87 29      4072   4085 
    INC HL                              ;1b1f  23            4073   4086 
    JP  LETDA'                          ;1b20  c3 ff 14      4074   4087 
                                        ;                    4075   4088 ;
POKE:   LD  C,L                         ;1b23  4d            4076   4089 
    LD  B,H                             ;1b24  44            4077   4090 
    CALL    IHLEXP                      ;1b25  cd cc 22      4078   4091 
POKELP: CP  02Ch                        ;1b28  fe 2c         4079   4092 
    JR  NZ,RETIRQ                       ;1b2a  20 0d         4080   4093 
    PUSH    HL                          ;1b2c  e5            4081   4094 
    CALL    IBYTE                       ;1b2d  cd df 22      4082   4095 
    POP HL                              ;1b30  e1            4083   4096 
    LD  (HL),A                          ;1b31  77            4084   4097 
    INC HL                              ;1b32  23            4085   4098 
    DEC BC                              ;1b33  0b            4086   4099 
    CALL    BCFTCH                      ;1b34  cd c4 25      4087   4100 
    JR  POKELP                          ;1b37  18 ef         4088   4101 
                                        ;                    4089   4102 ;
RETIRQ: LD  L,C                         ;1b39  69            4090   4103 
    LD  H,B                             ;1b3a  60            4091   4104 
    DEC HL                              ;1b3b  2b            4092   4105 
    LD  A,1                             ;1b3c  3e 01         4093   4106 
    LD  (DISFLG),A                      ;1b3e  32 eb 11      4094   4107 
    RET                                 ;1b41  c9            4095   4108 
                                        ;                    4096   4109 ;
CLS:    LD  A,(GMODEF)                  ;1b42  3a 06 1c      4097   4110 
    CP  2                               ;1b45  fe 02         4098   4111 
    LD  A,12                            ;1b47  3e 0c         4099   4112 
    JP  C,ACCPRT                        ;1b49  da 64 08      4100   4113 
CLSSB:                                  ;                    4101   4114 
    LD  BC,01800h                       ;1b4c  01 00 18      4102   4115 
    LD  D,000h                          ;1b4f  16 00         4103   4116 
CLS1LP: DEC BC                          ;1b51  0b            4104   4117 
    OUT (C),D                           ;1b52  ed 51         4105   4118 
    LD  A,B                             ;1b54  78            4106   4119 
    OR  C                               ;1b55  b1            4107   4120 
    JR  NZ,CLS1LP                       ;1b56  20 f9         4108   4121 
    RET                                 ;1b58  c9            4109   4122 
                                        ;                    4110   4123 ;
                                        ;                    4111   4124 ;
SCREEN: LD  C,L                         ;1b59  4d            4112   4125 
    LD  B,H                             ;1b5a  44            4113   4126 
    CALL    IHLEXP                      ;1b5b  cd cc 22      4114   4127 
    CALL    CH2CH                       ;1b5e  cd 61 2d      4115   4128 
    CALL    HCHECK                      ;1b61  cd d8 22      4116   4129 
    CP  5                               ;1b64  fe 05         4117   4130 
    JP  NC,IFCALL                       ;1b66  d2 36 17      4118   4131 
    PUSH    AF                          ;1b69  f5            4119   4132 
    CALL    IHLEXP                      ;1b6a  cd cc 22      4120   4133 
    CALL    CH2CH                       ;1b6d  cd 61 2d      4121   4134 
    CALL    HCHECK                      ;1b70  cd d8 22      4122   4135 
    CP  5                               ;1b73  fe 05         4123   4136 
    JP  NC,IFCALL                       ;1b75  d2 36 17      4124   4137 
    PUSH    AF                          ;1b78  f5            4125   4138 
    CALL    IBYTE                       ;1b79  cd df 22      4126   4139 
    CP  6                               ;1b7c  fe 06         4127   4140 
    JP  NC,IFCALL                       ;1b7e  d2 36 17      4128   4141 
    POP DE                              ;1b81  d1            4129   4142 
    LD  E,D                             ;1b82  5a            4130   4143 
    LD  L,A                             ;1b83  6f            4131   4144 
    POP AF                              ;1b84  f1            4132   4145 
    LD  D,A                             ;1b85  57            4133   4146 
    PUSH    BC                          ;1b86  c5            4134   4147 
    PUSH    DE                          ;1b87  d5            4135   4148 
    CALL    GRAPH                       ;1b88  cd 95 1b      4136   4149 
    POP BC                              ;1b8b  c1            4137   4150 
    CALL    SCRNBC                      ;1b8c  cd d6 05      4138   4151 
    POP BC                              ;1b8f  c1            4139   4152 
    JP  RETIRQ                          ;1b90  c3 39 1b      4140   4153 
                                        ;                    4141   4154 ;
GRAPHI: LD  L,0                         ;1b93  2e 00         4142   4155 
GRAPH:  LD  A,(GMODEF)                  ;1b95  3a 06 1c      4143   4156 
    CP  L                               ;1b98  bd            4144   4157 
    JR  Z,GRAPOK                        ;1b99  28 1d         4145   4158 
    CP  2                               ;1b9b  fe 02         4146   4159 
    JR  NC,GM2345                       ;1b9d  30 0c         4147   4160 
    LD  A,L                             ;1b9f  7d            4148   4161 
    CP  2                               ;1ba0  fe 02         4149   4162 
    JR  C,GRAPOK                        ;1ba2  38 14         4150   4163 
    PUSH    AF                          ;1ba4  f5            4151   4164 
    CALL    CLSSB                       ;1ba5  cd 4c 1b      4152   4165 
    POP AF                              ;1ba8  f1            4153   4166 
    JR  GRAPOK                          ;1ba9  18 0d         4154   4167 
GM2345: LD  A,L                         ;1bab  7d            4155   4168 
    CP  2                               ;1bac  fe 02         4156   4169 
    JR  NC,GRAPOK                       ;1bae  30 08         4157   4170 
    PUSH    AF                          ;1bb0  f5            4158   4171 
    CALL    CLSSB                       ;1bb1  cd 4c 1b      4159   4172 
    CALL    GSAVES                      ;1bb4  cd ea 1b      4160   4173 
    POP AF                              ;1bb7  f1            4161   4174 
GRAPOK: LD  (GMODEF),A                  ;1bb8  32 06 1c      4162   4175 
    LD  L,A                             ;1bbb  6f            4163   4176 
    LD  E,A                             ;1bbc  5f            4164   4177 
    LD  H,0                             ;1bbd  26 00         4165   4178 
    LD  D,H                             ;1bbf  54            4166   4179 
    ADD HL,HL                           ;1bc0  29            4167   4180 
    ADD HL,HL                           ;1bc1  29            4168   4181 
    ADD HL,DE                           ;1bc2  19            4169   4182 
    LD  DE,SCRTAB                       ;1bc3  11 07 1c      4170   4183 
    ADD HL,DE                           ;1bc6  19            4171   4184 
    LD  A,(HL)                          ;1bc7  7e            4172   4185 
    LD  (SCRNYE+1),A                    ;1bc8  32 25 48      4173   4186 
    INC HL                              ;1bcb  23            4174   4187 
    LD  A,(HL)                          ;1bcc  7e            4175   4188 
    LD  (SCRNXE+1),A                    ;1bcd  32 2d 48      4176   4189 
    LD  A,0FFh                          ;1bd0  3e ff         4177   4190 
    LD  (SCRNYE+2),A                    ;1bd2  32 26 48      4178   4191 
    LD  (SCRNXE+2),A                    ;1bd5  32 2e 48      4179   4192 
    INC HL                              ;1bd8  23            4180   4193 
    LD  E,(HL)                          ;1bd9  5e            4181   4194 
    INC HL                              ;1bda  23            4182   4195 
    LD  D,(HL)                          ;1bdb  56            4183   4196 
    LD  (CALADR+1),DE                   ;1bdc  ed 53 34 48   4184   4197 
    INC HL                              ;1be0  23            4185   4198 
    LD  A,(IO2000)                      ;1be1  3a ea 11      4186   4199 
    AND 030h                            ;1be4  e6 30         4187   4200 
    OR  (HL)                            ;1be6  b6            4188   4201 
    JP  IO20SB                          ;1be7  c3 62 00      4189   4202 
                                        ;                    4190   4203 ;
                                        ;                    4191   4204 ;
GSAVES: PUSH    HL                      ;1bea  e5            4192   4205 
    LD  HL,$CGBUF                       ;1beb  21 4a 55      4193   4206 
    LD  BC,01000h                       ;1bee  01 00 10      4194   4207 
    LD  D,080h                          ;1bf1  16 80         4195   4208 
GSAVEL: LD  E,12                        ;1bf3  1e 0c         4196   4209 
GSAVEP: LD  A,(HL)                      ;1bf5  7e            4197   4210 
    OUT (C),A                           ;1bf6  ed 79         4198   4211 
    INC HL                              ;1bf8  23            4199   4212 
    INC BC                              ;1bf9  03            4200   4213 
    DEC E                               ;1bfa  1d            4201   4214 
    JR  NZ,GSAVEP                       ;1bfb  20 f8         4202   4215 
    INC BC                              ;1bfd  03            4203   4216 
    INC BC                              ;1bfe  03            4204   4217 
    INC BC                              ;1bff  03            4205   4218 
    INC BC                              ;1c00  03            4206   4219 
    DEC D                               ;1c01  15            4207   4220 
    JR  NZ,GSAVEL                       ;1c02  20 ef         4208   4221 
    POP HL                              ;1c04  e1            4209   4222 
    RET                                 ;1c05  c9            4210   4223 
                                        ;                    4211   4224 ;
                                        ;                    4212   4225 ;
GMODEF: DEFB    0                       ;1c06  00            4213   4226 
                                        ;                    4214   4227 ;
SCRTAB: DEFB    0E0H                    ;1c07  e0            4215   4228 ;-32	G0
    DEFB    0C0H                        ;1c08  c0            4216   4229 ;-64
    DEFW    CALAD0                      ;1c09  36 48         4217   4230 
    DEFB    000H                        ;1c0b  00            4218   4231 
                                        ;                    4219   4232 ;
    DEFB    0D0H                        ;1c0c  d0            4220   4233 ;G1	;-48
    DEFB    0C0H                        ;1c0d  c0            4221   4234 ;-64
    DEFW    CALAD1                      ;1c0e  75 48         4222   4235 
    DEFB    000H                        ;1c10  00            4223   4236 
                                        ;                    4224   4237 ;
    DEFB    040H                        ;1c11  40            4225   4238 ;G2	;-192
    DEFB    080H                        ;1c12  80            4226   4239 ;-128
    DEFW    CALAD2                      ;1c13  ca 48         4227   4240 
    DEFB    00AH                        ;1c15  0a            4228   4241 
                                        ;                    4229   4242 ;
    DEFB    040H                        ;1c16  40            4230   4243 ;G3
    DEFB    080H                        ;1c17  80            4231   4244 
    DEFW    CALAD3                      ;1c18  ca 48         4232   4245 
    DEFB    08AH                        ;1c1a  8a            4233   4246 
                                        ;                    4234   4247 ;
    DEFB    040H                        ;1c1b  40            4235   4248 ;G4	;-192
    DEFB    000H                        ;1c1c  00            4236   4249 ;-256
    DEFW    CALAD4                      ;1c1d  f3 48         4237   4250 
    DEFB    00EH                        ;1c1f  0e            4238   4251 
                                        ;                    4239   4252 ;
    DEFB    040H                        ;1c20  40            4240   4253 ;G5
    DEFB    000H                        ;1c21  00            4241   4254 
    DEFW    CALAD5                      ;1c22  f3 48         4242   4255 
    DEFB    08EH                        ;1c24  8e            4243   4256 
                                        ;                    4244   4257 ;
LOCATE: LD  C,L                         ;1c25  4d            4245   4258 
    LD  B,H                             ;1c26  44            4246   4259 
    CALL    IHLEXP                      ;1c27  cd cc 22      4247   4260 
    CALL    CH2CH                       ;1c2a  cd 61 2d      4248   4261 
    CALL    HCHECK                      ;1c2d  cd d8 22      4249   4262 
    CP  32                              ;1c30  fe 20         4250   4263 ; CURX LIMI
LCTIFC: JP  NC,IFCALL                   ;1c32  d2 36 17      4251   4264 
    LD  (CURX),A                        ;1c35  32 ed 11      4252   4265 
    CALL    IBYTE                       ;1c38  cd df 22      4253   4266 
    CP  16                              ;1c3b  fe 10         4254   4267 ; CURY LIMIT
    JR  NC,LCTIFC                       ;1c3d  30 f3         4255   4268 
    LD  (CURY),A                        ;1c3f  32 ee 11      4256   4269 
    JP  RETIRQ                          ;1c42  c3 39 1b      4257   4270 
                                        ;                    4258   4271 ;
READ:   LD  C,L                         ;1c45  4d            4259   4272 
    LD  B,H                             ;1c46  44            4260   4273 
    LD  HL,DATASK                       ;1c47  21 5f 1c      4261   4274 
    LD  (READVC),HL                     ;1c4a  22 5a 1e      4262   4275 
    LD  HL,LNG+1                        ;1c4d  21 28 45      4263   4276 
    LD  (DATAFV),HL                     ;1c50  22 fc 1d      4264   4277 
    LD  HL,00000h                       ;1c53  21 00 00      4265   4278 
    LD  (DATAV1),HL                     ;1c56  22 e2 1d      4266   4279 
    LD  HL,00428h                       ;1c59  21 28 04      4267   4280 
    LD  (DATAV2),HL                     ;1c5c  22 81 1e      4268   4281 
DATASK: DEFB    021H                    ;1c5f  21            4269   4282 ; LD HL,?
DATAPO: DEFS    2                       ;1c60                4270   4283 
DATAS': LD  A,(HL)                      ;1c62  7e            4271   4284 
    CP  03Ah                            ;1c63  fe 3a         4272   4285 
    JR  Z,MIDDAR                        ;1c65  28 11         4273   4286 
    OR  A                               ;1c67  b7            4274   4287 
    JR  NZ,DATAFD                       ;1c68  20 20         4275   4288 
    INC HL                              ;1c6a  23            4276   4289 
    LD  E,(HL)                          ;1c6b  5e            4277   4290 
    INC HL                              ;1c6c  23            4278   4291 
    LD  D,(HL)                          ;1c6d  56            4279   4292 
    LD  A,E                             ;1c6e  7b            4280   4293 
    OR  D                               ;1c6f  b2            4281   4294 
    LD  A,4                             ;1c70  3e 04         4282   4295 
    JP  Z,ERROR                         ;1c72  ca 96 21      4283   4296 
    INC HL                              ;1c75  23            4284   4297 
    INC HL                              ;1c76  23            4285   4298 
    INC HL                              ;1c77  23            4286   4299 
MIDDAR: CALL    HLFTCH                  ;1c78  cd 87 29      4287   4300 
    OR  A                               ;1c7b  b7            4288   4301 
    JR  Z,DATAS'                        ;1c7c  28 e4         4289   4302 
    CP  08Fh                            ;1c7e  fe 8f         4290   4303 ; DATA IM
    JR  Z,DATAFD                        ;1c80  28 08         4291   4304 
    CALL    DATA                        ;1c82  cd c8 1c      4292   4305 
    JR  C,DATAS'                        ;1c85  38 db         4293   4306 
    INC HL                              ;1c87  23            4294   4307 
    JR  MIDDAR                          ;1c88  18 ee         4295   4308 
                                        ;                    4296   4309 ;
DATAFD: INC HL                          ;1c8a  23            4297   4310 
    LD  (DATAPO),HL                     ;1c8b  22 60 1c      4298   4311 
    EX  DE,HL                           ;1c8e  eb            4299   4312 
    JP  INPLOP                          ;1c8f  c3 df 1d      4300   4313 
                                        ;                    4301   4314 ;
RESLBL: PUSH    HL                      ;1c92  e5            4302   4315 
    CALL    LBLSER                      ;1c93  cd be 42      4303   4316 
    LD  HL,(CURLPT)                     ;1c96  2a 53 43      4304   4317 
    DEC HL                              ;1c99  2b            4305   4318 
    LD  (DATAPO),HL                     ;1c9a  22 60 1c      4306   4319 
    POP HL                              ;1c9d  e1            4307   4320 
    CALL    IFDQSK                      ;1c9e  cd 64 44      4308   4321 
    OR  A                               ;1ca1  b7            4309   4322 
    RET Z                               ;1ca2  c8            4310   4323 
    INC HL                              ;1ca3  23            4311   4324 
    RET                                 ;1ca4  c9            4312   4325 
                                        ;                    4313   4326 ;
RESTOR: CALL    HLFTCH                  ;1ca5  cd 87 29      4314   4327 
    CP  022h                            ;1ca8  fe 22         4315   4328 
    JR  Z,RESLBL                        ;1caa  28 e6         4316   4329 
    CP  00Bh                            ;1cac  fe 0b         4317   4330 
    PUSH    HL                          ;1cae  e5            4318   4331 
    LD  HL,TEXTST                       ;1caf  21 4e 7c      4319   4332 
    JR  NZ,RESTTT                       ;1cb2  20 0e         4320   4333 
    POP HL                              ;1cb4  e1            4321   4334 
    INC HL                              ;1cb5  23            4322   4335 
    LD  E,(HL)                          ;1cb6  5e            4323   4336 
    INC HL                              ;1cb7  23            4324   4337 
    LD  D,(HL)                          ;1cb8  56            4325   4338 
    INC HL                              ;1cb9  23            4326   4339 
    PUSH    HL                          ;1cba  e5            4327   4340 
    EX  DE,HL                           ;1cbb  eb            4328   4341 
    CALL    LNOSER                      ;1cbc  cd 8e 3f      4329   4342 
    JP  C,UDFLNO                        ;1cbf  da dc 43      4330   4343 
RESTTT: DEC HL                          ;1cc2  2b            4331   4344 
    LD  (DATAPO),HL                     ;1cc3  22 60 1c      4332   4345 
    POP HL                              ;1cc6  e1            4333   4346 
    RET                                 ;1cc7  c9            4334   4347 
                                        ;                    4335   4348 ;
DATA:   DEC HL                          ;1cc8  2b            4336   4349 
DATALZ: CALL    IFSKSB                  ;1cc9  cd 40 44      4337   4350 
    OR  A                               ;1ccc  b7            4338   4351 
    SCF                                 ;1ccd  37            4339   4352 
    RET Z                               ;1cce  c8            4340   4353 
    CP  03Ah                            ;1ccf  fe 3a         4341   4354 
    RET Z                               ;1cd1  c8            4342   4355 
    JR  DATALZ                          ;1cd2  18 f5         4343   4356 
                                        ;                    4344   4357 ;
LINCIN: CALL    IHLEXP                  ;1cd4  cd cc 22      4345   4358 
    CP  02Ch                            ;1cd7  fe 2c         4346   4359 
    JP  NZ,SERROR                       ;1cd9  c2 3a 17      4347   4360 
    LD  HL,CINPUT                       ;1cdc  21 f8 39      4348   4361 
    LD  (LINVEC),HL                     ;1cdf  22 30 1d      4349   4362 
    CALL    BCFTCH                      ;1ce2  cd c4 25      4350   4363 
    JR  LINPNP                          ;1ce5  18 35         4351   4364 
                                        ;                    4352   4365 ;
LINE:   LD  (IBREKH),HL                 ;1ce7  22 4c 1d      4353   4366 
    LD  C,L                             ;1cea  4d            4354   4367 
    LD  B,H                             ;1ceb  44            4355   4368 
    CALL    BCFTCH                      ;1cec  cd c4 25      4356   4369 
    CP  08Dh                            ;1cef  fe 8d         4357   4370 
    JP  NZ,LINE@                        ;1cf1  c2 79 49      4358   4371 
    CALL    BCFTCH                      ;1cf4  cd c4 25      4359   4372 
    CP  023h                            ;1cf7  fe 23         4360   4373 
    JR  Z,LINCIN                        ;1cf9  28 d9         4361   4374 
    LD  HL,LININP                       ;1cfb  21 93 15      4362   4375 
    LD  (LINVEC),HL                     ;1cfe  22 30 1d      4363   4376 
    CP  022h                            ;1d01  fe 22         4364   4377 
    JR  NZ,LINPNP                       ;1d03  20 17         4365   4378 
LINPOL: LD  A,(BC)                      ;1d05  0a            4366   4379 
    INC BC                              ;1d06  03            4367   4380 
    OR  A                               ;1d07  b7            4368   4381 
    JP  Z,SERROR                        ;1d08  ca 3a 17      4369   4382 
    CP  022h                            ;1d0b  fe 22         4370   4383 
    JR  Z,PMTOUE                        ;1d0d  28 05         4371   4384 
    CALL    ACCPRT                      ;1d0f  cd 64 08      4372   4385 
    JR  LINPOL                          ;1d12  18 f1         4373   4386 
PMTOUE: CALL    BCFTCH                  ;1d14  cd c4 25      4374   4387 
    CP  03Bh                            ;1d17  fe 3b         4375   4388 
    CALL    Z,BCFTCH                    ;1d19  cc c4 25      4376   4389 
LINPNP: LD  DE,(INTFAC)                 ;1d1c  ed 5b 4b 7a   4377   4390 
    CALL    GETVAR                      ;1d20  cd da 1e      4378   4391 
    CP  003h                            ;1d23  fe 03         4379   4392 
    JP  NZ,TYPEMS                       ;1d25  c2 32 17      4380   4393 
    CALL    BCFTCH                      ;1d28  cd c4 25      4381   4394 
    PUSH    HL                          ;1d2b  e5            4382   4395 
    LD  DE,KEYBUF                       ;1d2c  11 4f 7a      4383   4396 
    DEFB    0CDH                        ;1d2f  cd            4384   4397 ; CALL ?
LINVEC: DEFW    LININP                  ;1d30  93 15         4385   4398 
    JR  C,IBREAK                        ;1d32  38 15         4386   4399 
    PUSH    BC                          ;1d34  c5            4387   4400 
    PUSH    DE                          ;1d35  d5            4388   4401 
    LD  B,0                             ;1d36  06 00         4389   4402 
LINESR: LD  A,(DE)                      ;1d38  1a            4390   4403 
    OR  A                               ;1d39  b7            4391   4404 
    JR  Z,ESLINE                        ;1d3a  28 04         4392   4405 
    INC DE                              ;1d3c  13            4393   4406 
    INC B                               ;1d3d  04            4394   4407 
    JR  LINESR                          ;1d3e  18 f8         4395   4408 
ESLINE: EX  DE,HL                       ;1d40  eb            4396   4409 
    POP DE                              ;1d41  d1            4397   4410 
    CALL    ENTSTR                      ;1d42  cd 1a 2b      4398   4411 
    POP BC                              ;1d45  c1            4399   4412 
    JP  STRMDM                          ;1d46  c3 52 15      4400   4413 
                                        ;                    4401   4414 ;
IBREAK: POP HL                          ;1d49  e1            4402   4415 
    POP HL                              ;1d4a  e1            4403   4416 
    DEFB    021H                        ;1d4b  21            4404   4417 ; LD HL,?
IBREKH: DEFS    2                       ;1d4c                4405   4418 
    JP  BREAK                           ;1d4e  c3 a2 16      4406   4419 
                                        ;                    4407   4420 ;
CINP'#: LD  HL,CIRPUT                   ;1d51  21 6c 1d      4408   4421 
    LD  (PMASVC),HL                     ;1d54  22 c3 1d      4409   4422 
    INC BC                              ;1d57  03            4410   4423 
    CALL    IHLEXP                      ;1d58  cd cc 22      4411   4424 
    CP  02Ch                            ;1d5b  fe 2c         4412   4425 
    JP  NZ,SERROR                       ;1d5d  c2 3a 17      4413   4426 
    LD  A,(FILEFG)                      ;1d60  3a 83 33      4414   4427 
    DEC A                               ;1d63  3d            4415   4428 
    JP  NZ,FILEER                       ;1d64  c2 3e 18      4416   4429 
    LD  A,0C3h                          ;1d67  3e c3         4417   4430 
    LD  (NRLDED),A                      ;1d69  32 30 3a      4418   4431 
CIRPUT: LD  DE,KEYBUF                   ;1d6c  11 4f 7a      4419   4432 
    CALL    CINPUT                      ;1d6f  cd f8 39      4420   4433 
    JR  INPLOP                          ;1d72  18 6b         4421   4434 
                                        ;                    4422   4435 ;
INPUT:  PUSH    HL                      ;1d74  e5            4423   4436 
    LD  (IBREKH),HL                     ;1d75  22 4c 1d      4424   4437 
    LD  HL,PMTASK                       ;1d78  21 c2 1d      4425   4438 
    LD  (READVC),HL                     ;1d7b  22 5a 1e      4426   4439 
    LD  HL,00000h                       ;1d7e  21 00 00      4427   4440 
    LD  (DATAFV),HL                     ;1d81  22 fc 1d      4428   4441 
    LD  (DATAV2),HL                     ;1d84  22 81 1e      4429   4442 
    LD  HL,00418h                       ;1d87  21 18 04      4430   4443 
    LD  (DATAV1),HL                     ;1d8a  22 e2 1d      4431   4444 
    POP HL                              ;1d8d  e1            4432   4445 
    CALL    HLFTCH                      ;1d8e  cd 87 29      4433   4446 
    LD  C,L                             ;1d91  4d            4434   4447 
    LD  B,H                             ;1d92  44            4435   4448 
    PUSH    HL                          ;1d93  e5            4436   4449 
    LD  HL,LINEKB                       ;1d94  21 c5 1d      4437   4450 
    LD  (PMASVC),HL                     ;1d97  22 c3 1d      4438   4451 
    POP HL                              ;1d9a  e1            4439   4452 
    CP  023h                            ;1d9b  fe 23         4440   4453 
    JP  Z,CINP'#                        ;1d9d  ca 51 1d      4441   4454 
    CP  022h                            ;1da0  fe 22         4442   4455 
    JR  NZ,PMTASK                       ;1da2  20 1e         4443   4456 
PMTOUL: INC HL                          ;1da4  23            4444   4457 
    LD  A,(HL)                          ;1da5  7e            4445   4458 
    CP  022h                            ;1da6  fe 22         4446   4459 
    JR  Z,NPASK?                        ;1da8  28 09         4447   4460 
    OR  A                               ;1daa  b7            4448   4461 
    JP  Z,SERROR                        ;1dab  ca 3a 17      4449   4462 
    CALL    ACCPRT                      ;1dae  cd 64 08      4450   4463 
    JR  PMTOUL                          ;1db1  18 f1         4451   4464 
NPASK?: CALL    INCHLF                  ;1db3  cd 86 29      4452   4465 
    INC HL                              ;1db6  23            4453   4466 
    LD  C,L                             ;1db7  4d            4454   4467 
    LD  B,H                             ;1db8  44            4455   4468 
    CP  02Ch                            ;1db9  fe 2c         4456   4469 
    JR  Z,NOPPMT                        ;1dbb  28 10         4457   4470 
    CP  03Bh                            ;1dbd  fe 3b         4458   4471 
    JP  NZ,SERROR                       ;1dbf  c2 3a 17      4459   4472 
                                        ;                    4460   4473 ;
PMTASK: DEFB    0C3H                    ;1dc2  c3            4461   4474 ; JP ?
PMASVC: DEFS    2                       ;1dc3                4462   4475 
LINEKB: LD  A,03Fh                      ;1dc5  3e 3f         4463   4476 
    CALL    ACCPRT                      ;1dc7  cd 64 08      4464   4477 
    CALL    SPPRT                       ;1dca  cd 62 08      4465   4478 
                                        ;                    4466   4479 ;
NOPPMT: LD  HL,(CURX)                   ;1dcd  2a ed 11      4467   4480 ; ??DISPN
    PUSH    HL                          ;1dd0  e5            4468   4481 
    LD  DE,KEYBUF                       ;1dd1  11 4f 7a      4469   4482 
    CALL    LININP                      ;1dd4  cd 93 15      4470   4483 
    JP  C,IBREAK                        ;1dd7  da 49 1d      4471   4484 
    POP HL                              ;1dda  e1            4472   4485 
    LD  H,0                             ;1ddb  26 00         4473   4486 
    ADD HL,DE                           ;1ddd  19            4474   4487 
    EX  DE,HL                           ;1dde  eb            4475   4488 
                                        ;                    4476   4489 ;
INPLOP: CALL    BCFTCH                  ;1ddf  cd c4 25      4477   4490 
DATAV1: JR  DASKIO                      ;1de2  18 04         4478   4491 
    LD  (DATAPO),DE                     ;1de4  ed 53 60 1c   4479   4492 
DASKIO: OR  A                           ;1de8  b7            4480   4493 
    JP  Z,RETIRQ                        ;1de9  ca 39 1b      4481   4494 
    CP  03Ah                            ;1dec  fe 3a         4482   4495 
    JP  Z,RETIRQ                        ;1dee  ca 39 1b      4483   4496 
    EX  AF,AF'                          ;1df1  08            4484   4497 
    CALL    DEFTCH                      ;1df2  cd 51 5d      4485   4498 
    DEC DE                              ;1df5  1b            4486   4499 
    OR  A                               ;1df6  b7            4487   4500 
    DEC BC                              ;1df7  0b            4488   4501 
    JR  Z,PMTERM                        ;1df8  28 5f         4489   4502 
    CP  03Ah                            ;1dfa  fe 3a         4490   4503 
DATAFV:                                 ;                    4491   4504 
    JR  Z,PMTERM                        ;1dfc  28 5b         4492   4505 
    INC BC                              ;1dfe  03            4493   4506 
    EX  AF,AF'                          ;1dff  08            4494   4507 
    PUSH    DE                          ;1e00  d5            4495   4508 
    LD  DE,(INTFAC)                     ;1e01  ed 5b 4b 7a   4496   4509 
    CALL    GETVAR                      ;1e05  cd da 1e      4497   4510 
    POP DE                              ;1e08  d1            4498   4511 
    CP  003h                            ;1e09  fe 03         4499   4512 
    JP  Z,STRINP                        ;1e0b  ca 69 1e      4500   4513 
    PUSH    HL                          ;1e0e  e5            4501   4514 
    PUSH    AF                          ;1e0f  f5            4502   4515 
    CALL    DEFTCH                      ;1e10  cd 51 5d      4503   4516 
    DEC DE                              ;1e13  1b            4504   4517 
    CP  02Eh                            ;1e14  fe 2e         4505   4518 
    JR  Z,INNMOK                        ;1e16  28 16         4506   4519 
    CP  02Dh                            ;1e18  fe 2d         4507   4520 
    JR  Z,INNMOK                        ;1e1a  28 12         4508   4521 
    CP  026h                            ;1e1c  fe 26         4509   4522 
    JR  Z,INNMOK                        ;1e1e  28 0e         4510   4523 
    CP  02Bh                            ;1e20  fe 2b         4511   4524 
    JR  Z,INNMOK                        ;1e22  28 0a         4512   4525 
    CP  030h                            ;1e24  fe 30         4513   4526 
    JP  C,TYPEMS                        ;1e26  da 32 17      4514   4527 
    CP  03Ah                            ;1e29  fe 3a         4515   4528 
    JP  NC,TYPEMS                       ;1e2b  d2 32 17      4516   4529 
INNMOK: LD  HL,ZFAC                     ;1e2e  21 f2 62      4517   4530 
    PUSH    BC                          ;1e31  c5            4518   4531 
    CALL    OVFLAG                      ;1e32  cd b8 5b      4519   4532 
    POP BC                              ;1e35  c1            4520   4533 
    POP AF                              ;1e36  f1            4521   4534 
    CP  002h                            ;1e37  fe 02         4522   4535 
    JR  Z,INITDI                        ;1e39  28 21         4523   4536 
    POP HL                              ;1e3b  e1            4524   4537 
    PUSH    BC                          ;1e3c  c5            4525   4538 
    LD  C,A                             ;1e3d  4f            4526   4539 
    LD  B,0                             ;1e3e  06 00         4527   4540 
    PUSH    DE                          ;1e40  d5            4528   4541 
    EX  DE,HL                           ;1e41  eb            4529   4542 
    LD  HL,ZFAC                         ;1e42  21 f2 62      4530   4543 
    LDIR                                ;1e45  ed b0         4531   4544 
    POP DE                              ;1e47  d1            4532   4545 
    POP BC                              ;1e48  c1            4533   4546 
NXTIN?: CALL    BCFTCH                  ;1e49  cd c4 25      4534   4547 
    CP  02Ch                            ;1e4c  fe 2c         4535   4548 
    DEC BC                              ;1e4e  0b            4536   4549 
    JR  NZ,INPLOP                       ;1e4f  20 8e         4537   4550 
    INC BC                              ;1e51  03            4538   4551 
    CALL    DEFTCH                      ;1e52  cd 51 5d      4539   4552 
    CP  02Ch                            ;1e55  fe 2c         4540   4553 ; BCOUTA?
    JR  Z,INPLOP                        ;1e57  28 86         4541   4554 
                                        ;                    4542   4555 ;
PMTERM: DEFB    0C3H                    ;1e59  c3            4543   4556 ; JP ?
READVC: DEFS    2                       ;1e5a                4544   4557 
                                        ;                    4545   4558 ;
INITDI: CALL    HLFLTO                  ;1e5c  cd 97 2d      4546   4559 
    POP IX                              ;1e5f  dd e1         4547   4560 
    LD  (IX+0),L                        ;1e61  dd 75 00      4548   4561 
    LD  (IX+1),H                        ;1e64  dd 74 01      4549   4562 
    JR  NXTIN?                          ;1e67  18 e0         4550   4563 
                                        ;                    4551   4564 ;
STRINP: PUSH    BC                      ;1e69  c5            4552   4565 ; TEXT POINTR
    PUSH    HL                          ;1e6a  e5            4553   4566 ; VAR ADRS
    LD  (INPSDC),DE                     ;1e6b  ed 53 a9 1e   4554   4567 
    LD  B,0                             ;1e6f  06 00         4555   4568 
    CALL    DEFTCH                      ;1e71  cd 51 5d      4556   4569 
    CP  022h                            ;1e74  fe 22         4557   4570 
    JR  Z,DATA22                        ;1e76  28 20         4558   4571 
    DEC DE                              ;1e78  1b            4559   4572 
SRINPL: LD  A,(DE)                      ;1e79  1a            4560   4573 
    INC DE                              ;1e7a  13            4561   4574 
    INC B                               ;1e7b  04            4562   4575 
    OR  A                               ;1e7c  b7            4563   4576 
    JR  Z,ESCINS                        ;1e7d  28 08         4564   4577 
    CP  03Ah                            ;1e7f  fe 3a         4565   4578 
DATAV2: JR  Z,ESCINS                    ;1e81  28 04         4566   4579 
    CP  02Ch                            ;1e83  fe 2c         4567   4580 
    JR  NZ,SRINPL                       ;1e85  20 f2         4568   4581 
ESCINS: DEC DE                          ;1e87  1b            4569   4582 
ESCIN': DEC B                           ;1e88  05            4570   4583 
    LD  HL,INSDC                        ;1e89  21 a8 1e      4571   4584 
    LD  (HL),B                          ;1e8c  70            4572   4585 
    LD  C,E                             ;1e8d  4b            4573   4586 
    LD  B,D                             ;1e8e  42            4574   4587 
    POP DE                              ;1e8f  d1            4575   4588 
    PUSH    BC                          ;1e90  c5            4576   4589 
    CALL    INPENT                      ;1e91  cd 71 15      4577   4590 
    POP DE                              ;1e94  d1            4578   4591 
    POP BC                              ;1e95  c1            4579   4592 
    JR  NXTIN?                          ;1e96  18 b1         4580   4593 
                                        ;                    4581   4594 ;
DATA22: LD  (INPSDC),DE                 ;1e98  ed 53 a9 1e   4582   4595 
DATADN: LD  A,(DE)                      ;1e9c  1a            4583   4596 
    INC B                               ;1e9d  04            4584   4597 
    OR  A                               ;1e9e  b7            4585   4598 
    JR  Z,ESCIN'                        ;1e9f  28 e7         4586   4599 
    INC DE                              ;1ea1  13            4587   4600 
    CP  022h                            ;1ea2  fe 22         4588   4601 
    JR  NZ,DATADN                       ;1ea4  20 f6         4589   4602 
    JR  ESCIN'                          ;1ea6  18 e0         4590   4603 
INSDC:  DEFS    1                       ;1ea8                4591   4604 
INPSDC: DEFS    2                       ;1ea9                4592   4605 
                                        ;                    4593   4606 ;
HMEMCK: PUSH    HL                      ;1eab  e5            4594   4607 
    PUSH    DE                          ;1eac  d5            4595   4608 
    EX  DE,HL                           ;1ead  eb            4596   4609 
    JR  MCHKMD                          ;1eae  18 06         4597   4610 
                                        ;                    4598   4611 ;
MEMCHK: PUSH    HL                      ;1eb0  e5            4599   4612 
    PUSH    DE                          ;1eb1  d5            4600   4613 
    LD  DE,(STKLMT)                     ;1eb2  ed 5b 3f 7a   4601   4614 
MCHKMD: PUSH    AF                      ;1eb6  f5            4602   4615 
    LD  HL,0                            ;1eb7  21 00 00      4603   4616 
    ADD HL,SP                           ;1eba  39            4604   4617 
    DEC H                               ;1ebb  25            4605   4618 
    OR  A                               ;1ebc  b7            4606   4619 
    SBC HL,DE                           ;1ebd  ed 52         4607   4620 
    JR  NC,MCHCKR                       ;1ebf  30 0e         4608   4621 
    CALL    MEMPUR                      ;1ec1  cd e8 2d      4609   4622 
    LD  HL,0                            ;1ec4  21 00 00      4610   4623 
    ADD HL,SP                           ;1ec7  39            4611   4624 
    DEC H                               ;1ec8  25            4612   4625 
    OR  A                               ;1ec9  b7            4613   4626 
    SBC HL,DE                           ;1eca  ed 52         4614   4627 
    JP  C,OMERR                         ;1ecc  da 88 21      4615   4628 
MCHCKR: POP AF                          ;1ecf  f1            4616   4629 
    POP DE                              ;1ed0  d1            4617   4630 
    POP HL                              ;1ed1  e1            4618   4631 
    RET                                 ;1ed2  c9            4619   4632 
                                        ;                    4620   4633 
GETVAC: LD  DE,(INTFAC)                 ;1ed3  ed 5b 4b 7a   4621   4634 
GETVAB: CALL    BCFTCH                  ;1ed7  cd c4 25      4622   4635 
GETVAR: PUSH    DE                      ;1eda  d5            4623   4636 
    CALL    VSRTST                      ;1edb  cd fe 20      4624   4637 
    CP  028h                            ;1ede  fe 28         4625   4638 
    JP  Z,ARRAY                         ;1ee0  ca 41 1f      4626   4639 
    DEC BC                              ;1ee3  0b            4627   4640 
    PUSH    BC                          ;1ee4  c5            4628   4641 
    LD  A,E                             ;1ee5  7b            4629   4642 
    EX  DE,HL                           ;1ee6  eb            4630   4643 
    LD  B,A                             ;1ee7  47            4631   4644 
    LD  HL,(VSTART)                     ;1ee8  2a 3b 7a      4632   4645 
VARCLP: LD  A,(HL)                      ;1eeb  7e            4633   4646 
    OR  A                               ;1eec  b7            4634   4647 
    JR  Z,CRNVAR                        ;1eed  28 34         4635   4648 
    CP  B                               ;1eef  b8            4636   4649 
    JR  NZ,SKIPUS                       ;1ef0  20 12         4637   4650 
    INC HL                              ;1ef2  23            4638   4651 
    LD  A,E                             ;1ef3  7b            4639   4652 
    CP  (HL)                            ;1ef4  be            4640   4653 
    LD  A,B                             ;1ef5  78            4641   4654 
    JP  NZ,SKIPVT                       ;1ef6  c2 18 1f      4642   4655 
    INC HL                              ;1ef9  23            4643   4656 
    LD  A,D                             ;1efa  7a            4644   4657 
    CP  (HL)                            ;1efb  be            4645   4658 
    LD  A,B                             ;1efc  78            4646   4659 
    JP  NZ,SKIPVU                       ;1efd  c2 19 1f      4647   4660 
    INC HL                              ;1f00  23            4648   4661 
GVARRT: POP BC                          ;1f01  c1            4649   4662 
    POP DE                              ;1f02  d1            4650   4663 
    RET                                 ;1f03  c9            4651   4664 
                                        ;                    4652   4665 ;
SKIPUS: INC A                           ;1f04  3c            4653   4666 
    JP  P,SKIPVT                        ;1f05  f2 18 1f      4654   4667 
    DEC A                               ;1f08  3d            4655   4668 
    AND 0C0h                            ;1f09  e6 c0         4656   4669 
    CP  0C0h                            ;1f0b  fe c0         4657   4670 
    LD  A,5                             ;1f0d  3e 05         4658   4671 
    JR  Z,SKIPVV                        ;1f0f  28 09         4659   4672 
    INC HL                              ;1f11  23            4660   4673 
    CALL    INDRCT                      ;1f12  cd a3 2a      4661   4674 
    JP  VARCLP                          ;1f15  c3 eb 1e      4662   4675 
                                        ;                    4663   4676 ;
SKIPVT: INC A                           ;1f18  3c            4664   4677 
SKIPVU: INC A                           ;1f19  3c            4665   4678 
SKIPVV: ADD A,L                         ;1f1a  85            4666   4679 
    LD  L,A                             ;1f1b  6f            4667   4680 
    LD  A,000h                          ;1f1c  3e 00         4668   4681 
    ADC A,H                             ;1f1e  8c            4669   4682 
    LD  H,A                             ;1f1f  67            4670   4683 
    JP  VARCLP                          ;1f20  c3 eb 1e      4671   4684 
                                        ;                    4672   4685 ;
CRNVAR: LD  (HL),B                      ;1f23  70            4673   4686 
    INC HL                              ;1f24  23            4674   4687 
    LD  (HL),E                          ;1f25  73            4675   4688 
    INC HL                              ;1f26  23            4676   4689 
    LD  (HL),D                          ;1f27  72            4677   4690 
    INC HL                              ;1f28  23            4678   4691 
    LD  C,B                             ;1f29  48            4679   4692 
    PUSH    HL                          ;1f2a  e5            4680   4693 
    EX  DE,HL                           ;1f2b  eb            4681   4694 
    INC B                               ;1f2c  04            4682   4695 
    XOR A                               ;1f2d  af            4683   4696 
LZFIL1: LD  (DE),A                      ;1f2e  12            4684   4697 
    INC DE                              ;1f2f  13            4685   4698 
    DJNZ    LZFIL1                      ;1f30  10 fc         4686   4699 
    DEC DE                              ;1f32  1b            4687   4700 
    EX  DE,HL                           ;1f33  eb            4688   4701 
    CALL    HMEMCK                      ;1f34  cd ab 1e      4689   4702 
    EX  DE,HL                           ;1f37  eb            4690   4703 
    LD  (STKLMT),DE                     ;1f38  ed 53 3f 7a   4691   4704 
    POP HL                              ;1f3c  e1            4692   4705 
    LD  A,C                             ;1f3d  79            4693   4706 
    JP  GVARRT                          ;1f3e  c3 01 1f      4694   4707 
                                        ;                    4695   4708 ;
ARRAY:  LD  D,0                         ;1f41  16 00         4696   4709 
    EXX                                 ;1f43  d9            4697   4710 
    POP HL                              ;1f44  e1            4698   4711 
    PUSH    HL                          ;1f45  e5            4699   4712 
    PUSH    HL                          ;1f46  e5            4700   4713 
    EXX                                 ;1f47  d9            4701   4714 
    EX  (SP),HL                         ;1f48  e3            4702   4715 
    PUSH    HL                          ;1f49  e5            4703   4716 
TSALOP: POP HL                          ;1f4a  e1            4704   4717 
    PUSH    HL                          ;1f4b  e5            4705   4718 
    PUSH    DE                          ;1f4c  d5            4706   4719 
    DEC IY                              ;1f4d  fd 2b         4707   4720 
    CALL    HLEXP                       ;1f4f  cd c7 22      4708   4721 
    INC IY                              ;1f52  fd 23         4709   4722 
    CP  029h                            ;1f54  fe 29         4710   4723 
    JR  Z,TSFARY                        ;1f56  28 12         4711   4724 
    CP  02Ch                            ;1f58  fe 2c         4712   4725 
    JP  NZ,SERROR                       ;1f5a  c2 3a 17      4713   4726 
    POP DE                              ;1f5d  d1            4714   4727 
    INC D                               ;1f5e  14            4715   4728 
    EXX                                 ;1f5f  d9            4716   4729 
    POP HL                              ;1f60  e1            4717   4730 
    POP DE                              ;1f61  d1            4718   4731 
    EXX                                 ;1f62  d9            4719   4732 
    PUSH    HL                          ;1f63  e5            4720   4733 
    EXX                                 ;1f64  d9            4721   4734 
    PUSH    DE                          ;1f65  d5            4722   4735 
    PUSH    HL                          ;1f66  e5            4723   4736 
    EXX                                 ;1f67  d9            4724   4737 
    JR  TSALOP                          ;1f68  18 e0         4725   4738 
                                        ;                    4726   4739 ;
TSFARY: POP DE                          ;1f6a  d1            4727   4740 
    EXX                                 ;1f6b  d9            4728   4741 
    POP HL                              ;1f6c  e1            4729   4742 
    POP DE                              ;1f6d  d1            4730   4743 
    EXX                                 ;1f6e  d9            4731   4744 
    INC D                               ;1f6f  14            4732   4745 
    PUSH    HL                          ;1f70  e5            4733   4746 
    PUSH    BC                          ;1f71  c5            4734   4747 
    EXX                                 ;1f72  d9            4735   4748 
    PUSH    DE                          ;1f73  d5            4736   4749 
    EXX                                 ;1f74  d9            4737   4750 
    POP BC                              ;1f75  c1            4738   4751 
    LD  HL,(VSTART)                     ;1f76  2a 3b 7a      4739   4752 
ASLOP:  LD  A,(HL)                      ;1f79  7e            4740   4753 
    OR  A                               ;1f7a  b7            4741   4754 
    JP  Z,SORERR                        ;1f7b  ca f5 20      4742   4755 
    JP  M,ARYATA                        ;1f7e  fa 8c 1f      4743   4756 
    INC A                               ;1f81  3c            4744   4757 
    INC A                               ;1f82  3c            4745   4758 
    INC A                               ;1f83  3c            4746   4759 
ARSKFN: ADD A,L                         ;1f84  85            4747   4760 
    LD  L,A                             ;1f85  6f            4748   4761 
    LD  A,000h                          ;1f86  3e 00         4749   4762 
    ADC A,H                             ;1f88  8c            4750   4763 
    LD  H,A                             ;1f89  67            4751   4764 
    JR  ASLOP                           ;1f8a  18 ed         4752   4765 
                                        ;                    4753   4766 ;
ARYATA: AND 0C0h                        ;1f8c  e6 c0         4754   4767 
    CP  0C0h                            ;1f8e  fe c0         4755   4768 
    LD  A,005h                          ;1f90  3e 05         4756   4769 
    JR  Z,ARSKFN                        ;1f92  28 f0         4757   4770 
    LD  A,(HL)                          ;1f94  7e            4758   4771 
    AND 07Fh                            ;1f95  e6 7f         4759   4772 
    CP  E                               ;1f97  bb            4760   4773 
    JR  Z,ARMSN1                        ;1f98  28 0d         4761   4774 
    INC HL                              ;1f9a  23            4762   4775 
MIDNAM: CALL    INDRCT                  ;1f9b  cd a3 2a      4763   4776 
    JP  ASLOP                           ;1f9e  c3 79 1f      4764   4777 
                                        ;                    4765   4778 ;
NXTVR:  DEC HL                          ;1fa1  2b            4766   4779 
NXTVR1:     DEC HL                      ;1fa2  2b            4767   4780 
    DEC HL                              ;1fa3  2b            4768   4781 
    JP  MIDNAM                          ;1fa4  c3 9b 1f      4769   4782 
                                        ;                    4770   4783 ;
ARMSN1: EXX                             ;1fa7  d9            4771   4784 
    LD  C,A                             ;1fa8  4f            4772   4785 
    LD  B,000h                          ;1fa9  06 00         4773   4786 
    LD  HL,00000h                       ;1fab  21 00 00      4774   4787 
    EXX                                 ;1fae  d9            4775   4788 
    INC HL                              ;1faf  23            4776   4789 
    INC HL                              ;1fb0  23            4777   4790 
    INC HL                              ;1fb1  23            4778   4791 
    LD  A,C                             ;1fb2  79            4779   4792 
    CP  (HL)                            ;1fb3  be            4780   4793 
    JP  NZ,NXTVR1                       ;1fb4  c2 a2 1f      4781   4794 
    INC HL                              ;1fb7  23            4782   4795 
    LD  A,B                             ;1fb8  78            4783   4796 
    CP  (HL)                            ;1fb9  be            4784   4797 
    JP  NZ,NXTVR                        ;1fba  c2 a1 1f      4785   4798 
    INC HL                              ;1fbd  23            4786   4799 
    LD  A,D                             ;1fbe  7a            4787   4800 
    CP  (HL)                            ;1fbf  be            4788   4801 
    JP  NZ,SORERR                       ;1fc0  c2 f5 20      4789   4802 
    POP BC                              ;1fc3  c1            4790   4803 
    LD  (ARBCBF),BC                     ;1fc4  ed 43 f1 1f   4791   4804 
    LD  B,(HL)                          ;1fc8  46            4792   4805 
    INC HL                              ;1fc9  23            4793   4806 
ADRCL:  LD  E,(HL)                      ;1fca  5e            4794   4807 
    INC HL                              ;1fcb  23            4795   4808 
    LD  D,(HL)                          ;1fcc  56            4796   4809 
    INC HL                              ;1fcd  23            4797   4810 
    EX  (SP),HL                         ;1fce  e3            4798   4811 
    PUSH    DE                          ;1fcf  d5            4799   4812 
    EXX                                 ;1fd0  d9            4800   4813 
    POP DE                              ;1fd1  d1            4801   4814 
    CALL    IMUL                        ;1fd2  cd 4b 21      4802   4815 
    EXX                                 ;1fd5  d9            4803   4816 
    PUSH    HL                          ;1fd6  e5            4804   4817 
    SBC HL,DE                           ;1fd7  ed 52         4805   4818 
    JP  NC,SORERR                       ;1fd9  d2 f5 20      4806   4819 
    EXX                                 ;1fdc  d9            4807   4820 
    POP DE                              ;1fdd  d1            4808   4821 
    ADD HL,DE                           ;1fde  19            4809   4822 
    EXX                                 ;1fdf  d9            4810   4823 
    POP HL                              ;1fe0  e1            4811   4824 
    DJNZ    ADRCL                       ;1fe1  10 e7         4812   4825 
    PUSH    HL                          ;1fe3  e5            4813   4826 
    EXX                                 ;1fe4  d9            4814   4827 
    LD  E,C                             ;1fe5  59            4815   4828 
    LD  D,B                             ;1fe6  50            4816   4829 
    LD  A,C                             ;1fe7  79            4817   4830 
    CALL    IMUL                        ;1fe8  cd 4b 21      4818   4831 
    PUSH    HL                          ;1feb  e5            4819   4832 
    EXX                                 ;1fec  d9            4820   4833 
    POP DE                              ;1fed  d1            4821   4834 
    POP HL                              ;1fee  e1            4822   4835 
    ADD HL,DE                           ;1fef  19            4823   4836 
    DEFB    001H                        ;1ff0  01            4824   4837 ; LD BC,?
ARBCBF: DEFS    2                       ;1ff1                4825   4838 
    POP DE                              ;1ff3  d1            4826   4839 
    RET                                 ;1ff4  c9            4827   4840 
                                        ;                    4828   4841 ;
CHALNM: CP  030h                        ;1ff5  fe 30         4829   4842 
    RET C                               ;1ff7  d8            4830   4843 
    CP  05Bh                            ;1ff8  fe 5b         4831   4844 
    CCF                                 ;1ffa  3f            4832   4845 
    RET C                               ;1ffb  d8            4833   4846 
    CP  041h                            ;1ffc  fe 41         4834   4847 
    RET NC                              ;1ffe  d0            4835   4848 
    CP  03Ah                            ;1fff  fe 3a         4836   4849 
    CCF                                 ;2001  3f            4837   4850 
    RET                                 ;2002  c9            4838   4851 
                                        ;                    4839   4852 ;
DIM:    CALL    HLFTCH                  ;2003  cd 87 29      4840   4853 
    OR  A                               ;2006  b7            4841   4854 
    RET Z                               ;2007  c8            4842   4855 
    CP  03Ah                            ;2008  fe 3a         4843   4856 
    RET Z                               ;200a  c8            4844   4857 
    LD  C,L                             ;200b  4d            4845   4858 
    LD  B,H                             ;200c  44            4846   4859 
    CALL    BCFTCH                      ;200d  cd c4 25      4847   4860 
    CALL    VSRTST                      ;2010  cd fe 20      4848   4861 
    CP  028h                            ;2013  fe 28         4849   4862 
    JP  NZ,SERROR                       ;2015  c2 3a 17      4850   4863 
    PUSH    BC                          ;2018  c5            4851   4864 
    PUSH    DE                          ;2019  d5            4852   4865 
    PUSH    HL                          ;201a  e5            4853   4866 
    LD  C,L                             ;201b  4d            4854   4867 
    LD  B,H                             ;201c  44            4855   4868 
    LD  HL,(VSTART)                     ;201d  2a 3b 7a      4856   4869 
DASLOP: LD  A,(HL)                      ;2020  7e            4857   4870 
    OR  A                               ;2021  b7            4858   4871 
    JR  Z,DIMFDD                        ;2022  28 39         4859   4872 
    JP  M,DRYATA                        ;2024  fa 32 20      4860   4873 
    INC A                               ;2027  3c            4861   4874 
    INC A                               ;2028  3c            4862   4875 
    INC A                               ;2029  3c            4863   4876 
DRSKFN: ADD A,L                         ;202a  85            4864   4877 
    LD  L,A                             ;202b  6f            4865   4878 
    LD  A,000h                          ;202c  3e 00         4866   4879 
    ADC A,H                             ;202e  8c            4867   4880 
    LD  H,A                             ;202f  67            4868   4881 
    JR  DASLOP                          ;2030  18 ee         4869   4882 
                                        ;                    4870   4883 ;
DRYATA: AND 0C0h                        ;2032  e6 c0         4871   4884 
    CP  0C0h                            ;2034  fe c0         4872   4885 
    LD  A,5                             ;2036  3e 05         4873   4886 
    JR  Z,DRSKFN                        ;2038  28 f0         4874   4887 
    LD  A,(HL)                          ;203a  7e            4875   4888 
    AND 07Fh                            ;203b  e6 7f         4876   4889 
    CP  E                               ;203d  bb            4877   4890 
    JP  Z,MOPDIM                        ;203e  ca 4c 20      4878   4891 
    INC HL                              ;2041  23            4879   4892 
DIDNAM: CALL    INDRCT                  ;2042  cd a3 2a      4880   4893 
    JR  DASLOP                          ;2045  18 d9         4881   4894 
                                        ;                    4882   4895 ;
DXTVR1: DEC HL                          ;2047  2b            4883   4896 
DXTVR:  DEC HL                          ;2048  2b            4884   4897 
    DEC HL                              ;2049  2b            4885   4898 
    JR  DIDNAM                          ;204a  18 f6         4886   4899 
                                        ;                    4887   4900 ;
MOPDIM: INC HL                          ;204c  23            4888   4901 
    INC HL                              ;204d  23            4889   4902 
    INC HL                              ;204e  23            4890   4903 
    LD  A,C                             ;204f  79            4891   4904 
    CP  (HL)                            ;2050  be            4892   4905 
    JP  NZ,DXTVR                        ;2051  c2 48 20      4893   4906 
    INC HL                              ;2054  23            4894   4907 
    LD  A,B                             ;2055  78            4895   4908 
    CP  (HL)                            ;2056  be            4896   4909 
    JP  NZ,DXTVR1                       ;2057  c2 47 20      4897   4910 
    JP  DUPDEF                          ;205a  c3 8b 3b      4898   4911 
                                        ;                    4899   4912 ;
DIMFDD: POP HL                          ;205d  e1            4900   4913 
    POP DE                              ;205e  d1            4901   4914 
    POP BC                              ;205f  c1            4902   4915 
    LD  D,0                             ;2060  16 00         4903   4916 
    PUSH    HL                          ;2062  e5            4904   4917 
ARGLOP: PUSH    DE                      ;2063  d5            4905   4918 
    CALL    IHLEXP                      ;2064  cd cc 22      4906   4919 
    CP  029h                            ;2067  fe 29         4907   4920 
    JR  Z,DEFARY                        ;2069  28 09         4908   4921 
    CALL    CH2CH                       ;206b  cd 61 2d      4909   4922 
    POP DE                              ;206e  d1            4910   4923 
    INC D                               ;206f  14            4911   4924 
    INC HL                              ;2070  23            4912   4925 
    PUSH    HL                          ;2071  e5            4913   4926 
    JR  ARGLOP                          ;2072  18 ef         4914   4927 
                                        ;                    4915   4928 ;
DEFARY: POP DE                          ;2074  d1            4916   4929 
    INC D                               ;2075  14            4917   4930 
    INC HL                              ;2076  23            4918   4931 
    PUSH    HL                          ;2077  e5            4919   4932 
    LD  HL,(STKLMT)                     ;2078  2a 3f 7a      4920   4933 
    LD  A,E                             ;207b  7b            4921   4934 
    OR  080h                            ;207c  f6 80         4922   4935 
    LD  (HL),A                          ;207e  77            4923   4936 
    EX  AF,AF'                          ;207f  08            4924   4937 
    INC HL                              ;2080  23            4925   4938 
    INC HL                              ;2081  23            4926   4939 
    INC HL                              ;2082  23            4927   4940 
    INC HL                              ;2083  23            4928   4941 
    INC HL                              ;2084  23            4929   4942 
    LD  (HL),D                          ;2085  72            4930   4943 
    INC HL                              ;2086  23            4931   4944 
    LD  A,D                             ;2087  7a            4932   4945 
    EXX                                 ;2088  d9            4933   4946 
    LD  HL,00001h                       ;2089  21 01 00      4934   4947 
AREPUT: POP DE                          ;208c  d1            4935   4948 
    PUSH    DE                          ;208d  d5            4936   4949 
    CALL    IMUL                        ;208e  cd 4b 21      4937   4950 
    EXX                                 ;2091  d9            4938   4951 
    POP DE                              ;2092  d1            4939   4952 
    LD  (HL),E                          ;2093  73            4940   4953 
    INC HL                              ;2094  23            4941   4954 
    LD  (HL),D                          ;2095  72            4942   4955 
    INC HL                              ;2096  23            4943   4956 
    DEC A                               ;2097  3d            4944   4957 
    EXX                                 ;2098  d9            4945   4958 
    JR  NZ,AREPUT                       ;2099  20 f1         4946   4959 
    EX  AF,AF'                          ;209b  08            4947   4960 
    AND 07Fh                            ;209c  e6 7f         4948   4961 
    LD  E,A                             ;209e  5f            4949   4962 
    LD  D,0                             ;209f  16 00         4950   4963 
    CALL    IMUL                        ;20a1  cd 4b 21      4951   4964 
    PUSH    HL                          ;20a4  e5            4952   4965 
    EXX                                 ;20a5  d9            4953   4966 
    POP DE                              ;20a6  d1            4954   4967 
    PUSH    HL                          ;20a7  e5            4955   4968 
    ADD HL,DE                           ;20a8  19            4956   4969 
    JP  C,OMERR                         ;20a9  da 88 21      4957   4970 
    PUSH    DE                          ;20ac  d5            4958   4971 
    CALL    HMEMCK                      ;20ad  cd ab 1e      4959   4972 
    EX  DE,HL                           ;20b0  eb            4960   4973 
    LD  HL,(STKLMT)                     ;20b1  2a 3f 7a      4961   4974 
    INC HL                              ;20b4  23            4962   4975 
    LD  (HL),E                          ;20b5  73            4963   4976 
    INC HL                              ;20b6  23            4964   4977 
    LD  (HL),D                          ;20b7  72            4965   4978 
    INC HL                              ;20b8  23            4966   4979 
    LD  (STKLMT),DE                     ;20b9  ed 53 3f 7a   4967   4980 
    POP DE                              ;20bd  d1            4968   4981 
    INC DE                              ;20be  13            4969   4982 
    EX  (SP),HL                         ;20bf  e3            4970   4983 
ARYCLL: LD  (HL),0                      ;20c0  36 00         4971   4984 
    INC HL                              ;20c2  23            4972   4985 
    DEC DE                              ;20c3  1b            4973   4986 
    LD  A,D                             ;20c4  7a            4974   4987 
    OR  E                               ;20c5  b3            4975   4988 
    JR  NZ,ARYCLL                       ;20c6  20 f8         4976   4989 
    POP HL                              ;20c8  e1            4977   4990 
    POP DE                              ;20c9  d1            4978   4991 
    LD  (HL),E                          ;20ca  73            4979   4992 
    INC HL                              ;20cb  23            4980   4993 
    LD  (HL),D                          ;20cc  72            4981   4994 
    LD  L,C                             ;20cd  69            4982   4995 
    LD  H,B                             ;20ce  60            4983   4996 
    CALL    HLFTCH                      ;20cf  cd 87 29      4984   4997 
    INC HL                              ;20d2  23            4985   4998 
    CP  02Ch                            ;20d3  fe 2c         4986   4999 
    JP  Z,DIM                           ;20d5  ca 03 20      4987   5000 
    DEC HL                              ;20d8  2b            4988   5001 
    RET                                 ;20d9  c9            4989   5002 
                                        ;                    4990   5003 ;
OFF:    CALL    HLFTCH                  ;20da  cd 87 29      4991   5004 
    CP  09Ch                            ;20dd  fe 9c         4992   5005 
    JR  Z,BREAKL                        ;20df  28 0a         4993   5006 
    XOR A                               ;20e1  af            4994   5007 ;NUL CODE
    LD  (BREAKI),A                      ;20e2  32 be 06      4995   5008 
    LD  A,011h                          ;20e5  3e 11         4996   5009 ;LD DE,BREAK
OFFOFF: LD  (BREAKJ),A                  ;20e7  32 f7 14      4997   5010 
    RET                                 ;20ea  c9            4998   5011 
                                        ;                    4999   5012 ;
BREAKL: LD  A,3                         ;20eb  3e 03         5000   5013 ;BREAK CODE
    LD  (BREAKI),A                      ;20ed  32 be 06      5001   5014 
    LD  A,0CAh                          ;20f0  3e ca         5002   5015 ;JP Z,BREAK
    INC HL                              ;20f2  23            5003   5016 
    JR  OFFOFF                          ;20f3  18 f2         5004   5017 
                                        ;                    5005   5018 ;
SORERR: LD  A,9                         ;20f5  3e 09         5006   5019 
NIERRO: JP  ERROR                       ;20f7  c3 96 21      5007   5020 
                                        ;                    5008   5021 ;
NINS:   LD  A,29                        ;20fa  3e 1d         5009   5022 
    JR  NIERRO                          ;20fc  18 f9         5010   5023 
                                        ;                    5011   5024 ;
VSRTST: LD  HL,00000h                   ;20fe  21 00 00      5012   5025 
    CP  041h                            ;2101  fe 41         5013   5026 
    JP  C,SERROR                        ;2103  da 3a 17      5014   5027 
    CP  05Bh                            ;2106  fe 5b         5015   5028 
    JP  NC,SERROR                       ;2108  d2 3a 17      5016   5029 
    LD  L,A                             ;210b  6f            5017   5030 
    CALL    BCFTCH                      ;210c  cd c4 25      5018   5031 
    CALL    CHALNM                      ;210f  cd f5 1f      5019   5032 
    JR  C,CHKTYP                        ;2112  38 09         5020   5033 
    LD  H,A                             ;2114  67            5021   5034 
SKIPDM: CALL    BCFTCH                  ;2115  cd c4 25      5022   5035 
    CALL    CHALNM                      ;2118  cd f5 1f      5023   5036 
    JR  NC,SKIPDM                       ;211b  30 f8         5024   5037 
CHKTYP: CP  028h                        ;211d  fe 28         5025   5038 
    JR  NC,DFLTER                       ;211f  30 20         5026   5039 
    OR  A                               ;2121  b7            5027   5040 
    JP  Z,DFLTER                        ;2122  ca 41 21      5028   5041 
    CP  025h                            ;2125  fe 25         5029   5042 ;%
    LD  E,2                             ;2127  1e 02         5030   5043 
    JP  Z,BCFTCH                        ;2129  ca c4 25      5031   5044 
    CP  024h                            ;212c  fe 24         5032   5045 ;$
    LD  E,3                             ;212e  1e 03         5033   5046 
    JP  Z,BCFTCH                        ;2130  ca c4 25      5034   5047 
    CP  021h                            ;2133  fe 21         5035   5048 ;!
    LD  E,4                             ;2135  1e 04         5036   5049 
    JP  Z,BCFTCH                        ;2137  ca c4 25      5037   5050 
    CP  023h                            ;213a  fe 23         5038   5051 ;#
    LD  E,8                             ;213c  1e 08         5039   5052 
    JP  Z,BCFTCH                        ;213e  ca c4 25      5040   5053 
DFLTER: PUSH    HL                      ;2141  e5            5041   5054 
    LD  H,0                             ;2142  26 00         5042   5055 
    LD  DE,DFTABL-041H                  ;2144  11 47 30      5043   5056 
    ADD HL,DE                           ;2147  19            5044   5057 
    LD  E,(HL)                          ;2148  5e            5045   5058 
    POP HL                              ;2149  e1            5046   5059 
    RET                                 ;214a  c9            5047   5060 
                                        ;                    5048   5061 ;
IMUL:   PUSH    AF                      ;214b  f5            5049   5062 
    PUSH    BC                          ;214c  c5            5050   5063 
    LD  A,L                             ;214d  7d            5051   5064 
    LD  C,H                             ;214e  4c            5052   5065 
    LD  HL,00000h                       ;214f  21 00 00      5053   5066 
    LD  B,008h                          ;2152  06 08         5054   5067 
IMADL1: RRCA                            ;2154  0f            5055   5068 
    JR  NC,IMNADD                       ;2155  30 03         5056   5069 
    ADD HL,DE                           ;2157  19            5057   5070 
    JR  C,SORERR                        ;2158  38 9b         5058   5071 
IMNADD: RL  E                           ;215a  cb 13         5059   5072 
    RL  D                               ;215c  cb 12         5060   5073 
    DJNZ    IMADL1                      ;215e  10 f4         5061   5074 
    LD  A,C                             ;2160  79            5062   5075 
    OR  A                               ;2161  b7            5063   5076 
    JR  Z,IMRET                         ;2162  28 0e         5064   5077 
    LD  B,008h                          ;2164  06 08         5065   5078 
IMADL2: RRCA                            ;2166  0f            5066   5079 
    JR  NC,IMNAD1                       ;2167  30 03         5067   5080 
    ADD HL,DE                           ;2169  19            5068   5081 
    JR  C,SORERR                        ;216a  38 89         5069   5082 
IMNAD1: RL  E                           ;216c  cb 13         5070   5083 
    RL  D                               ;216e  cb 12         5071   5084 
    DJNZ    IMADL2                      ;2170  10 f4         5072   5085 
IMRET:  POP BC                          ;2172  c1            5073   5086 
    POP AF                              ;2173  f1            5074   5087 
    RET                                 ;2174  c9            5075   5088 
                                        ;                    5076   5089 ;
ERROPR: LD  A,2                         ;2175  3e 02         5077   5090 
    LD  (ERRORF),A                      ;2177  32 50 22      5078   5091 
    DEFB    021H                        ;217a  21            5079   5092 
CURTXT: DEFS    2                       ;217b                5080   5093 
    DEC HL                              ;217d  2b            5081   5094 
    LD  (RESTXT),HL                     ;217e  22 8a 22      5082   5095 
    POP AF                              ;2181  f1            5083   5096 
    DEFB    021H                        ;2182  21            5084   5097 
ERRORV: DEFS    2                       ;2183                5085   5098 
    JP  RUNMID                          ;2185  c3 0e 16      5086   5099 
                                        ;                    5087   5100 ;
OMERRE:                                 ;                    5088   5101 
OMERR:  CALL    CLR                     ;2188  cd 51 19      5089   5102 
    EI                                  ;218b  fb            5090   5103 
    LD  SP,(STRTOP)                     ;218c  ed 7b 41 7a   5091   5104 
    LD  (SPBUF),SP                      ;2190  ed 73 25 22   5092   5105 
    LD  A,7                             ;2194  3e 07         5093   5106 
ERROR:  LD  SP,(SPBUF)                  ;2196  ed 7b 25 22   5094   5107 
    PUSH    AF                          ;219a  f5            5095   5108 
    LD  HL,(LNOBUF)                     ;219b  2a cc 16      5096   5109 
    LD  A,H                             ;219e  7c            5097   5110 
    AND L                               ;219f  a5            5098   5111 
    INC A                               ;21a0  3c            5099   5112 
    JR  Z,ERRSML                        ;21a1  28 14         5100   5113 
    POP AF                              ;21a3  f1            5101   5114 
    LD  (ERRLNO),HL                     ;21a4  22 65 22      5102   5115 
    LD  (ERRCOD),A                      ;21a7  32 95 22      5103   5116 
    LD  HL,(NXTLPT)                     ;21aa  2a 12 16      5104   5117 
    LD  (ERNLPT),HL                     ;21ad  22 5f 22      5105   5118 
    PUSH    AF                          ;21b0  f5            5106   5119 
    LD  A,(ERRORF)                      ;21b1  3a 50 22      5107   5120 
    DEC A                               ;21b4  3d            5108   5121 
    JR  Z,ERROPR                        ;21b5  28 be         5109   5122 
ERRSML: CALL    CR2                     ;21b7  cd 23 08      5110   5123 
    LD  A,1                             ;21ba  3e 01         5111   5124 
    LD  (DISFLG),A                      ;21bc  32 eb 11      5112   5125 
    POP AF                              ;21bf  f1            5113   5126 
    OR  A                               ;21c0  b7            5114   5127 
    JR  Z,UNPERR                        ;21c1  28 14         5115   5128 
    CP  32                              ;21c3  fe 20         5116   5129 
    JR  NC,UNPERR                       ;21c5  30 10         5117   5130 
    LD  DE,ERRTXT                       ;21c7  11 b2 69      5118   5131 
    LD  B,A                             ;21ca  47            5119   5132 
ERRTCO: LD  A,(DE)                      ;21cb  1a            5120   5133 
    INC DE                              ;21cc  13            5121   5134 
    OR  A                               ;21cd  b7            5122   5135 
    JR  NZ,ERRTCO                       ;21ce  20 fb         5123   5136 
    DEC B                               ;21d0  05            5124   5137 
    JR  NZ,ERRTCO                       ;21d1  20 f8         5125   5138 
    LD  A,(DE)                          ;21d3  1a            5126   5139 
    INC A                               ;21d4  3c            5127   5140 
    JR  NZ,ERRLOP                       ;21d5  20 03         5128   5141 
UNPERR: LD  DE,UNPMES                   ;21d7  11 e5 21      5129   5142 
ERRLOP: LD  A,(DE)                      ;21da  1a            5130   5143 
    OR  A                               ;21db  b7            5131   5144 
    JP  Z,LNOPRT                        ;21dc  ca cb 16      5132   5145 
    CALL    ACCPRT                      ;21df  cd 64 08      5133   5146 
    INC DE                              ;21e2  13            5134   5147 
    JR  ERRLOP                          ;21e3  18 f5         5135   5148 
                                        ;                    5136   5149 
UNPMES: DEFM    'UNPRINTABLE ERROR'     ;21e5  55 4e 50 52   5137   5150 
                                        ;21e9  49 4e 54 41   5137   5151
                                        ;21ed  42 4c 45 20   5137   5152
                                        ;21f1  45 52 52 4f   5137   5153
                                        ;21f5  52            5137   5154
    DEFB    000H                        ;21f6  00            5138   5155 
                                        ;                    5139   5156 ;
OKMES:  DEFM    'OK'                    ;21f7  4f 4b         5140   5157 
                                        ;                    5141   5158 ;
SETSSP: LD  HL,00000h                   ;21f9  21 00 00      5142   5159 
    LD  (FUNCNS),HL                     ;21fc  22 2f 26      5143   5160 
    LD  HL,(INTFAC)                     ;21ff  2a 4b 7a      5144   5161 
    LD  IY,(INTSSP)                     ;2202  fd 2a 43 7a   5145   5162 
    RET                                 ;2206  c9            5146   5163 
                                        ;                    5147   5164 ;
CONT:   DEFB    03EH                    ;2207  3e            5148   5165 
CONTFG: DEFS    1                       ;2208                5149   5166 
    OR  A                               ;2209  b7            5150   5167 
    JR  NZ,OKCONT                       ;220a  20 05         5151   5168 
    LD  A,17                            ;220c  3e 11         5152   5169 
    JP  ERROR                           ;220e  c3 96 21      5153   5170 
                                        ;                    5154   5171 ;
OKCONT: XOR A                           ;2211  af            5155   5172 
    LD  (CONTFG),A                      ;2212  32 08 22      5156   5173 
    DEFB    021H                        ;2215  21            5157   5174 
BLNOBF: DEFS    2                       ;2216                5158   5175 
    LD  (LNOBUF),HL                     ;2218  22 cc 16      5159   5176 
    DEFB    021H                        ;221b  21            5160   5177 
BNXTLP: DEFS    2                       ;221c                5161   5178 
    LD  (NXTLPT),HL                     ;221e  22 12 16      5162   5179 
    DEFB    021H                        ;2221  21            5163   5180 
BTEXTP: DEFS    2                       ;2222                5164   5181 
    DEFB    031H                        ;2224  31            5165   5182 
SPBUF:  DEFS    2                       ;2225                5166   5183 
    JP  SPCCUT                          ;2227  c3 df 14      5167   5184 
                                        ;                    5168   5185 ;
AUTOFF: LD  A,(AUTOVC)                  ;222a  3a 37 22      5169   5186 
    OR  A                               ;222d  b7            5170   5187 
    RET NZ                              ;222e  c0            5171   5188 
    LD  A,0C9h                          ;222f  3e c9         5172   5189 
    LD  (AUTOVC),A                      ;2231  32 37 22      5173   5190 
    JP  HOTENT                          ;2234  c3 46 14      5174   5191 
                                        ;                    5175   5192 ;
AUTOVC: DEFB    0C9H                    ;2237  c9            5176   5193 
    DEFB    021H                        ;2238  21            5177   5194 
AUTOLN: DEFS    2                       ;2239                5178   5195 
    CALL    FIVEPR                      ;223b  cd e5 16      5179   5196 
    CALL    SPPRT                       ;223e  cd 62 08      5180   5197 
    LD  HL,(AUTOLN)                     ;2241  2a 39 22      5181   5198 
    DEFB    011H                        ;2244  11            5182   5199 ;LD DE,?
AUTOST: DEFS    2                       ;2245                5183   5200 
    ADD HL,DE                           ;2247  19            5184   5201 
    LD  (AUTOLN),HL                     ;2248  22 39 22      5185   5202 
    JP  C,AUTOFF                        ;224b  da 2a 22      5186   5203 
    RET                                 ;224e  c9            5187   5204 
                                        ;                    5188   5205 ;
RESUME: DEFB    03EH                    ;224f  3e            5189   5206 
ERRORF: DEFS    1                       ;2250                5190   5207 
    CP  2                               ;2251  fe 02         5191   5208 
    LD  A,20                            ;2253  3e 14         5192   5209 
    JP  NZ,ERROR                        ;2255  c2 96 21      5193   5210 
    LD  A,1                             ;2258  3e 01         5194   5211 
    LD  (ERRORF),A                      ;225a  32 50 22      5195   5212 
    PUSH    HL                          ;225d  e5            5196   5213 
    DEFB    021H                        ;225e  21            5197   5214 ; LD HL,?
ERNLPT: DEFS    2                       ;225f                5198   5215 
    LD  (NXTLPT),HL                     ;2261  22 12 16      5199   5216 
    DEFB    021H                        ;2264  21            5200   5217 ; LD HL,?
ERRLNO: DEFS    2                       ;2265                5201   5218 
    LD  (LNOBUF),HL                     ;2267  22 cc 16      5202   5219 
    POP HL                              ;226a  e1            5203   5220 
    CALL    HLFTCH                      ;226b  cd 87 29      5204   5221 
    CP  03Ah                            ;226e  fe 3a         5205   5222 
    JR  Z,THISLN                        ;2270  28 17         5206   5223 
    OR  A                               ;2272  b7            5207   5224 
    JR  Z,THISLN                        ;2273  28 14         5208   5225 
    CP  0B5h                            ;2275  fe b5         5209   5226 
    JR  Z,RESERR                        ;2277  28 14         5210   5227 
    CP  08Bh                            ;2279  fe 8b         5211   5228 
    JP  NZ,GOTO                         ;227b  c2 b1 43      5212   5229 
    LD  HL,(RESTXT)                     ;227e  2a 8a 22      5213   5230 
    CALL    DATA                        ;2281  cd c8 1c      5214   5231 
    RET NC                              ;2284  d0            5215   5232 
    POP HL                              ;2285  e1            5216   5233 
    JP  NXLINE                          ;2286  c3 11 16      5217   5234 
                                        ;                    5218   5235 ;
THISLN:                                 ;                    5219   5236 
    DEFB    021H                        ;2289  21            5220   5237 
RESTXT: DEFS    2                       ;228a                5221   5238 
    RET                                 ;228c  c9            5222   5239 
                                        ;                    5223   5240 ;
RESERR: XOR A                           ;228d  af            5224   5241 
    LD  (ERRORF),A                      ;228e  32 50 22      5225   5242 
    CALL    THISLN                      ;2291  cd 89 22      5226   5243 
    DEFB    03EH                        ;2294  3e            5227   5244 
ERRCOD: DEFS    1                       ;2295                5228   5245 
    JP  ERROR                           ;2296  c3 96 21      5229   5246 
                                        ;                    5230   5247 ;
                                        ;                    5231   5248 ;	CHAIN	,EXPR
FLEXPR: CALL    SETSSP                  ;2299  cd f9 21      5232   5249 
FLEXP': LD  (IY+0),0                    ;229c  fd 36 00 00   5233   5250 
    CALL    EXPRSN                      ;22a0  cd f2 22      5234   5251 
    PUSH    AF                          ;22a3  f5            5235   5252 
    LD  A,(IY+0)                        ;22a4  fd 7e 00      5236   5253 
    CP  003h                            ;22a7  fe 03         5237   5254 
    JP  Z,TYPEMS                        ;22a9  ca 32 17      5238   5255 
MOTEST: OR  A                           ;22ac  b7            5239   5256 
    JP  Z,MOPRND                        ;22ad  ca bf 25      5240   5257 
    POP AF                              ;22b0  f1            5241   5258 
    RET                                 ;22b1  c9            5242   5259 
                                        ;                    5243   5260 ;
STEXPR: CALL    SETSSP                  ;22b2  cd f9 21      5244   5261 
STEXP': LD  (IY+0),0                    ;22b5  fd 36 00 00   5245   5262 
    CALL    EXPRSN                      ;22b9  cd f2 22      5246   5263 
    PUSH    AF                          ;22bc  f5            5247   5264 
    LD  A,(IY+0)                        ;22bd  fd 7e 00      5248   5265 
    CP  003h                            ;22c0  fe 03         5249   5266 
    JP  NZ,TYPEMS                       ;22c2  c2 32 17      5250   5267 
    JR  MOTEST                          ;22c5  18 e5         5251   5268 
                                        ;                    5252   5269 ;
HLEXP:  CALL    FLEXP'                  ;22c7  cd 9c 22      5253   5270 
    JR  MDLHLE                          ;22ca  18 03         5254   5271 
                                        ;                    5255   5272 ;
IHLEXP: CALL    FLEXPR                  ;22cc  cd 99 22      5256   5273 
MDLHLE: PUSH    AF                      ;22cf  f5            5257   5274 
    CALL    HLFLTO                      ;22d0  cd 97 2d      5258   5275 
    POP AF                              ;22d3  f1            5259   5276 
    RET                                 ;22d4  c9            5260   5277 
                                        ;                    5261   5278 ;
BYTE:   CALL    HLEXP                   ;22d5  cd c7 22      5262   5279 
HCHECK: LD  A,H                         ;22d8  7c            5263   5280 
    OR  A                               ;22d9  b7            5264   5281 
    LD  A,L                             ;22da  7d            5265   5282 
    RET Z                               ;22db  c8            5266   5283 
    JP  IFCALL                          ;22dc  c3 36 17      5267   5284 
                                        ;                    5268   5285 ;
IBYTE:  CALL    IHLEXP                  ;22df  cd cc 22      5269   5286 
    JR  HCHECK                          ;22e2  18 f4         5270   5287 
                                        ;                    5271   5288 ;
TYPECS: LD  A,(IY+0)                    ;22e4  fd 7e 00      5272   5289 
    CP  003h                            ;22e7  fe 03         5273   5290 
    RET NZ                              ;22e9  c0            5274   5291 
    JP  TYPEMS                          ;22ea  c3 32 17      5275   5292 
                                        ;                    5276   5293 ;
TOOCMP: LD  A,16                        ;22ed  3e 10         5277   5294 
    JP  ERROR                           ;22ef  c3 96 21      5278   5295 
                                        ;                    5279   5296 ;
EXPRSN: EX  DE,HL                       ;22f2  eb            5280   5297 
    DEFB    021H                        ;22f3  21            5281   5298 
MEMFAC: DEFS    2                       ;22f4                5282   5299 
    OR  A                               ;22f6  b7            5283   5300 
    SBC HL,DE                           ;22f7  ed 52         5284   5301 
    EX  DE,HL                           ;22f9  eb            5285   5302 
    JR  C,TOOCMP                        ;22fa  38 f1         5286   5303 
    CALL    EXPPH3                      ;22fc  cd 26 23      5287   5304 
XORAGN: CP  0EBh                        ;22ff  fe eb         5288   5305 
    RET NZ                              ;2301  c0            5289   5306 
    CALL    TYPECS                      ;2302  cd e4 22      5290   5307 
    PUSH    HL                          ;2305  e5            5291   5308 
    LD  (IY+0),0                        ;2306  fd 36 00 00   5292   5309 
    CALL    EXPPH3                      ;230a  cd 26 23      5293   5310 
    PUSH    AF                          ;230d  f5            5294   5311 
    CALL    HLFLTO                      ;230e  cd 97 2d      5295   5312 
    POP AF                              ;2311  f1            5296   5313 
    EX  DE,HL                           ;2312  eb            5297   5314 
    POP HL                              ;2313  e1            5298   5315 
    PUSH    AF                          ;2314  f5            5299   5316 
    PUSH    HL                          ;2315  e5            5300   5317 
    CALL    HLFLTO                      ;2316  cd 97 2d      5301   5318 
    LD  A,H                             ;2319  7c            5302   5319 
    XOR D                               ;231a  aa            5303   5320 
    LD  D,A                             ;231b  57            5304   5321 
    LD  A,L                             ;231c  7d            5305   5322 
    XOR E                               ;231d  ab            5306   5323 
    LD  E,A                             ;231e  5f            5307   5324 
    POP HL                              ;231f  e1            5308   5325 
    CALL    FLTHEX                      ;2320  cd 02 29      5309   5326 
    POP AF                              ;2323  f1            5310   5327 
    JR  XORAGN                          ;2324  18 d9         5311   5328 
                                        ;                    5312   5329 ;
EXPPH3: CALL    EXPPH4                  ;2326  cd 50 23      5313   5330 
ORAGN:  CP  0ECh                        ;2329  fe ec         5314   5331 
    RET NZ                              ;232b  c0            5315   5332 
    CALL    TYPECS                      ;232c  cd e4 22      5316   5333 
    PUSH    HL                          ;232f  e5            5317   5334 
    LD  (IY+0),0                        ;2330  fd 36 00 00   5318   5335 
    CALL    EXPPH4                      ;2334  cd 50 23      5319   5336 
    PUSH    AF                          ;2337  f5            5320   5337 
    CALL    HLFLTO                      ;2338  cd 97 2d      5321   5338 
    POP AF                              ;233b  f1            5322   5339 
    EX  DE,HL                           ;233c  eb            5323   5340 
    POP HL                              ;233d  e1            5324   5341 
    PUSH    AF                          ;233e  f5            5325   5342 
    PUSH    HL                          ;233f  e5            5326   5343 
    CALL    HLFLTO                      ;2340  cd 97 2d      5327   5344 
    LD  A,H                             ;2343  7c            5328   5345 
    OR  D                               ;2344  b2            5329   5346 
    LD  D,A                             ;2345  57            5330   5347 
    LD  A,L                             ;2346  7d            5331   5348 
    OR  E                               ;2347  b3            5332   5349 
    LD  E,A                             ;2348  5f            5333   5350 
    POP HL                              ;2349  e1            5334   5351 
    CALL    FLTHEX                      ;234a  cd 02 29      5335   5352 
    POP AF                              ;234d  f1            5336   5353 
    JR  ORAGN                           ;234e  18 d9         5337   5354 
                                        ;                    5338   5355 ;
EXPPH4: CALL    EXPPH5                  ;2350  cd 7b 23      5339   5356 
ANDAGN: CP  0EDh                        ;2353  fe ed         5340   5357 
    RET NZ                              ;2355  c0            5341   5358 
    CALL    TYPECS                      ;2356  cd e4 22      5342   5359 
    PUSH    HL                          ;2359  e5            5343   5360 
    LD  (IY+0),0                        ;235a  fd 36 00 00   5344   5361 
    CALL    EXPPH5                      ;235e  cd 7b 23      5345   5362 
    PUSH    AF                          ;2361  f5            5346   5363 
    CALL    HLFLTO                      ;2362  cd 97 2d      5347   5364 
    POP AF                              ;2365  f1            5348   5365 
    EX  DE,HL                           ;2366  eb            5349   5366 
    POP HL                              ;2367  e1            5350   5367 
    PUSH    AF                          ;2368  f5            5351   5368 
    PUSH    HL                          ;2369  e5            5352   5369 
    CALL    HLFLTO                      ;236a  cd 97 2d      5353   5370 
    LD  A,H                             ;236d  7c            5354   5371 
    AND D                               ;236e  a2            5355   5372 
    LD  D,A                             ;236f  57            5356   5373 
    LD  A,L                             ;2370  7d            5357   5374 
    AND E                               ;2371  a3            5358   5375 
    LD  E,A                             ;2372  5f            5359   5376 
    POP HL                              ;2373  e1            5360   5377 
    CALL    FLTHEX                      ;2374  cd 02 29      5361   5378 
    POP AF                              ;2377  f1            5362   5379 
    JP  ANDAGN                          ;2378  c3 53 23      5363   5380 
                                        ;                    5364   5381 ;
EXPPH5: CALL    BCFTCH                  ;237b  cd c4 25      5365   5382 
    DEC BC                              ;237e  0b            5366   5383 
    CP  0EEh                            ;237f  fe ee         5367   5384 
    JP  NZ,EXPPH6                       ;2381  c2 9d 23      5368   5385 
    INC BC                              ;2384  03            5369   5386 
    CALL    EXPPH6                      ;2385  cd 9d 23      5370   5387 
    PUSH    AF                          ;2388  f5            5371   5388 
    CALL    TYPECS                      ;2389  cd e4 22      5372   5389 
    PUSH    HL                          ;238c  e5            5373   5390 
    CALL    HLFLTO                      ;238d  cd 97 2d      5374   5391 
    LD  A,L                             ;2390  7d            5375   5392 
    CPL                                 ;2391  2f            5376   5393 
    LD  L,A                             ;2392  6f            5377   5394 
    LD  A,H                             ;2393  7c            5378   5395 
    CPL                                 ;2394  2f            5379   5396 
    LD  H,A                             ;2395  67            5380   5397 
    EX  DE,HL                           ;2396  eb            5381   5398 
    POP HL                              ;2397  e1            5382   5399 
    CALL    FLTHEX                      ;2398  cd 02 29      5383   5400 
    POP AF                              ;239b  f1            5384   5401 
    RET                                 ;239c  c9            5385   5402 
                                        ;                    5386   5403 ;
EXPPH6: CALL    EXPR1                   ;239d  cd 0e 24      5387   5404 
LOGLP:  CP  0EFh                        ;23a0  fe ef         5388   5405 
    RET C                               ;23a2  d8            5389   5406 
    PUSH    AF                          ;23a3  f5            5390   5407 
    PUSH    HL                          ;23a4  e5            5391   5408 
    CALL    EXPR1                       ;23a5  cd 0e 24      5392   5409 
    EX  DE,HL                           ;23a8  eb            5393   5410 
    POP HL                              ;23a9  e1            5394   5411 
    EX  AF,AF'                          ;23aa  08            5395   5412 
    POP AF                              ;23ab  f1            5396   5413 
    EX  AF,AF'                          ;23ac  08            5397   5414 
    PUSH    AF                          ;23ad  f5            5398   5415 
    EX  AF,AF'                          ;23ae  08            5399   5416 
    CP  0F6h                            ;23af  fe f6         5400   5417 
    JR  C,EQUALG                        ;23b1  38 2d         5401   5418 
    JR  Z,GTTHAN                        ;23b3  28 22         5402   5419 
    CALL    CMP                         ;23b5  cd d6 61      5403   5420 
LDGTCM: JR  Z,FALSE                     ;23b8  28 12         5404   5421 
    JR  NC,FALSE                        ;23ba  30 10         5405   5422 
TRUE:   PUSH    DE                      ;23bc  d5            5406   5423 
    PUSH    HL                          ;23bd  e5            5407   5424 
    PUSH    BC                          ;23be  c5            5408   5425 
    EX  DE,HL                           ;23bf  eb            5409   5426 
    CALL    LDIR1                       ;23c0  cd a3 73      5410   5427 
    POP BC                              ;23c3  c1            5411   5428 
    POP HL                              ;23c4  e1            5412   5429 
    CALL    TOGLE                       ;23c5  cd eb 6b      5413   5430 
    POP DE                              ;23c8  d1            5414   5431 
LGBACK: POP AF                          ;23c9  f1            5415   5432 
    JR  LOGLP                           ;23ca  18 d4         5416   5433 
                                        ;                    5417   5434 ;
FALSE:  PUSH    BC                      ;23cc  c5            5418   5435 
    LD  B,8                             ;23cd  06 08         5419   5436 
    EX  DE,HL                           ;23cf  eb            5420   5437 
    CALL    ZFILL                       ;23d0  cd 10 62      5421   5438 
    POP BC                              ;23d3  c1            5422   5439 
    EX  DE,HL                           ;23d4  eb            5423   5440 
    JR  LGBACK                          ;23d5  18 f2         5424   5441 
                                        ;                    5425   5442 ;
GTTHAN: CALL    CMP                     ;23d7  cd d6 61      5426   5443 
    CCF                                 ;23da  3f            5427   5444 
    JR  LDGTCM                          ;23db  18 db         5428   5445 
                                        ;                    5429   5446 ;
PORTRU: POP AF                          ;23dd  f1            5430   5447 
    JR  TRUE                            ;23de  18 dc         5431   5448 
                                        ;                    5432   5449 ;
EQUALG: CP  0F5h                        ;23e0  fe f5         5433   5450 
    JR  C,ALGLOG                        ;23e2  38 07         5434   5451 
    CALL    CMP                         ;23e4  cd d6 61      5435   5452 
    JR  Z,TRUE                          ;23e7  28 d3         5436   5453 
    JR  FALSE                           ;23e9  18 e1         5437   5454 
                                        ;                    5438   5455 ;
ALGLOG: CP  0F1h                        ;23eb  fe f1         5439   5456 
    JP  C,NOTEQU                        ;23ed  da 07 24      5440   5457 
    PUSH    AF                          ;23f0  f5            5441   5458 
    CALL    CMP                         ;23f1  cd d6 61      5442   5459 
    JR  Z,PORTRU                        ;23f4  28 e7         5443   5460 
    EX  AF,AF'                          ;23f6  08            5444   5461 
    POP AF                              ;23f7  f1            5445   5462 
    CP  0F2h                            ;23f8  fe f2         5446   5463 
    JR  Z,GTEQLG                        ;23fa  28 07         5447   5464 
    CP  0F4h                            ;23fc  fe f4         5448   5465 
    JR  Z,GTEQLG                        ;23fe  28 03         5449   5466 
    EX  AF,AF'                          ;2400  08            5450   5467 
    JR  LDGTCM                          ;2401  18 b5         5451   5468 
GTEQLG: EX  AF,AF'                      ;2403  08            5452   5469 
    CCF                                 ;2404  3f            5453   5470 
    JR  LDGTCM                          ;2405  18 b1         5454   5471 
                                        ;                    5455   5472 ;
NOTEQU: CALL    CMP                     ;2407  cd d6 61      5456   5473 
    JR  Z,FALSE                         ;240a  28 c0         5457   5474 
    JR  TRUE                            ;240c  18 ae         5458   5475 
                                        ;                    5459   5476 ;
EXPR1:  CALL    TERM                    ;240e  cd 33 24      5460   5477 
EXPR':  CP  0F8h                        ;2411  fe f8         5461   5478 
    RET C                               ;2413  d8            5462   5479 
    PUSH    HL                          ;2414  e5            5463   5480 
    JR  Z,EXADD                         ;2415  28 0f         5464   5481 
    CALL    TERM                        ;2417  cd 33 24      5465   5482 
    EX  DE,HL                           ;241a  eb            5466   5483 
    POP HL                              ;241b  e1            5467   5484 
    PUSH    BC                          ;241c  c5            5468   5485 
EXPRBK: PUSH    AF                      ;241d  f5            5469   5486 
    CALL    SUB                         ;241e  cd d1 6b      5470   5487 
EXPRBK1:                                ;                    5471   5488 
    POP AF                              ;2421  f1            5472   5489 
    POP BC                              ;2422  c1            5473   5490 
    JP  EXPR'                           ;2423  c3 11 24      5474   5491 
                                        ;                    5475   5492 ;
EXADD:  CALL    TERM                    ;2426  cd 33 24      5476   5493 
    EX  DE,HL                           ;2429  eb            5477   5494 
    POP HL                              ;242a  e1            5478   5495 
    PUSH    BC                          ;242b  c5            5479   5496 
    PUSH    AF                          ;242c  f5            5480   5497 
    CALL    ADD                         ;242d  cd a6 6c      5481   5498 
    JP  EXPRBK1                         ;2430  c3 21 24      5482   5499 
                                        ;                    5483   5500 ;
TERM:   CALL    MFACT                   ;2433  cd 5b 24      5484   5501 
TERM':  CP  0FAh                        ;2436  fe fa         5485   5502 ; /
    RET C                               ;2438  d8            5486   5503 
    PUSH    HL                          ;2439  e5            5487   5504 
    JR  NZ,TMDIV                        ;243a  20 0f         5488   5505 
    CALL    MFACT                       ;243c  cd 5b 24      5489   5506 
    EX  DE,HL                           ;243f  eb            5490   5507 
    POP HL                              ;2440  e1            5491   5508 
    PUSH    BC                          ;2441  c5            5492   5509 
    PUSH    AF                          ;2442  f5            5493   5510 
    CALL    MOD                         ;2443  cd 4f 61      5494   5511 
TERMBK: POP AF                          ;2446  f1            5495   5512 
    POP BC                              ;2447  c1            5496   5513 
    JP  TERM'                           ;2448  c3 36 24      5497   5514 
                                        ;                    5498   5515 ;
TMDIV:  CALL    MFACT                   ;244b  cd 5b 24      5499   5516 
    EX  DE,HL                           ;244e  eb            5500   5517 
    POP HL                              ;244f  e1            5501   5518 
    PUSH    BC                          ;2450  c5            5502   5519 
    PUSH    AF                          ;2451  f5            5503   5520 
    CALL    DIV                         ;2452  cd bd 70      5504   5521 
    CALL    INT                         ;2455  cd 10 60      5505   5522 
    JP  TERMBK                          ;2458  c3 46 24      5506   5523 
                                        ;                    5507   5524 ;
MFACT:  CALL    FACT                    ;245b  cd 8f 24      5508   5525 
MFACT': CP  0FCh                        ;245e  fe fc         5509   5526 ; MOD
    RET C                               ;2460  d8            5510   5527 
    PUSH    HL                          ;2461  e5            5511   5528 
    JR  Z,TMMOD                         ;2462  28 0f         5512   5529 
    CALL    FACT                        ;2464  cd 8f 24      5513   5530 
    EX  DE,HL                           ;2467  eb            5514   5531 
    POP HL                              ;2468  e1            5515   5532 
    PUSH    BC                          ;2469  c5            5516   5533 
    PUSH    AF                          ;246a  f5            5517   5534 
    CALL    MUL                         ;246b  cd e0 6f      5518   5535 
MFACBK: POP AF                          ;246e  f1            5519   5536 
    POP BC                              ;246f  c1            5520   5537 
    JP  MFACT'                          ;2470  c3 5e 24      5521   5538 
                                        ;                    5522   5539 ;
TMMOD:  CALL    FACT                    ;2473  cd 8f 24      5523   5540 
    EX  DE,HL                           ;2476  eb            5524   5541 
    POP HL                              ;2477  e1            5525   5542 
    PUSH    BC                          ;2478  c5            5526   5543 
    PUSH    AF                          ;2479  f5            5527   5544 
    CALL    DIV                         ;247a  cd bd 70      5528   5545 
    JP  MFACBK                          ;247d  c3 6e 24      5529   5546 
                                        ;                    5530   5547 ;
POWZRR: POP HL                          ;2480  e1            5531   5548 
    PUSH    HL                          ;2481  e5            5532   5549 
    EX  DE,HL                           ;2482  eb            5533   5550 
    PUSH    BC                          ;2483  c5            5534   5551 
    CALL    LDIR1                       ;2484  cd a3 73      5535   5552 
    POP BC                              ;2487  c1            5536   5553 
    POP HL                              ;2488  e1            5537   5554 
POWAGN: DEC BC                          ;2489  0b            5538   5555 
    CALL    BCFTCH                      ;248a  cd c4 25      5539   5556 
    JR  MIDFAP                          ;248d  18 03         5540   5557 
                                        ;                    5541   5558 ;
FACT:   CALL    FACT''                  ;248f  cd 5f 25      5542   5559 
MIDFAP: CP  0FEh                        ;2492  fe fe         5543   5560 
    RET NZ                              ;2494  c0            5544   5561 
    PUSH    HL                          ;2495  e5            5545   5562 
    CALL    FACT''                      ;2496  cd 5f 25      5546   5563 
    LD  A,(HL)                          ;2499  7e            5547   5564 
    OR  A                               ;249a  b7            5548   5565 
    JR  Z,POWZRR                        ;249b  28 e3         5549   5566 
    INC HL                              ;249d  23            5550   5567 
    BIT 7,(HL)                          ;249e  cb 7e         5551   5568 
    RES 7,(HL)                          ;24a0  cb be         5552   5569 
    DEC HL                              ;24a2  2b            5553   5570 
    JR  NZ,MPOWER                       ;24a3  20 07         5554   5571 
    EX  DE,HL                           ;24a5  eb            5555   5572 
    POP HL                              ;24a6  e1            5556   5573 
    CALL    POWER                       ;24a7  cd c6 24      5557   5574 
    JR  POWAGN                          ;24aa  18 dd         5558   5575 
                                        ;                    5559   5576 ;
MPOWER: EX  DE,HL                       ;24ac  eb            5560   5577 
    POP HL                              ;24ad  e1            5561   5578 
    PUSH    HL                          ;24ae  e5            5562   5579 
    PUSH    DE                          ;24af  d5            5563   5580 
    CALL    POWER                       ;24b0  cd c6 24      5564   5581 
    POP DE                              ;24b3  d1            5565   5582 
    PUSH    DE                          ;24b4  d5            5566   5583 
    PUSH    BC                          ;24b5  c5            5567   5584 
    CALL    LDIR1                       ;24b6  cd a3 73      5568   5585 
    POP BC                              ;24b9  c1            5569   5586 
    POP DE                              ;24ba  d1            5570   5587 
    POP HL                              ;24bb  e1            5571   5588 
    CALL    PSWAP                       ;24bc  cd 42 25      5572   5589 
    PUSH    BC                          ;24bf  c5            5573   5590 
    CALL    DIV                         ;24c0  cd bd 70      5574   5591 
    POP BC                              ;24c3  c1            5575   5592 
    JR  POWAGN                          ;24c4  18 c3         5576   5593 
                                        ;                    5577   5594 ;
POWER:  PUSH    BC                      ;24c6  c5            5578   5595 
    PUSH    HL                          ;24c7  e5            5579   5596 
    PUSH    DE                          ;24c8  d5            5580   5597 
    LD  HL,8                            ;24c9  21 08 00      5581   5598 
    ADD HL,DE                           ;24cc  19            5582   5599 
    EX  DE,HL                           ;24cd  eb            5583   5600 
    PUSH    DE                          ;24ce  d5            5584   5601 
    CALL    LDIR8                       ;24cf  cd a6 73      5585   5602 
    POP HL                              ;24d2  e1            5586   5603 
    CALL    INT                         ;24d3  cd 10 60      5587   5604 
    EX  DE,HL                           ;24d6  eb            5588   5605 
    POP HL                              ;24d7  e1            5589   5606 
    CALL    CMP                         ;24d8  cd d6 61      5590   5607 
    JR  Z,IPOWER                        ;24db  28 12         5591   5608 
RPOWER: POP DE                          ;24dd  d1            5592   5609 
    PUSH    DE                          ;24de  d5            5593   5610 
    CALL    PSWAP                       ;24df  cd 42 25      5594   5611 
    CALL    B_LOG                       ;24e2  cd bd 78      5595   5612 
    EX  DE,HL                           ;24e5  eb            5596   5613 
    POP HL                              ;24e6  e1            5597   5614 
    CALL    MUL                         ;24e7  cd e0 6f      5598   5615 
    CALL    B_EXP                       ;24ea  cd ca 77      5599   5616 
    POP BC                              ;24ed  c1            5600   5617 
    RET                                 ;24ee  c9            5601   5618 
                                        ;                    5602   5619 
IPOWER: LD  A,(HL)                      ;24ef  7e            5603   5620 
    CP  086h                            ;24f0  fe 86         5604   5621 
    JR  NC,RPOWER                       ;24f2  30 e9         5605   5622 
    EX  (SP),HL                         ;24f4  e3            5606   5623 
    LD  A,(HL)                          ;24f5  7e            5607   5624 
    EX  (SP),HL                         ;24f6  e3            5608   5625 
    CP  088h                            ;24f7  fe 88         5609   5626 
    JR  NC,RPOWER                       ;24f9  30 e2         5610   5627 
    CALL    HLFLTO                      ;24fb  cd 97 2d      5611   5628 ; 0 END
    LD  A,L                             ;24fe  7d            5612   5629 
    POP HL                              ;24ff  e1            5613   5630 
    PUSH    AF                          ;2500  f5            5614   5631 ; BIT-P
    PUSH    HL                          ;2501  e5            5615   5632 ; FAC
    LD  DE,KEYBUF                       ;2502  11 4f 7a      5616   5633 
    PUSH    DE                          ;2505  d5            5617   5634 
    CALL    LDIR8                       ;2506  cd a6 73      5618   5635 
    POP HL                              ;2509  e1            5619   5636 ;ZFAC
    LD  B,4                             ;250a  06 04         5620   5637 ;RCOUNT
PWCLLP: PUSH    BC                      ;250c  c5            5621   5638 
    EX  DE,HL                           ;250d  eb            5622   5639 
    LD  HL,00008h                       ;250e  21 08 00      5623   5640 
    ADD HL,DE                           ;2511  19            5624   5641 
    EX  DE,HL                           ;2512  eb            5625   5642 
    CALL    LDIR8                       ;2513  cd a6 73      5626   5643 
    LD  E,L                             ;2516  5d            5627   5644 
    LD  D,H                             ;2517  54            5628   5645 
    CALL    MUL                         ;2518  cd e0 6f      5629   5646 
    POP BC                              ;251b  c1            5630   5647 
    DJNZ    PWCLLP                      ;251c  10 ee         5631   5648 
    POP HL                              ;251e  e1            5632   5649 
    PUSH    HL                          ;251f  e5            5633   5650 
    EX  DE,HL                           ;2520  eb            5634   5651 
    CALL    LDIR1                       ;2521  cd a3 73      5635   5652 
    POP HL                              ;2524  e1            5636   5653 
    POP AF                              ;2525  f1            5637   5654 
    LD  DE,KEYBUF                       ;2526  11 4f 7a      5638   5655 
    LD  B,5                             ;2529  06 05         5639   5656 
PWCLL1: RRCA                            ;252b  0f            5640   5657 
    JR  NC,NEXTPL                       ;252c  30 09         5641   5658 
    PUSH    AF                          ;252e  f5            5642   5659 
    PUSH    BC                          ;252f  c5            5643   5660 
    PUSH    DE                          ;2530  d5            5644   5661 
    CALL    MUL                         ;2531  cd e0 6f      5645   5662 
    POP DE                              ;2534  d1            5646   5663 
    POP BC                              ;2535  c1            5647   5664 
    POP AF                              ;2536  f1            5648   5665 
NEXTPL: PUSH    HL                      ;2537  e5            5649   5666 
    LD  HL,8                            ;2538  21 08 00      5650   5667 
    ADD HL,DE                           ;253b  19            5651   5668 
    EX  DE,HL                           ;253c  eb            5652   5669 
    POP HL                              ;253d  e1            5653   5670 
    DJNZ    PWCLL1                      ;253e  10 eb         5654   5671 
    POP BC                              ;2540  c1            5655   5672 
    RET                                 ;2541  c9            5656   5673 
                                        ;                    5657   5674 ;
PSWAP:  PUSH    BC                      ;2542  c5            5658   5675 
    PUSH    HL                          ;2543  e5            5659   5676 
    PUSH    DE                          ;2544  d5            5660   5677 
    EX  DE,HL                           ;2545  eb            5661   5678 
    LD  DE,ZFAC                         ;2546  11 f2 62      5662   5679 
    CALL    LDIR8                       ;2549  cd a6 73      5663   5680 
    POP DE                              ;254c  d1            5664   5681 
    POP HL                              ;254d  e1            5665   5682 
    PUSH    DE                          ;254e  d5            5666   5683 
    PUSH    HL                          ;254f  e5            5667   5684 
    CALL    LDIR8                       ;2550  cd a6 73      5668   5685 
    POP DE                              ;2553  d1            5669   5686 
    PUSH    DE                          ;2554  d5            5670   5687 
    LD  HL,ZFAC                         ;2555  21 f2 62      5671   5688 
    CALL    LDIR8                       ;2558  cd a6 73      5672   5689 
    POP HL                              ;255b  e1            5673   5690 
    POP DE                              ;255c  d1            5674   5691 
    POP BC                              ;255d  c1            5675   5692 
    RET                                 ;255e  c9            5676   5693 
:                                       ;                    5677   5694 
FACT'': CALL    BCFTCH                  ;255f  cd c4 25      5678   5695 
    CP  020h                            ;2562  fe 20         5679   5696 
    JP  C,CONST                         ;2564  da cc 25      5680   5697 
    CP  0F8h                            ;2567  fe f8         5681   5698 
    JR  Z,FACT''                        ;2569  28 f4         5682   5699 
    CP  0F9h                            ;256b  fe f9         5683   5700 
    JP  Z,INUSE                         ;256d  ca 85 25      5684   5701 
    CP  041h                            ;2570  fe 41         5685   5702 
    JP  NC,VARFUN                       ;2572  d2 24 26      5686   5703 
    CP  028h                            ;2575  fe 28         5687   5704 
    JR  Z,KAKKO                         ;2577  28 1d         5688   5705 
    CP  029h                            ;2579  fe 29         5689   5706 
    JP  Z,SERROR                        ;257b  ca 3a 17      5690   5707 
    CP  022h                            ;257e  fe 22         5691   5708 
    JP  Z,STRFAC                        ;2580  ca b5 28      5692   5709 
    JR  MOCHCK                          ;2583  18 32         5693   5710 
                                        ;                    5694   5711 ;
INUSE:  CALL    FACT''                  ;2585  cd 5f 25      5695   5712 
    PUSH    AF                          ;2588  f5            5696   5713 
    LD  A,(IY+0)                        ;2589  fd 7e 00      5697   5714 
    CP  003h                            ;258c  fe 03         5698   5715 
    JP  Z,TYPEMS                        ;258e  ca 32 17      5699   5716 
    CALL    TOGLE                       ;2591  cd eb 6b      5700   5717 
    POP AF                              ;2594  f1            5701   5718 
    RET                                 ;2595  c9            5702   5719 
                                        ;                    5703   5720 ;
KAKKO:  DEC IY                          ;2596  fd 2b         5704   5721 
    LD  (IY+0),0                        ;2598  fd 36 00 00   5705   5722 
    CALL    EXPRSN                      ;259c  cd f2 22      5706   5723 
    CALL    CH29H                       ;259f  cd 66 2d      5707   5724 
    LD  A,(IY+0)                        ;25a2  fd 7e 00      5708   5725 
    INC IY                              ;25a5  fd 23         5709   5726 
    CP  003h                            ;25a7  fe 03         5710   5727 
    JR  Z,CONDSB                        ;25a9  28 06         5711   5728 
    CALL    CONDFL                      ;25ab  cd eb 28      5712   5729 
    JP  BCFTCH                          ;25ae  c3 c4 25      5713   5730 
                                        ;                    5714   5731 ;
CONDSB: CALL    CONDSR                  ;25b1  cd d9 28      5715   5732 
    JP  BCFTCH                          ;25b4  c3 c4 25      5716   5733 
                                        ;                    5717   5734 ;
MOCHCK: LD  D,A                         ;25b7  57            5718   5735 
    XOR A                               ;25b8  af            5719   5736 
    CP  (IY+0)                          ;25b9  fd be 00      5720   5737 
    LD  A,D                             ;25bc  7a            5721   5738 
    DEC BC                              ;25bd  0b            5722   5739 
    RET Z                               ;25be  c8            5723   5740 
MOPRND: LD  A,22                        ;25bf  3e 16         5724   5741 
    JP  ERROR                           ;25c1  c3 96 21      5725   5742 
                                        ;                    5726   5743 ;
BCFTCH: LD  A,(BC)                      ;25c4  0a            5727   5744 
    INC BC                              ;25c5  03            5728   5745 
    CP  020h                            ;25c6  fe 20         5729   5746 
    RET NZ                              ;25c8  c0            5730   5747 
    JP  BCFTCH                          ;25c9  c3 c4 25      5731   5748 
                                        ;                    5732   5749 ;
CONST:  CP  00Bh                        ;25cc  fe 0b         5733   5750 
    JR  NC,HXORFL                       ;25ce  30 16         5734   5751 
    OR  A                               ;25d0  b7            5735   5752 
    JR  Z,MOPRND                        ;25d1  28 ec         5736   5753 
    DEC A                               ;25d3  3d            5737   5754 
    LD  DE,00008h                       ;25d4  11 08 00      5738   5755 
    ADD HL,DE                           ;25d7  19            5739   5756 
    LD  E,A                             ;25d8  5f            5740   5757 
    LD  D,0                             ;25d9  16 00         5741   5758 
FLTHXB: LD  A,004h                      ;25db  3e 04         5742   5759 
    CALL    CONDFL                      ;25dd  cd eb 28      5743   5760 
    CALL    FLTHEX                      ;25e0  cd 02 29      5744   5761 
BCKFTR: JP  BCFTCH                      ;25e3  c3 c4 25      5745   5762 
                                        ;                    5746   5763 ;
HXORFL: CP  014h                        ;25e6  fe 14         5747   5764 
    JR  NC,FLTPNT                       ;25e8  30 19         5748   5765 
    CP  00Bh                            ;25ea  fe 0b         5749   5766 
    LD  DE,00008h                       ;25ec  11 08 00      5750   5767 
    ADD HL,DE                           ;25ef  19            5751   5768 
    JR  Z,LNOCON                        ;25f0  28 08         5752   5769 
LDELNO: LD  A,(BC)                      ;25f2  0a            5753   5770 
    LD  E,A                             ;25f3  5f            5754   5771 
    INC BC                              ;25f4  03            5755   5772 
    LD  A,(BC)                          ;25f5  0a            5756   5773 
    LD  D,A                             ;25f6  57            5757   5774 
    INC BC                              ;25f7  03            5758   5775 
    JR  FLTHXB                          ;25f8  18 e1         5759   5776 
                                        ;                    5760   5777 ;
LNOCON: CALL    LDELNO                  ;25fa  cd f2 25      5761   5778 
    PUSH    AF                          ;25fd  f5            5762   5779 
    CALL    ADJERL                      ;25fe  cd 78 37      5763   5780 
    POP AF                              ;2601  f1            5764   5781 
    RET                                 ;2602  c9            5765   5782 
                                        ;                    5766   5783 ;
FLTPNT: CP  019h                        ;2603  fe 19         5767   5784 
    JP  NC,SERROR                       ;2605  d2 3a 17      5768   5785 
    LD  DE,00008h                       ;2608  11 08 00      5769   5786 
    ADD HL,DE                           ;260b  19            5770   5787 
    AND 00Fh                            ;260c  e6 0f         5771   5788 
    CALL    CONDFL                      ;260e  cd eb 28      5772   5789 
    CP  004h                            ;2611  fe 04         5773   5790 
    CALL    Z,CLRFAC                    ;2613  cc a9 28      5774   5791 
    PUSH    HL                          ;2616  e5            5775   5792 
    EX  DE,HL                           ;2617  eb            5776   5793 
    LD  L,C                             ;2618  69            5777   5794 
    LD  H,B                             ;2619  60            5778   5795 
    LD  B,000h                          ;261a  06 00         5779   5796 
    LD  C,A                             ;261c  4f            5780   5797 
    LDIR                                ;261d  ed b0         5781   5798 
    LD  C,L                             ;261f  4d            5782   5799 
    LD  B,H                             ;2620  44            5783   5800 
    POP HL                              ;2621  e1            5784   5801 
    JR  BCKFTR                          ;2622  18 bf         5785   5802 
                                        ;                    5786   5803 ;
VARFUN: CP  0FFh                        ;2624  fe ff         5787   5804 
    JP  Z,FCTION                        ;2626  ca 61 27      5788   5805 
    CP  05Ch                            ;2629  fe 5c         5789   5806 
    JP  NC,SERROR                       ;262b  d2 3a 17      5790   5807 
    DEFB    011H                        ;262e  11            5791   5808 ;LD DE,
FUNCNS: DEFS    2                       ;262f                5792   5809 
    EX  AF,AF'                          ;2631  08            5793   5810 
    LD  A,E                             ;2632  7b            5794   5811 
    OR  D                               ;2633  b2            5795   5812 
    JR  NZ,FUNGVR                       ;2634  20 3d         5796   5813 
    EX  AF,AF'                          ;2636  08            5797   5814 
VARFNE: LD  DE,00008h                   ;2637  11 08 00      5798   5815 
    ADD HL,DE                           ;263a  19            5799   5816 
    EX  DE,HL                           ;263b  eb            5800   5817 
    CALL    GETVAR                      ;263c  cd da 1e      5801   5818 
    EX  DE,HL                           ;263f  eb            5802   5819 
    CALL    CLRFAC                      ;2640  cd a9 28      5803   5820 
    PUSH    HL                          ;2643  e5            5804   5821 
    PUSH    BC                          ;2644  c5            5805   5822 
    CP  003h                            ;2645  fe 03         5806   5823 
    JR  Z,STRVAR                        ;2647  28 13         5807   5824 
    CP  002h                            ;2649  fe 02         5808   5825 
    JR  Z,INTVAR                        ;264b  28 17         5809   5826 
    CALL    CONDFL                      ;264d  cd eb 28      5810   5827 
    LD  B,A                             ;2650  47            5811   5828 
VARTR#: LD  A,(DE)                      ;2651  1a            5812   5829 
    LD  (HL),A                          ;2652  77            5813   5830 
    INC HL                              ;2653  23            5814   5831 
    INC DE                              ;2654  13            5815   5832 
    DJNZ    VARTR#                      ;2655  10 fa         5816   5833 
RTVARI: POP BC                          ;2657  c1            5817   5834 
    POP HL                              ;2658  e1            5818   5835 
    JP  BCFTCH                          ;2659  c3 c4 25      5819   5836 
                                        ;                    5820   5837 ;
STRVAR: CALL    CONDSR                  ;265c  cd d9 28      5821   5838 
    LD  (HL),E                          ;265f  73            5822   5839 
    INC HL                              ;2660  23            5823   5840 
    LD  (HL),D                          ;2661  72            5824   5841 
    JR  RTVARI                          ;2662  18 f3         5825   5842 
                                        ;                    5826   5843 ;
INTVAR: LD  A,004h                      ;2664  3e 04         5827   5844 
    CALL    CONDFL                      ;2666  cd eb 28      5828   5845 
    EX  DE,HL                           ;2669  eb            5829   5846 
    CALL    INDRCT                      ;266a  cd a3 2a      5830   5847 
    EX  DE,HL                           ;266d  eb            5831   5848 
    CALL    FLTHEX                      ;266e  cd 02 29      5832   5849 
    JR  RTVARI                          ;2671  18 e4         5833   5850 
                                        ;                    5834   5851 ;
FUNGVR: EX  AF,AF'                      ;2673  08            5835   5852 
    PUSH    HL                          ;2674  e5            5836   5853 
    PUSH    AF                          ;2675  f5            5837   5854 
    PUSH    BC                          ;2676  c5            5838   5855 
    CALL    VSRTST                      ;2677  cd fe 20      5839   5856 
    LD  (FNBCPT),BC                     ;267a  ed 43 c3 26   5840   5857 
    CP  028h                            ;267e  fe 28         5841   5858 
    JR  NZ,EFCT1                        ;2680  20 05         5842   5859 
NFCVAR: POP BC                          ;2682  c1            5843   5860 
    POP AF                              ;2683  f1            5844   5861 
    POP HL                              ;2684  e1            5845   5862 
    JR  VARFNE                          ;2685  18 b0         5846   5863 
                                        ;                    5847   5864 ;
EFCT1:  LD  A,E                         ;2687  7b            5848   5865 
    LD  (CPIMDP),A                      ;2688  32 ad 26      5849   5866 
    LD  (CPIMDQ),A                      ;268b  32 ba 26      5850   5867 
    XOR A                               ;268e  af            5851   5868 
    EX  AF,AF'                          ;268f  08            5852   5869 
    EX  DE,HL                           ;2690  eb            5853   5870 
    LD  HL,(FUNCNS)                     ;2691  2a 2f 26      5854   5871 
    LD  C,(HL)                          ;2694  4e            5855   5872 
    INC HL                              ;2695  23            5856   5873 
    LD  B,(HL)                          ;2696  46            5857   5874 
VRFLOP: PUSH    DE                      ;2697  d5            5858   5875 
    EX  AF,AF'                          ;2698  08            5859   5876 
    INC A                               ;2699  3c            5860   5877 
    EX  AF,AF'                          ;269a  08            5861   5878 
    CALL    BCFTCH                      ;269b  cd c4 25      5862   5879 
    CALL    VSRTST                      ;269e  cd fe 20      5863   5880 
    CP  029h                            ;26a1  fe 29         5864   5881 
    JR  Z,LSTCMP                        ;26a3  28 12         5865   5882 
    CP  02Ch                            ;26a5  fe 2c         5866   5883 
    JP  NZ,SERROR                       ;26a7  c2 3a 17      5867   5884 
    LD  A,E                             ;26aa  7b            5868   5885 
    POP DE                              ;26ab  d1            5869   5886 
    DEFB    0FEH                        ;26ac  fe            5870   5887 ;CP
CPIMDP: DEFS    1                       ;26ad                5871   5888 
    JR  NZ,VRFLOP                       ;26ae  20 e7         5872   5889 
    OR  A                               ;26b0  b7            5873   5890 
    SBC HL,DE                           ;26b1  ed 52         5874   5891 
    JR  NZ,VRFLOP                       ;26b3  20 e2         5875   5892 
    JR  FVRFND                          ;26b5  18 0b         5876   5893 
                                        ;                    5877   5894 ;
LSTCMP: LD  A,E                         ;26b7  7b            5878   5895 
    POP DE                              ;26b8  d1            5879   5896 
    DEFB    0FEH                        ;26b9  fe            5880   5897 ;CP
CPIMDQ: DEFS    1                       ;26ba                5881   5898 
    JR  NZ,NFCVAR                       ;26bb  20 c5         5882   5899 
    OR  A                               ;26bd  b7            5883   5900 
    SBC HL,DE                           ;26be  ed 52         5884   5901 
    JR  NZ,NFCVAR                       ;26c0  20 c0         5885   5902 
                                        ;                    5886   5903 ;
FVRFND: DEFB    001H                    ;26c2  01            5887   5904 ;LD BC,?
FNBCPT: DEFS    2                       ;26c3                5888   5905 
    EX  AF,AF'                          ;26c5  08            5889   5906 
    LD  E,A                             ;26c6  5f            5890   5907 
    LD  A,(CPIMDQ)                      ;26c7  3a ba 26      5891   5908 
    CP  003h                            ;26ca  fe 03         5892   5909 
    JR  Z,FNLVRS                        ;26cc  28 05         5893   5910 
    CALL    CONDFL                      ;26ce  cd eb 28      5894   5911 
    JR  FVRFDD                          ;26d1  18 03         5895   5912 
FNLVRS: CALL    CONDSR                  ;26d3  cd d9 28      5896   5913 
FVRFDD: POP HL                          ;26d6  e1            5897   5914 
    POP HL                              ;26d7  e1            5898   5915 
    POP HL                              ;26d8  e1            5899   5916 
    DEC BC                              ;26d9  0b            5900   5917 
    PUSH    BC                          ;26da  c5            5901   5918 
    PUSH    HL                          ;26db  e5            5902   5919 
    LD  HL,(FUNCNS)                     ;26dc  2a 2f 26      5903   5920 
    INC HL                              ;26df  23            5904   5921 
    INC HL                              ;26e0  23            5905   5922 
    LD  C,(HL)                          ;26e1  4e            5906   5923 
    INC HL                              ;26e2  23            5907   5924 
    LD  B,(HL)                          ;26e3  46            5908   5925 
TSTARG: DEC E                           ;26e4  1d            5909   5926 
    JR  Z,FNCGS                         ;26e5  28 05         5910   5927 
    CALL    SNXT2C                      ;26e7  cd 08 27      5911   5928 
    JR  TSTARG                          ;26ea  18 f8         5912   5929 
                                        ;                    5913   5930 ;
FNCGS:  LD  HL,(FUNCNS)                 ;26ec  2a 2f 26      5914   5931 
    POP DE                              ;26ef  d1            5915   5932 
    PUSH    HL                          ;26f0  e5            5916   5933 
    INC HL                              ;26f1  23            5917   5934 
    INC HL                              ;26f2  23            5918   5935 
    INC HL                              ;26f3  23            5919   5936 
    INC HL                              ;26f4  23            5920   5937 
    CALL    INDRCT                      ;26f5  cd a3 2a      5921   5938 
    LD  (FUNCNS),HL                     ;26f8  22 2f 26      5922   5939 
    EX  DE,HL                           ;26fb  eb            5923   5940 
    CALL    EXPRSN                      ;26fc  cd f2 22      5924   5941 
    POP DE                              ;26ff  d1            5925   5942 
    LD  (FUNCNS),DE                     ;2700  ed 53 2f 26   5926   5943 
    POP BC                              ;2704  c1            5927   5944 
    JP  BCFTCH                          ;2705  c3 c4 25      5928   5945 
                                        ;                    5929   5946 ;
SNXT2C: CALL    SK2C2C                  ;2708  cd 10 27      5930   5947 
    CP  02Ch                            ;270b  fe 2c         5931   5948 
    JR  NZ,SNXT2C                       ;270d  20 f9         5932   5949 
    RET                                 ;270f  c9            5933   5950 
                                        ;                    5934   5951 ;
SK2C2C: CALL    SKPSBL                  ;2710  cd 2d 27      5935   5952 
    CP  028h                            ;2713  fe 28         5936   5953 
    RET NZ                              ;2715  c0            5937   5954 
S2C2CL: CALL    SK2C2C                  ;2716  cd 10 27      5938   5955 
    CP  029h                            ;2719  fe 29         5939   5956 
    RET Z                               ;271b  c8            5940   5957 
    JR  S2C2CL                          ;271c  18 f8         5941   5958 
                                        ;                    5942   5959 ;
SK2829: CALL    SKPSBL                  ;271e  cd 2d 27      5943   5960 
    CP  029h                            ;2721  fe 29         5944   5961 
    RET Z                               ;2723  c8            5945   5962 
    CP  028h                            ;2724  fe 28         5946   5963 
    JR  NZ,SK2829                       ;2726  20 f6         5947   5964 
SK2BLO: CALL    SK2829                  ;2728  cd 1e 27      5948   5965 
    JR  SK2829                          ;272b  18 f1         5949   5966 
                                        ;                    5950   5967 ;
SKPSBL: CALL    BCFTCH                  ;272d  cd c4 25      5951   5968 
    OR  A                               ;2730  b7            5952   5969 
SKSBER: JP  Z,SERROR                    ;2731  ca 3a 17      5953   5970 
    CP  03Ah                            ;2734  fe 3a         5954   5971 
    JR  Z,SKSBER                        ;2736  28 f9         5955   5972 
    CP  022h                            ;2738  fe 22         5956   5973 
    JR  Z,DQSKCM                        ;273a  28 19         5957   5974 
    CP  020h                            ;273c  fe 20         5958   5975 
    RET NC                              ;273e  d0            5959   5976 
    CP  012h                            ;273f  fe 12         5960   5977 
    JR  C,DWNERG                        ;2741  38 0a         5961   5978 
    AND 00Fh                            ;2743  e6 0f         5962   5979 
HEXSKS: ADD A,C                         ;2745  81            5963   5980 
    LD  C,A                             ;2746  4f            5964   5981 
    LD  A,0                             ;2747  3e 00         5965   5982 
    ADC A,B                             ;2749  88            5966   5983 
    LD  B,A                             ;274a  47            5967   5984 
    JR  SKPSBL                          ;274b  18 e0         5968   5985 
                                        ;                    5969   5986 ;
DWNERG: CP  00Bh                        ;274d  fe 0b         5970   5987 
    JR  C,SKPSBL                        ;274f  38 dc         5971   5988 
    LD  A,002h                          ;2751  3e 02         5972   5989 
    JR  HEXSKS                          ;2753  18 f0         5973   5990 
                                        ;                    5974   5991 ;
DQSKCM: CALL    BCFTCH                  ;2755  cd c4 25      5975   5992 
    CP  022h                            ;2758  fe 22         5976   5993 
    JR  Z,SKPSBL                        ;275a  28 d1         5977   5994 
    OR  A                               ;275c  b7            5978   5995 
    JR  Z,SKSBER                        ;275d  28 d2         5979   5996 
    JR  DQSKCM                          ;275f  18 f4         5980   5997 
                                        ;                    5981   5998 ;
FCTION: LD  A,(BC)                      ;2761  0a            5982   5999 
    INC BC                              ;2762  03            5983   6000 
    CP  0A0h                            ;2763  fe a0         5984   6001 
    JP  NC,FUNCT1                       ;2765  d2 8c 27      5985   6002 
    PUSH    HL                          ;2768  e5            5986   6003 
    LD  HL,FLFNRT                       ;2769  21 81 27      5987   6004 
FTRMER: EX  (SP),HL                     ;276c  e3            5988   6005 
    PUSH    HL                          ;276d  e5            5989   6006 
    CALL    GETFJP                      ;276e  cd 9c 28      5990   6007 
    EX  (SP),HL                         ;2771  e3            5991   6008 
    CALL    CH28H                       ;2772  cd 58 2d      5992   6009 
    DEC IY                              ;2775  fd 2b         5993   6010 
    LD  (IY+0),0                        ;2777  fd 36 00 00   5994   6011 
    CALL    FLEXP'                      ;277b  cd 9c 22      5995   6012 
    JP  CH29H                           ;277e  c3 66 2d      5996   6013 
                                        ;                    5997   6014 ;
FLFNRT: LD  A,(IY+0)                    ;2781  fd 7e 00      5998   6015 
    INC IY                              ;2784  fd 23         5999   6016 
    CALL    CONDFL                      ;2786  cd eb 28      6000   6017 
FNCCON: JP  BCFTCH                      ;2789  c3 c4 25      6001   6018 
                                        ;                    6002   6019 ;
FUNCT1: CP  0A9h                        ;278c  fe a9         6003   6020 
    JP  NC,FUNCT2                       ;278e  d2 9c 27      6004   6021 
    PUSH    HL                          ;2791  e5            6005   6022 
    LD  HL,SRFNRT                       ;2792  21 97 27      6006   6023 
    JR  FTRMER                          ;2795  18 d5         6007   6024 
                                        ;                    6008   6025 ;
SRFNRT: INC IY                          ;2797  fd 23         6009   6026 
    JP  CONDSB                          ;2799  c3 b1 25      6010   6027 
                                        ;                    6011   6028 ;
                                        ;                    6012   6029 ;
FUNCT2: CP  0B2h                        ;279c  fe b2         6013   6030 
    JP  NC,OTHERF                       ;279e  d2 c5 27      6014   6031 
    PUSH    HL                          ;27a1  e5            6015   6032 
    LD  HL,SRSRRT                       ;27a2  21 ba 27      6016   6033 
    EX  (SP),HL                         ;27a5  e3            6017   6034 
    PUSH    HL                          ;27a6  e5            6018   6035 
    CALL    GETFJP                      ;27a7  cd 9c 28      6019   6036 
    EX  (SP),HL                         ;27aa  e3            6020   6037 
    CALL    CH28H                       ;27ab  cd 58 2d      6021   6038 
    DEC IY                              ;27ae  fd 2b         6022   6039 
    LD  (IY+0),0                        ;27b0  fd 36 00 00   6023   6040 
    CALL    STEXP'                      ;27b4  cd b5 22      6024   6041 
    JP  CH29H                           ;27b7  c3 66 2d      6025   6042 
                                        ;                    6026   6043 ;
SRSRRT: LD  A,(IY+0)                    ;27ba  fd 7e 00      6027   6044 
    INC IY                              ;27bd  fd 23         6028   6045 
    CALL    CONDFL                      ;27bf  cd eb 28      6029   6046 
    JP  BCFTCH                          ;27c2  c3 c4 25      6030   6047 
                                        ;                    6031   6048 ;
OTHERF: PUSH    HL                      ;27c5  e5            6032   6049 
    CALL    GETFJP                      ;27c6  cd 9c 28      6033   6050 
    EX  (SP),HL                         ;27c9  e3            6034   6051 
    RET                                 ;27ca  c9            6035   6052 
                                        ;                    6036   6053 ;
LENSUB: PUSH    BC                      ;27cb  c5            6037   6054 
    PUSH    DE                          ;27cc  d5            6038   6055 
    PUSH    HL                          ;27cd  e5            6039   6056 
    CALL    CONDMZ                      ;27ce  cd f6 6b      6040   6057 
    CALL    INDRCT                      ;27d1  cd a3 2a      6041   6058 
    JR  MIDERL                          ;27d4  18 12         6042   6059 
                                        ;                    6043   6060 ;
ASCSUB: PUSH    BC                      ;27d6  c5            6044   6061 
    PUSH    DE                          ;27d7  d5            6045   6062 
    PUSH    HL                          ;27d8  e5            6046   6063 
    CALL    CONDMZ                      ;27d9  cd f6 6b      6047   6064 
    CALL    INDRCT                      ;27dc  cd a3 2a      6048   6065 
    LD  A,(HL)                          ;27df  7e            6049   6066 
    OR  A                               ;27e0  b7            6050   6067 
    JP  Z,IFCALL                        ;27e1  ca 36 17      6051   6068 
    INC HL                              ;27e4  23            6052   6069 
    CALL    INDRCT                      ;27e5  cd a3 2a      6053   6070 
MIDERL: LD  E,(HL)                      ;27e8  5e            6054   6071 
    LD  D,0                             ;27e9  16 00         6055   6072 
    POP HL                              ;27eb  e1            6056   6073 
    LD  (IY+0),4                        ;27ec  fd 36 00 04   6057   6074 
    CALL    CLRFAC                      ;27f0  cd a9 28      6058   6075 
    CALL    FLTHEX                      ;27f3  cd 02 29      6059   6076 
    POP DE                              ;27f6  d1            6060   6077 
    POP BC                              ;27f7  c1            6061   6078 
    RET                                 ;27f8  c9            6062   6079 
                                        ;                    6063   6080 ;
VALSUB: PUSH    BC                      ;27f9  c5            6064   6081 
    PUSH    DE                          ;27fa  d5            6065   6082 
    PUSH    HL                          ;27fb  e5            6066   6083 
    CALL    CONDMZ                      ;27fc  cd f6 6b      6067   6084 
    CALL    INDRCT                      ;27ff  cd a3 2a      6068   6085 
    LD  A,(HL)                          ;2802  7e            6069   6086 
    OR  A                               ;2803  b7            6070   6087 
    JR  Z,ZRVALR                        ;2804  28 1a         6071   6088 
    INC HL                              ;2806  23            6072   6089 
    CALL    INDRCT                      ;2807  cd a3 2a      6073   6090 
    LD  B,A                             ;280a  47            6074   6091 
    LD  DE,KEYBUF                       ;280b  11 4f 7a      6075   6092 
VALTRL: LD  A,(HL)                      ;280e  7e            6076   6093 
    LD  (DE),A                          ;280f  12            6077   6094 
    INC HL                              ;2810  23            6078   6095 
    INC DE                              ;2811  13            6079   6096 
    DJNZ    VALTRL                      ;2812  10 fa         6080   6097 
MIDVAL: XOR A                           ;2814  af            6081   6098 
    LD  (DE),A                          ;2815  12            6082   6099 
    LD  DE,KEYBUF                       ;2816  11 4f 7a      6083   6100 
    POP HL                              ;2819  e1            6084   6101 
    CALL    OVFLAG                      ;281a  cd b8 5b      6085   6102 
    POP DE                              ;281d  d1            6086   6103 
    POP BC                              ;281e  c1            6087   6104 
    RET                                 ;281f  c9            6088   6105 
                                        ;                    6089   6106 ;
ZRVALR: LD  DE,KEYBUF                   ;2820  11 4f 7a      6090   6107 
    JR  MIDVAL                          ;2823  18 ef         6091   6108 
                                        ;                    6092   6109 ;
NULSDC: DEFB    000H                    ;2825  00            6093   6110 
    DEFW    0                           ;2826  00 00         6094   6111 
                                        ;                    6095   6112 ;
INKEY:  LD  DE,00008h                   ;2828  11 08 00      6096   6113 
    ADD HL,DE                           ;282b  19            6097   6114 
    CALL    BCFTCH                      ;282c  cd c4 25      6098   6115 
    CP  028h                            ;282f  fe 28         6099   6116 
    DEC BC                              ;2831  0b            6100   6117 
    JR  NZ,NORGET                       ;2832  20 20         6101   6118 
    INC BC                              ;2834  03            6102   6119 
    PUSH    HL                          ;2835  e5            6103   6120 
    DEC IY                              ;2836  fd 2b         6104   6121 
    LD  (IY+0),0                        ;2838  fd 36 00 00   6105   6122 
    CALL    FLEXP'                      ;283c  cd 9c 22      6106   6123 
    CALL    CH29H                       ;283f  cd 66 2d      6107   6124 
    INC IY                              ;2842  fd 23         6108   6125 
    CALL    HLFLTO                      ;2844  cd 97 2d      6109   6126 
    CALL    HCHECK                      ;2847  cd d8 22      6110   6127 
    POP HL                              ;284a  e1            6111   6128 
    LD  (FLASHF),A                      ;284b  32 7f 0c      6112   6129 
    CALL    ASCGET                      ;284e  cd 62 0c      6113   6130 
    JP  INKMID                          ;2851  c3 62 28      6114   6131 
                                        ;                    6115   6132 ;
NORGET: XOR A                           ;2854  af            6116   6133 
    LD  (FLASHF),A                      ;2855  32 7f 0c      6117   6134 
    CALL    ASCGET                      ;2858  cd 62 0c      6118   6135 
    DEFB    0FEH                        ;285b  fe            6119   6136 ;CP
LSTGET: DEFB    000H                    ;285c  00            6120   6137 
    JR  Z,NLINKY                        ;285d  28 06         6121   6138 
    LD  (LSTGET),A                      ;285f  32 5c 28      6122   6139 
INKMID: OR  A                           ;2862  b7            6123   6140 
    JR  NZ,CHRMIS                       ;2863  20 0a         6124   6141 
NLINKY: LD  DE,NULSDC                   ;2865  11 25 28      6125   6142 
    LD  (HL),E                          ;2868  73            6126   6143 
    INC HL                              ;2869  23            6127   6144 
    LD  (HL),D                          ;286a  72            6128   6145 
    DEC HL                              ;286b  2b            6129   6146 
INKBCK: JP  CONDSB                      ;286c  c3 b1 25      6130   6147 
                                        ;                    6131   6148 ;
                                        ;                    6132   6149 ;
CHRMIS: CALL    CHRMID                  ;286f  cd 7c 28      6133   6150 
    JR  INKBCK                          ;2872  18 f8         6134   6151 
                                        ;                    6135   6152 ;
CHRSUB: PUSH    HL                      ;2874  e5            6136   6153 
    CALL    HLFLTO                      ;2875  cd 97 2d      6137   6154 
    CALL    HCHECK                      ;2878  cd d8 22      6138   6155 
    POP HL                              ;287b  e1            6139   6156 
CHRMID: PUSH    HL                      ;287c  e5            6140   6157 
    PUSH    DE                          ;287d  d5            6141   6158 
    LD  E,L                             ;287e  5d            6142   6159 
    LD  D,H                             ;287f  54            6143   6160 
    INC DE                              ;2880  13            6144   6161 
    INC DE                              ;2881  13            6145   6162 
    LD  (HL),E                          ;2882  73            6146   6163 
    INC HL                              ;2883  23            6147   6164 
    LD  (HL),D                          ;2884  72            6148   6165 
    INC HL                              ;2885  23            6149   6166 
    PUSH    HL                          ;2886  e5            6150   6167 
    LD  (HL),1                          ;2887  36 01         6151   6168 
    INC HL                              ;2889  23            6152   6169 
    INC DE                              ;288a  13            6153   6170 
    INC DE                              ;288b  13            6154   6171 
    INC DE                              ;288c  13            6155   6172 
    INC DE                              ;288d  13            6156   6173 
    INC DE                              ;288e  13            6157   6174 
    LD  (HL),E                          ;288f  73            6158   6175 
    INC HL                              ;2890  23            6159   6176 
    LD  (HL),D                          ;2891  72            6160   6177 
    LD  (DE),A                          ;2892  12            6161   6178 
    POP HL                              ;2893  e1            6162   6179 
    LD  E,L                             ;2894  5d            6163   6180 
    LD  D,H                             ;2895  54            6164   6181 
    CALL    GETSTR                      ;2896  cd 9e 2d      6165   6182 
    POP DE                              ;2899  d1            6166   6183 
    POP HL                              ;289a  e1            6167   6184 
    RET                                 ;289b  c9            6168   6185 
                                        ;                    6169   6186 ;
GETFJP: LD  HL,FJPTBL                   ;289c  21 06 30      6170   6187 
GETJPA: SUB 081h                        ;289f  d6 81         6171   6188 
    ADD A,A                             ;28a1  87            6172   6189 
    LD  E,A                             ;28a2  5f            6173   6190 
    LD  D,0                             ;28a3  16 00         6174   6191 
    ADD HL,DE                           ;28a5  19            6175   6192 
    JP  INDRCT                          ;28a6  c3 a3 2a      6176   6193 
                                        ;                    6177   6194 ;
CLRFAC: PUSH    HL                      ;28a9  e5            6178   6195 
    PUSH    BC                          ;28aa  c5            6179   6196 
    LD  B,8                             ;28ab  06 08         6180   6197 
CLFCLP: LD  (HL),0                      ;28ad  36 00         6181   6198 
    INC HL                              ;28af  23            6182   6199 
    DJNZ    CLFCLP                      ;28b0  10 fb         6183   6200 
    POP BC                              ;28b2  c1            6184   6201 
    POP HL                              ;28b3  e1            6185   6202 
    RET                                 ;28b4  c9            6186   6203 
                                        ;                    6187   6204 ;
STRFAC: LD  DE,00008h                   ;28b5  11 08 00      6188   6205 
    ADD HL,DE                           ;28b8  19            6189   6206 
    INC HL                              ;28b9  23            6190   6207 
    INC HL                              ;28ba  23            6191   6208 
    LD  (HL),0                          ;28bb  36 00         6192   6209 
    INC HL                              ;28bd  23            6193   6210 
    LD  (HL),C                          ;28be  71            6194   6211 
    INC HL                              ;28bf  23            6195   6212 
    LD  (HL),B                          ;28c0  70            6196   6213 
    DEC HL                              ;28c1  2b            6197   6214 
    DEC HL                              ;28c2  2b            6198   6215 
STRSL:  LD  A,(BC)                      ;28c3  0a            6199   6216 
    INC (HL)                            ;28c4  34            6200   6217 
    OR  A                               ;28c5  b7            6201   6218 
    JR  Z,LENOKS                        ;28c6  28 05         6202   6219 
    INC BC                              ;28c8  03            6203   6220 
    CP  022h                            ;28c9  fe 22         6204   6221 
    JR  NZ,STRSL                        ;28cb  20 f6         6205   6222 
LENOKS: DEC (HL)                        ;28cd  35            6206   6223 
    PUSH    DE                          ;28ce  d5            6207   6224 
    LD  E,L                             ;28cf  5d            6208   6225 
    LD  D,H                             ;28d0  54            6209   6226 
    DEC HL                              ;28d1  2b            6210   6227 
    LD  (HL),D                          ;28d2  72            6211   6228 
    DEC HL                              ;28d3  2b            6212   6229 
    LD  (HL),E                          ;28d4  73            6213   6230 
    POP DE                              ;28d5  d1            6214   6231 
    JP  CONDSB                          ;28d6  c3 b1 25      6215   6232 
                                        ;                    6216   6233 ;
CONDSR: PUSH    AF                      ;28d9  f5            6217   6234 
    LD  A,(IY+0)                        ;28da  fd 7e 00      6218   6235 
    OR  A                               ;28dd  b7            6219   6236 
    JR  Z,OKSTTH                        ;28de  28 05         6220   6237 
    CP  003h                            ;28e0  fe 03         6221   6238 
    JP  NZ,TYPEMS                       ;28e2  c2 32 17      6222   6239 
OKSTTH: POP AF                          ;28e5  f1            6223   6240 
    LD  (IY+0),3                        ;28e6  fd 36 00 03   6224   6241 
    RET                                 ;28ea  c9            6225   6242 
                                        ;                    6226   6243 ;
CONDFL: PUSH    AF                      ;28eb  f5            6227   6244 
    LD  A,(IY+0)                        ;28ec  fd 7e 00      6228   6245 
    OR  A                               ;28ef  b7            6229   6246 
    JR  Z,STFLMK                        ;28f0  28 0b         6230   6247 
    CP  003h                            ;28f2  fe 03         6231   6248 
    JP  Z,TYPEMS                        ;28f4  ca 32 17      6232   6249 
    POP AF                              ;28f7  f1            6233   6250 
    CP  004h                            ;28f8  fe 04         6234   6251 
    RET Z                               ;28fa  c8            6235   6252 
    JR  STDBL                           ;28fb  18 01         6236   6253 
STFLMK: POP AF                          ;28fd  f1            6237   6254 
STDBL:  LD  (IY+0),A                    ;28fe  fd 77 00      6238   6255 
    RET                                 ;2901  c9            6239   6256 
                                        ;                    6240   6257 ;
FLTHEX: CALL    CLRFAC                  ;2902  cd a9 28      6241   6258 
    LD  A,E                             ;2905  7b            6242   6259 
    OR  D                               ;2906  b2            6243   6260 
    RET Z                               ;2907  c8            6244   6261 
    BIT 7,D                             ;2908  cb 7a         6245   6262 
    JR  Z,NORFLH                        ;290a  28 0d         6246   6263 
    LD  A,D                             ;290c  7a            6247   6264 
    CPL                                 ;290d  2f            6248   6265 
    LD  D,A                             ;290e  57            6249   6266 
    LD  A,E                             ;290f  7b            6250   6267 
    CPL                                 ;2910  2f            6251   6268 
    LD  E,A                             ;2911  5f            6252   6269 
    INC DE                              ;2912  13            6253   6270 
    CALL    NORFLH                      ;2913  cd 19 29      6254   6271 
    JP  TOGLE                           ;2916  c3 eb 6b      6255   6272 
                                        ;                    6256   6273 ;
NORFLH: LD  A,091h                      ;2919  3e 91         6257   6274 
SFL:    DEC A                           ;291b  3d            6258   6275 
    BIT 7,D                             ;291c  cb 7a         6259   6276 
    JR  NZ,FLHXRT                       ;291e  20 06         6260   6277 
    RL  E                               ;2920  cb 13         6261   6278 
    RL  D                               ;2922  cb 12         6262   6279 
    JR  SFL                             ;2924  18 f5         6263   6280 
FLHXRT: LD  (HL),A                      ;2926  77            6264   6281 
    INC HL                              ;2927  23            6265   6282 
    RES 7,D                             ;2928  cb ba         6266   6283 
    LD  (HL),D                          ;292a  72            6267   6284 
    INC HL                              ;292b  23            6268   6285 
    LD  (HL),E                          ;292c  73            6269   6286 
    DEC HL                              ;292d  2b            6270   6287 
    DEC HL                              ;292e  2b            6271   6288 
    RET                                 ;292f  c9            6272   6289 
                                        ;                    6273   6290 ;
DEFINT: LD  C,002h                      ;2930  0e 02         6274   6291 
    JR  CONTDF                          ;2932  18 0a         6275   6292 
DEFSTR: LD  C,003h                      ;2934  0e 03         6276   6293 
    JR  CONTDF                          ;2936  18 06         6277   6294 
DEFSNG: LD  C,004h                      ;2938  0e 04         6278   6295 
    JR  CONTDF                          ;293a  18 02         6279   6296 
DEFDBL: LD  C,008h                      ;293c  0e 08         6280   6297 
CONTDF: CALL    HLFTCH                  ;293e  cd 87 29      6281   6298 
    CP  05Bh                            ;2941  fe 5b         6282   6299 
    RET NC                              ;2943  d0            6283   6300 
    SUB 041h                            ;2944  d6 41         6284   6301 
    RET C                               ;2946  d8            6285   6302 
    LD  E,A                             ;2947  5f            6286   6303 
    LD  D,0                             ;2948  16 00         6287   6304 
    LD  B,A                             ;294a  47            6288   6305 
    PUSH    HL                          ;294b  e5            6289   6306 
    LD  HL,DFTABL                       ;294c  21 88 30      6290   6307 
    ADD HL,DE                           ;294f  19            6291   6308 
    LD  (HL),C                          ;2950  71            6292   6309 
    EX  DE,HL                           ;2951  eb            6293   6310 
    POP HL                              ;2952  e1            6294   6311 
CDEFTP: CALL    INCHLF                  ;2953  cd 86 29      6295   6312 
                                        ;                    6296   6313 ;
    INC HL                              ;2956  23            6297   6314 
    CP  02Ch                            ;2957  fe 2c         6298   6315 
    JR  Z,CONTDF                        ;2959  28 e3         6299   6316 
    DEC HL                              ;295b  2b            6300   6317 
    CP  0F9h                            ;295c  fe f9         6301   6318 
    RET NZ                              ;295e  c0            6302   6319 
    CALL    INCHLF                      ;295f  cd 86 29      6303   6320 
                                        ;                    6304   6321 ;
    CP  05Bh                            ;2962  fe 5b         6305   6322 
    RET NC                              ;2964  d0            6306   6323 
    SUB 041h                            ;2965  d6 41         6307   6324 
    RET C                               ;2967  d8            6308   6325 
STRMDM2: SUB    B                       ;2968  90            6309   6326 
    RET C                               ;2969  d8            6310   6327 
    RET Z                               ;296a  c8            6311   6328 
    EX  DE,HL                           ;296b  eb            6312   6329 
DFFIL1: INC HL                          ;296c  23            6313   6330 
    LD  (HL),C                          ;296d  71            6314   6331 
    DEC A                               ;296e  3d            6315   6332 
    JR  NZ,DFFIL1                       ;296f  20 fb         6316   6333 
    EX  DE,HL                           ;2971  eb            6317   6334 
    JR  CDEFTP                          ;2972  18 df         6318   6335 
                                        ;                    6319   6336 ;
CALLUP: LD  C,L                         ;2974  4d            6320   6337 
    LD  B,H                             ;2975  44            6321   6338 
    CALL    IHLEXP                      ;2976  cd cc 22      6322   6339 
    PUSH    BC                          ;2979  c5            6323   6340 
    PUSH    IY                          ;297a  fd e5         6324   6341 
    LD  BC,CALUPR                       ;297c  01 81 29      6325   6342 
    PUSH    BC                          ;297f  c5            6326   6343 
    JP  (HL)                            ;2980  e9            6327   6344 
CALUPR: POP IY                          ;2981  fd e1         6328   6345 
    POP HL                              ;2983  e1            6329   6346 
    DEC HL                              ;2984  2b            6330   6347 
    RET                                 ;2985  c9            6331   6348 
                                        ;                    6332   6349 ;
INCHLF: INC HL                          ;2986  23            6333   6350 
HLFTCH:                                 ;                    6334   6351 
    LD  A,(HL)                          ;2987  7e            6335   6352 
    CP  020h                            ;2988  fe 20         6336   6353 
    RET NZ                              ;298a  c0            6337   6354 
    JR  INCHLF                          ;298b  18 f9         6338   6355 
                                        ;                    6339   6356 ;
INTG:   INC HL                          ;298d  23            6340   6357 
    BIT 7,(HL)                          ;298e  cb 7e         6341   6358 
    DEC HL                              ;2990  2b            6342   6359 
    JP  Z,INT                           ;2991  ca 10 60      6343   6360 
    PUSH    DE                          ;2994  d5            6344   6361 
    PUSH    HL                          ;2995  e5            6345   6362 
    LD  DE,00008h                       ;2996  11 08 00      6346   6363 
    ADD HL,DE                           ;2999  19            6347   6364 
    EX  DE,HL                           ;299a  eb            6348   6365 
    POP HL                              ;299b  e1            6349   6366 
    PUSH    HL                          ;299c  e5            6350   6367 
    PUSH    DE                          ;299d  d5            6351   6368 
    PUSH    BC                          ;299e  c5            6352   6369 
    CALL    LDIR8                       ;299f  cd a6 73      6353   6370 
    POP BC                              ;29a2  c1            6354   6371 
    POP HL                              ;29a3  e1            6355   6372 
    CALL    INT                         ;29a4  cd 10 60      6356   6373 
    EX  DE,HL                           ;29a7  eb            6357   6374 
    POP HL                              ;29a8  e1            6358   6375 
    CALL    CMP                         ;29a9  cd d6 61      6359   6376 
    JR  Z,MNINTR                        ;29ac  28 08         6360   6377 
    CALL    INT                         ;29ae  cd 10 60      6361   6378 
    PUSH    BC                          ;29b1  c5            6362   6379 
    CALL    ONESUB                      ;29b2  cd ce 6b      6363   6380 
    POP BC                              ;29b5  c1            6364   6381 
MNINTR: POP DE                          ;29b6  d1            6365   6382 
    RET                                 ;29b7  c9            6366   6383 
                                        ;                    6367   6384 ;
STRING: CALL    CH28H                   ;29b8  cd 58 2d      6368   6385 
    DEC IY                              ;29bb  fd 2b         6369   6386 
    PUSH    HL                          ;29bd  e5            6370   6387 
    CALL    FLEXP'                      ;29be  cd 9c 22      6371   6388 
    CALL    CH2CH                       ;29c1  cd 61 2d      6372   6389 
    CALL    HLFLTO                      ;29c4  cd 97 2d      6373   6390 
    CALL    HCHECK                      ;29c7  cd d8 22      6374   6391 
    POP HL                              ;29ca  e1            6375   6392 
    PUSH    AF                          ;29cb  f5            6376   6393 
    CALL    FLEXP'                      ;29cc  cd 9c 22      6377   6394 
    INC IY                              ;29cf  fd 23         6378   6395 
    PUSH    HL                          ;29d1  e5            6379   6396 
    CALL    HLFLTO                      ;29d2  cd 97 2d      6380   6397 
    CALL    HCHECK                      ;29d5  cd d8 22      6381   6398 
    LD  (FILLCH),A                      ;29d8  32 ff 29      6382   6399 
    POP HL                              ;29db  e1            6383   6400 
    POP AF                              ;29dc  f1            6384   6401 
    CALL    SPCSU'                      ;29dd  cd e3 29      6385   6402 
    JP  CONDSB                          ;29e0  c3 b1 25      6386   6403 
                                        ;                    6387   6404 ;
                                        ;                    6388   6405 ;
SPCSU': PUSH    BC                      ;29e3  c5            6389   6406 
    PUSH    DE                          ;29e4  d5            6390   6407 
    PUSH    HL                          ;29e5  e5            6391   6408 
    JR  SPCSME                          ;29e6  18 0e         6392   6409 
                                        ;                    6393   6410 ;
SPCSUB: LD  A,020h                      ;29e8  3e 20         6394   6411 
    LD  (FILLCH),A                      ;29ea  32 ff 29      6395   6412 
    PUSH    BC                          ;29ed  c5            6396   6413 
    PUSH    DE                          ;29ee  d5            6397   6414 
    PUSH    HL                          ;29ef  e5            6398   6415 
    CALL    HLFLTO                      ;29f0  cd 97 2d      6399   6416 
    CALL    HCHECK                      ;29f3  cd d8 22      6400   6417 
SPCSME: OR  A                           ;29f6  b7            6401   6418 
    JR  Z,NULRET                        ;29f7  28 0a         6402   6419 
    LD  B,A                             ;29f9  47            6403   6420 
    LD  C,B                             ;29fa  48            6404   6421 
    LD  HL,KEYBUF                       ;29fb  21 4f 7a      6405   6422 
SPCFLL: DEFB    036H                    ;29fe  36            6406   6423 ;LD (HL),?
FILLCH: DEFB    020H                    ;29ff  20            6407   6424 
    INC HL                              ;2a00  23            6408   6425 
    DJNZ    SPCFLL                      ;2a01  10 fb         6409   6426 
NULRET: POP HL                          ;2a03  e1            6410   6427 
    LD  DE,KEYBUF                       ;2a04  11 4f 7a      6411   6428 
    LD  B,C                             ;2a07  41            6412   6429 
    CALL    ENTSTR                      ;2a08  cd 1a 2b      6413   6430 
    POP DE                              ;2a0b  d1            6414   6431 
    POP BC                              ;2a0c  c1            6415   6432 
    RET                                 ;2a0d  c9            6416   6433 
                                        ;                    6417   6434 ;
FRACSB: PUSH    BC                      ;2a0e  c5            6418   6435 
    CALL    FRAC                        ;2a0f  cd 95 60      6419   6436 
    POP BC                              ;2a12  c1            6420   6437 
    RET                                 ;2a13  c9            6421   6438 
                                        ;                    6422   6439 ;
PEEK:   PUSH    DE                      ;2a14  d5            6423   6440 
    PUSH    HL                          ;2a15  e5            6424   6441 
    CALL    HLFLTO                      ;2a16  cd 97 2d      6425   6442 
    LD  E,(HL)                          ;2a19  5e            6426   6443 
    LD  D,0                             ;2a1a  16 00         6427   6444 
    POP HL                              ;2a1c  e1            6428   6445 
    CALL    FLTHEX                      ;2a1d  cd 02 29      6429   6446 
    POP DE                              ;2a20  d1            6430   6447 
    LD  (IY+0),4                        ;2a21  fd 36 00 04   6431   6448 
    RET                                 ;2a25  c9            6432   6449 
                                        ;                    6433   6450 ;
HEXD:   PUSH    BC                      ;2a26  c5            6434   6451 
    PUSH    DE                          ;2a27  d5            6435   6452 
    PUSH    HL                          ;2a28  e5            6436   6453 
    PUSH    HL                          ;2a29  e5            6437   6454 
    LD  DE,KEYBUF                       ;2a2a  11 4f 7a      6438   6455 
    CALL    HLFLTO                      ;2a2d  cd 97 2d      6439   6456 
    CALL    HEXHL                       ;2a30  cd 12 67      6440   6457 
    LD  B,4                             ;2a33  06 04         6441   6458 
MIDOCT: LD  A,(DE)                      ;2a35  1a            6442   6459 
    CP  030h                            ;2a36  fe 30         6443   6460 
    JR  NZ,MIDHEX                       ;2a38  20 20         6444   6461 
    INC DE                              ;2a3a  13            6445   6462 
    DEC B                               ;2a3b  05            6446   6463 
    JR  NZ,MIDOCT                       ;2a3c  20 f7         6447   6464 
    INC B                               ;2a3e  04            6448   6465 
    DEC DE                              ;2a3f  1b            6449   6466 
    JR  MIDHEX                          ;2a40  18 18         6450   6467 
                                        ;                    6451   6468 ;
OCTD:   PUSH    BC                      ;2a42  c5            6452   6469 
    PUSH    DE                          ;2a43  d5            6453   6470 
    PUSH    HL                          ;2a44  e5            6454   6471 
    PUSH    HL                          ;2a45  e5            6455   6472 
    LD  DE,KEYBUF                       ;2a46  11 4f 7a      6456   6473 
    CALL    HLFLTO                      ;2a49  cd 97 2d      6457   6474 
    CALL    OCTHL                       ;2a4c  cd db 66      6458   6475 
    LD  B,6                             ;2a4f  06 06         6459   6476 
    JR  MIDOCT                          ;2a51  18 e2         6460   6477 
                                        ;                    6461   6478 ;
STRSUB: PUSH    BC                      ;2a53  c5            6462   6479 
    PUSH    DE                          ;2a54  d5            6463   6480 
    PUSH    HL                          ;2a55  e5            6464   6481 
    PUSH    HL                          ;2a56  e5            6465   6482 
    CALL    CVNMFL                      ;2a57  cd 58 5d      6466   6483 
MIDHEX: EX  DE,HL                       ;2a5a  eb            6467   6484 
    EX  (SP),HL                         ;2a5b  e3            6468   6485 
    LD  E,L                             ;2a5c  5d            6469   6486 
    LD  D,H                             ;2a5d  54            6470   6487 
    INC DE                              ;2a5e  13            6471   6488 
    INC DE                              ;2a5f  13            6472   6489 
    LD  (HL),E                          ;2a60  73            6473   6490 
    INC HL                              ;2a61  23            6474   6491 
    LD  (HL),D                          ;2a62  72            6475   6492 
    INC HL                              ;2a63  23            6476   6493 
    LD  (HL),B                          ;2a64  70            6477   6494 
    INC HL                              ;2a65  23            6478   6495 
    POP DE                              ;2a66  d1            6479   6496 
    LD  (HL),E                          ;2a67  73            6480   6497 
    INC HL                              ;2a68  23            6481   6498 
    LD  (HL),D                          ;2a69  72            6482   6499 
    DEC HL                              ;2a6a  2b            6483   6500 
    DEC HL                              ;2a6b  2b            6484   6501 
    LD  E,L                             ;2a6c  5d            6485   6502 
    LD  D,H                             ;2a6d  54            6486   6503 
    CALL    GETSTR                      ;2a6e  cd 9e 2d      6487   6504 
    POP HL                              ;2a71  e1            6488   6505 
    POP DE                              ;2a72  d1            6489   6506 
    POP BC                              ;2a73  c1            6490   6507 
    RET                                 ;2a74  c9            6491   6508 
                                        ;                    6492   6509 ;
MK1:    PUSH    BC                      ;2a75  c5            6493   6510 
    PUSH    DE                          ;2a76  d5            6494   6511 
    PUSH    HL                          ;2a77  e5            6495   6512 
    PUSH    HL                          ;2a78  e5            6496   6513 
    CALL    HLFLTO                      ;2a79  cd 97 2d      6497   6514 
    LD  (INPSDC),HL                     ;2a7c  22 a9 1e      6498   6515 
    LD  B,2                             ;2a7f  06 02         6499   6516 
    LD  DE,INPSDC                       ;2a81  11 a9 1e      6500   6517 
    POP HL                              ;2a84  e1            6501   6518 
    PUSH    HL                          ;2a85  e5            6502   6519 
    JR  MIDHEX                          ;2a86  18 d2         6503   6520 
                                        ;                    6504   6521 ;
MKS:    PUSH    BC                      ;2a88  c5            6505   6522 
    LD  BC,4                            ;2a89  01 04 00      6506   6523 
    JR  MKHILS                          ;2a8c  18 04         6507   6524 
                                        ;                    6508   6525 ;
MKD:    PUSH    BC                      ;2a8e  c5            6509   6526 
    LD  BC,8                            ;2a8f  01 08 00      6510   6527 
MKHILS: PUSH    DE                      ;2a92  d5            6511   6528 
    PUSH    HL                          ;2a93  e5            6512   6529 
    PUSH    HL                          ;2a94  e5            6513   6530 
    LD  DE,ZFAC                         ;2a95  11 f2 62      6514   6531 
    PUSH    DE                          ;2a98  d5            6515   6532 
    PUSH    BC                          ;2a99  c5            6516   6533 
    LDIR                                ;2a9a  ed b0         6517   6534 
    POP BC                              ;2a9c  c1            6518   6535 
    POP DE                              ;2a9d  d1            6519   6536 
    POP HL                              ;2a9e  e1            6520   6537 
    PUSH    HL                          ;2a9f  e5            6521   6538 
    LD  B,C                             ;2aa0  41            6522   6539 
    JR  MIDHEX                          ;2aa1  18 b7         6523   6540 
INDRCT: PUSH    DE                      ;2aa3  d5            6524   6541 
    LD  E,(HL)                          ;2aa4  5e            6525   6542 
    INC HL                              ;2aa5  23            6526   6543 
    LD  D,(HL)                          ;2aa6  56            6527   6544 
    EX  DE,HL                           ;2aa7  eb            6528   6545 
    POP DE                              ;2aa8  d1            6529   6546 
    RET                                 ;2aa9  c9            6530   6547 
                                        ;                    6531   6548 ;
CVI:    PUSH    BC                      ;2aaa  c5            6532   6549 
    PUSH    HL                          ;2aab  e5            6533   6550 
    CALL    CONDMZ                      ;2aac  cd f6 6b      6534   6551 
    CALL    INDRCT                      ;2aaf  cd a3 2a      6535   6552 
    LD  A,(HL)                          ;2ab2  7e            6536   6553 
    CP  002h                            ;2ab3  fe 02         6537   6554 
    JP  NZ,IFCALL                       ;2ab5  c2 36 17      6538   6555 
    INC HL                              ;2ab8  23            6539   6556 
    CALL    INDRCT                      ;2ab9  cd a3 2a      6540   6557 
    CALL    INDRCT                      ;2abc  cd a3 2a      6541   6558 
    EX  DE,HL                           ;2abf  eb            6542   6559 
    POP HL                              ;2ac0  e1            6543   6560 
    CALL    FLTHEX                      ;2ac1  cd 02 29      6544   6561 
    POP BC                              ;2ac4  c1            6545   6562 
    LD  (IY+0),4                        ;2ac5  fd 36 00 04   6546   6563 
    RET                                 ;2ac9  c9            6547   6564 
                                        ;                    6548   6565 ;
CVD:    PUSH    BC                      ;2aca  c5            6549   6566 
    LD  C,8                             ;2acb  0e 08         6550   6567 
    JR  CVMIDE                          ;2acd  18 03         6551   6568 
                                        ;                    6552   6569 ;
CVS:    PUSH    BC                      ;2acf  c5            6553   6570 
    LD  C,4                             ;2ad0  0e 04         6554   6571 
CVMIDE: PUSH    HL                      ;2ad2  e5            6555   6572 
    CALL    CONDMZ                      ;2ad3  cd f6 6b      6556   6573 
    CALL    INDRCT                      ;2ad6  cd a3 2a      6557   6574 
    LD  A,(HL)                          ;2ad9  7e            6558   6575 
    CP  C                               ;2ada  b9            6559   6576 
    JP  NZ,IFCALL                       ;2adb  c2 36 17      6560   6577 
    INC HL                              ;2ade  23            6561   6578 
    CALL    INDRCT                      ;2adf  cd a3 2a      6562   6579 
    EX  DE,HL                           ;2ae2  eb            6563   6580 
    POP HL                              ;2ae3  e1            6564   6581 
    PUSH    HL                          ;2ae4  e5            6565   6582 
    CALL    CLRFAC                      ;2ae5  cd a9 28      6566   6583 
    LD  B,C                             ;2ae8  41            6567   6584 
CVTRLP: LD  A,(DE)                      ;2ae9  1a            6568   6585 
    LD  (HL),A                          ;2aea  77            6569   6586 
    INC HL                              ;2aeb  23            6570   6587 
    INC DE                              ;2aec  13            6571   6588 
    DJNZ    CVTRLP                      ;2aed  10 fa         6572   6589 
    POP HL                              ;2aef  e1            6573   6590 
    LD  (IY+0),C                        ;2af0  fd 71 00      6574   6591 
    POP BC                              ;2af3  c1            6575   6592 
    RET                                 ;2af4  c9            6576   6593 
                                        ;                    6577   6594 ;
PARI:   PUSH    BC                      ;2af5  c5            6578   6595 
    PUSH    DE                          ;2af6  d5            6579   6596 
    PUSH    HL                          ;2af7  e5            6580   6597 
    CALL    CONDMZ                      ;2af8  cd f6 6b      6581   6598 
    CALL    INDRCT                      ;2afb  cd a3 2a      6582   6599 
    LD  A,(HL)                          ;2afe  7e            6583   6600 
    JP  Z,IFCALL                        ;2aff  ca 36 17      6584   6601 
    INC HL                              ;2b02  23            6585   6602 
    CALL    INDRCT                      ;2b03  cd a3 2a      6586   6603 
    LD  A,(HL)                          ;2b06  7e            6587   6604 
    AND A                               ;2b07  a7            6588   6605 
    LD  DE,00001h                       ;2b08  11 01 00      6589   6606 
    JP  PO,SKIMPL                       ;2b0b  e2 0f 2b      6590   6607 
    DEC DE                              ;2b0e  1b            6591   6608 
SKIMPL: POP HL                          ;2b0f  e1            6592   6609 
    CALL    FLTHEX                      ;2b10  cd 02 29      6593   6610 
    POP DE                              ;2b13  d1            6594   6611 
    POP BC                              ;2b14  c1            6595   6612 
    LD  (IY+0),4                        ;2b15  fd 36 00 04   6596   6613 
    RET                                 ;2b19  c9            6597   6614 
                                        ;                    6598   6615 ;
ENTSTR: PUSH    BC                      ;2b1a  c5            6599   6616 
    PUSH    DE                          ;2b1b  d5            6600   6617 
    PUSH    HL                          ;2b1c  e5            6601   6618 
    PUSH    HL                          ;2b1d  e5            6602   6619 
    JP  MIDHEX                          ;2b1e  c3 5a 2a      6603   6620 
                                        ;                    6604   6621 ;
CDBL:   LD  A,8                         ;2b21  3e 08         6605   6622 
    JP  CONDFL                          ;2b23  c3 eb 28      6606   6623 ;CONDFL
                                        ;                    6607   6624 ;
CSNG:   LD  A,(HL)                      ;2b26  7e            6608   6625 
    OR  A                               ;2b27  b7            6609   6626 
    JR  Z,INRETY                        ;2b28  28 51         6610   6627 
    LD  A,(IY+0)                        ;2b2a  fd 7e 00      6611   6628 
    CP  004h                            ;2b2d  fe 04         6612   6629 
    JR  Z,INRETY                        ;2b2f  28 4a         6613   6630 
    INC HL                              ;2b31  23            6614   6631 
    LD  A,(HL)                          ;2b32  7e            6615   6632 
    RES 7,(HL)                          ;2b33  cb be         6616   6633 
    DEC HL                              ;2b35  2b            6617   6634 
    PUSH    AF                          ;2b36  f5            6618   6635 
    LD  A,(HL)                          ;2b37  7e            6619   6636 
    PUSH    AF                          ;2b38  f5            6620   6637 
    LD  (HL),099h                       ;2b39  36 99         6621   6638 
    PUSH    BC                          ;2b3b  c5            6622   6639 
    CALL    ONEADD                      ;2b3c  cd ac 73      6623   6640 
    POP BC                              ;2b3f  c1            6624   6641 
    LD  A,(HL)                          ;2b40  7e            6625   6642 
    CP  09Ah                            ;2b41  fe 9a         6626   6643 
    JR  NZ,EPREST                       ;2b43  20 06         6627   6644 
    POP AF                              ;2b45  f1            6628   6645 
    INC A                               ;2b46  3c            6629   6646 
    JP  Z,OVERFL                        ;2b47  ca b8 30      6630   6647 
    PUSH    AF                          ;2b4a  f5            6631   6648 
EPREST: POP AF                          ;2b4b  f1            6632   6649 
    LD  (HL),A                          ;2b4c  77            6633   6650 
    POP AF                              ;2b4d  f1            6634   6651 
    INC HL                              ;2b4e  23            6635   6652 
    AND 080h                            ;2b4f  e6 80         6636   6653 
    OR  (HL)                            ;2b51  b6            6637   6654 
    LD  (HL),A                          ;2b52  77            6638   6655 
    DEC HL                              ;2b53  2b            6639   6656 
    LD  (IY+0),4                        ;2b54  fd 36 00 04   6640   6657 
    JR  INRETY                          ;2b58  18 21         6641   6658 
                                        ;                    6642   6659 ;
CINT:   LD  A,(HL)                      ;2b5a  7e            6643   6660 
    OR  A                               ;2b5b  b7            6644   6661 
    JR  Z,INRETY                        ;2b5c  28 1d         6645   6662 
    PUSH    HL                          ;2b5e  e5            6646   6663 
    INC HL                              ;2b5f  23            6647   6664 
    LD  A,(HL)                          ;2b60  7e            6648   6665 
    PUSH    AF                          ;2b61  f5            6649   6666 
    RES 7,(HL)                          ;2b62  cb be         6650   6667 
    DEC HL                              ;2b64  2b            6651   6668 
    PUSH    BC                          ;2b65  c5            6652   6669 
    INC (HL)                            ;2b66  34            6653   6670 
    CALL    ONEADD                      ;2b67  cd ac 73      6654   6671 
    DEC (HL)                            ;2b6a  35            6655   6672 
    POP BC                              ;2b6b  c1            6656   6673 
    INC HL                              ;2b6c  23            6657   6674 
    POP AF                              ;2b6d  f1            6658   6675 
    AND 080h                            ;2b6e  e6 80         6659   6676 
    ADD A,(HL)                          ;2b70  86            6660   6677 
    LD  (HL),A                          ;2b71  77            6661   6678 
    DEC HL                              ;2b72  2b            6662   6679 
    CALL    HLFLTO                      ;2b73  cd 97 2d      6663   6680 
    EX  DE,HL                           ;2b76  eb            6664   6681 
    POP HL                              ;2b77  e1            6665   6682 
    CALL    FLTHEX                      ;2b78  cd 02 29      6666   6683 
INRETY: LD  A,004h                      ;2b7b  3e 04         6667   6684 
    JP  CONDFL                          ;2b7d  c3 eb 28      6668   6685 
                                        ;                    6669   6686 ;
LEFT1:  CALL    CH28H                   ;2b80  cd 58 2d      6670   6687 
    LD  DE,00008h                       ;2b83  11 08 00      6671   6688 
    ADD HL,DE                           ;2b86  19            6672   6689 
    PUSH    HL                          ;2b87  e5            6673   6690 
    CALL    STEXP'                      ;2b88  cd b5 22      6674   6691 
    CALL    CH2CH                       ;2b8b  cd 61 2d      6675   6692 
    PUSH    HL                          ;2b8e  e5            6676   6693 
    DEC IY                              ;2b8f  fd 2b         6677   6694 
    LD  (IY+0),0                        ;2b91  fd 36 00 00   6678   6695 
    CALL    HLEXP                       ;2b95  cd c7 22      6679   6696 
    INC IY                              ;2b98  fd 23         6680   6697 
    CALL    CH29H                       ;2b9a  cd 66 2d      6681   6698 
    CALL    HCHECK                      ;2b9d  cd d8 22      6682   6699 
    POP HL                              ;2ba0  e1            6683   6700 
    PUSH    HL                          ;2ba1  e5            6684   6701 
    CALL    INDRCT                      ;2ba2  cd a3 2a      6685   6702 
    CP  (HL)                            ;2ba5  be            6686   6703 
    JR  C,LFTOLM                        ;2ba6  38 01         6687   6704 
    LD  A,(HL)                          ;2ba8  7e            6688   6705 
LFTOLM: INC HL                          ;2ba9  23            6689   6706 
    CALL    INDRCT                      ;2baa  cd a3 2a      6690   6707 
    EX  DE,HL                           ;2bad  eb            6691   6708 
LMIDET: POP IX                          ;2bae  dd e1         6692   6709 
    POP HL                              ;2bb0  e1            6693   6710 
    PUSH    BC                          ;2bb1  c5            6694   6711 
    LD  B,A                             ;2bb2  47            6695   6712 
    OR  A                               ;2bb3  b7            6696   6713 
    JR  Z,NOLENE                        ;2bb4  28 0f         6697   6714 
    PUSH    HL                          ;2bb6  e5            6698   6715 
    PUSH    BC                          ;2bb7  c5            6699   6716 
    EX  DE,HL                           ;2bb8  eb            6700   6717 
    LD  DE,KEYBUF                       ;2bb9  11 4f 7a      6701   6718 
    PUSH    DE                          ;2bbc  d5            6702   6719 
    LD  C,B                             ;2bbd  48            6703   6720 
    LD  B,0                             ;2bbe  06 00         6704   6721 
    LDIR                                ;2bc0  ed b0         6705   6722 
    POP DE                              ;2bc2  d1            6706   6723 
    POP BC                              ;2bc3  c1            6707   6724 
    POP HL                              ;2bc4  e1            6708   6725 
NOLENE: CALL    ENTSTR                  ;2bc5  cd 1a 2b      6709   6726 
    PUSH    HL                          ;2bc8  e5            6710   6727 
    PUSH    IX                          ;2bc9  dd e5         6711   6728 
    POP HL                              ;2bcb  e1            6712   6729 
    CALL    CONDMZ                      ;2bcc  cd f6 6b      6713   6730 
    POP HL                              ;2bcf  e1            6714   6731 
    POP BC                              ;2bd0  c1            6715   6732 
    JP  CONDSB                          ;2bd1  c3 b1 25      6716   6733 
                                        ;                    6717   6734 ;
RIGHT1: CALL    CH28H                   ;2bd4  cd 58 2d      6718   6735 
    LD  DE,00008h                       ;2bd7  11 08 00      6719   6736 
    ADD HL,DE                           ;2bda  19            6720   6737 
    PUSH    HL                          ;2bdb  e5            6721   6738 
    CALL    STEXP'                      ;2bdc  cd b5 22      6722   6739 
    CALL    CH2CH                       ;2bdf  cd 61 2d      6723   6740 
    PUSH    HL                          ;2be2  e5            6724   6741 
    DEC IY                              ;2be3  fd 2b         6725   6742 
    LD  (IY+0),0                        ;2be5  fd 36 00 00   6726   6743 
    CALL    HLEXP                       ;2be9  cd c7 22      6727   6744 
    INC IY                              ;2bec  fd 23         6728   6745 
    CALL    CH29H                       ;2bee  cd 66 2d      6729   6746 
    CALL    HCHECK                      ;2bf1  cd d8 22      6730   6747 
    POP HL                              ;2bf4  e1            6731   6748 
    PUSH    HL                          ;2bf5  e5            6732   6749 
    CALL    INDRCT                      ;2bf6  cd a3 2a      6733   6750 
    CP  (HL)                            ;2bf9  be            6734   6751 
    JR  C,NOLSRD                        ;2bfa  38 01         6735   6752 
    LD  A,(HL)                          ;2bfc  7e            6736   6753 
NOLSRD: PUSH    AF                      ;2bfd  f5            6737   6754 
    SUB (HL)                            ;2bfe  96            6738   6755 
    NEG                                 ;2bff  ed 44         6739   6756 
    INC HL                              ;2c01  23            6740   6757 
    CALL    INDRCT                      ;2c02  cd a3 2a      6741   6758 
    ADD A,L                             ;2c05  85            6742   6759 
    LD  L,A                             ;2c06  6f            6743   6760 
    LD  A,000h                          ;2c07  3e 00         6744   6761 
    ADC A,H                             ;2c09  8c            6745   6762 
    LD  H,A                             ;2c0a  67            6746   6763 
    EX  DE,HL                           ;2c0b  eb            6747   6764 
    POP AF                              ;2c0c  f1            6748   6765 
    JR  LMIDET                          ;2c0d  18 9f         6749   6766 
                                        ;                    6750   6767 ;
MID:    CALL    CH28H                   ;2c0f  cd 58 2d      6751   6768 
    LD  DE,00008h                       ;2c12  11 08 00      6752   6769 
    ADD HL,DE                           ;2c15  19            6753   6770 
    PUSH    HL                          ;2c16  e5            6754   6771 
    CALL    STEXP'                      ;2c17  cd b5 22      6755   6772 
    CALL    CH2CH                       ;2c1a  cd 61 2d      6756   6773 
    PUSH    HL                          ;2c1d  e5            6757   6774 
    DEC IY                              ;2c1e  fd 2b         6758   6775 
    LD  (IY+0),0                        ;2c20  fd 36 00 00   6759   6776 
    CALL    HLEXP                       ;2c24  cd c7 22      6760   6777 
    INC IY                              ;2c27  fd 23         6761   6778 
    EX  AF,AF'                          ;2c29  08            6762   6779 
    CALL    HCHECK                      ;2c2a  cd d8 22      6763   6780 
    OR  A                               ;2c2d  b7            6764   6781 
    JP  Z,IFCALL                        ;2c2e  ca 36 17      6765   6782 
    LD  D,A                             ;2c31  57            6766   6783 
    EX  AF,AF'                          ;2c32  08            6767   6784 
    CP  029h                            ;2c33  fe 29         6768   6785 
    LD  E,0FFh                          ;2c35  1e ff         6769   6786 
    JR  Z,MIDALL                        ;2c37  28 19         6770   6787 
    CALL    CH2CH                       ;2c39  cd 61 2d      6771   6788 
    POP HL                              ;2c3c  e1            6772   6789 
    PUSH    HL                          ;2c3d  e5            6773   6790 
    PUSH    DE                          ;2c3e  d5            6774   6791 
    DEC IY                              ;2c3f  fd 2b         6775   6792 
    LD  (IY+0),0                        ;2c41  fd 36 00 00   6776   6793 
    CALL    HLEXP                       ;2c45  cd c7 22      6777   6794 
    INC IY                              ;2c48  fd 23         6778   6795 
    CALL    CH29H                       ;2c4a  cd 66 2d      6779   6796 
    CALL    HCHECK                      ;2c4d  cd d8 22      6780   6797 
    POP DE                              ;2c50  d1            6781   6798 
    LD  E,A                             ;2c51  5f            6782   6799 
MIDALL: POP HL                          ;2c52  e1            6783   6800 
    PUSH    HL                          ;2c53  e5            6784   6801 
    CALL    INDRCT                      ;2c54  cd a3 2a      6785   6802 
    LD  A,D                             ;2c57  7a            6786   6803 
    DEC A                               ;2c58  3d            6787   6804 
    CP  (HL)                            ;2c59  be            6788   6805 
    JR  NC,MIDNUL                       ;2c5a  30 18         6789   6806 
    EX  AF,AF'                          ;2c5c  08            6790   6807 
    LD  A,(HL)                          ;2c5d  7e            6791   6808 
    SUB D                               ;2c5e  92            6792   6809 
    INC A                               ;2c5f  3c            6793   6810 
    EX  AF,AF'                          ;2c60  08            6794   6811 
    INC HL                              ;2c61  23            6795   6812 
    CALL    INDRCT                      ;2c62  cd a3 2a      6796   6813 
    ADD A,L                             ;2c65  85            6797   6814 
    LD  L,A                             ;2c66  6f            6798   6815 
    LD  A,000h                          ;2c67  3e 00         6799   6816 
    ADC A,H                             ;2c69  8c            6800   6817 
    LD  H,A                             ;2c6a  67            6801   6818 
    EX  AF,AF'                          ;2c6b  08            6802   6819 
    CP  E                               ;2c6c  bb            6803   6820 
    JR  C,KMIJL                         ;2c6d  38 01         6804   6821 
    LD  A,E                             ;2c6f  7b            6805   6822 
KMIJL:  EX  DE,HL                       ;2c70  eb            6806   6823 
MNULIS: JP  LMIDET                      ;2c71  c3 ae 2b      6807   6824 
                                        ;                    6808   6825 ;
MIDNUL: LD  DE,00000h                   ;2c74  11 00 00      6809   6826 
    XOR A                               ;2c77  af            6810   6827 
    JR  MNULIS                          ;2c78  18 f7         6811   6828 
                                        ;                    6812   6829 ;
INSTR:  PUSH    HL                      ;2c7a  e5            6813   6830 
    CALL    CH28H                       ;2c7b  cd 58 2d      6814   6831 
    LD  D,001h                          ;2c7e  16 01         6815   6832 
    DEC IY                              ;2c80  fd 2b         6816   6833 
    LD  (IY+0),0                        ;2c82  fd 36 00 00   6817   6834 
    PUSH    DE                          ;2c86  d5            6818   6835 
    CALL    EXPRSN                      ;2c87  cd f2 22      6819   6836 
    POP DE                              ;2c8a  d1            6820   6837 
    CALL    CH2CH                       ;2c8b  cd 61 2d      6821   6838 
    LD  A,(IY+0)                        ;2c8e  fd 7e 00      6822   6839 
    CP  003h                            ;2c91  fe 03         6823   6840 
    JR  Z,SINSEX                        ;2c93  28 11         6824   6841 
    CALL    HLFLTO                      ;2c95  cd 97 2d      6825   6842 
    CALL    HCHECK                      ;2c98  cd d8 22      6826   6843 
    LD  D,A                             ;2c9b  57            6827   6844 
    POP HL                              ;2c9c  e1            6828   6845 
    PUSH    HL                          ;2c9d  e5            6829   6846 
    PUSH    DE                          ;2c9e  d5            6830   6847 
    CALL    STEXP'                      ;2c9f  cd b5 22      6831   6848 
    POP DE                              ;2ca2  d1            6832   6849 
    CALL    CH2CH                       ;2ca3  cd 61 2d      6833   6850 
SINSEX: PUSH    DE                      ;2ca6  d5            6834   6851 
    PUSH    HL                          ;2ca7  e5            6835   6852 
    CALL    STEXP'                      ;2ca8  cd b5 22      6836   6853 
    CALL    CH29H                       ;2cab  cd 66 2d      6837   6854 
    LD  (BCPOTR),BC                     ;2cae  ed 43 11 2d   6838   6855 
    INC IY                              ;2cb2  fd 23         6839   6856 
    CALL    CONDMZ                      ;2cb4  cd f6 6b      6840   6857 
    CALL    INDRCT                      ;2cb7  cd a3 2a      6841   6858 
    LD  A,(HL)                          ;2cba  7e            6842   6859 
    OR  A                               ;2cbb  b7            6843   6860 
    JR  Z,INSZR1                        ;2cbc  28 5b         6844   6861 
    INC HL                              ;2cbe  23            6845   6862 
    CALL    INDRCT                      ;2cbf  cd a3 2a      6846   6863 
    EX  DE,HL                           ;2cc2  eb            6847   6864 
    LD  C,A                             ;2cc3  4f            6848   6865 
    POP HL                              ;2cc4  e1            6849   6866 
    CALL    CONDMZ                      ;2cc5  cd f6 6b      6850   6867 
    CALL    INDRCT                      ;2cc8  cd a3 2a      6851   6868 
    LD  A,(HL)                          ;2ccb  7e            6852   6869 
    OR  A                               ;2ccc  b7            6853   6870 
    JR  Z,INSZR2                        ;2ccd  28 4b         6854   6871 
    CP  C                               ;2ccf  b9            6855   6872 
    JR  C,INSZR2                        ;2cd0  38 48         6856   6873 
    LD  B,A                             ;2cd2  47            6857   6874 
    INC HL                              ;2cd3  23            6858   6875 
    CALL    INDRCT                      ;2cd4  cd a3 2a      6859   6876 
    POP AF                              ;2cd7  f1            6860   6877 
    DEC A                               ;2cd8  3d            6861   6878 
INCPL1: CP  B                           ;2cd9  b8            6862   6879 
    JR  NC,INSZR3                       ;2cda  30 3f         6863   6880 
    PUSH    AF                          ;2cdc  f5            6864   6881 
    SUB B                               ;2cdd  90            6865   6882 
    NEG                                 ;2cde  ed 44         6866   6883 
    CP  C                               ;2ce0  b9            6867   6884 
    JR  C,INSZR2                        ;2ce1  38 37         6868   6885 
    POP AF                              ;2ce3  f1            6869   6886 
    PUSH    BC                          ;2ce4  c5            6870   6887 
    PUSH    DE                          ;2ce5  d5            6871   6888 
    PUSH    HL                          ;2ce6  e5            6872   6889 
    PUSH    AF                          ;2ce7  f5            6873   6890 
    ADD A,L                             ;2ce8  85            6874   6891 
    LD  L,A                             ;2ce9  6f            6875   6892 
    LD  A,0                             ;2cea  3e 00         6876   6893 
    ADC A,H                             ;2cec  8c            6877   6894 
    LD  H,A                             ;2ced  67            6878   6895 
    LD  B,C                             ;2cee  41            6879   6896 
INSCPL: LD  A,(DE)                      ;2cef  1a            6880   6897 
    CP  (HL)                            ;2cf0  be            6881   6898 
    JR  NZ,INMTCH                       ;2cf1  20 06         6882   6899 
    INC HL                              ;2cf3  23            6883   6900 
    INC DE                              ;2cf4  13            6884   6901 
    DJNZ    INSCPL                      ;2cf5  10 f8         6885   6902 
    JR  INSRET                          ;2cf7  18 07         6886   6903 
INMTCH: POP AF                          ;2cf9  f1            6887   6904 
    POP HL                              ;2cfa  e1            6888   6905 
    POP DE                              ;2cfb  d1            6889   6906 
    POP BC                              ;2cfc  c1            6890   6907 
    INC A                               ;2cfd  3c            6891   6908 
    JR  INCPL1                          ;2cfe  18 d9         6892   6909 
                                        ;                    6893   6910 ;
INSRET: POP AF                          ;2d00  f1            6894   6911 
    POP HL                              ;2d01  e1            6895   6912 
    POP DE                              ;2d02  d1            6896   6913 
    POP BC                              ;2d03  c1            6897   6914 
    INC A                               ;2d04  3c            6898   6915 
INSZR:  LD  DE,00008h                   ;2d05  11 08 00      6899   6916 
    POP HL                              ;2d08  e1            6900   6917 
    ADD HL,DE                           ;2d09  19            6901   6918 
    LD  E,A                             ;2d0a  5f            6902   6919 
    CALL    FLTHEX                      ;2d0b  cd 02 29      6903   6920 
    LD  A,004h                          ;2d0e  3e 04         6904   6921 
    DEFB    001H                        ;2d10  01            6905   6922 ;LD BC,?
BCPOTR: DEFS    2                       ;2d11                6906   6923 
    CALL    CONDFL                      ;2d13  cd eb 28      6907   6924 
    JP  BCFTCH                          ;2d16  c3 c4 25      6908   6925 
                                        ;                    6909   6926 ;
INSZR1: POP HL                          ;2d19  e1            6910   6927 
INSZR2: POP AF                          ;2d1a  f1            6911   6928 
INSZR3: XOR A                           ;2d1b  af            6912   6929 
    JR  INSZR                           ;2d1c  18 e7         6913   6930 
                                        ;                    6914   6931 ;
FRE:    CALL    CH28H                   ;2d1e  cd 58 2d      6915   6932 
    CALL    FLEXP'                      ;2d21  cd 9c 22      6916   6933 
    CALL    CH29H                       ;2d24  cd 66 2d      6917   6934 
                                        ;                    6918   6935 ;
    PUSH    HL                          ;2d27  e5            6919   6936 
    LD  DE,(STKLMT)                     ;2d28  ed 5b 3f 7a   6920   6937 
    LD  HL,00000h                       ;2d2c  21 00 00      6921   6938 
    ADD HL,SP                           ;2d2f  39            6922   6939 
    OR  A                               ;2d30  b7            6923   6940 
    SBC HL,DE                           ;2d31  ed 52         6924   6941 
    EX  DE,HL                           ;2d33  eb            6925   6942 
    POP HL                              ;2d34  e1            6926   6943 
FREMID: CALL    FLTHEX                  ;2d35  cd 02 29      6927   6944 
    LD  A,004h                          ;2d38  3e 04         6928   6945 
    CALL    CONDFL                      ;2d3a  cd eb 28      6929   6946 
    JP  BCFTCH                          ;2d3d  c3 c4 25      6930   6947 
                                        ;                    6931   6948 ;
VARPTR: CALL    CH28H                   ;2d40  cd 58 2d      6932   6949 
    PUSH    HL                          ;2d43  e5            6933   6950 
    EX  DE,HL                           ;2d44  eb            6934   6951 
    CALL    GETVAB                      ;2d45  cd d7 1e      6935   6952 
    CALL    BCFTCH                      ;2d48  cd c4 25      6936   6953 
    CALL    CH29H                       ;2d4b  cd 66 2d      6937   6954 
    EX  DE,HL                           ;2d4e  eb            6938   6955 
    POP HL                              ;2d4f  e1            6939   6956 
    PUSH    DE                          ;2d50  d5            6940   6957 
    LD  DE,00008h                       ;2d51  11 08 00      6941   6958 
    ADD HL,DE                           ;2d54  19            6942   6959 
    POP DE                              ;2d55  d1            6943   6960 
    JR  FREMID                          ;2d56  18 dd         6944   6961 
                                        ;                    6945   6962 ;
CH28H:  CALL    BCFTCH                  ;2d58  cd c4 25      6946   6963 
    CP  028h                            ;2d5b  fe 28         6947   6964 
    RET Z                               ;2d5d  c8            6948   6965 
SERVED: JP  SERROR                      ;2d5e  c3 3a 17      6949   6966 
                                        ;                    6950   6967 ;
CH2CH:  CP  02Ch                        ;2d61  fe 2c         6951   6968 
    RET Z                               ;2d63  c8            6952   6969 
    JR  SERVED                          ;2d64  18 f8         6953   6970 
                                        ;                    6954   6971 ;
CH29H:  CP  029h                        ;2d66  fe 29         6955   6972 
    RET Z                               ;2d68  c8            6956   6973 
    JR  SERVED                          ;2d69  18 f3         6957   6974 
                                        ;                    6958   6975 ;
MEM$:   CALL    CH28H                   ;2d6b  cd 58 2d      6959   6976 
    DEC IY                              ;2d6e  fd 2b         6960   6977 
    PUSH    HL                          ;2d70  e5            6961   6978 
    CALL    FLEXP'                      ;2d71  cd 9c 22      6962   6979 
    CALL    CH2CH                       ;2d74  cd 61 2d      6963   6980 
    CALL    HLFLTO                      ;2d77  cd 97 2d      6964   6981 
    EX  DE,HL                           ;2d7a  eb            6965   6982 
    POP HL                              ;2d7b  e1            6966   6983 
    PUSH    DE                          ;2d7c  d5            6967   6984 
    CALL    FLEXP'                      ;2d7d  cd 9c 22      6968   6985 
    CALL    CH29H                       ;2d80  cd 66 2d      6969   6986 
    INC IY                              ;2d83  fd 23         6970   6987 
    PUSH    HL                          ;2d85  e5            6971   6988 
    CALL    HLFLTO                      ;2d86  cd 97 2d      6972   6989 
    CALL    HCHECK                      ;2d89  cd d8 22      6973   6990 
    POP HL                              ;2d8c  e1            6974   6991 
    POP DE                              ;2d8d  d1            6975   6992 
    PUSH    BC                          ;2d8e  c5            6976   6993 
    LD  B,A                             ;2d8f  47            6977   6994 
    CALL    ENTSTR                      ;2d90  cd 1a 2b      6978   6995 
    POP BC                              ;2d93  c1            6979   6996 
    JP  CONDSB                          ;2d94  c3 b1 25      6980   6997 
                                        ;                    6981   6998 ;
                                        ;                    6982   6999 ;
HLFLTO: CALL    HLFLT                   ;2d97  cd 67 61      6983   7000 
    RET NC                              ;2d9a  d0            6984   7001 
    JP  OVERFL                          ;2d9b  c3 b8 30      6985   7002 
                                        ;                    6986   7003 ;
GETSTR: PUSH    BC                      ;2d9e  c5            6987   7004 
    PUSH    HL                          ;2d9f  e5            6988   7005 
    PUSH    DE                          ;2da0  d5            6989   7006 
    XOR A                               ;2da1  af            6990   7007 
    LD  B,(HL)                          ;2da2  46            6991   7008 
    OR  B                               ;2da3  b0            6992   7009 
    JR  Z,NULSTR                        ;2da4  28 3d         6993   7010 
    INC HL                              ;2da6  23            6994   7011 
    LD  E,(HL)                          ;2da7  5e            6995   7012 
    INC HL                              ;2da8  23            6996   7013 
    LD  D,(HL)                          ;2da9  56            6997   7014 
    LD  HL,(STRPTR)                     ;2daa  2a 3d 7a      6998   7015 
    XOR A                               ;2dad  af            6999   7016 
    LD  C,B                             ;2dae  48            7000   7017 
    LD  B,A                             ;2daf  47            7001   7018 
    SBC HL,BC                           ;2db0  ed 42         7002   7019 
    DEC HL                              ;2db2  2b            7003   7020 
    DEC HL                              ;2db3  2b            7004   7021 
    PUSH    HL                          ;2db4  e5            7005   7022 
    PUSH    DE                          ;2db5  d5            7006   7023 
    LD  DE,(STRTOP)                     ;2db6  ed 5b 41 7a   7007   7024 
    OR  A                               ;2dba  b7            7008   7025 
    SBC HL,DE                           ;2dbb  ed 52         7009   7026 
    POP DE                              ;2dbd  d1            7010   7027 
    POP HL                              ;2dbe  e1            7011   7028 
    JR  C,PURGE                         ;2dbf  38 76         7012   7029 
    LD  (STRPTR),HL                     ;2dc1  22 3d 7a      7013   7030 
    EX  DE,HL                           ;2dc4  eb            7014   7031 
    EX  (SP),HL                         ;2dc5  e3            7015   7032 
    EX  DE,HL                           ;2dc6  eb            7016   7033 
    LD  (HL),E                          ;2dc7  73            7017   7034 
    INC HL                              ;2dc8  23            7018   7035 
    LD  (HL),D                          ;2dc9  72            7019   7036 
    INC HL                              ;2dca  23            7020   7037 
    EX  DE,HL                           ;2dcb  eb            7021   7038 
    EX  (SP),HL                         ;2dcc  e3            7022   7039 
    EX  DE,HL                           ;2dcd  eb            7023   7040 
    LD  B,C                             ;2dce  41            7024   7041 
    PUSH    HL                          ;2dcf  e5            7025   7042 
STRTRL: LD  A,(DE)                      ;2dd0  1a            7026   7043 
    LD  (HL),A                          ;2dd1  77            7027   7044 
    INC HL                              ;2dd2  23            7028   7045 
    INC DE                              ;2dd3  13            7029   7046 
    DJNZ    STRTRL                      ;2dd4  10 fa         7030   7047 
    POP DE                              ;2dd6  d1            7031   7048 
NULBCK: POP BC                          ;2dd7  c1            7032   7049 
    POP HL                              ;2dd8  e1            7033   7050 
    INC HL                              ;2dd9  23            7034   7051 
    LD  (HL),E                          ;2dda  73            7035   7052 
    INC HL                              ;2ddb  23            7036   7053 
    LD  (HL),D                          ;2ddc  72            7037   7054 
    DEC HL                              ;2ddd  2b            7038   7055 
    DEC HL                              ;2dde  2b            7039   7056 
    LD  D,B                             ;2ddf  50            7040   7057 
    LD  E,C                             ;2de0  59            7041   7058 
    POP BC                              ;2de1  c1            7042   7059 
    RET                                 ;2de2  c9            7043   7060 
                                        ;                    7044   7061 ;
NULSTR: LD  DE,00000h                   ;2de3  11 00 00      7045   7062 
    JR  NULBCK                          ;2de6  18 ef         7046   7063 
                                        ;                    7047   7064 ;
MEMPUR: LD  (BLTHLB),HL                 ;2de8  22 c1 2e      7048   7065 
    LD  (BLTDEB),DE                     ;2deb  ed 53 c4 2e   7049   7066 
    LD  (BLTBCB),BC                     ;2def  ed 43 c7 2e   7050   7067 
    POP HL                              ;2df3  e1            7051   7068 
    LD  (BLTRTA),HL                     ;2df4  22 ca 2e      7052   7069 
    CALL    STRPRG                      ;2df7  cd cc 2e      7053   7070 
    LD  HL,(STRPTR)                     ;2dfa  2a 3d 7a      7054   7071 
    LD  DE,0FC00h                       ;2dfd  11 00 fc      7055   7072 ;-400H
    ADD HL,DE                           ;2e00  19            7056   7073 
    LD  DE,(STRTOP)                     ;2e01  ed 5b 41 7a   7057   7074 
    LD  (STRTOP),HL                     ;2e05  22 41 7a      7058   7075 
    EX  DE,HL                           ;2e08  eb            7059   7076 
    LD  (MEPDEB),HL                     ;2e09  22 1d 2e      7060   7077 
    EX  DE,HL                           ;2e0c  eb            7061   7078 
    LD  HL,0                            ;2e0d  21 00 00      7062   7079 
    ADD HL,SP                           ;2e10  39            7063   7080 
    EX  DE,HL                           ;2e11  eb            7064   7081 
    OR  A                               ;2e12  b7            7065   7082 
    SBC HL,DE                           ;2e13  ed 52         7066   7083 
    LD  C,L                             ;2e15  4d            7067   7084 
    LD  B,H                             ;2e16  44            7068   7085 
    INC BC                              ;2e17  03            7069   7086 
    LD  HL,(STRTOP)                     ;2e18  2a 41 7a      7070   7087 
    EX  DE,HL                           ;2e1b  eb            7071   7088 
    DEFB    021H                        ;2e1c  21            7072   7089 ; LD HL,
MEPDEB: DEFS    2                       ;2e1d                7073   7090 
    DI                                  ;2e1f  f3            7074   7091 
    INC DE                              ;2e20  13            7075   7092 
    INC HL                              ;2e21  23            7076   7093 
    INC BC                              ;2e22  03            7077   7094 
    LDDR                                ;2e23  ed b8         7078   7095 
    EX  DE,HL                           ;2e25  eb            7079   7096 
    INC HL                              ;2e26  23            7080   7097 
    LD  SP,HL                           ;2e27  f9            7081   7098 
    EI                                  ;2e28  fb            7082   7099 
    LD  DE,(STRTOP)                     ;2e29  ed 5b 41 7a   7083   7100 
    LD  HL,(MEPDEB)                     ;2e2d  2a 1d 2e      7084   7101 
    OR  A                               ;2e30  b7            7085   7102 
    SBC HL,DE                           ;2e31  ed 52         7086   7103 
    EX  DE,HL                           ;2e33  eb            7087   7104 
    JP  MIDMPR                          ;2e34  c3 a0 2e      7088   7105 
                                        ;                    7089   7106 ;
PURGE:  CALL    STRPRG                  ;2e37  cd cc 2e      7090   7107 
    LD  HL,(STRPTR)                     ;2e3a  2a 3d 7a      7091   7108 
    SBC HL,BC                           ;2e3d  ed 42         7092   7109 
    DEC HL                              ;2e3f  2b            7093   7110 
    DEC HL                              ;2e40  2b            7094   7111 
PURAGN: LD  DE,(STRTOP)                 ;2e41  ed 5b 41 7a   7095   7112 
    OR  A                               ;2e45  b7            7096   7113 
    SBC HL,DE                           ;2e46  ed 52         7097   7114 
    JR  C,SPBLTF                        ;2e48  38 06         7098   7115 
    POP DE                              ;2e4a  d1            7099   7116 
    POP HL                              ;2e4b  e1            7100   7117 
    POP BC                              ;2e4c  c1            7101   7118 
    JP  GETSTR                          ;2e4d  c3 9e 2d      7102   7119 
                                        ;                    7103   7120 ;
SPBLTF: CALL    STKBLT                  ;2e50  cd 55 2e      7104   7121 
    JR  PURAGN                          ;2e53  18 ec         7105   7122 
                                        ;                    7106   7123 ;
STKBLT: PUSH    HL                      ;2e55  e5            7107   7124 
    PUSH    DE                          ;2e56  d5            7108   7125 
    LD  HL,00000h                       ;2e57  21 00 00      7109   7126 
    ADD HL,SP                           ;2e5a  39            7110   7127 
    EX  DE,HL                           ;2e5b  eb            7111   7128 
    LD  HL,(STKLMT)                     ;2e5c  2a 3f 7a      7112   7129 
    INC H                               ;2e5f  24            7113   7130 
    INC H                               ;2e60  24            7114   7131 
    INC H                               ;2e61  24            7115   7132 
    OR  A                               ;2e62  b7            7116   7133 
    SBC HL,DE                           ;2e63  ed 52         7117   7134 
    JP  NC,OMERR                        ;2e65  d2 88 21      7118   7135 
    POP DE                              ;2e68  d1            7119   7136 
    POP HL                              ;2e69  e1            7120   7137 
    LD  (BLTHLB),HL                     ;2e6a  22 c1 2e      7121   7138 
    LD  (BLTDEB),DE                     ;2e6d  ed 53 c4 2e   7122   7139 
    LD  (BLTBCB),BC                     ;2e71  ed 43 c7 2e   7123   7140 
    POP HL                              ;2e75  e1            7124   7141 
    LD  (BLTRTA),HL                     ;2e76  22 ca 2e      7125   7142 
    LD  HL,0                            ;2e79  21 00 00      7126   7143 
    ADD HL,SP                           ;2e7c  39            7127   7144 
    EX  DE,HL                           ;2e7d  eb            7128   7145 
    LD  HL,(STRTOP)                     ;2e7e  2a 41 7a      7129   7146 
    OR  A                               ;2e81  b7            7130   7147 
    SBC HL,DE                           ;2e82  ed 52         7131   7148 
    LD  C,L                             ;2e84  4d            7132   7149 
    LD  B,H                             ;2e85  44            7133   7150 
    INC BC                              ;2e86  03            7134   7151 
    INC BC                              ;2e87  03            7135   7152 
    LD  HL,0FE00h                       ;2e88  21 00 fe      7136   7153 ;-200H
    ADD HL,DE                           ;2e8b  19            7137   7154 
    EX  DE,HL                           ;2e8c  eb            7138   7155 
    DI                                  ;2e8d  f3            7139   7156 
    LDIR                                ;2e8e  ed b0         7140   7157 
    LD  HL,0FE00h                       ;2e90  21 00 fe      7141   7158 ;-200H
    ADD HL,SP                           ;2e93  39            7142   7159 
    LD  SP,HL                           ;2e94  f9            7143   7160 
    EI                                  ;2e95  fb            7144   7161 
    LD  DE,0FE00h                       ;2e96  11 00 fe      7145   7162 ;-200H
    LD  HL,(STRTOP)                     ;2e99  2a 41 7a      7146   7163 
    ADD HL,DE                           ;2e9c  19            7147   7164 
    LD  (STRTOP),HL                     ;2e9d  22 41 7a      7148   7165 
MIDMPR: LD  HL,(SPBUF)                  ;2ea0  2a 25 22      7149   7166 
    ADD HL,DE                           ;2ea3  19            7150   7167 
    LD  (SPBUF),HL                      ;2ea4  22 25 22      7151   7168 
    LD  BC,FUNCNS                       ;2ea7  01 2f 26      7152   7169 
BLTAJL: LD  A,(BC)                      ;2eaa  0a            7153   7170 
    LD  L,A                             ;2eab  6f            7154   7171 
    INC BC                              ;2eac  03            7155   7172 
    LD  A,(BC)                          ;2ead  0a            7156   7173 
    LD  H,A                             ;2eae  67            7157   7174 
    OR  L                               ;2eaf  b5            7158   7175 
    JR  Z,BLTRET                        ;2eb0  28 0e         7159   7176 
    ADD HL,DE                           ;2eb2  19            7160   7177 
    LD  A,H                             ;2eb3  7c            7161   7178 
    LD  (BC),A                          ;2eb4  02            7162   7179 
    DEC BC                              ;2eb5  0b            7163   7180 
    LD  A,L                             ;2eb6  7d            7164   7181 
    LD  (BC),A                          ;2eb7  02            7165   7182 
    LD  C,L                             ;2eb8  4d            7166   7183 
    LD  B,H                             ;2eb9  44            7167   7184 
    INC BC                              ;2eba  03            7168   7185 
    INC BC                              ;2ebb  03            7169   7186 
    INC BC                              ;2ebc  03            7170   7187 
    INC BC                              ;2ebd  03            7171   7188 
    JR  BLTAJL                          ;2ebe  18 ea         7172   7189 
                                        ;                    7173   7190 ;
BLTRET: DEFB    021H                    ;2ec0  21            7174   7191 ; LD HL,?
BLTHLB: DEFS    2                       ;2ec1                7175   7192 
    DEFB    011H                        ;2ec3  11            7176   7193 ; LD DE,?
BLTDEB: DEFS    2                       ;2ec4                7177   7194 
    DEFB    001H                        ;2ec6  01            7178   7195 ; LD BC,?
BLTBCB: DEFS    2                       ;2ec7                7179   7196 
    DEFB    0C3H                        ;2ec9  c3            7180   7197 ; JP ?
BLTRTA: DEFS    2                       ;2eca                7181   7198 
                                        ;                    7182   7199 ;
STRPRG: PUSH    BC                      ;2ecc  c5            7183   7200 
    PUSH    DE                          ;2ecd  d5            7184   7201 
    PUSH    HL                          ;2ece  e5            7185   7202 
    LD  HL,(STRPTR)                     ;2ecf  2a 3d 7a      7186   7203 
FSTRTP: CALL    SREDCK                  ;2ed2  cd 59 2f      7187   7204 
    LD  C,(HL)                          ;2ed5  4e            7188   7205 
    INC HL                              ;2ed6  23            7189   7206 
    LD  B,(HL)                          ;2ed7  46            7190   7207 
    INC HL                              ;2ed8  23            7191   7208 
    XOR A                               ;2ed9  af            7192   7209 
    CP  B                               ;2eda  b8            7193   7210 
    JP  NZ,FDSRTP                       ;2edb  c2 e5 2e      7194   7211 
    ADD HL,BC                           ;2ede  09            7195   7212 
    LD  (STRPTR),HL                     ;2edf  22 3d 7a      7196   7213 
    JP  FSTRTP                          ;2ee2  c3 d2 2e      7197   7214 
                                        ;                    7198   7215 ;
FDSRTP: LD  HL,(STRPTR)                 ;2ee5  2a 3d 7a      7199   7216 
SPRGLP: CALL    SREDCK                  ;2ee8  cd 59 2f      7200   7217 
    LD  C,(HL)                          ;2eeb  4e            7201   7218 
    INC HL                              ;2eec  23            7202   7219 
    LD  B,(HL)                          ;2eed  46            7203   7220 
    INC HL                              ;2eee  23            7204   7221 
    XOR A                               ;2eef  af            7205   7222 
    CP  B                               ;2ef0  b8            7206   7223 
    JR  Z,SHORTN                        ;2ef1  28 0c         7207   7224 
    LD  A,(BC)                          ;2ef3  0a            7208   7225 
    LD  E,A                             ;2ef4  5f            7209   7226 
    LD  D,0                             ;2ef5  16 00         7210   7227 
    ADD HL,DE                           ;2ef7  19            7211   7228 
    JP  SPRGLP                          ;2ef8  c3 e8 2e      7212   7229 
ESCSPR: POP HL                          ;2efb  e1            7213   7230 
    POP DE                              ;2efc  d1            7214   7231 
    POP BC                              ;2efd  c1            7215   7232 
    RET                                 ;2efe  c9            7216   7233 
                                        ;                    7217   7234 ;
SHORTN: PUSH    HL                      ;2eff  e5            7218   7235 
SHRTNL: ADD HL,BC                       ;2f00  09            7219   7236 
    EX  DE,HL                           ;2f01  eb            7220   7237 
    LD  HL,(STRBTM)                     ;2f02  2a 45 7a      7221   7238 
    XOR A                               ;2f05  af            7222   7239 
    SBC HL,DE                           ;2f06  ed 52         7223   7240 
    EX  DE,HL                           ;2f08  eb            7224   7241 
    JR  Z,STRNST                        ;2f09  28 09         7225   7242 
    LD  C,(HL)                          ;2f0b  4e            7226   7243 
    INC HL                              ;2f0c  23            7227   7244 
    LD  B,(HL)                          ;2f0d  46            7228   7245 
    INC HL                              ;2f0e  23            7229   7246 
    CP  B                               ;2f0f  b8            7230   7247 
    JR  Z,SHRTNL                        ;2f10  28 ee         7231   7248 
    DEC HL                              ;2f12  2b            7232   7249 
    DEC HL                              ;2f13  2b            7233   7250 
STRNST: POP DE                          ;2f14  d1            7234   7251 
    DEC DE                              ;2f15  1b            7235   7252 
    DEC DE                              ;2f16  1b            7236   7253 
    DEC DE                              ;2f17  1b            7237   7254 
    PUSH    HL                          ;2f18  e5            7238   7255 
    DEC HL                              ;2f19  2b            7239   7256 
    EX  DE,HL                           ;2f1a  eb            7240   7257 
    PUSH    HL                          ;2f1b  e5            7241   7258 
    LD  BC,(STRPTR)                     ;2f1c  ed 4b 3d 7a   7242   7259 
    OR  A                               ;2f20  b7            7243   7260 
    SBC HL,BC                           ;2f21  ed 42         7244   7261 
    LD  C,L                             ;2f23  4d            7245   7262 
    LD  B,H                             ;2f24  44            7246   7263 
    INC BC                              ;2f25  03            7247   7264 
    POP HL                              ;2f26  e1            7248   7265 
    PUSH    HL                          ;2f27  e5            7249   7266 
    PUSH    DE                          ;2f28  d5            7250   7267 
    EX  DE,HL                           ;2f29  eb            7251   7268 
    OR  A                               ;2f2a  b7            7252   7269 
    SBC HL,DE                           ;2f2b  ed 52         7253   7270 
    EX  DE,HL                           ;2f2d  eb            7254   7271 
    LD  HL,(STRPTR)                     ;2f2e  2a 3d 7a      7255   7272 
    ADD HL,DE                           ;2f31  19            7256   7273 
    LD  (STRPTR),HL                     ;2f32  22 3d 7a      7257   7274 
    POP DE                              ;2f35  d1            7258   7275 
    POP HL                              ;2f36  e1            7259   7276 
    LDDR                                ;2f37  ed b8         7260   7277 
    LD  HL,(STRPTR)                     ;2f39  2a 3d 7a      7261   7278 
    POP DE                              ;2f3c  d1            7262   7279 
ADRSFL: LD  C,(HL)                      ;2f3d  4e            7263   7280 
    INC HL                              ;2f3e  23            7264   7281 
    LD  B,(HL)                          ;2f3f  46            7265   7282 
    INC HL                              ;2f40  23            7266   7283 
    LD  A,(BC)                          ;2f41  0a            7267   7284 
    EX  AF,AF'                          ;2f42  08            7268   7285 
    INC BC                              ;2f43  03            7269   7286 
    LD  A,L                             ;2f44  7d            7270   7287 
    LD  (BC),A                          ;2f45  02            7271   7288 
    INC BC                              ;2f46  03            7272   7289 
    LD  A,H                             ;2f47  7c            7273   7290 
    LD  (BC),A                          ;2f48  02            7274   7291 
    EX  AF,AF'                          ;2f49  08            7275   7292 
    ADD A,L                             ;2f4a  85            7276   7293 
    LD  L,A                             ;2f4b  6f            7277   7294 
    LD  A,000h                          ;2f4c  3e 00         7278   7295 
    ADC A,H                             ;2f4e  8c            7279   7296 
    LD  H,A                             ;2f4f  67            7280   7297 
    PUSH    HL                          ;2f50  e5            7281   7298 
    SBC HL,DE                           ;2f51  ed 52         7282   7299 
    POP HL                              ;2f53  e1            7283   7300 
    JR  NZ,ADRSFL                       ;2f54  20 e7         7284   7301 
    JP  SPRGLP                          ;2f56  c3 e8 2e      7285   7302 
                                        ;                    7286   7303 ;
SREDCK: EX  DE,HL                       ;2f59  eb            7287   7304 
    LD  HL,(STRBTM)                     ;2f5a  2a 45 7a      7288   7305 
    OR  A                               ;2f5d  b7            7289   7306 
    SBC HL,DE                           ;2f5e  ed 52         7290   7307 
    EX  DE,HL                           ;2f60  eb            7291   7308 
    JR  C,OVERST                        ;2f61  38 01         7292   7309 
    RET NZ                              ;2f63  c0            7293   7310 
OVERST: POP HL                          ;2f64  e1            7294   7311 
    JP  ESCSPR                          ;2f65  c3 fb 2e      7295   7312 
                                        ;                    7296   7313 ;
SJPTBL: DEFW    GOTO                    ;2f68  b1 43         7297   7314 ; GOTO
    DEFW    GOSUB                       ;2f6a  63 42         7298   7315 ; GOSUB
    DEFW    RUN                         ;2f6c  c3 15         7299   7316 ; RUN
    DEFW    RETURN                      ;2f6e  78 41         7300   7317 ; RETURN
    DEFW    RESTOR                      ;2f70  a5 1c         7301   7318 ; RESTORE
    DEFW    LIST                        ;2f72  7e 40         7302   7319 ; LIST
    DEFW    LIST#                       ;2f74  72 40         7303   7320 ; LIST#
    DEFW    AUTO                        ;2f76  0f 37         7304   7321 ; AUTO
    DEFW    DEL                         ;2f78  8e 37         7305   7322 ; DELETE
    DEFW    FOR                         ;2f7a  6f 19         7306   7323 ; FOR
    DEFW    NEXT                        ;2f7c  0a 1a         7307   7324 ; NEXT
    DEFW    PRINT                       ;2f7e  55 18         7308   7325 ; PRINT
    DEFW    INPUT                       ;2f80  74 1d         7309   7326 ; INPUT
    DEFW    IF                          ;2f82  01 44         7310   7327 ; IF
    DEFW    DATA                        ;2f84  c8 1c         7311   7328 ; DATA
    DEFW    READ                        ;2f86  45 1c         7312   7329 ; READ ; 90H
    DEFW    DIM                         ;2f88  03 20         7313   7330 ; DIM
    DEFW    REM                         ;2f8a  3a 18         7314   7331 ; REM
    DEFW    EDIT                        ;2f8c  22 40         7315   7332 ; EDIT
    DEFW    BREAK$                      ;2f8e  a0 16         7316   7333 ; STOP
    DEFW    CONT                        ;2f90  07 22         7317   7334 ; CONT
    DEFW    CLS                         ;2f92  42 1b         7318   7335 ; CLS
    DEFW    CLEAR                       ;2f94  ab 33         7319   7336 ; CLEAR
    DEFW    ON                          ;2f96  72 43         7320   7337 ; ON
    DEFW    LET                         ;2f98  1c 1b         7321   7338 ; LET
    DEFW    START                       ;2f9a  3d 14         7322   7339 ; START
    DEFW    POKE                        ;2f9c  23 1b         7323   7340 ; POKE
    DEFW    OFF                         ;2f9e  da 20         7324   7341 ; OFF
    DEFW    WHILE                       ;2fa0  b2 41         7325   7342 ; WHILE
    DEFW    WEND                        ;2fa2  df 41         7326   7343 ; WEND
    DEFW    REPEAT                      ;2fa4  44 42         7327   7344 ; REPEAT
    DEFW    UNTIL                       ;2fa6  3e 41         7328   7345 ; UNTIL ; A0H
    DEFW    TRACE                       ;2fa8  9b 32         7329   7346 ; TRACE
    DEFW    OK                          ;2faa  62 14         7330   7347 ; END
    DEFW    PLAY                        ;2fac  8c 47         7331   7348 ; PLAY
    DEFW    BEEPOP                      ;2fae  48 47         7332   7349 ; BEEP
    DEFW    DEFINT                      ;2fb0  30 29         7333   7350 ; DEFINT
    DEFW    DEFSNG                      ;2fb2  38 29         7334   7351 ; DEFSNG
    DEFW    DEFDBL                      ;2fb4  3c 29         7335   7352 ; DEFDBL
    DEFW    DEFSTR                      ;2fb6  34 29         7336   7353 ; DEFSTR
    DEFW    DEFFN                       ;2fb8  4d 3b         7337   7354 ; DEF
    DEFW    DUMP                        ;2fba  2f 3d         7338   7355 ; DUMP
    DEFW    LOAD                        ;2fbc  2c 39         7339   7356 ; LOAD
    DEFW    SAVE$                       ;2fbe  bb 3a         7340   7357 ; SAVE
    DEFW    MERGE                       ;2fc0  19 39         7341   7358 ; MERGE
    DEFW    NINS                        ;2fc2  fa 20         7342   7359 ; CONSOLE/WIDTH
    DEFW    OUT                         ;2fc4  67 33         7343   7360 ; OUT
    DEFW    SEARCH                      ;2fc6  2b 32         7344   7361 ; SEARCH ; B0H
    DEFW    SOUND                       ;2fc8  22 47         7345   7362 ;SOUND
    DEFW    NINS                        ;2fca  fa 20         7346   7363 ; WRITE
    DEFW    SWAP                        ;2fcc  ef 32         7347   7364 ; SWAP
    DEFW    NINS                        ;2fce  fa 20         7348   7365 ; ERASE
    DEFW    ERTEST                      ;2fd0  14 1b         7349   7366 ; ERROR
    DEFW    RESUME                      ;2fd2  4f 22         7350   7367 ; RESUME
    DEFW    RENUM                       ;2fd4  aa 37         7351   7368 ; RENUM
    DEFW    REM                         ;2fd6  3a 18         7352   7369 ; ELSE
    DEFW    CALLUP                      ;2fd8  74 29         7353   7370 ; CALL
    DEFW    LOCATE                      ;2fda  25 1c         7354   7371 ; LOCATE
    DEFW    NINS                        ;2fdc  fa 20         7355   7372 ; MAT
    DEFW    MONOP                       ;2fde  50 04         7356   7373 ; MON
    DEFW    HCOPY                       ;2fe0  d3 50         7357   7374 ; HCOPY
    DEFW    KEY                         ;2fe2  75 3e         7358   7375 ; KEY
    DEFW    VPUSH                       ;2fe4  6d 44         7359   7376 ; PUSH
    DEFW    VPOP                        ;2fe6  b4 44         7360   7377 ; POP ; C0H
    DEFW    NINS                        ;2fe8  fa 20         7361   7378 ;BASE
    DEFW    DATA                        ;2fea  c8 1c         7362   7379 ; LABEL
    DEFW    NINS                        ;2fec  fa 20         7363   7380 ; RANDOMIZE
    DEFW    SCREEN                      ;2fee  59 1b         7364   7381 ;SCREEN
    DEFW    LINE                        ;2ff0  e7 1c         7365   7382 ; LINE
    DEFW    COLOR                       ;2ff2  e9 47         7366   7383 ; COLOR
    DEFW    PSET                        ;2ff4  03 48         7367   7384 ; PSET
    DEFW    PRESET                      ;2ff6  fa 47         7368   7385 ; PRESET
    DEFW    GSAVES                      ;2ff8  ea 1b         7369   7386 ;CGINIT
    DEFW    PATTEN                      ;2ffa  28 50         7370   7387 ;PATTERN
    DEFW    CIRCLE                      ;2ffc  de 4b         7371   7388 ;CIRCLE
    DEFW    PAINT                       ;2ffe  c1 4e         7372   7389 ; PAINT
    DEFW    ROPEN                       ;3000  f4 38         7373   7390 ; ROPEN
    DEFW    WOPEN                       ;3002  51 3a         7374   7391 ; WOPEN
    DEFW    CLOSE                       ;3004  82 33         7375   7392 ; CLOSE
                                        ;                    7376   7393 ;DEFW	NINS	; FILES
                                        ;                    7377   7394 ;DEFW	NINS	; RENAME
                                        ;                    7378   7395 ;DEFW	NINS	; KILL
                                        ;                    7379   7396 ;DEFW	NINS	; LSET
                                        ;                    7380   7397 ;DEFW	NINS	; RSET
                                        ;                    7381   7398 ;DEFW	NINS	; FORMAT
                                        ;                    7382   7399 ;DEFW	NINS	; INIT
                                        ;                    7383   7400 ;DEFW	NINS	; CHAIN
                                        ;                    7384   7401 ;DEFW	NINS	; PEN
                                        ;                    7385   7402 ;DEFW	NINS	; COM
                                        ;                    7386   7403 ;DEFW	NINS	; PAUSE ; DEH
                                        ;                    7387   7404 ;
FJPTBL: DEFW    INTG                    ;3006  8d 29         7388   7405 ; INT 81H
    DEFW    RESNHL                      ;3008  c0 6b         7389   7406 ; ABS
    DEFW    B_SIN                       ;300a  57 75         7390   7407 ; SIN
    DEFW    B_COS                       ;300c  45 75         7391   7408 ; COS
    DEFW    B_TAN                       ;300e  46 76         7392   7409 ; TAN
    DEFW    B_LOG                       ;3010  bd 78         7393   7410 ; LOG 078bdh
    DEFW    B_EXP                       ;3012  ca 77         7394   7411 ; EXP
    DEFW    B_SQR                       ;3014  b9 73         7395   7412 ; SQR
    DEFW    B_RND                       ;3016  99 77         7396   7413 ; RND
    DEFW    PEEK                        ;3018  14 2a         7397   7414 ; PEEK
    DEFW    B_ATN                       ;301a  77 74         7398   7415 ; ATN
    DEFW    B_SGN                       ;301c  52 77         7399   7416 ; SGN
    DEFW    FRACSB                      ;301e  0e 2a         7400   7417 ; FRAC
    DEFW    INT                         ;3020  10 60         7401   7418 ; FIX
    DEFW    B_PAI                       ;3022  6f 77         7402   7419 ; PAI   776fh
    DEFW    B_RAD                       ;3024  6a 77         7403   7420 ; RAD 90H 776ah
    DEFW    B_INP                       ;3026  88 77         7404   7421 ; INP   7788h
    DEFW    CDBL                        ;3028  21 2b         7405   7422 ; CDBL
    DEFW    CSNG                        ;302a  26 2b         7406   7423 ; CSNG
    DEFW    CINT                        ;302c  5a 2b         7407   7424 ; CINT
    DEFW    NINS                        ;302e  fa 20         7408   7425 ; DSKF
    DEFW    NINS                        ;3030  fa 20         7409   7426 ; EOF
    DEFW    NINS                        ;3032  fa 20         7410   7427 ; FPOS
    DEFW    NINS                        ;3034  fa 20         7411   7428 ; LOC
    DEFW    NINS                        ;3036  fa 20         7412   7429 ; LOF
    DEFW    POS                         ;3038  4f 37         7413   7430 ; POS
    DEFW    LPOS                        ;303a  4a 37         7414   7431 ; LPOS
    DEFW    B_FACG                      ;303c  2b 74         7415   7432 ; FAC
    DEFW    B_SUM                       ;303e  09 74         7416   7433 ; SUM
    DEFW    NINS                        ;3040  fa 20         7417   7434 ; REV
    DEFW    NINS                        ;3042  fa 20         7418   7435 ; DUMMY
    DEFW    CHRSUB                      ;3044  74 28         7419   7436 ; CHR$ A0H
    DEFW    STRSUB                      ;3046  53 2a         7420   7437 ; STR$
    DEFW    HEXD                        ;3048  26 2a         7421   7438 ; HEX$
    DEFW    OCTD                        ;304a  42 2a         7422   7439 ; OCT$
    DEFW    MK1                         ;304c  75 2a         7423   7440 ; MK1$
    DEFW    MKS                         ;304e  88 2a         7424   7441 ; MKS$
    DEFW    MKD                         ;3050  8e 2a         7425   7442 ; MKD$
    DEFW    SPCSUB                      ;3052  e8 29         7426   7443 ; SPACE$
    DEFW    SPCSUB                      ;3054  e8 29         7427   7444 ; SPC
    DEFW    ASCSUB                      ;3056  d6 27         7428   7445 ; ASC A9H
    DEFW    LENSUB                      ;3058  cb 27         7429   7446 ; LEN
    DEFW    VALSUB                      ;305a  f9 27         7430   7447 ; VAL
    DEFW    CVS                         ;305c  cf 2a         7431   7448 ; CVS
    DEFW    CVD                         ;305e  ca 2a         7432   7449 ; CVD
    DEFW    CVI                         ;3060  aa 2a         7433   7450 ; CVI
    DEFW    NINS                        ;3062  fa 20         7434   7451 ; STAT
    DEFW    PARI                        ;3064  f5 2a         7435   7452 ; PARITY
    DEFW    NINS                        ;3066  fa 20         7436   7453 ; 
    DEFW    LEFT1                       ;3068  80 2b         7437   7454 ; LEFT$ (CVI)
    DEFW    RIGHT1                      ;306a  d4 2b         7438   7455 ; RIGHT$
    DEFW    MID                         ;306c  0f 2c         7439   7456 ; MID$
    DEFW    INKEY                       ;306e  28 28         7440   7457 ; INKEY$
    DEFW    INSTR                       ;3070  7a 2c         7441   7458 ; INSTR
    DEFW    FRE                         ;3072  1e 2d         7442   7459 ; FRE
    DEFW    MEM$                        ;3074  6b 2d         7443   7460 ; MEM$
    DEFW    SCRN$                       ;3076  c4 3c         7444   7461 ; SCRN
    DEFW    VARPTR                      ;3078  40 2d         7445   7462 ; VARPTR
    DEFW    STRING                      ;307a  b8 29         7446   7463 ; STRING$
    DEFW    NINS                        ;307c  fa 20         7447   7464 ; TIME$
    DEFW    FNOPR                       ;307e  f4 3b         7448   7465 ;
    DEFW    USROPR                      ;3080  78 3c         7449   7466 ; USR
    DEFW    ERR                         ;3082  58 37         7450   7467 ; ERR
    DEFW    ERL                         ;3084  72 37         7451   7468 ; ERL
    DEFW    CSRLIN                      ;3086  e8 3e         7452   7469 ; CSRLIN
                                        ;                    7453   7470 ;
                                        ;                    7454   7471 ;
DFTABL: DEFS    26                      ;3088                7455   7472 
                                        ;                    7456   7473 ;
USRTBL: DEFS    20                      ;30a2                7457   7474 
                                        ;                    7458   7475 ;
ADHLHL: ADD HL,HL                       ;30b6  29            7459   7476 
    RET NC                              ;30b7  d0            7460   7477 
OVERFL: LD  A,6                         ;30b8  3e 06         7461   7478 
    JP  ERROR                           ;30ba  c3 96 21      7462   7479 
                                        ;                    7463   7480 ;
CVBCAS: PUSH    HL                      ;30bd  e5            7464   7481 
    CALL    HEXCUL                      ;30be  cd d0 30      7465   7482 
    LD  C,L                             ;30c1  4d            7466   7483 
    LD  B,H                             ;30c2  44            7467   7484 
    DEC DE                              ;30c3  1b            7468   7485 
    DEC DE                              ;30c4  1b            7469   7486 
    POP HL                              ;30c5  e1            7470   7487 
CVBABS: LD  A,(DE)                      ;30c6  1a            7471   7488 
    CP  020h                            ;30c7  fe 20         7472   7489 
    JR  NZ,INCRTM                       ;30c9  20 03         7473   7490 
    DEC DE                              ;30cb  1b            7474   7491 
    JR  CVBABS                          ;30cc  18 f8         7475   7492 
                                        ;                    7476   7493 ;
INCRTM: INC DE                          ;30ce  13            7477   7494 
    RET                                 ;30cf  c9            7478   7495 
                                        ;                    7479   7496 ;
HEXCUL: LD  HL,00000h                   ;30d0  21 00 00      7480   7497 
LNOCLP: CALL    DEFTCH                  ;30d3  cd 51 5d      7481   7498 
    SUB 030h                            ;30d6  d6 30         7482   7499 
    RET C                               ;30d8  d8            7483   7500 
    CP  00Ah                            ;30d9  fe 0a         7484   7501 
    RET NC                              ;30db  d0            7485   7502 
    CALL    ADHLHL                      ;30dc  cd b6 30      7486   7503 
    LD  C,L                             ;30df  4d            7487   7504 
    LD  B,H                             ;30e0  44            7488   7505 
    CALL    ADHLHL                      ;30e1  cd b6 30      7489   7506 
    CALL    ADHLHL                      ;30e4  cd b6 30      7490   7507 
    ADD HL,BC                           ;30e7  09            7491   7508 
    JR  C,OVERFL                        ;30e8  38 ce         7492   7509 
    LD  C,A                             ;30ea  4f            7493   7510 
    LD  B,0                             ;30eb  06 00         7494   7511 
    ADD HL,BC                           ;30ed  09            7495   7512 
    JR  C,OVERFL                        ;30ee  38 c8         7496   7513 
    JR  LNOCLP                          ;30f0  18 e1         7497   7514 
                                        ;                    7498   7515 ;
EDITOR: CALL    CLR                     ;30f2  cd 51 19      7499   7516 
    XOR A                               ;30f5  af            7500   7517 
    LD  (CONTFG),A                      ;30f6  32 08 22      7501   7518 
    LD  (ERRORF),A                      ;30f9  32 50 22      7502   7519 
    CALL    RETLNO                      ;30fc  cd 0a 3f      7503   7520 
    CALL    HEXCUL                      ;30ff  cd d0 30      7504   7521 
    LD  (EDLINE),HL                     ;3102  22 2a 37      7505   7522 
    ADD A,030h                          ;3105  c6 30         7506   7523 
    DEC DE                              ;3107  1b            7507   7524 
    JR  Z,DELMIK                        ;3108  28 0f         7508   7525 
    DEC DE                              ;310a  1b            7509   7526 
RSFGLP: LD  A,(DE)                      ;310b  1a            7510   7527 
    CP  020h                            ;310c  fe 20         7511   7528 
    DEC DE                              ;310e  1b            7512   7529 
    JR  Z,RSFGLP                        ;310f  28 fa         7513   7530 
    INC DE                              ;3111  13            7514   7531 
    INC DE                              ;3112  13            7515   7532 
    LD  A,(DE)                          ;3113  1a            7516   7533 
    CP  020h                            ;3114  fe 20         7517   7534 
    JR  NZ,DELMIK                       ;3116  20 01         7518   7535 
    INC DE                              ;3118  13            7519   7536 
DELMIK: PUSH    HL                      ;3119  e5            7520   7537 
    PUSH    AF                          ;311a  f5            7521   7538 
    LD  HL,IMDBUF                       ;311b  21 4e 7b      7522   7539 
    CALL    CVIMTX                      ;311e  cd 25 63      7523   7540 
    LD  (IMLSTP),HL                     ;3121  22 2f 31      7524   7541 
    POP AF                              ;3124  f1            7525   7542 
    POP HL                              ;3125  e1            7526   7543 
    LD  E,L                             ;3126  5d            7527   7544 
    LD  D,H                             ;3127  54            7528   7545 
    CALL    DELETE1                     ;3128  cd a5 31      7529   7546 
    OR  A                               ;312b  b7            7530   7547 
    RET Z                               ;312c  c8            7531   7548 
    PUSH    HL                          ;312d  e5            7532   7549 
    DEFB    021H                        ;312e  21            7533   7550 ; LD HL,?
IMLSTP: DEFS    2                       ;312f                7534   7551 
    LD  DE,IMDBUF                       ;3131  11 4e 7b      7535   7552 
    OR  A                               ;3134  b7            7536   7553 
    SBC HL,DE                           ;3135  ed 52         7537   7554 
    INC HL                              ;3137  23            7538   7555 
    INC HL                              ;3138  23            7539   7556 
    INC HL                              ;3139  23            7540   7557 
    INC HL                              ;313a  23            7541   7558 
    INC HL                              ;313b  23            7542   7559 
    EX  (SP),HL                         ;313c  e3            7543   7560 
    LD  C,L                             ;313d  4d            7544   7561 
    LD  B,H                             ;313e  44            7545   7562 
    LD  HL,TEXTST                       ;313f  21 4e 7c      7546   7563 
    JR  IMDENS                          ;3142  18 04         7547   7564 
                                        ;                    7548   7565 ;
ENOSLP: LD  E,(HL)                      ;3144  5e            7549   7566 
    INC HL                              ;3145  23            7550   7567 
    LD  D,(HL)                          ;3146  56            7551   7568 
    EX  DE,HL                           ;3147  eb            7552   7569 
IMDENS: LD  E,(HL)                      ;3148  5e            7553   7570 
    INC HL                              ;3149  23            7554   7571 
    LD  D,(HL)                          ;314a  56            7555   7572 
    DEC HL                              ;314b  2b            7556   7573 
    LD  A,D                             ;314c  7a            7557   7574 
    OR  E                               ;314d  b3            7558   7575 
    JR  Z,EAPEND                        ;314e  28 0e         7559   7576 
    INC HL                              ;3150  23            7560   7577 
    INC HL                              ;3151  23            7561   7578 
    LD  E,(HL)                          ;3152  5e            7562   7579 
    INC HL                              ;3153  23            7563   7580 
    LD  D,(HL)                          ;3154  56            7564   7581 
    EX  DE,HL                           ;3155  eb            7565   7582 
    SBC HL,BC                           ;3156  ed 42         7566   7583 
    DEC DE                              ;3158  1b            7567   7584 
    DEC DE                              ;3159  1b            7568   7585 
    DEC DE                              ;315a  1b            7569   7586 
    EX  DE,HL                           ;315b  eb            7570   7587 
    JR  C,ENOSLP                        ;315c  38 e6         7571   7588 
EAPEND: POP DE                          ;315e  d1            7572   7589 
    PUSH    BC                          ;315f  c5            7573   7590 ; L NO
    PUSH    HL                          ;3160  e5            7574   7591 ; INS POINTER
    PUSH    DE                          ;3161  d5            7575   7592 ; LENGTH
    EX  DE,HL                           ;3162  eb            7576   7593 
    LD  HL,(VSTART)                     ;3163  2a 3b 7a      7577   7594 
    PUSH    HL                          ;3166  e5            7578   7595 
    SBC HL,DE                           ;3167  ed 52         7579   7596 
    LD  C,L                             ;3169  4d            7580   7597 
    LD  B,H                             ;316a  44            7581   7598 
    POP HL                              ;316b  e1            7582   7599 
    POP DE                              ;316c  d1            7583   7600 
    PUSH    DE                          ;316d  d5            7584   7601 
    EX  DE,HL                           ;316e  eb            7585   7602 
    ADD HL,DE                           ;316f  19            7586   7603 
    CALL    HMEMCK                      ;3170  cd ab 1e      7587   7604 
    LD  (VSTART),HL                     ;3173  22 3b 7a      7588   7605 
    EX  DE,HL                           ;3176  eb            7589   7606 
    INC BC                              ;3177  03            7590   7607 
    LDDR                                ;3178  ed b8         7591   7608 
    POP BC                              ;317a  c1            7592   7609 ; LENGTH
    POP DE                              ;317b  d1            7593   7610 ; INS POINTER
    POP HL                              ;317c  e1            7594   7611 ; L NO
    PUSH    DE                          ;317d  d5            7595   7612 
    EX  DE,HL                           ;317e  eb            7596   7613 
    INC HL                              ;317f  23            7597   7614 
    INC HL                              ;3180  23            7598   7615 
    LD  (HL),E                          ;3181  73            7599   7616 
    INC HL                              ;3182  23            7600   7617 
    LD  (HL),D                          ;3183  72            7601   7618 
    INC HL                              ;3184  23            7602   7619 
    EX  DE,HL                           ;3185  eb            7603   7620 
    LD  HL,IMDBUF                       ;3186  21 4e 7b      7604   7621 
    PUSH    BC                          ;3189  c5            7605   7622 
    DEC BC                              ;318a  0b            7606   7623 
    DEC BC                              ;318b  0b            7607   7624 
    DEC BC                              ;318c  0b            7608   7625 
    DEC BC                              ;318d  0b            7609   7626 
    LDIR                                ;318e  ed b0         7610   7627 
    POP BC                              ;3190  c1            7611   7628 
    POP HL                              ;3191  e1            7612   7629 
    LD  (HL),E                          ;3192  73            7613   7630 
    INC HL                              ;3193  23            7614   7631 
    LD  (HL),D                          ;3194  72            7615   7632 
    EX  DE,HL                           ;3195  eb            7616   7633 
RELPTR: LD  E,(HL)                      ;3196  5e            7617   7634 
    INC HL                              ;3197  23            7618   7635 
    LD  D,(HL)                          ;3198  56            7619   7636 
    LD  A,D                             ;3199  7a            7620   7637 
    OR  E                               ;319a  b3            7621   7638 
    RET Z                               ;319b  c8            7622   7639 
    EX  DE,HL                           ;319c  eb            7623   7640 
    ADD HL,BC                           ;319d  09            7624   7641 
    EX  DE,HL                           ;319e  eb            7625   7642 
    LD  (HL),D                          ;319f  72            7626   7643 
    DEC HL                              ;31a0  2b            7627   7644 
    LD  (HL),E                          ;31a1  73            7628   7645 
    EX  DE,HL                           ;31a2  eb            7629   7646 
    JR  RELPTR                          ;31a3  18 f1         7630   7647 
                                        ;                    7631   7648 ;
DELETE1: PUSH   AF                      ;31a5  f5            7632   7649 ; 315ah
    PUSH    BC                          ;31a6  c5            7633   7650 
    PUSH    HL                          ;31a7  e5            7634   7651 
    PUSH    DE                          ;31a8  d5            7635   7652 
    LD  C,L                             ;31a9  4d            7636   7653 
    LD  B,H                             ;31aa  44            7637   7654 
    LD  HL,TEXTST                       ;31ab  21 4e 7c      7638   7655 
FSTLOP: LD  E,(HL)                      ;31ae  5e            7639   7656 
    INC HL                              ;31af  23            7640   7657 
    LD  D,(HL)                          ;31b0  56            7641   7658 
    INC HL                              ;31b1  23            7642   7659 
    LD  A,E                             ;31b2  7b            7643   7660 
    OR  D                               ;31b3  b2            7644   7661 
    JR  NZ,FDDLST                       ;31b4  20 08         7645   7662 
RTDLTE: POP DE                          ;31b6  d1            7646   7663 
    POP HL                              ;31b7  e1            7647   7664 
    POP BC                              ;31b8  c1            7648   7665 
    POP AF                              ;31b9  f1            7649   7666 
    RET                                 ;31ba  c9            7650   7667 
                                        ;                    7651   7668 ;
POPDLR: POP DE                          ;31bb  d1            7652   7669 
    JR  RTDLTE                          ;31bc  18 f8         7653   7670 
                                        ;                    7654   7671 ;
FDDLST: PUSH    DE                      ;31be  d5            7655   7672 
    LD  E,(HL)                          ;31bf  5e            7656   7673 
    INC HL                              ;31c0  23            7657   7674 
    LD  D,(HL)                          ;31c1  56            7658   7675 
    EX  DE,HL                           ;31c2  eb            7659   7676 
    LD  (LNOTBF),HL                     ;31c3  22 d3 31      7660   7677 
    SBC HL,BC                           ;31c6  ed 42         7661   7678 
    POP HL                              ;31c8  e1            7662   7679 
    JR  C,FSTLOP                        ;31c9  38 e3         7663   7680 
    DEC DE                              ;31cb  1b            7664   7681 
    DEC DE                              ;31cc  1b            7665   7682 
    DEC DE                              ;31cd  1b            7666   7683 
    POP BC                              ;31ce  c1            7667   7684 ; DELETE END LINE NO.
    PUSH    BC                          ;31cf  c5            7668   7685 
    PUSH    DE                          ;31d0  d5            7669   7686 ; DELETE START ADRS
    PUSH    HL                          ;31d1  e5            7670   7687 ; NEXT LINE ADRS
    DEFB    021H                        ;31d2  21            7671   7688 ; LD HL,?
LNOTBF: DEFS    2                       ;31d3                7672   7689 
    SBC HL,BC                           ;31d5  ed 42         7673   7690 
    POP HL                              ;31d7  e1            7674   7691 
    JR  Z,DLSTRT                        ;31d8  28 1a         7675   7692 ; DEL-LINE END FOUND
    JR  NC,POPDLR                       ;31da  30 df         7676   7693 ; NOTHING OCCUR
SNDDLP: LD  E,(HL)                      ;31dc  5e            7677   7694 ; END S-LOOP
    INC HL                              ;31dd  23            7678   7695 
    LD  D,(HL)                          ;31de  56            7679   7696 
    INC HL                              ;31df  23            7680   7697 
    LD  A,D                             ;31e0  7a            7681   7698 
    OR  E                               ;31e1  b3            7682   7699 
    JR  Z,DLEFD'                        ;31e2  28 0e         7683   7700 
    PUSH    DE                          ;31e4  d5            7684   7701 
    LD  E,(HL)                          ;31e5  5e            7685   7702 
    INC HL                              ;31e6  23            7686   7703 
    LD  D,(HL)                          ;31e7  56            7687   7704 
    EX  DE,HL                           ;31e8  eb            7688   7705 
    SBC HL,BC                           ;31e9  ed 42         7689   7706 
    POP HL                              ;31eb  e1            7690   7707 
    JR  C,SNDDLP                        ;31ec  38 ee         7691   7708 
    JR  Z,DLSTRT                        ;31ee  28 04         7692   7709 
    EX  DE,HL                           ;31f0  eb            7693   7710 
    DEC HL                              ;31f1  2b            7694   7711 
DLEFD': DEC HL                          ;31f2  2b            7695   7712 
    DEC HL                              ;31f3  2b            7696   7713 
DLSTRT: POP DE                          ;31f4  d1            7697   7714 
    PUSH    DE                          ;31f5  d5            7698   7715 
    PUSH    HL                          ;31f6  e5            7699   7716 
    OR  A                               ;31f7  b7            7700   7717 
    SBC HL,DE                           ;31f8  ed 52         7701   7718 
    LD  C,L                             ;31fa  4d            7702   7719 
    LD  B,H                             ;31fb  44            7703   7720 
    POP HL                              ;31fc  e1            7704   7721 
    POP DE                              ;31fd  d1            7705   7722 
    PUSH    BC                          ;31fe  c5            7706   7723 
    PUSH    DE                          ;31ff  d5            7707   7724 
    PUSH    DE                          ;3200  d5            7708   7725 
    PUSH    HL                          ;3201  e5            7709   7726 
    EX  DE,HL                           ;3202  eb            7710   7727 
    LD  HL,(VSTART)                     ;3203  2a 3b 7a      7711   7728 
    OR  A                               ;3206  b7            7712   7729 
    SBC HL,DE                           ;3207  ed 52         7713   7730 
    LD  C,L                             ;3209  4d            7714   7731 
    LD  B,H                             ;320a  44            7715   7732 
    POP HL                              ;320b  e1            7716   7733 
    POP DE                              ;320c  d1            7717   7734 
    LDIR                                ;320d  ed b0         7718   7735 
    EX  DE,HL                           ;320f  eb            7719   7736 
    LD  (VSTART),HL                     ;3210  22 3b 7a      7720   7737 
    CALL    CLR                         ;3213  cd 51 19      7721   7738 
    POP HL                              ;3216  e1            7722   7739 
    POP BC                              ;3217  c1            7723   7740 
DRNLOP: LD  E,(HL)                      ;3218  5e            7724   7741 
    INC HL                              ;3219  23            7725   7742 
    LD  D,(HL)                          ;321a  56            7726   7743 
    LD  A,D                             ;321b  7a            7727   7744 
    OR  E                               ;321c  b3            7728   7745 
    JP  Z,RTDLTE                        ;321d  ca b6 31      7729   7746 
    EX  DE,HL                           ;3220  eb            7730   7747 
    OR  A                               ;3221  b7            7731   7748 
    SBC HL,BC                           ;3222  ed 42         7732   7749 
    EX  DE,HL                           ;3224  eb            7733   7750 
    LD  (HL),D                          ;3225  72            7734   7751 
    DEC HL                              ;3226  2b            7735   7752 
    LD  (HL),E                          ;3227  73            7736   7753 
    EX  DE,HL                           ;3228  eb            7737   7754 
    JR  DRNLOP                          ;3229  18 ed         7738   7755 
                                        ;                    7739   7756 ;
                                        ;                    7740   7757 ;
                                        ;                    7741   7758 ;	CHAIN	,LIST
                                        ;                    7742   7759 ;
                                        ;                    7743   7760 ;   LIST
                                        ;                    7744   7761 ;
SEARCH: XOR A                           ;322b  af            7745   7762 
    LD  (DISFLG),A                      ;322c  32 eb 11      7746   7763 
    CALL    HLFTCH                      ;322f  cd 87 29      7747   7764 
    CP  023h                            ;3232  fe 23         7748   7765 
    JR  NZ,SEARC'                       ;3234  20 06         7749   7766 
    LD  A,2                             ;3236  3e 02         7750   7767 
    LD  (DISFLG),A                      ;3238  32 eb 11      7751   7768 
    INC HL                              ;323b  23            7752   7769 
SEARC': CALL    STREXZ                  ;323c  cd 9b 45      7753   7770 
    OR  A                               ;323f  b7            7754   7771 
    JP  Z,IFCALL                        ;3240  ca 36 17      7755   7772 
    PUSH    BC                          ;3243  c5            7756   7773 
    LD  (SERLEN),A                      ;3244  32 90 32      7757   7774 
    LD  (MATLEN),A                      ;3247  32 62 32      7758   7775 
    LD  (SERDEB),DE                     ;324a  ed 53 95 32   7759   7776 
    LD  (MARDEB),DE                     ;324e  ed 53 5c 32   7760   7777 
    CALL    SLIST                       ;3252  cd 50 40      7761   7778 
    POP HL                              ;3255  e1            7762   7779 
    DEC HL                              ;3256  2b            7763   7780 
    RET                                 ;3257  c9            7764   7781 
                                        ;                    7765   7782 ;
SERVEC: PUSH    DE                      ;3258  d5            7766   7783 
    PUSH    HL                          ;3259  e5            7767   7784 
    LD  B,A                             ;325a  47            7768   7785 
    DEFB    021H                        ;325b  21            7769   7786 ; LD HL,?
MARDEB: DEFS    2                       ;325c                7770   7787 
    CP  (HL)                            ;325e  be            7771   7788 
    JR  NZ,SERNMT                       ;325f  20 11         7772   7789 
    DEFB    03EH                        ;3261  3e            7773   7790 ; LD A,?
MATLEN: DEFS    1                       ;3262                7774   7791 
    DEC A                               ;3263  3d            7775   7792 
    LD  (MATLEN),A                      ;3264  32 62 32      7776   7793 
    JR  Z,MATLIS                        ;3267  28 0e         7777   7794 
    INC HL                              ;3269  23            7778   7795 
    LD  (MARDEB),HL                     ;326a  22 5c 32      7779   7796 
SERRTT: POP HL                          ;326d  e1            7780   7797 
    POP DE                              ;326e  d1            7781   7798 
    JP  CTIRTR                          ;326f  c3 00 41      7782   7799 
                                        ;                    7783   7800 ;
SERNMT: CALL    SERINT                  ;3272  cd 8f 32      7784   7801 
    JR  SERRTT                          ;3275  18 f6         7785   7802 
                                        ;                    7786   7803 ;
MATLIS: DEFB    011H                    ;3277  11            7787   7804 ; LD DE,?
SERDIS: DEFS    2                       ;3278                7788   7805 
SERLPP: LD  A,(DE)                      ;327a  1a            7789   7806 
    OR  A                               ;327b  b7            7790   7807 
    JR  Z,ESSRSP                        ;327c  28 06         7791   7808 
    CALL    ACCPRT                      ;327e  cd 64 08      7792   7809 
    INC DE                              ;3281  13            7793   7810 
    JR  SERLPP                          ;3282  18 f6         7794   7811 
                                        ;                    7795   7812 ;
ESSRSP: CALL    CR2                     ;3284  cd 23 08      7796   7813 
    JR  SERRTT                          ;3287  18 e4         7797   7814 
                                        ;                    7798   7815 ;
SER0DH: CALL    SERINT                  ;3289  cd 8f 32      7799   7816 
    JP  LISCRC                          ;328c  c3 11 41      7800   7817 
                                        ;                    7801   7818 ;
SERINT: DEFB    03EH                    ;328f  3e            7802   7819 ; LD A,?
SERLEN: DEFS    1                       ;3290                7803   7820 
    LD  (MATLEN),A                      ;3291  32 62 32      7804   7821 
    DEFB    021H                        ;3294  21            7805   7822 ; LD HL,?
SERDEB: DEFS    2                       ;3295                7806   7823 
    LD  (MARDEB),HL                     ;3297  22 5c 32      7807   7824 
    RET                                 ;329a  c9            7808   7825 
                                        ;                    7809   7826 ;
TRACE:  CALL    HLFTCH                  ;329b  cd 87 29      7810   7827 
    OR  A                               ;329e  b7            7811   7828 
    JR  Z,TROFF                         ;329f  28 49         7812   7829 
    CP  03Ah                            ;32a1  fe 3a         7813   7830 
    JR  Z,TROFF                         ;32a3  28 45         7814   7831 
    CALL    STREXZ                      ;32a5  cd 9b 45      7815   7832 
    LD  A,(HL)                          ;32a8  7e            7816   7833 
    OR  A                               ;32a9  b7            7817   7834 
    JR  Z,TRCOFF                        ;32aa  28 38         7818   7835 
    PUSH    BC                          ;32ac  c5            7819   7836 
    INC HL                              ;32ad  23            7820   7837 
    LD  B,A                             ;32ae  47            7821   7838 
    CALL    INDRCT                      ;32af  cd a3 2a      7822   7839 
    CALL    TROFF                       ;32b2  cd ea 32      7823   7840 
    EX  DE,HL                           ;32b5  eb            7824   7841 
    LD  HL,TRACEF                       ;32b6  21 29 16      7825   7842 
TRLTPR: LD  A,(DE)                      ;32b9  1a            7826   7843 
    CP  048h                            ;32ba  fe 48         7827   7844 ; HOME?
    JR  NZ,TRACL0                       ;32bc  20 02         7828   7845 
    SET 0,(HL)                          ;32be  cb c6         7829   7846 
TRACL0: CP  050h                        ;32c0  fe 50         7830   7847 
    JR  NZ,TRACL1                       ;32c2  20 02         7831   7848 ; PRINTER?
    SET 1,(HL)                          ;32c4  cb ce         7832   7849 
TRACL1: CP  04Eh                        ;32c6  fe 4e         7833   7850 ; NUMBER?
    JR  NZ,TRACL2                       ;32c8  20 02         7834   7851 
    SET 2,(HL)                          ;32ca  cb d6         7835   7852 
TRACL2: CP  04Ch                        ;32cc  fe 4c         7836   7853 ; LIST?
    JR  NZ,TRACL3                       ;32ce  20 02         7837   7854 
    SET 3,(HL)                          ;32d0  cb de         7838   7855 
TRACL3: CP  053h                        ;32d2  fe 53         7839   7856 ; STEP?
    JR  NZ,TRACL4                       ;32d4  20 02         7840   7857 
    SET 4,(HL)                          ;32d6  cb e6         7841   7858 
TRACL4: CP  044h                        ;32d8  fe 44         7842   7859 ; DUMP?
    JR  NZ,TRACLP                       ;32da  20 02         7843   7860 
    SET 5,(HL)                          ;32dc  cb ee         7844   7861 
TRACLP: INC DE                          ;32de  13            7845   7862 
    DJNZ    TRLTPR                      ;32df  10 d8         7846   7863 
    POP BC                              ;32e1  c1            7847   7864 
    JR  RTTRAC                          ;32e2  18 03         7848   7865 
                                        ;                    7849   7866 ;
TRCOFF: CALL    TROFF                   ;32e4  cd ea 32      7850   7867 
RTTRAC: JP  RETIRQ                      ;32e7  c3 39 1b      7851   7868 
                                        ;                    7852   7869 ;
TROFF:  XOR A                           ;32ea  af            7853   7870 
    LD  (TRACEF),A                      ;32eb  32 29 16      7854   7871 
    RET                                 ;32ee  c9            7855   7872 
                                        ;                    7856   7873 ;
SWAP:   LD  C,L                         ;32ef  4d            7857   7874 
    LD  B,H                             ;32f0  44            7858   7875 
    CALL    GETVAC                      ;32f1  cd d3 1e      7859   7876 
    PUSH    HL                          ;32f4  e5            7860   7877 
    PUSH    AF                          ;32f5  f5            7861   7878 
    CALL    BCFTCH                      ;32f6  cd c4 25      7862   7879 
    CALL    CH2CH                       ;32f9  cd 61 2d      7863   7880 
    CALL    GETVAC                      ;32fc  cd d3 1e      7864   7881 
    POP DE                              ;32ff  d1            7865   7882 
    CP  D                               ;3300  ba            7866   7883 
    JP  NZ,TYPEMS                       ;3301  c2 32 17      7867   7884 
    POP DE                              ;3304  d1            7868   7885 
    PUSH    AF                          ;3305  f5            7869   7886 
    PUSH    BC                          ;3306  c5            7870   7887 
    LD  B,A                             ;3307  47            7871   7888 
    LD  C,B                             ;3308  48            7872   7889 
    PUSH    HL                          ;3309  e5            7873   7890 
    PUSH    DE                          ;330a  d5            7874   7891 
    LD  (SWAPHL),DE                     ;330b  ed 53 49 33   7875   7892 
    LD  HL,ZFAC                         ;330f  21 f2 62      7876   7893 
SWTRL1: LD  A,(DE)                      ;3312  1a            7877   7894 
    LD  (HL),A                          ;3313  77            7878   7895 
    INC HL                              ;3314  23            7879   7896 
    INC DE                              ;3315  13            7880   7897 
    DJNZ    SWTRL1                      ;3316  10 fa         7881   7898 
    POP DE                              ;3318  d1            7882   7899 
    POP HL                              ;3319  e1            7883   7900 
    PUSH    HL                          ;331a  e5            7884   7901 
    PUSH    BC                          ;331b  c5            7885   7902 
    LDIR                                ;331c  ed b0         7886   7903 
    POP BC                              ;331e  c1            7887   7904 
    POP DE                              ;331f  d1            7888   7905 
    PUSH    DE                          ;3320  d5            7889   7906 
    LD  HL,ZFAC                         ;3321  21 f2 62      7890   7907 
    LDIR                                ;3324  ed b0         7891   7908 
    POP DE                              ;3326  d1            7892   7909 
    POP HL                              ;3327  e1            7893   7910 
    POP AF                              ;3328  f1            7894   7911 
    CP  003h                            ;3329  fe 03         7895   7912 
    RET NZ                              ;332b  c0            7896   7913 
    PUSH    HL                          ;332c  e5            7897   7914 ; TEXT POINT
    EX  DE,HL                           ;332d  eb            7898   7915 
    LD  A,(HL)                          ;332e  7e            7899   7916 
    OR  A                               ;332f  b7            7900   7917 
    JR  Z,NXTSAS                        ;3330  28 16         7901   7918 
    LD  E,L                             ;3332  5d            7902   7919 
    LD  D,H                             ;3333  54            7903   7920 
    INC HL                              ;3334  23            7904   7921 
    CALL    INDRCT                      ;3335  cd a3 2a      7905   7922 
    PUSH    DE                          ;3338  d5            7906   7923 
    EX  DE,HL                           ;3339  eb            7907   7924 
    LD  HL,(STRPTR)                     ;333a  2a 3d 7a      7908   7925 
    OR  A                               ;333d  b7            7909   7926 
    SBC HL,DE                           ;333e  ed 52         7910   7927 
    EX  DE,HL                           ;3340  eb            7911   7928 
    POP DE                              ;3341  d1            7912   7929 
    JR  NC,NXTSAS                       ;3342  30 04         7913   7930 
    DEC HL                              ;3344  2b            7914   7931 
    LD  (HL),H                          ;3345  74            7915   7932 
    DEC HL                              ;3346  2b            7916   7933 
    LD  (HL),L                          ;3347  75            7917   7934 
NXTSAS: DEFB    021H                    ;3348  21            7918   7935 
SWAPHL: DEFS    2                       ;3349                7919   7936 
    LD  A,(HL)                          ;334b  7e            7920   7937 
    OR  A                               ;334c  b7            7921   7938 
    JR  Z,NXTSAW                        ;334d  28 16         7922   7939 
    LD  E,L                             ;334f  5d            7923   7940 
    LD  D,H                             ;3350  54            7924   7941 
    INC HL                              ;3351  23            7925   7942 
    CALL    INDRCT                      ;3352  cd a3 2a      7926   7943 
    PUSH    DE                          ;3355  d5            7927   7944 
    EX  DE,HL                           ;3356  eb            7928   7945 
    LD  HL,(STRPTR)                     ;3357  2a 3d 7a      7929   7946 
    OR  A                               ;335a  b7            7930   7947 
    SBC HL,DE                           ;335b  ed 52         7931   7948 
    EX  DE,HL                           ;335d  eb            7932   7949 
    POP DE                              ;335e  d1            7933   7950 
    JR  NC,NXTSAW                       ;335f  30 04         7934   7951 
    DEC HL                              ;3361  2b            7935   7952 
    LD  (HL),H                          ;3362  74            7936   7953 
    DEC HL                              ;3363  2b            7937   7954 
    LD  (HL),L                          ;3364  75            7938   7955 
NXTSAW: POP HL                          ;3365  e1            7939   7956 
    RET                                 ;3366  c9            7940   7957 
                                        ;                    7941   7958 ;
OUT:    LD  C,L                         ;3367  4d            7942   7959 
    LD  B,H                             ;3368  44            7943   7960 
    CALL    IHLEXP                      ;3369  cd cc 22      7944   7961 
    CALL    CH2CH                       ;336c  cd 61 2d      7945   7962 
    LD  (OPORT),HL                      ;336f  22 7a 33      7946   7963 
    CALL    IHLEXP                      ;3372  cd cc 22      7947   7964 
    CALL    HCHECK                      ;3375  cd d8 22      7948   7965 
    PUSH    BC                          ;3378  c5            7949   7966 
    DEFB    001H                        ;3379  01            7950   7967 ;LD BC,OPOR
OPORT:  DEFW    00000H                  ;337a  00 00         7951   7968 
    OUT (C),A                           ;337c  ed 79         7952   7969 
    POP BC                              ;337e  c1            7953   7970 
    JP  RETIRQ                          ;337f  c3 39 1b      7954   7971 
                                        ;                    7955   7972 ;
CLOSE:  DEFB    03EH                    ;3382  3e            7956   7973 ; LD A,?
FILEFG: DEFS    1                       ;3383                7957   7974 
    CP  2                               ;3384  fe 02         7958   7975 
    LD  A,0                             ;3386  3e 00         7959   7976 
    LD  (FILEFG),A                      ;3388  32 83 33      7960   7977 
    JR  NZ,CLSINP                       ;338b  20 10         7961   7978 
    LD  A,00Dh                          ;338d  3e 0d         7962   7979 
    CALL    CTOUT                       ;338f  cd 58 45      7963   7980 
    XOR A                               ;3392  af            7964   7981 
    CALL    CTOUT                       ;3393  cd 58 45      7965   7982 
    XOR A                               ;3396  af            7966   7983 
    CALL    CTOUT                       ;3397  cd 58 45      7967   7984 
    CALL    CTCLOS                      ;339a  cd 86 45      7968   7985 
CLSINP: PUSH    HL                      ;339d  e5            7969   7986 
    LD  HL,LININP                       ;339e  21 93 15      7970   7987 
    LD  (LODVEC),HL                     ;33a1  22 9d 14      7971   7988 
    POP HL                              ;33a4  e1            7972   7989 
    LD  A,001h                          ;33a5  3e 01         7973   7990 
    LD  (DISFLG),A                      ;33a7  32 eb 11      7974   7991 
    RET                                 ;33aa  c9            7975   7992 
                                        ;                    7976   7993 ;
CLEAR:  CALL    HLFTCH                  ;33ab  cd 87 29      7977   7994 
    OR  A                               ;33ae  b7            7978   7995 
    JP  Z,CLR                           ;33af  ca 51 19      7979   7996 
    CP  03Ah                            ;33b2  fe 3a         7980   7997 
    JP  Z,CLR                           ;33b4  ca 51 19      7981   7998 
    LD  C,L                             ;33b7  4d            7982   7999 
    LD  B,H                             ;33b8  44            7983   8000 
    CALL    IHLEXP                      ;33b9  cd cc 22      7984   8001 
    PUSH    HL                          ;33bc  e5            7985   8002 
    LD  DE,(MEMMAX)                     ;33bd  ed 5b 49 7a   7986   8003 
    SCF                                 ;33c1  37            7987   8004 
    SBC HL,DE                           ;33c2  ed 52         7988   8005 
    JP  NC,OMERR                        ;33c4  d2 88 21      7989   8006 
    LD  DE,(VSTART)                     ;33c7  ed 5b 3b 7a   7990   8007 
    LD  HL,00800h                       ;33cb  21 00 08      7991   8008 
    ADD HL,DE                           ;33ce  19            7992   8009 
                                        ;                    7993   8010 
    POP DE                              ;33cf  d1            7994   8011 
    PUSH    DE                          ;33d0  d5            7995   8012 
    OR  A                               ;33d1  b7            7996   8013 
    SBC HL,DE                           ;33d2  ed 52         7997   8014 
    JP  NC,OMERR                        ;33d4  d2 88 21      7998   8015 
    POP HL                              ;33d7  e1            7999   8016 
    CALL    MEMSET                      ;33d8  cd e9 33      8000   8017 
    LD  SP,(STRTOP)                     ;33db  ed 7b 41 7a   8001   8018 
    LD  DE,0FFFFh                       ;33df  11 ff ff      8002   8019 
    PUSH    DE                          ;33e2  d5            8003   8020 
    LD  L,C                             ;33e3  69            8004   8021 
    LD  H,B                             ;33e4  60            8005   8022 
    DEC HL                              ;33e5  2b            8006   8023 
    JP  ONELIN                          ;33e6  c3 db 14      8007   8024 
                                        ;                    8008   8025 ;
MEMSET: LD  (MEMEND),HL                 ;33e9  22 47 7a      8009   8026 
    LD  DE,00010h                       ;33ec  11 10 00      8010   8027 
    OR  A                               ;33ef  b7            8011   8028 
    SBC HL,DE                           ;33f0  ed 52         8012   8029 
    LD  (MEMFAC),HL                     ;33f2  22 f4 22      8013   8030 
    LD  DE,000F1h                       ;33f5  11 f1 00      8014   8031 
    SBC HL,DE                           ;33f8  ed 52         8015   8032 
    LD  (INTSSP),HL                     ;33fa  22 43 7a      8016   8033 
    LD  DE,00007h                       ;33fd  11 07 00      8017   8034 
    SBC HL,DE                           ;3400  ed 52         8018   8035 
    LD  (INTFAC),HL                     ;3402  22 4b 7a      8019   8036 
    LD  DE,JT9                          ;3405  11 18 00      8020   8037 
    SBC HL,DE                           ;3408  ed 52         8021   8038 
    LD  (STRBTM),HL                     ;340a  22 45 7a      8022   8039 
    JP  CLR                             ;340d  c3 51 19      8023   8040 
                                        ;                    8024   8041 ;
USING:  CALL    STREXX                  ;3410  cd 9d 45      8025   8042 
    DEC BC                              ;3413  0b            8026   8043 
    CALL    BCFTCH                      ;3414  cd c4 25      8027   8044 
    CP  02Ch                            ;3417  fe 2c         8028   8045 
    JR  Z,OKLIOP                        ;3419  28 05         8029   8046 
    CP  03Bh                            ;341b  fe 3b         8030   8047 
    JP  NZ,SERROR                       ;341d  c2 3a 17      8031   8048 
OKLIOP: LD  A,(HL)                      ;3420  7e            8032   8049 
    CP  019h                            ;3421  fe 19         8033   8050 
USGIFC: JP  NC,IFCALL                   ;3423  d2 36 17      8034   8051 
    OR  A                               ;3426  b7            8035   8052 
    JR  Z,USGIFC                        ;3427  28 fa         8036   8053 
    INC HL                              ;3429  23            8037   8054 
    CALL    INDRCT                      ;342a  cd a3 2a      8038   8055 
    LD  DE,USINGB                       ;342d  11 b1 46      8039   8056 
    PUSH    BC                          ;3430  c5            8040   8057 
    LD  C,A                             ;3431  4f            8041   8058 
    LD  B,000h                          ;3432  06 00         8042   8059 
    LDIR                                ;3434  ed b0         8043   8060 
    POP BC                              ;3436  c1            8044   8061 
    XOR A                               ;3437  af            8045   8062 
    LD  (DE),A                          ;3438  12            8046   8063 
    INC DE                              ;3439  13            8047   8064 
    LD  (DE),A                          ;343a  12            8048   8065 
IUSGLP: LD  DE,USINGB                   ;343b  11 b1 46      8049   8066 
    XOR A                               ;343e  af            8050   8067 
    LD  (PRTEDF),A                      ;343f  32 75 34      8051   8068 
USNGLP: LD  A,(DE)                      ;3442  1a            8052   8069 
    INC DE                              ;3443  13            8053   8070 
    OR  A                               ;3444  b7            8054   8071 
    JP  Z,USINED                        ;3445  ca 74 34      8055   8072 
    CP  0C4h                            ;3448  fe c4         8056   8073 
    JR  Z,PESCCH                        ;344a  28 38         8057   8074 
    CP  021h                            ;344c  fe 21         8058   8075 
    JP  Z,PSFRST                        ;344e  ca 88 34      8059   8076 
    CP  026h                            ;3451  fe 26         8060   8077 
    JP  Z,PSMIDL                        ;3453  ca e9 34      8061   8078 
    CP  023h                            ;3456  fe 23         8062   8079 
    JP  Z,PFLENG                        ;3458  ca 81 35      8063   8080 
    CP  02Ah                            ;345b  fe 2a         8064   8081 
    JP  Z,ASTRSK                        ;345d  ca 34 35      8065   8082 
    CP  07Ch                            ;3460  fe 7c         8066   8083 
    JP  Z,VENUSG                        ;3462  ca 59 35      8067   8084 
    CP  02Eh                            ;3465  fe 2e         8068   8085 
    JP  Z,PRLEN?                        ;3467  ca 79 35      8069   8086 
    CP  02Bh                            ;346a  fe 2b         8070   8087 
    JP  Z,PLUSUS                        ;346c  ca 6b 35      8071   8088 
PUTCHS: CALL    ACCPRT                  ;346f  cd 64 08      8072   8089 
    JR  USNGLP                          ;3472  18 ce         8073   8090 
                                        ;                    8074   8091 ;
USINED: DEFB    03EH                    ;3474  3e            8075   8092 ; LD A,?
PRTEDF: DEFS    1                       ;3475                8076   8093 
    OR  A                               ;3476  b7            8077   8094 
    JP  Z,IFCALL                        ;3477  ca 36 17      8078   8095 
    LD  DE,USINGB                       ;347a  11 b1 46      8079   8096 
    XOR A                               ;347d  af            8080   8097 
    LD  (PRTEDF),A                      ;347e  32 75 34      8081   8098 
ESPUVC: DEFB    0C3H                    ;3481  c3            8082   8099 ; JP ?
URTVEC: DEFW    RETIRQ                  ;3482  39 1b         8083   8100 
                                        ;                    8084   8101 ;
PESCCH: LD  A,(DE)                      ;3484  1a            8085   8102 
    INC DE                              ;3485  13            8086   8103 
    JR  PUTCHS                          ;3486  18 e7         8087   8104 
                                        ;                    8088   8105 ;
PSFRST: PUSH    DE                      ;3488  d5            8089   8106 
    CALL    STREXX                      ;3489  cd 9d 45      8090   8107 
    CALL    CHCKRV                      ;348c  cd a2 34      8091   8108 
    POP DE                              ;348f  d1            8092   8109 
    LD  A,1                             ;3490  3e 01         8093   8110 
    LD  (PRTEDF),A                      ;3492  32 75 34      8094   8111 
    LD  A,(HL)                          ;3495  7e            8095   8112 
    OR  A                               ;3496  b7            8096   8113 
    LD  A,020h                          ;3497  3e 20         8097   8114 
    JR  Z,PUTCHS                        ;3499  28 d4         8098   8115 
    INC HL                              ;349b  23            8099   8116 
    CALL    INDRCT                      ;349c  cd a3 2a      8100   8117 
    LD  A,(HL)                          ;349f  7e            8101   8118 
    JR  PUTCHS                          ;34a0  18 cd         8102   8119 
                                        ;                    8103   8120 ;
CHCKRV: DEC BC                          ;34a2  0b            8104   8121 
    LD  A,(BC)                          ;34a3  0a            8105   8122 
    INC BC                              ;34a4  03            8106   8123 
    CP  03Bh                            ;34a5  fe 3b         8107   8124 
    JR  Z,USGCON                        ;34a7  28 0a         8108   8125 
    CP  02Ch                            ;34a9  fe 2c         8109   8126 
    JR  Z,USGCMN                        ;34ab  28 1a         8110   8127 
    PUSH    HL                          ;34ad  e5            8111   8128 
    LD  HL,CRRTIR                       ;34ae  21 e3 34      8112   8129 
    JR  PTPURV                          ;34b1  18 0f         8113   8130 
                                        ;                    8114   8131 ;
USGCON: CALL    BCFTCH                  ;34b3  cd c4 25      8115   8132 
    OR  A                               ;34b6  b7            8116   8133 
    JR  Z,PUSEMR                        ;34b7  28 24         8117   8134 
    CP  03Ah                            ;34b9  fe 3a         8118   8135 
    JR  Z,PUSEMR                        ;34bb  28 20         8119   8136 
MGFDXZ: DEC BC                          ;34bd  0b            8120   8137 
    PUSH    HL                          ;34be  e5            8121   8138 
    LD  HL,USNGLP                       ;34bf  21 42 34      8122   8139 
PTPURV: LD  (URTVEC),HL                 ;34c2  22 82 34      8123   8140 
    POP HL                              ;34c5  e1            8124   8141 
    RET                                 ;34c6  c9            8125   8142 
                                        ;                    8126   8143 ;
USGCMN: CALL    BCFTCH                  ;34c7  cd c4 25      8127   8144 
    OR  A                               ;34ca  b7            8128   8145 
    JR  Z,PUCHRA                        ;34cb  28 04         8129   8146 
    CP  03Ah                            ;34cd  fe 3a         8130   8147 
    JR  NZ,MGFDXZ                       ;34cf  20 ec         8131   8148 
PUCHRA: PUSH    HL                      ;34d1  e5            8132   8149 
    LD  HL,PULSC#                       ;34d2  21 d7 34      8133   8150 
    JR  PTPURV                          ;34d5  18 eb         8134   8151 
                                        ;                    8135   8152 ;
PULSC#: CALL    TABPRT                  ;34d7  cd 02 08      8136   8153 
    JP  RETIRQ                          ;34da  c3 39 1b      8137   8154 
                                        ;                    8138   8155 ;
PUSEMR: PUSH    HL                      ;34dd  e5            8139   8156 
    LD  HL,RETIRQ                       ;34de  21 39 1b      8140   8157 
    JR  PTPURV                          ;34e1  18 df         8141   8158 
                                        ;                    8142   8159 ;
CRRTIR: CALL    CR1                     ;34e3  cd 43 08      8143   8160 
    JP  RETIRQ                          ;34e6  c3 39 1b      8144   8161 
                                        ;                    8145   8162 ;
PSMIDL: LD  H,1                         ;34e9  26 01         8146   8163 
COUUSP: LD  A,(DE)                      ;34eb  1a            8147   8164 
    INC H                               ;34ec  24            8148   8165 
    INC DE                              ;34ed  13            8149   8166 
    CP  026h                            ;34ee  fe 26         8150   8167 
    JR  Z,ESCCSP                        ;34f0  28 07         8151   8168 
    CP  020h                            ;34f2  fe 20         8152   8169 
    JR  Z,COUUSP                        ;34f4  28 f5         8153   8170 
    JP  IFCALL                          ;34f6  c3 36 17      8154   8171 
                                        ;                    8155   8172 ;
ESCCSP: PUSH    DE                      ;34f9  d5            8156   8173 
    PUSH    HL                          ;34fa  e5            8157   8174 
    CALL    STREXX                      ;34fb  cd 9d 45      8158   8175 
    CALL    CHCKRV                      ;34fe  cd a2 34      8159   8176 
    POP AF                              ;3501  f1            8160   8177 
    CP  (HL)                            ;3502  be            8161   8178 
    PUSH    BC                          ;3503  c5            8162   8179 
    JR  NC,PRSPNE                       ;3504  30 16         8163   8180 
ZRPRUS: LD  B,A                         ;3506  47            8164   8181 
    INC HL                              ;3507  23            8165   8182 
    CALL    INDRCT                      ;3508  cd a3 2a      8166   8183 
USGMDL: LD  A,(HL)                      ;350b  7e            8167   8184 
    INC HL                              ;350c  23            8168   8185 
    CALL    ACCPRT                      ;350d  cd 64 08      8169   8186 
    DJNZ    USGMDL                      ;3510  10 f9         8170   8187 
RETIOE: POP BC                          ;3512  c1            8171   8188 
    POP DE                              ;3513  d1            8172   8189 
    LD  A,1                             ;3514  3e 01         8173   8190 
    LD  (PRTEDF),A                      ;3516  32 75 34      8174   8191 
    JP  USNGLP                          ;3519  c3 42 34      8175   8192 
                                        ;                    8176   8193 ;
PRSPNE: JR  Z,ZRPRUS                    ;351c  28 e8         8177   8194 
    SUB (HL)                            ;351e  96            8178   8195 
    PUSH    AF                          ;351f  f5            8179   8196 
    LD  B,(HL)                          ;3520  46            8180   8197 
    INC HL                              ;3521  23            8181   8198 
    CALL    INDRCT                      ;3522  cd a3 2a      8182   8199 
USGMD': LD  A,(HL)                      ;3525  7e            8183   8200 
    INC HL                              ;3526  23            8184   8201 
    CALL    ACCPRT                      ;3527  cd 64 08      8185   8202 
    DJNZ    USGMD'                      ;352a  10 f9         8186   8203 
    POP BC                              ;352c  c1            8187   8204 
SPACPT: CALL    SPPRT                   ;352d  cd 62 08      8188   8205 
    DJNZ    SPACPT                      ;3530  10 fb         8189   8206 
    JR  RETIOE                          ;3532  18 de         8190   8207 
                                        ;                    8191   8208 ;
ASTRSK: LD  A,(DE)                      ;3534  1a            8192   8209 
    CP  02Ah                            ;3535  fe 2a         8193   8210 
    LD  A,02Ah                          ;3537  3e 2a         8194   8211 
    JP  NZ,PUTCHS                       ;3539  c2 6f 34      8195   8212 
    LD  A,1                             ;353c  3e 01         8196   8213 
    LD  (PUASTF),A                      ;353e  32 c5 36      8197   8214 
    INC DE                              ;3541  13            8198   8215 
    LD  A,(DE)                          ;3542  1a            8199   8216 
    INC DE                              ;3543  13            8200   8217 
    LD  H,2                             ;3544  26 02         8201   8218 
    CP  07Ch                            ;3546  fe 7c         8202   8219 
    LD  A,0                             ;3548  3e 00         8203   8220 
    JR  NZ,PULSLS                       ;354a  20 3d         8204   8221 
    INC DE                              ;354c  13            8205   8222 
    INC H                               ;354d  24            8206   8223 
KIUYTJ: LD  A,1                         ;354e  3e 01         8207   8224 
    LD  (PUYENF),A                      ;3550  32 ae 36      8208   8225 
    XOR A                               ;3553  af            8209   8226 
    LD  (FPLUSF),A                      ;3554  32 80 36      8210   8227 
    JR  MIDFUS                          ;3557  18 33         8211   8228 
                                        ;                    8212   8229 ;
VENUSG: LD  A,(DE)                      ;3559  1a            8213   8230 
    CP  07Ch                            ;355a  fe 7c         8214   8231 
    LD  A,07Ch                          ;355c  3e 7c         8215   8232 
    JP  NZ,PUTCHS                       ;355e  c2 6f 34      8216   8233 
    XOR A                               ;3561  af            8217   8234 
    LD  (PUASTF),A                      ;3562  32 c5 36      8218   8235 
    INC DE                              ;3565  13            8219   8236 
    INC DE                              ;3566  13            8220   8237 
    LD  H,2                             ;3567  26 02         8221   8238 
    JR  KIUYTJ                          ;3569  18 e3         8222   8239 
                                        ;                    8223   8240 ;
PLUSUS: LD  A,1                         ;356b  3e 01         8224   8241 
    LD  (FPLUSF),A                      ;356d  32 80 36      8225   8242 
    XOR A                               ;3570  af            8226   8243 
    LD  (PUASTF),A                      ;3571  32 c5 36      8227   8244 
    INC DE                              ;3574  13            8228   8245 
    LD  H,1                             ;3575  26 01         8229   8246 
    JR  PULSLS                          ;3577  18 10         8230   8247 
                                        ;                    8231   8248 ;
PRLEN?: LD  A,(DE)                      ;3579  1a            8232   8249 
    CP  023h                            ;357a  fe 23         8233   8250 
    LD  A,02Eh                          ;357c  3e 2e         8234   8251 
    JP  NZ,PUTCHS                       ;357e  c2 6f 34      8235   8252 
PFLENG: XOR A                           ;3581  af            8236   8253 
    LD  H,A                             ;3582  67            8237   8254 
    LD  (FPLUSF),A                      ;3583  32 80 36      8238   8255 
    LD  (PUASTF),A                      ;3586  32 c5 36      8239   8256 ; PUT *   FLG
PULSLS: LD  (PUYENF),A                  ;3589  32 ae 36      8240   8257 ;PUT * FLG
MIDFUS: LD  (PUAFMF),A                  ;358c  32 75 36      8241   8258 ;AFTER-FLG
    LD  (PUCOMF),A                      ;358f  32 31 36      8242   8259 ; PUT ,   FLG
    LD  (INTLEN),A                      ;3592  32 5d 36      8243   8260 ; INT LENGTH
    LD  (FRCLEN),A                      ;3595  32 21 36      8244   8261 ; FRAC LENGTH
    LD  (RPLUSF),A                      ;3598  32 7b 36      8245   8262 ; ###+
    LD  (PUEXPF),A                      ;359b  32 24 36      8246   8263 ; ^^^^
    DEC DE                              ;359e  1b            8247   8264 
PUGTFC: INC H                           ;359f  24            8248   8265 
    LD  A,(DE)                          ;35a0  1a            8249   8266 
    INC DE                              ;35a1  13            8250   8267 
    CP  023h                            ;35a2  fe 23         8251   8268 
    JR  Z,PUGTFC                        ;35a4  28 f9         8252   8269 
    CP  02Ch                            ;35a6  fe 2c         8253   8270 
    JR  NZ,PUCOMP                       ;35a8  20 07         8254   8271 
    LD  A,1                             ;35aa  3e 01         8255   8272 
    LD  (PUCOMF),A                      ;35ac  32 31 36      8256   8273 
    JR  PUGTFC                          ;35af  18 ee         8257   8274 
PUCOMP: CP  02Eh                        ;35b1  fe 2e         8258   8275 
    JR  Z,PUPOIT                        ;35b3  28 1e         8259   8276 
    CP  02Dh                            ;35b5  fe 2d         8260   8277 
    JR  NZ,PUAFMO                       ;35b7  20 08         8261   8278 
    LD  A,1                             ;35b9  3e 01         8262   8279 
    LD  (PUAFMF),A                      ;35bb  32 75 36      8263   8280 
    INC DE                              ;35be  13            8264   8281 
    JR  PUAFQO                          ;35bf  18 0a         8265   8282 
PUAFMO: CP  02Bh                        ;35c1  fe 2b         8266   8283 
    JR  NZ,PUAFQO                       ;35c3  20 06         8267   8284 
    LD  A,1                             ;35c5  3e 01         8268   8285 
    LD  (RPLUSF),A                      ;35c7  32 7b 36      8269   8286 
    INC DE                              ;35ca  13            8270   8287 
PUAFQO: DEC DE                          ;35cb  1b            8271   8288 
    DEC H                               ;35cc  25            8272   8289 
    LD  A,H                             ;35cd  7c            8273   8290 
    LD  (INTLEN),A                      ;35ce  32 5d 36      8274   8291 
    JR  BEGUSG                          ;35d1  18 1e         8275   8292 
                                        ;                    8276   8293 ;
PUPOIT: DEC H                           ;35d3  25            8277   8294 
    LD  A,H                             ;35d4  7c            8278   8295 
    LD  (INTLEN),A                      ;35d5  32 5d 36      8279   8296 
    LD  H,1                             ;35d8  26 01         8280   8297 
PUPOFC: INC H                           ;35da  24            8281   8298 
    LD  A,(DE)                          ;35db  1a            8282   8299 
    INC DE                              ;35dc  13            8283   8300 
    CP  023h                            ;35dd  fe 23         8284   8301 
    JR  Z,PUPOFC                        ;35df  28 f9         8285   8302 
    CP  02Dh                            ;35e1  fe 2d         8286   8303 
    JR  NZ,PUCOPP                       ;35e3  20 06         8287   8304 
    LD  A,1                             ;35e5  3e 01         8288   8305 
    LD  (PUAFMF),A                      ;35e7  32 75 36      8289   8306 
    INC DE                              ;35ea  13            8290   8307 
PUCOPP: DEC DE                          ;35eb  1b            8291   8308 
    DEC H                               ;35ec  25            8292   8309 
    LD  A,H                             ;35ed  7c            8293   8310 
    LD  (FRCLEN),A                      ;35ee  32 21 36      8294   8311 
                                        ;                    8295   8312 ;
BEGUSG: LD  (USGDEB),DE                 ;35f1  ed 53 05 37   8296   8313 
    PUSH    BC                          ;35f5  c5            8297   8314 
    LD  B,4                             ;35f6  06 04         8298   8315 
CHEXPU: LD  A,(DE)                      ;35f8  1a            8299   8316 
    INC DE                              ;35f9  13            8300   8317 
    CP  05Eh                            ;35fa  fe 5e         8301   8318 
    JR  NZ,NEXPPU                       ;35fc  20 0b         8302   8319 
    DJNZ    CHEXPU                      ;35fe  10 f8         8303   8320 
    LD  (USGDEB),DE                     ;3600  ed 53 05 37   8304   8321 
    LD  A,1                             ;3604  3e 01         8305   8322 
    LD  (PUEXPF),A                      ;3606  32 24 36      8306   8323 
NEXPPU: POP BC                          ;3609  c1            8307   8324 
    CALL    FLEXPR                      ;360a  cd 99 22      8308   8325 
    CALL    CHCKRV                      ;360d  cd a2 34      8309   8326 
    LD  (USGBCB),BC                     ;3610  ed 43 02 37   8310   8327 
    INC HL                              ;3614  23            8311   8328 
    LD  A,(HL)                          ;3615  7e            8312   8329 
    RES 7,(HL)                          ;3616  cb be         8313   8330 
    DEC HL                              ;3618  2b            8314   8331 
    LD  (USGSGN),A                      ;3619  32 a3 36      8315   8332 
    LD  A,(INTLEN)                      ;361c  3a 5d 36      8316   8333 
    LD  B,A                             ;361f  47            8317   8334 
    DEFB    03EH                        ;3620  3e            8318   8335 ; LD A,?
FRCLEN: DEFS    1                       ;3621                8319   8336 
    LD  C,A                             ;3622  4f            8320   8337 
    DEFB    03EH                        ;3623  3e            8321   8338 ; LD A,?
PUEXPF: DEFS    1                       ;3624                8322   8339 
    CALL    USGNCV                      ;3625  cd d6 5e      8323   8340 
    PUSH    HL                          ;3628  e5            8324   8341 
    LD  DE,KEYBUF                       ;3629  11 4f 7a      8325   8342 
    LD  A,020h                          ;362c  3e 20         8326   8343 
    LD  (DE),A                          ;362e  12            8327   8344 
    INC DE                              ;362f  13            8328   8345 
    DEFB    03EH                        ;3630  3e            8329   8346 ; LD A,?
PUCOMF: DEFS    1                       ;3631                8330   8347 
    OR  A                               ;3632  b7            8331   8348 
    JR  Z,LADJS1                        ;3633  28 3f         8332   8349 
    PUSH    DE                          ;3635  d5            8333   8350 
    LD  A,(INTLEN)                      ;3636  3a 5d 36      8334   8351 
    LD  L,A                             ;3639  6f            8335   8352 
    LD  H,000h                          ;363a  26 00         8336   8353 
    ADD HL,DE                           ;363c  19            8337   8354 
    DEC HL                              ;363d  2b            8338   8355 
    LD  DE,ZFAC                         ;363e  11 f2 62      8339   8356 
    LD  C,0                             ;3641  0e 00         8340   8357 
COMN3D: LD  B,3                         ;3643  06 03         8341   8358 
COMSK3: LD  A,(HL)                      ;3645  7e            8342   8359 
    CP  020h                            ;3646  fe 20         8343   8360 
    JR  Z,ESCPUC                        ;3648  28 12         8344   8361 
    INC C                               ;364a  0c            8345   8362 
    LD  (DE),A                          ;364b  12            8346   8363 
    INC DE                              ;364c  13            8347   8364 
    DEC HL                              ;364d  2b            8348   8365 
    DJNZ    COMSK3                      ;364e  10 f5         8349   8366 
    LD  A,(HL)                          ;3650  7e            8350   8367 
    CP  020h                            ;3651  fe 20         8351   8368 
    JR  Z,ESCPUC                        ;3653  28 07         8352   8369 
PURTJM: LD  A,02Ch                      ;3655  3e 2c         8353   8370 
    LD  (DE),A                          ;3657  12            8354   8371 
    INC DE                              ;3658  13            8355   8372 
    INC C                               ;3659  0c            8356   8373 
    JR  COMN3D                          ;365a  18 e7         8357   8374 
                                        ;                    8358   8375 ;
ESCPUC: DEFB    03EH                    ;365c  3e            8359   8376 ; LD A,?
INTLEN: DEFS    1                       ;365d                8360   8377 
    CP  C                               ;365e  b9            8361   8378 
    JP  C,FOVER                         ;365f  da a6 5f      8362   8379 
    LD  B,C                             ;3662  41            8363   8380 
    LD  L,A                             ;3663  6f            8364   8381 
    LD  H,0                             ;3664  26 00         8365   8382 
    POP DE                              ;3666  d1            8366   8383 
    PUSH    DE                          ;3667  d5            8367   8384 
    ADD HL,DE                           ;3668  19            8368   8385 
    DEC HL                              ;3669  2b            8369   8386 
    LD  DE,ZFAC                         ;366a  11 f2 62      8370   8387 
COMTPU: LD  A,(DE)                      ;366d  1a            8371   8388 
    LD  (HL),A                          ;366e  77            8372   8389 
    DEC HL                              ;366f  2b            8373   8390 
    INC DE                              ;3670  13            8374   8391 
    DJNZ    COMTPU                      ;3671  10 fa         8375   8392 
    POP DE                              ;3673  d1            8376   8393 
LADJS1: DEFB    03EH                    ;3674  3e            8377   8394 ; LD A,?
PUAFMF: DEFS    1                       ;3675                8378   8395 
    OR  A                               ;3676  b7            8379   8396 
NPUSGN: JP  NZ,LADJS2                   ;3677  c2 ad 36      8380   8397 ; ###-
    DEFB    03EH                        ;367a  3e            8381   8398 ; LD A,?
RPLUSF: DEFS    1                       ;367b                8382   8399 
    OR  A                               ;367c  b7            8383   8400 ; ###+
    JR  NZ,NPUSGN                       ;367d  20 f8         8384   8401 
    DEFB    03EH                        ;367f  3e            8385   8402 ; LD A,?
FPLUSF: DEFS    1                       ;3680                8386   8403 
    OR  A                               ;3681  b7            8387   8404 ; +###
    JR  NZ,PTPLS1                       ;3682  20 1e         8388   8405 
    LD  A,(USGSGN)                      ;3684  3a a3 36      8389   8406 
    RLCA                                ;3687  07            8390   8407 
    JP  NC,LADJS2                       ;3688  d2 ad 36      8391   8408 
    LD  A,(DE)                          ;368b  1a            8392   8409 
    CP  020h                            ;368c  fe 20         8393   8410 
    JP  NZ,FOVER                        ;368e  c2 a6 5f      8394   8411 
    LD  B,02Dh                          ;3691  06 2d         8395   8412 
FPUTER: PUSH    DE                      ;3693  d5            8396   8413 
PUPTML: LD  A,(DE)                      ;3694  1a            8397   8414 
    INC DE                              ;3695  13            8398   8415 
    CP  020h                            ;3696  fe 20         8399   8416 
    JR  Z,PUPTML                        ;3698  28 fa         8400   8417 
    DEC DE                              ;369a  1b            8401   8418 
    DEC DE                              ;369b  1b            8402   8419 
    LD  A,B                             ;369c  78            8403   8420 
    LD  (DE),A                          ;369d  12            8404   8421 
    POP DE                              ;369e  d1            8405   8422 
THISLN1: JP LADJS2                      ;369f  c3 ad 36      8406   8423 
                                        ;                    8407   8424 ;
PTPLS1: DEFB    03EH                    ;36a2  3e            8408   8425 ; LD A,?
USGSGN: DEFS    1                       ;36a3                8409   8426 
    RLCA                                ;36a4  07            8410   8427 
    LD  B,02Bh                          ;36a5  06 2b         8411   8428 
    JR  NC,FPUTER                       ;36a7  30 ea         8412   8429 
    LD  B,02Dh                          ;36a9  06 2d         8413   8430 
    JR  FPUTER                          ;36ab  18 e6         8414   8431 
                                        ;                    8415   8432 ;
LADJS2: DEFB    03EH                    ;36ad  3e            8416   8433 ; LD A,?
PUYENF: DEFS    1                       ;36ae                8417   8434 
    OR  A                               ;36af  b7            8418   8435 
    JR  Z,LADJS3                        ;36b0  28 12         8419   8436 
    LD  A,(DE)                          ;36b2  1a            8420   8437 
    CP  020h                            ;36b3  fe 20         8421   8438 
    JR  NZ,LADJS3                       ;36b5  20 0d         8422   8439 
    PUSH    DE                          ;36b7  d5            8423   8440 
LSDQW1: LD  A,(DE)                      ;36b8  1a            8424   8441 
    INC DE                              ;36b9  13            8425   8442 
    CP  020h                            ;36ba  fe 20         8426   8443 
    JR  Z,LSDQW1                        ;36bc  28 fa         8427   8444 
    DEC DE                              ;36be  1b            8428   8445 
    DEC DE                              ;36bf  1b            8429   8446 
    LD  A,07Ch                          ;36c0  3e 7c         8430   8447 
    LD  (DE),A                          ;36c2  12            8431   8448 
    POP DE                              ;36c3  d1            8432   8449 
LADJS3: DEFB    03EH                    ;36c4  3e            8433   8450 ; LD A,?
PUASTF: DEFS    1                       ;36c5                8434   8451 
    OR  A                               ;36c6  b7            8435   8452 
    JR  Z,LADJS4                        ;36c7  28 0d         8436   8453 
    PUSH    DE                          ;36c9  d5            8437   8454 
ASTFIL: LD  A,(DE)                      ;36ca  1a            8438   8455 
    CP  020h                            ;36cb  fe 20         8439   8456 
    JR  NZ,LADJ4'                       ;36cd  20 06         8440   8457 
    LD  A,02Ah                          ;36cf  3e 2a         8441   8458 
    LD  (DE),A                          ;36d1  12            8442   8459 
    INC DE                              ;36d2  13            8443   8460 
    JR  ASTFIL                          ;36d3  18 f5         8444   8461 
LADJ4': POP DE                          ;36d5  d1            8445   8462 
LADJS4: POP HL                          ;36d6  e1            8446   8463 
    OR  A                               ;36d7  b7            8447   8464 
    SBC HL,DE                           ;36d8  ed 52         8448   8465 
    LD  B,L                             ;36da  45            8449   8466 
    CALL    PRTSDC                      ;36db  cd e1 07      8450   8467 
    LD  A,(RPLUSF)                      ;36de  3a 7b 36      8451   8468 
    OR  A                               ;36e1  b7            8452   8469 
    JR  Z,TST2DH                        ;36e2  28 0f         8453   8470 
    LD  A,(USGSGN)                      ;36e4  3a a3 36      8454   8471 
    RLCA                                ;36e7  07            8455   8472 
    LD  A,02Bh                          ;36e8  3e 2b         8456   8473 
LSDVZR: JR  NC,PULSTX                   ;36ea  30 02         8457   8474 
    LD  A,02Dh                          ;36ec  3e 2d         8458   8475 
PULSTX: CALL    ACCPRT                  ;36ee  cd 64 08      8459   8476 
    JR  RETPU$                          ;36f1  18 0e         8460   8477 
                                        ;                    8461   8478 ;
TST2DH: LD  A,(PUAFMF)                  ;36f3  3a 75 36      8462   8479 
    OR  A                               ;36f6  b7            8463   8480 
    JR  Z,RETPU$                        ;36f7  28 08         8464   8481 
    LD  A,(USGSGN)                      ;36f9  3a a3 36      8465   8482 
    RLCA                                ;36fc  07            8466   8483 
    LD  A,020h                          ;36fd  3e 20         8467   8484 
    JR  LSDVZR                          ;36ff  18 e9         8468   8485 
                                        ;                    8469   8486 ;
RETPU$: DEFB    001H                    ;3701  01            8470   8487 ; LD BC,?
USGBCB: DEFS    2                       ;3702                8471   8488 
    DEFB    011H                        ;3704  11            8472   8489 ; LD DE,?
USGDEB: DEFS    2                       ;3705                8473   8490 
    LD  A,1                             ;3707  3e 01         8474   8491 
    LD  (PRTEDF),A                      ;3709  32 75 34      8475   8492 
    JP  USNGLP                          ;370c  c3 42 34      8476   8493 
                                        ;                    8477   8494 ;
AUTO:   LD  C,L                         ;370f  4d            8478   8495 
    LD  B,H                             ;3710  44            8479   8496 
    LD  HL,10                           ;3711  21 0a 00      8480   8497 ; 그냥 AUTO면 10부터 시작한다.
    LD  (AUTOST),HL                     ;3714  22 45 22      8481   8498 
    LD  (AUTOLN),HL                     ;3717  22 39 22      8482   8499 
    CALL    BCFTCH                      ;371a  cd c4 25      8483   8500 
    DEC BC                              ;371d  0b            8484   8501 
    OR  A                               ;371e  b7            8485   8502 
    JR  Z,AUTOES                        ;371f  28 22         8486   8503 
    CP  03Ah                            ;3721  fe 3a         8487   8504 
    JR  Z,AUTOES                        ;3723  28 1e         8488   8505 
    CP  02Eh                            ;3725  fe 2e         8489   8506 
    JR  NZ,AUTONE                       ;3727  20 09         8490   8507 
    DEFB    021H                        ;3729  21            8491   8508 ; LD HL,?
EDLINE: DEFS    2                       ;372a                8492   8509 
    INC BC                              ;372c  03            8493   8510 
    CALL    BCFTCH                      ;372d  cd c4 25      8494   8511 
    JR  AUTNER                          ;3730  18 03         8495   8512 
AUTONE: CALL    IHLEXP                  ;3732  cd cc 22      8496   8513 
AUTNER: CP  02Ch                        ;3735  fe 2c         8497   8514 
    LD  (AUTOLN),HL                     ;3737  22 39 22      8498   8515 
    JP  NZ,AUTOES                       ;373a  c2 43 37      8499   8516 
    CALL    IHLEXP                      ;373d  cd cc 22      8500   8517 
    LD  (AUTOST),HL                     ;3740  22 45 22      8501   8518 
AUTOES: XOR A                           ;3743  af            8502   8519 
    LD  (AUTOVC),A                      ;3744  32 37 22      8503   8520 
    JP  AUTOBK                          ;3747  c3 8b 14      8504   8521 
                                        ;                    8505   8522 ;
LPOS:   LD  A,(PRINTN)                  ;374a  3a ec 11      8506   8523 
    JR  POSMID                          ;374d  18 03         8507   8524 
                                        ;                    8508   8525 ;
POS:    LD  A,(CURX)                    ;374f  3a ed 11      8509   8526 
POSMID: LD  E,A                         ;3752  5f            8510   8527 
    LD  D,0                             ;3753  16 00         8511   8528 
    JP  FLTHEX                          ;3755  c3 02 29      8512   8529 
                                        ;                    8513   8530 ;
ERR:    LD  A,(ERRCOD)                  ;3758  3a 95 22      8514   8531 
    LD  E,A                             ;375b  5f            8515   8532 
    LD  D,0                             ;375c  16 00         8516   8533 
MIDERS: PUSH    DE                      ;375e  d5            8517   8534 
    LD  DE,8                            ;375f  11 08 00      8518   8535 
    ADD HL,DE                           ;3762  19            8519   8536 
    POP DE                              ;3763  d1            8520   8537 
    CALL    FLTHEX                      ;3764  cd 02 29      8521   8538 
    CALL    ADJERL                      ;3767  cd 78 37      8522   8539 
    LD  A,4                             ;376a  3e 04         8523   8540 
    CALL    CONDFL                      ;376c  cd eb 28      8524   8541 
    JP  BCFTCH                          ;376f  c3 c4 25      8525   8542 
                                        ;                    8526   8543 ;
ERL:    LD  DE,(ERRLNO)                 ;3772  ed 5b 65 22   8527   8544 
    JR  MIDERS                          ;3776  18 e6         8528   8545 
                                        ;                    8529   8546 ;
ADJERL: INC HL                          ;3778  23            8530   8547 
    LD  A,(HL)                          ;3779  7e            8531   8548 
    DEC HL                              ;377a  2b            8532   8549 
    ADD A,A                             ;377b  87            8533   8550 
    RET NC                              ;377c  d0            8534   8551 
    PUSH    BC                          ;377d  c5            8535   8552 
    LD  DE,FLMXD0                       ;377e  11 86 37      8536   8553 
    CALL    ADD                         ;3781  cd a6 6c      8537   8554 
    POP BC                              ;3784  c1            8538   8555 
    RET                                 ;3785  c9            8539   8556 
FLMXD0:                                 ;                    8540   8557 
    DEFB    091H                        ;3786  91            8541   8558 
    DEFB    000H                        ;3787  00            8542   8559 
    DEFB    000H                        ;3788  00            8543   8560 
    DEFB    000H                        ;3789  00            8544   8561 
    DEFB    000H                        ;378a  00            8545   8562 
    DEFB    000H                        ;378b  00            8546   8563 
    DEFB    000H                        ;378c  00            8547   8564 
    DEFB    000H                        ;378d  00            8548   8565 
                                        ;                    8549   8566 ;
DEL:    CALL    HLFTCH                  ;378e  cd 87 29      8550   8567 
    OR  A                               ;3791  b7            8551   8568 
    RET Z                               ;3792  c8            8552   8569 
    CP  03Ah                            ;3793  fe 3a         8553   8570 
    RET Z                               ;3795  c8            8554   8571 
    PUSH    HL                          ;3796  e5            8555   8572 
    CALL    RETLNO                      ;3797  cd 0a 3f      8556   8573 
    CALL    CLR                         ;379a  cd 51 19      8557   8574 
    POP HL                              ;379d  e1            8558   8575 
    CALL    GTSTED                      ;379e  cd c7 3f      8559   8576 
    EX  DE,HL                           ;37a1  eb            8560   8577 
    LD  E,C                             ;37a2  59            8561   8578 
    LD  D,B                             ;37a3  50            8562   8579 
    CALL    DELETE1                     ;37a4  cd a5 31      8563   8580 
    JP  HOTENT                          ;37a7  c3 46 14      8564   8581 
                                        ;                    8565   8582 ;
RENUM:  LD  C,L                         ;37aa  4d            8566   8583 
    LD  B,H                             ;37ab  44            8567   8584 
    LD  HL,10                           ;37ac  21 0a 00      8568   8585 ; 그냥 RENUM이면 10부터 10씩 증가
    LD  (NEWNO),HL                      ;37af  22 34 38      8569   8586 
    LD  (ADDNO),HL                      ;37b2  22 42 38      8570   8587 
    LD  L,0                             ;37b5  2e 00         8571   8588 
    LD  (STLNO),HL                      ;37b7  22 23 38      8572   8589 
    CALL    BCFTCH                      ;37ba  cd c4 25      8573   8590 
    DEC BC                              ;37bd  0b            8574   8591 
    OR  A                               ;37be  b7            8575   8592 
    JR  Z,RNSTRT                        ;37bf  28 39         8576   8593 
    CP  03Ah                            ;37c1  fe 3a         8577   8594 
    JR  Z,RNSTRT                        ;37c3  28 35         8578   8595 
    CP  02Ch                            ;37c5  fe 2c         8579   8596 
    JR  Z,SKIRE1                        ;37c7  28 0b         8580   8597 
    CALL    IHLEXP                      ;37c9  cd cc 22      8581   8598 
    LD  (NEWNO),HL                      ;37cc  22 34 38      8582   8599 
    CP  02Ch                            ;37cf  fe 2c         8583   8600 
    JR  NZ,RNSTRT                       ;37d1  20 27         8584   8601 
    DEC BC                              ;37d3  0b            8585   8602 
SKIRE1: INC BC                          ;37d4  03            8586   8603 
    CALL    BCFTCH                      ;37d5  cd c4 25      8587   8604 
    DEC BC                              ;37d8  0b            8588   8605 
    CP  02Ch                            ;37d9  fe 2c         8589   8606 
    JR  Z,SKMRNU                        ;37db  28 0b         8590   8607 
    CALL    IHLEXP                      ;37dd  cd cc 22      8591   8608 
    LD  (STLNO),HL                      ;37e0  22 23 38      8592   8609 
    CP  02Ch                            ;37e3  fe 2c         8593   8610 
    JR  NZ,RNSTRT                       ;37e5  20 13         8594   8611 
    DEC BC                              ;37e7  0b            8595   8612 
SKMRNU: INC BC                          ;37e8  03            8596   8613 
    CALL    BCFTCH                      ;37e9  cd c4 25      8597   8614 
    DEC BC                              ;37ec  0b            8598   8615 
    OR  A                               ;37ed  b7            8599   8616 
    JR  Z,RNSTRT                        ;37ee  28 0a         8600   8617 
    CP  03Ah                            ;37f0  fe 3a         8601   8618 
    JR  Z,RNSTRT                        ;37f2  28 06         8602   8619 
    CALL    IHLEXP                      ;37f4  cd cc 22      8603   8620 
    LD  (ADDNO),HL                      ;37f7  22 42 38      8604   8621 
RNSTRT: PUSH    BC                      ;37fa  c5            8605   8622 
    LD  HL,(ADDNO)                      ;37fb  2a 42 38      8606   8623 
    LD  A,H                             ;37fe  7c            8607   8624 
    OR  L                               ;37ff  b5            8608   8625 
    JP  Z,IFCALL                        ;3800  ca 36 17      8609   8626 
    LD  HL,(STLNO)                      ;3803  2a 23 38      8610   8627 
    EX  DE,HL                           ;3806  eb            8611   8628 
    LD  HL,(NEWNO)                      ;3807  2a 34 38      8612   8629 
    OR  A                               ;380a  b7            8613   8630 
    SBC HL,DE                           ;380b  ed 52         8614   8631 
    JP  C,IFCALL                        ;380d  da 36 17      8615   8632 
    CALL    LNOADR                      ;3810  cd fd 3e      8616   8633 
    LD  HL,TEXTST                       ;3813  21 4e 7c      8617   8634 
BEGRNS: LD  E,(HL)                      ;3816  5e            8618   8635 
    INC HL                              ;3817  23            8619   8636 
    LD  D,(HL)                          ;3818  56            8620   8637 
    LD  A,D                             ;3819  7a            8621   8638 
    OR  E                               ;381a  b3            8622   8639 
    JR  Z,RNUMED'                       ;381b  28 2f         8623   8640 
    INC HL                              ;381d  23            8624   8641 
    LD  C,(HL)                          ;381e  4e            8625   8642 
    INC HL                              ;381f  23            8626   8643 
    LD  B,(HL)                          ;3820  46            8627   8644 
    PUSH    HL                          ;3821  e5            8628   8645 
    DEFB    021H                        ;3822  21            8629   8646 ; LD HL,?
STLNO:  DEFS    2                       ;3823                8630   8647 
    OR  A                               ;3825  b7            8631   8648 
    SBC HL,BC                           ;3826  ed 42         8632   8649 
    POP HL                              ;3828  e1            8633   8650 
    JR  Z,BEGREN                        ;3829  28 05         8634   8651 
    JR  C,BEGREN                        ;382b  38 03         8635   8652 
    EX  DE,HL                           ;382d  eb            8636   8653 
    JR  BEGRNS                          ;382e  18 e6         8637   8654 
                                        ;                    8638   8655 ;
BEGREN: DEC HL                          ;3830  2b            8639   8656 
    DEC HL                              ;3831  2b            8640   8657 
    DEC HL                              ;3832  2b            8641   8658 
    DEFB    001H                        ;3833  01            8642   8659 ; LD BC,?
NEWNO:  DEFS    2                       ;3834                8643   8660 
REKUML: LD  E,(HL)                      ;3836  5e            8644   8661 
    INC HL                              ;3837  23            8645   8662 
    LD  D,(HL)                          ;3838  56            8646   8663 
    LD  A,D                             ;3839  7a            8647   8664 
    OR  E                               ;383a  b3            8648   8665 
    JR  Z,RNUMED'                       ;383b  28 0f         8649   8666 
    INC HL                              ;383d  23            8650   8667 
    LD  (HL),C                          ;383e  71            8651   8668 
    INC HL                              ;383f  23            8652   8669 
    LD  (HL),B                          ;3840  70            8653   8670 
    DEFB    021H                        ;3841  21            8654   8671 ; LD HL,?
ADDNO:  DEFS    2                       ;3842                8655   8672 
    ADD HL,BC                           ;3844  09            8656   8673 
    JR  C,RENOVR                        ;3845  38 0a         8657   8674 
    LD  C,L                             ;3847  4d            8658   8675 
    LD  B,H                             ;3848  44            8659   8676 
    EX  DE,HL                           ;3849  eb            8660   8677 
    JR  REKUML                          ;384a  18 ea         8661   8678 
                                        ;                    8662   8679 ;
RNUMED':CALL    RETLNO                  ;384c  cd 0a 3f      8663   8680 
    POP HL                              ;384f  e1            8664   8681 
    RET                                 ;3850  c9            8665   8682 
                                        ;                    8666   8683 ;
RENOVR: LD  HL,10                       ;3851  21 0a 00      8667   8684 
    LD  (ADDNO),HL                      ;3854  22 42 38      8668   8685 
    LD  (NEWNO),HL                      ;3857  22 34 38      8669   8686 
    LD  L,0                             ;385a  2e 00         8670   8687 
    LD  (STLNO),HL                      ;385c  22 23 38      8671   8688 
    CALL    RNSTRT                      ;385f  cd fa 37      8672   8689 
    JP  IFCALL                          ;3862  c3 36 17      8673   8690 
                                        ;                    8674   8691 ;
CROPEN: LD  A,(FILEFG)                  ;3865  3a 83 33      8675   8692 
    OR  A                               ;3868  b7            8676   8693 
    JP  NZ,FILEER                       ;3869  c2 3e 18      8677   8694 
    LD  (LOADFN),A                      ;386c  32 c3 38      8678   8695 
    INC A                               ;386f  3c            8679   8696 
    LD  (FILEFG),A                      ;3870  32 83 33      8680   8697 
    CALL    BCFTCH                      ;3873  cd c4 25      8681   8698 
    DEC BC                              ;3876  0b            8682   8699 
    OR  A                               ;3877  b7            8683   8700 
    JR  Z,LOADST                        ;3878  28 24         8684   8701 
    CP  03Ah                            ;387a  fe 3a         8685   8702 
    JR  Z,LOADST                        ;387c  28 20         8686   8703 
    LD  A,001h                          ;387e  3e 01         8687   8704 
    LD  (LOADFN),A                      ;3880  32 c3 38      8688   8705 
    CALL    STREXX                      ;3883  cd 9d 45      8689   8706 
    DEC BC                              ;3886  0b            8690   8707 
    PUSH    BC                          ;3887  c5            8691   8708 
    OR  A                               ;3888  b7            8692   8709 
    JR  Z,LODIFC                        ;3889  28 02         8693   8710 
    CP  17                              ;388b  fe 11         8694   8711 
LODIFC: JP  NC,IFCALL                   ;388d  d2 36 17      8695   8712 
    LD  B,A                             ;3890  47            8696   8713 
    EX  DE,HL                           ;3891  eb            8697   8714 
    LD  DE,KEYBUF                       ;3892  11 4f 7a      8698   8715 
LDFNTR: LD  A,(HL)                      ;3895  7e            8699   8716 
    LD  (DE),A                          ;3896  12            8700   8717 
    INC DE                              ;3897  13            8701   8718 
    INC HL                              ;3898  23            8702   8719 
    DJNZ    LDFNTR                      ;3899  10 fa         8703   8720 
    XOR A                               ;389b  af            8704   8721 
    LD  (DE),A                          ;389c  12            8705   8722 
    POP BC                              ;389d  c1            8706   8723 
LOADST: CALL    FLOAD                   ;389e  cd 14 01      8707   8724 ;0027
    JP  C,BREAK                         ;38a1  da a2 16      8708   8725 
    CALL    CR2                         ;38a4  cd 23 08      8709   8726 
    LD  DE,LFOUM                        ;38a7  11 43 3a      8710   8727 
    PUSH    BC                          ;38aa  c5            8711   8728 
    LD  B,6                             ;38ab  06 06         8712   8729 
    CALL    PRTSDC                      ;38ad  cd e1 07      8713   8730 
    LD  DE,FILMOD                       ;38b0  11 96 13      8714   8731 ;10F0
LFDFNL: INC DE                          ;38b3  13            8715   8732 
    LD  A,(DE)                          ;38b4  1a            8716   8733 
    CP  000h                            ;38b5  fe 00         8717   8734 
    JR  Z,FLFPRE                        ;38b7  28 05         8718   8735 
    CALL    ACCPRT                      ;38b9  cd 64 08      8719   8736 
    JR  LFDFNL                          ;38bc  18 f5         8720   8737 
FLFPRE: POP BC                          ;38be  c1            8721   8738 
    CALL    CR2                         ;38bf  cd 23 08      8722   8739 
    DEFB    03EH                        ;38c2  3e            8723   8740 
LOADFN: DEFS    1                       ;38c3                8724   8741 
    OR  A                               ;38c4  b7            8725   8742 
    JR  Z,LFNOK                         ;38c5  28 16         8726   8743 
    LD  HL,KEYBUF                       ;38c7  21 4f 7a      8727   8744 
    LD  DE,FILNAM                       ;38ca  11 97 13      8728   8745 ;10F1
FNCMPL: LD  A,(DE)                      ;38cd  1a            8729   8746 
    CP  000h                            ;38ce  fe 00         8730   8747 
    JR  Z,LFNLCP                        ;38d0  28 07         8731   8748 
    CP  (HL)                            ;38d2  be            8732   8749 
    INC HL                              ;38d3  23            8733   8750 
    INC DE                              ;38d4  13            8734   8751 
    JR  Z,FNCMPL                        ;38d5  28 f6         8735   8752 
    JR  LOADST                          ;38d7  18 c5         8736   8753 
LFNLCP: LD  A,(HL)                      ;38d9  7e            8737   8754 
    OR  A                               ;38da  b7            8738   8755 
    JR  NZ,LOADST                       ;38db  20 c1         8739   8756 
LFNOK:  PUSH    BC                      ;38dd  c5            8740   8757 
    CALL    BUFCLR                      ;38de  cd 11 45      8741   8758 
    LD  DE,LDINGM                       ;38e1  11 49 3a      8742   8759 
    LD  B,8                             ;38e4  06 08         8743   8760 
    CALL    PRTSDC                      ;38e6  cd e1 07      8744   8761 
    LD  DE,FILNAM                       ;38e9  11 97 13      8745   8762 
    CALL    DEPRT                       ;38ec  cd f3 07      8746   8763 ;0015
    CALL    CR2                         ;38ef  cd 23 08      8747   8764 
    POP BC                              ;38f2  c1            8748   8765 
    RET                                 ;38f3  c9            8749   8766 
                                        ;                    8750   8767 ;
ROPEN:  LD  C,L                         ;38f4  4d            8751   8768 
    LD  B,H                             ;38f5  44            8752   8769 
    CALL    CROPEN                      ;38f6  cd 65 38      8753   8770 
    LD  L,C                             ;38f9  69            8754   8771 
    LD  H,B                             ;38fa  60            8755   8772 
    RET                                 ;38fb  c9            8756   8773 
                                        ;                    8757   8774 ;
VERIFY: INC HL                          ;38fc  23            8758   8775 
    LD  C,L                             ;38fd  4d            8759   8776 
    LD  B,H                             ;38fe  44            8760   8777 
    CALL    CROPEN                      ;38ff  cd 65 38      8761   8778 
    LD  A,(FILMOD)                      ;3902  3a 96 13      8762   8779 
    CP  016h                            ;3905  fe 16         8763   8780 
    JP  Z,FILEER                        ;3907  ca 3e 18      8764   8781 
    CALL    CVSAVE                      ;390a  cd de 39      8765   8782 
    CALL    MVRFY                       ;390d  cd b9 01      8766   8783 
    CALL    CVLOAD                      ;3910  cd b9 39      8767   8784 
    LD  A,27                            ;3913  3e 1b         8768   8785 
    JP  C,ERROR                         ;3915  da 96 21      8769   8786 
    RET                                 ;3918  c9            8770   8787 
                                        ;                    8771   8788 ;
MERGE:  XOR A                           ;3919  af            8772   8789 
    LD  (FILEFG),A                      ;391a  32 83 33      8773   8790 
    LD  C,L                             ;391d  4d            8774   8791 
    LD  B,H                             ;391e  44            8775   8792 
    CALL    CROPEN                      ;391f  cd 65 38      8776   8793 
    LD  A,(FILMOD)                      ;3922  3a 96 13      8777   8794 
    CP  004h                            ;3925  fe 04         8778   8795 
    JP  C,FILEER                        ;3927  da 3e 18      8779   8796 
    JR  MRGEVC                          ;392a  18 1d         8780   8797 
                                        ;                    8781   8798 ;
LOAD:   XOR A                           ;392c  af            8782   8799 
    LD  (FILEFG),A                      ;392d  32 83 33      8783   8800 
    LD  (CONTFG),A                      ;3930  32 08 22      8784   8801 
    CALL    HLFTCH                      ;3933  cd 87 29      8785   8802 
    CP  08Ch                            ;3936  fe 8c         8786   8803 
    JR  Z,VERIFY                        ;3938  28 c2         8787   8804 
    LD  C,L                             ;393a  4d            8788   8805 
    LD  B,H                             ;393b  44            8789   8806 
    CALL    CROPEN                      ;393c  cd 65 38      8790   8807 
    LD  A,(FILMOD)                      ;393f  3a 96 13      8791   8808 
    CP  004h                            ;3942  fe 04         8792   8809 
    JR  C,BLOAD                         ;3944  38 32         8793   8810 
    CALL    NEW                         ;3946  cd ac 39      8794   8811 
MRGEVC: CALL    CLR                     ;3949  cd 51 19      8795   8812 
    LD  SP,(STRTOP)                     ;394c  ed 7b 41 7a   8796   8813 
    LD  HL,0FFFFh                       ;3950  21 ff ff      8797   8814 
    PUSH    HL                          ;3953  e5            8798   8815 
    LD  (SPBUF),SP                      ;3954  ed 73 25 22   8799   8816 
    LD  HL,CINPUT                       ;3958  21 f8 39      8800   8817 
    LD  (LODVEC),HL                     ;395b  22 9d 14      8801   8818 
    LD  A,001h                          ;395e  3e 01         8802   8819 
    LD  (NRLDED),A                      ;3960  32 30 3a      8803   8820 
    CALL    BUFCLR                      ;3963  cd 11 45      8804   8821 
    JP  NMESOK                          ;3966  c3 88 14      8805   8822 
                                        ;                    8806   8823 ;
TPRDER: XOR A                           ;3969  af            8807   8824 
    LD  (FILEFG),A                      ;396a  32 83 33      8808   8825 
    LD  A,(FILMOD)                      ;396d  3a 96 13      8809   8826 
    CP  002h                            ;3970  fe 02         8810   8827 
    CALL    Z,NEW                       ;3972  cc ac 39      8811   8828 
    JP  BREAK                           ;3975  c3 a2 16      8812   8829 
                                        ;                    8813   8830 ;
BLOAD:  CP  002h                        ;3978  fe 02         8814   8831 ; basic이면 TEXTST에 로딩
    JR  NZ,MLLOAD                       ;397a  20 28         8815   8832 
    LD  HL,TEXTST                       ;397c  21 4e 7c      8816   8833 
    LD  (MTADRS),HL                     ;397f  22 aa 13      8817   8834 
    LD  DE,(MTBYTE)                     ;3982  ed 5b a8 13   8818   8835 
    ADD HL,DE                           ;3986  19            8819   8836 
    LD  HL,(MEMEND)                     ;3987  2a 47 7a      8820   8837 
    OR  A                               ;398a  b7            8821   8838 
    SBC HL,DE                           ;398b  ed 52         8822   8839 
    JP  C,OMERR                         ;398d  da 88 21      8823   8840 
    CALL    MLOAD                       ;3990  cd 34 01      8824   8841 
    JR  C,TPRDER                        ;3993  38 d4         8825   8842 
    CALL    CVLOAD                      ;3995  cd b9 39      8826   8843 
    LD  HL,PROTCT                       ;3998  21 ae 13      8827   8844 
    LD  A,(HL)                          ;399b  7e            8828   8845 
    CP  03Ah                            ;399c  fe 3a         8829   8846 
    JP  Z,RUN                           ;399e  ca c3 15      8830   8847 
RTBLOD: LD  L,C                         ;39a1  69            8831   8848 
    LD  H,B                             ;39a2  60            8832   8849 
    RET                                 ;39a3  c9            8833   8850 
                                        ;                    8834   8851 ;
MLLOAD: CALL    MLOAD                   ;39a4  cd 34 01      8835   8852 
    JP  C,TPRDER                        ;39a7  da 69 39      8836   8853 
    JR  RTBLOD                          ;39aa  18 f5         8837   8854 
                                        ;                    8838   8855 ;
NEW:    LD  HL,TEXTST                   ;39ac  21 4e 7c      8839   8856 
    XOR A                               ;39af  af            8840   8857 
    LD  (HL),A                          ;39b0  77            8841   8858 
    INC HL                              ;39b1  23            8842   8859 
    LD  (HL),A                          ;39b2  77            8843   8860 
    INC HL                              ;39b3  23            8844   8861 
    LD  (HL),A                          ;39b4  77            8845   8862 
    LD  (VSTART),HL                     ;39b5  22 3b 7a      8846   8863 
    RET                                 ;39b8  c9            8847   8864 
                                        ;                    8848   8865 ;
CVLOAD: PUSH    AF                      ;39b9  f5            8849   8866 
    PUSH    HL                          ;39ba  e5            8850   8867 
    PUSH    DE                          ;39bb  d5            8851   8868 
    LD  HL,TEXTST                       ;39bc  21 4e 7c      8852   8869 
CVLDLP: LD  E,(HL)                      ;39bf  5e            8853   8870 
    INC HL                              ;39c0  23            8854   8871 
    LD  D,(HL)                          ;39c1  56            8855   8872 
    LD  A,E                             ;39c2  7b            8856   8873 
    OR  D                               ;39c3  b2            8857   8874 
    JR  Z,ESCCVL                        ;39c4  28 0b         8858   8875 
    PUSH    HL                          ;39c6  e5            8859   8876 
    ADD HL,DE                           ;39c7  19            8860   8877 
    DEC HL                              ;39c8  2b            8861   8878 
    EX  DE,HL                           ;39c9  eb            8862   8879 
    POP HL                              ;39ca  e1            8863   8880 
    LD  (HL),D                          ;39cb  72            8864   8881 
    DEC HL                              ;39cc  2b            8865   8882 
    LD  (HL),E                          ;39cd  73            8866   8883 
    EX  DE,HL                           ;39ce  eb            8867   8884 
    JR  CVLDLP                          ;39cf  18 ee         8868   8885 
ESCCVL: INC HL                          ;39d1  23            8869   8886 
    LD  (VSTART),HL                     ;39d2  22 3b 7a      8870   8887 
    LD  (HL),0                          ;39d5  36 00         8871   8888 
    LD  (STKLMT),HL                     ;39d7  22 3f 7a      8872   8889 
    POP DE                              ;39da  d1            8873   8890 
    POP HL                              ;39db  e1            8874   8891 
    POP AF                              ;39dc  f1            8875   8892 
    RET                                 ;39dd  c9            8876   8893 
                                        ;                    8877   8894 ;
CVSAVE: PUSH    AF                      ;39de  f5            8878   8895 
    PUSH    HL                          ;39df  e5            8879   8896 
    PUSH    DE                          ;39e0  d5            8880   8897 
    LD  HL,TEXTST                       ;39e1  21 4e 7c      8881   8898 
CVSVLP: LD  E,(HL)                      ;39e4  5e            8882   8899 
    INC HL                              ;39e5  23            8883   8900 
    LD  D,(HL)                          ;39e6  56            8884   8901 
    LD  A,D                             ;39e7  7a            8885   8902 
    OR  E                               ;39e8  b3            8886   8903 
    JR  Z,ESCCVL                        ;39e9  28 e6         8887   8904 
    PUSH    DE                          ;39eb  d5            8888   8905 
    EX  DE,HL                           ;39ec  eb            8889   8906 
    OR  A                               ;39ed  b7            8890   8907 
    DEC DE                              ;39ee  1b            8891   8908 
    SBC HL,DE                           ;39ef  ed 52         8892   8909 
    EX  DE,HL                           ;39f1  eb            8893   8910 
    LD  (HL),E                          ;39f2  73            8894   8911 
    INC HL                              ;39f3  23            8895   8912 
    LD  (HL),D                          ;39f4  72            8896   8913 
    POP HL                              ;39f5  e1            8897   8914 
    JR  CVSVLP                          ;39f6  18 ec         8898   8915 
                                        ;                    8899   8916 ;
CINPUT: PUSH    DE                      ;39f8  d5            8900   8917 
    CALL    CTINP                       ;39f9  cd 21 45      8901   8918 
    JR  C,ABORT                         ;39fc  38 1e         8902   8919 
    CP  00Dh                            ;39fe  fe 0d         8903   8920 
    JR  Z,NRLDED                        ;3a00  28 2e         8904   8921 
    JR  MIDCIP                          ;3a02  18 05         8905   8922 
CLDLP1: CALL    CTINP                   ;3a04  cd 21 45      8906   8923 
    JR  C,ABORT                         ;3a07  38 13         8907   8924 
MIDCIP: OR  A                           ;3a09  b7            8908   8925 
    JP  Z,FILEER                        ;3a0a  ca 3e 18      8909   8926 
    LD  (DE),A                          ;3a0d  12            8910   8927 
    INC DE                              ;3a0e  13            8911   8928 
    CP  00Dh                            ;3a0f  fe 0d         8912   8929 
    JR  NZ,CLDLP1                       ;3a11  20 f1         8913   8930 
    DEC DE                              ;3a13  1b            8914   8931 
    XOR A                               ;3a14  af            8915   8932 
    LD  (DE),A                          ;3a15  12            8916   8933 
    INC DE                              ;3a16  13            8917   8934 
    LD  (DE),A                          ;3a17  12            8918   8935 
    INC DE                              ;3a18  13            8919   8936 
    LD  (DE),A                          ;3a19  12            8920   8937 
    POP DE                              ;3a1a  d1            8921   8938 
    RET                                 ;3a1b  c9            8922   8939 
                                        ;                    8923   8940 ;
ABORT:  LD  HL,LININP                   ;3a1c  21 93 15      8924   8941 
    LD  (LODVEC),HL                     ;3a1f  22 9d 14      8925   8942 
    LD  SP,(SPBUF)                      ;3a22  ed 7b 25 22   8926   8943 
CBREAK: XOR A                           ;3a26  af            8927   8944 
    LD  (FILEFG),A                      ;3a27  32 83 33      8928   8945 
    LD  (CONTFG),A                      ;3a2a  32 08 22      8929   8946 
    JP  BREAK                           ;3a2d  c3 a2 16      8930   8947 
                                        ;                    8931   8948 ;
NRLDED: JP  FILEER                      ;3a30  c3 3e 18      8932   8949 
    LD  HL,LININP                       ;3a33  21 93 15      8933   8950 
    LD  (LODVEC),HL                     ;3a36  22 9d 14      8934   8951 
    LD  SP,(SPBUF)                      ;3a39  ed 7b 25 22   8935   8952 
    CALL    CLOSE                       ;3a3d  cd 82 33      8936   8953 
    JP  OK                              ;3a40  c3 62 14      8937   8954 
                                        ;                    8938   8955 ;
LFOUM:  DEFM    'FOUND:'                ;3a43  46 4f 55 4e   8939   8956 
                                        ;3a47  44 3a         8939   8957
                                        ;                    8940   8958 ;
LDINGM: DEFM    'LOADING:'              ;3a49  4c 4f 41 44   8941   8959 
                                        ;3a4d  49 4e 47 3a   8941   8960
                                        ;                    8942   8961 ;
WOPEN:  CALL    CWOPEN                  ;3a51  cd 5d 3a      8943   8962 
    CALL    FSAVE                       ;3a54  cd 80 00      8944   8963 
    JP  C,CBREAK                        ;3a57  da 26 3a      8945   8964 
    LD  L,C                             ;3a5a  69            8946   8965 
    LD  H,B                             ;3a5b  60            8947   8966 
    RET                                 ;3a5c  c9            8948   8967 
                                        ;                    8949   8968 ;
CWOPEN: LD  A,(FILEFG)                  ;3a5d  3a 83 33      8950   8969 
    OR  A                               ;3a60  b7            8951   8970 
    JP  NZ,FILEER                       ;3a61  c2 3e 18      8952   8971 
    LD  A,2                             ;3a64  3e 02         8953   8972 
    LD  (FILEFG),A                      ;3a66  32 83 33      8954   8973 
    LD  C,L                             ;3a69  4d            8955   8974 
    LD  B,H                             ;3a6a  44            8956   8975 
    CALL    BCFTCH                      ;3a6b  cd c4 25      8957   8976 
    DEC BC                              ;3a6e  0b            8958   8977 
    LD  HL,NULSDC                       ;3a6f  21 25 28      8959   8978 
    OR  A                               ;3a72  b7            8960   8979 
    JR  Z,NULSAV                        ;3a73  28 0a         8961   8980 
    CP  03Ah                            ;3a75  fe 3a         8962   8981 
    LD  A,0                             ;3a77  3e 00         8963   8982 
    JR  Z,NULSAV                        ;3a79  28 04         8964   8983 
    CALL    STREXX                      ;3a7b  cd 9d 45      8965   8984 
    DEC BC                              ;3a7e  0b            8966   8985 
NULSAV: CP  17                          ;3a7f  fe 11         8967   8986 
WOPIFC: JP  NC,IFCALL                   ;3a81  d2 36 17      8968   8987 
    PUSH    BC                          ;3a84  c5            8969   8988 
    LD  B,A                             ;3a85  47            8970   8989 
    EX  DE,HL                           ;3a86  eb            8971   8990 
    LD  DE,FILMOD                       ;3a87  11 96 13      8972   8991 
    LD  A,016h                          ;3a8a  3e 16         8973   8992 
    LD  (DE),A                          ;3a8c  12            8974   8993 
    INC DE                              ;3a8d  13            8975   8994 
    LD  A,B                             ;3a8e  78            8976   8995 
    OR  A                               ;3a8f  b7            8977   8996 
    JR  Z,NULFNM                        ;3a90  28 06         8978   8997 
SAVEFT: LD  A,(HL)                      ;3a92  7e            8979   8998 
    LD  (DE),A                          ;3a93  12            8980   8999 
    INC DE                              ;3a94  13            8981   9000 
    INC HL                              ;3a95  23            8982   9001 
    DJNZ    SAVEFT                      ;3a96  10 fa         8983   9002 
NULFNM: LD  A,000h                      ;3a98  3e 00         8984   9003 
    LD  (DE),A                          ;3a9a  12            8985   9004 
    POP BC                              ;3a9b  c1            8986   9005 
    LD  HL,TEXTST                       ;3a9c  21 4e 7c      8987   9006 
    LD  (MTADRS),HL                     ;3a9f  22 aa 13      8988   9007 
    EX  DE,HL                           ;3aa2  eb            8989   9008 
    LD  HL,(VSTART)                     ;3aa3  2a 3b 7a      8990   9009 
    OR  A                               ;3aa6  b7            8991   9010 
    SBC HL,DE                           ;3aa7  ed 52         8992   9011 
    LD  (MTBYTE),HL                     ;3aa9  22 a8 13      8993   9012 
    LD  HL,0                            ;3aac  21 00 00      8994   9013 
    LD  (MTEXEC),HL                     ;3aaf  22 ac 13      8995   9014 
    LD  A,0                             ;3ab2  3e 00         8996   9015 
    LD  (PROTCT),A                      ;3ab4  32 ae 13      8997   9016 
    CALL    BUFCLR                      ;3ab7  cd 11 45      8998   9017 
    RET                                 ;3aba  c9            8999   9018 
                                        ;                    9000   9019 ;
SAVE$:  XOR A                           ;3abb  af            9001   9020 
    LD  (FILEFG),A                      ;3abc  32 83 33      9002   9021 
    LD  A,(HL)                          ;3abf  7e            9003   9022 
    CP  04Dh                            ;3ac0  fe 4d         9004   9023 
    JR  Z,SAVEM                         ;3ac2  28 4f         9005   9024 
    CALL    CWOPEN                      ;3ac4  cd 5d 3a      9006   9025 
    CALL    BCFTCH                      ;3ac7  cd c4 25      9007   9026 
    CP  02Ch                            ;3aca  fe 2c         9008   9027 
    JR  NZ,BSAVE                        ;3acc  20 28         9009   9028 
    CALL    BCFTCH                      ;3ace  cd c4 25      9010   9029 
    CP  041h                            ;3ad1  fe 41         9011   9030 
    JP  NZ,SERROR                       ;3ad3  c2 3a 17      9012   9031 
    CALL    FSAVE                       ;3ad6  cd 80 00      9013   9032 
    JP  C,CBREAK                        ;3ad9  da 26 3a      9014   9033 
    PUSH    BC                          ;3adc  c5            9015   9034 
    CALL    RETLNO                      ;3add  cd 0a 3f      9016   9035 
    CALL    CLIST                       ;3ae0  cd 5e 40      9017   9036 
    LD  HL,CRTCR2                       ;3ae3  21 0e 41      9018   9037 
    LD  (LSCRVC),HL                     ;3ae6  22 04 41      9019   9038 
    LD  HL,CRTVEC                       ;3ae9  21 fd 40      9020   9039 
    LD  (SAVEVC),HL                     ;3aec  22 f6 40      9021   9040 
    JP  C,BREAK                         ;3aef  da a2 16      9022   9041 
    POP HL                              ;3af2  e1            9023   9042 
    JP  CLOSE                           ;3af3  c3 82 33      9024   9043 
                                        ;                    9025   9044 ;
BSAVE:  DEC BC                          ;3af6  0b            9026   9045 
    PUSH    BC                          ;3af7  c5            9027   9046 
    CALL    RETLNO                      ;3af8  cd 0a 3f      9028   9047 
    CALL    CVSAVE                      ;3afb  cd de 39      9029   9048 
    LD  A,002h                          ;3afe  3e 02         9030   9049 
    LD  (FILMOD),A                      ;3b00  32 96 13      9031   9050 
    CALL    FSAVE                       ;3b03  cd 80 00      9032   9051 
    JR  C,CBREA'                        ;3b06  38 03         9033   9052 
    CALL    MSAVE                       ;3b08  cd b6 00      9034   9053 
CBREA': CALL    CVLOAD                  ;3b0b  cd b9 39      9035   9054 
CBRSHM: POP HL                          ;3b0e  e1            9036   9055 
    JP  C,CBREAK                        ;3b0f  da 26 3a      9037   9056 
    RET                                 ;3b12  c9            9038   9057 
                                        ;                    9039   9058 ;
SAVEM:  INC HL                          ;3b13  23            9040   9059 
    CALL    CWOPEN                      ;3b14  cd 5d 3a      9041   9060 
    CALL    BCFTCH                      ;3b17  cd c4 25      9042   9061 
    CALL    CH2CH                       ;3b1a  cd 61 2d      9043   9062 
    CALL    IHLEXP                      ;3b1d  cd cc 22      9044   9063 
    LD  (MTADRS),HL                     ;3b20  22 aa 13      9045   9064 
    PUSH    HL                          ;3b23  e5            9046   9065 
    CALL    CH2CH                       ;3b24  cd 61 2d      9047   9066 
    CALL    IHLEXP                      ;3b27  cd cc 22      9048   9067 
    POP DE                              ;3b2a  d1            9049   9068 
    OR  A                               ;3b2b  b7            9050   9069 
    SBC HL,DE                           ;3b2c  ed 52         9051   9070 
    INC HL                              ;3b2e  23            9052   9071 
    LD  (MTBYTE),HL                     ;3b2f  22 a8 13      9053   9072 
    CP  02Ch                            ;3b32  fe 2c         9054   9073 
    JR  NZ,SVMNEA                       ;3b34  20 06         9055   9074 
    CALL    IHLEXP                      ;3b36  cd cc 22      9056   9075 
    LD  (MTEXEC),HL                     ;3b39  22 ac 13      9057   9076 
SVMNEA: DEC BC                          ;3b3c  0b            9058   9077 
    PUSH    BC                          ;3b3d  c5            9059   9078 
    LD  A,1                             ;3b3e  3e 01         9060   9079 
    LD  (FILMOD),A                      ;3b40  32 96 13      9061   9080 
    CALL    FSAVE                       ;3b43  cd 80 00      9062   9081 
    JR  C,CBRSHM                        ;3b46  38 c6         9063   9082 
    CALL    MSAVE                       ;3b48  cd b6 00      9064   9083 
    JR  CBRSHM                          ;3b4b  18 c1         9065   9084 
                                        ;                    9066   9085 ;
DEFFN:  CALL    HLFTCH                  ;3b4d  cd 87 29      9067   9086 
    INC A                               ;3b50  3c            9068   9087 
FNSERR: JP  NZ,SERROR                   ;3b51  c2 3a 17      9069   9088 
    INC HL                              ;3b54  23            9070   9089 
    LD  A,(HL)                          ;3b55  7e            9071   9090 
    CP  0A0h                            ;3b56  fe a0         9072   9091 
    JP  Z,DEFCHR                        ;3b58  ca cb 46      9073   9092 
    CP  0BEh                            ;3b5b  fe be         9074   9093 
    JP  Z,DEFUSR                        ;3b5d  ca 40 3c      9075   9094 
    CP  0BDh                            ;3b60  fe bd         9076   9095 
    JR  NZ,FNSERR                       ;3b62  20 ed         9077   9096 
    INC HL                              ;3b64  23            9078   9097 
    LD  C,L                             ;3b65  4d            9079   9098 
    LD  B,H                             ;3b66  44            9080   9099 
    CALL    ILDRCH                      ;3b67  cd 90 3b      9081   9100 
    CALL    BCFTCH                      ;3b6a  cd c4 25      9082   9101 
    CALL    GETFUN                      ;3b6d  cd a1 3b      9083   9102 
    JR  NC,DUPDEF                       ;3b70  30 19         9084   9103 
    LD  HL,(STKLMT)                     ;3b72  2a 3f 7a      9085   9104 
    OR  0C0h                            ;3b75  f6 c0         9086   9105 
    LD  (HL),A                          ;3b77  77            9087   9106 
    INC HL                              ;3b78  23            9088   9107 
    LD  (HL),E                          ;3b79  73            9089   9108 
    INC HL                              ;3b7a  23            9090   9109 
    LD  (HL),D                          ;3b7b  72            9091   9110 
    INC HL                              ;3b7c  23            9092   9111 
    LD  (HL),C                          ;3b7d  71            9093   9112 
    INC HL                              ;3b7e  23            9094   9113 
    LD  (HL),B                          ;3b7f  70            9095   9114 
    INC HL                              ;3b80  23            9096   9115 
    LD  (HL),000h                       ;3b81  36 00         9097   9116 
    LD  (STKLMT),HL                     ;3b83  22 3f 7a      9098   9117 
    LD  L,C                             ;3b86  69            9099   9118 
    LD  H,B                             ;3b87  60            9100   9119 
    JP  DATA                            ;3b88  c3 c8 1c      9101   9120 
                                        ;                    9102   9121 ;
DUPDEF: LD  A,10                        ;3b8b  3e 0a         9103   9122 
ERJVDE: JP  ERROR                       ;3b8d  c3 96 21      9104   9123 
                                        ;                    9105   9124 ;
ILDRCH: PUSH    HL                      ;3b90  e5            9106   9125 
    LD  HL,(LNOBUF)                     ;3b91  2a cc 16      9107   9126 
    INC HL                              ;3b94  23            9108   9127 
    LD  A,H                             ;3b95  7c            9109   9128 
    OR  L                               ;3b96  b5            9110   9129 
    POP HL                              ;3b97  e1            9111   9130 
    RET NZ                              ;3b98  c0            9112   9131 
    LD  A,12                            ;3b99  3e 0c         9113   9132 
    JR  ERJVDE                          ;3b9b  18 f0         9114   9133 
                                        ;                    9115   9134 ;
UNDEFN: LD  A,012h                      ;3b9d  3e 12         9116   9135 
    JR  ERJVDE                          ;3b9f  18 ec         9117   9136 
                                        ;                    9118   9137 ;
GETFUN: CALL    VSRTST                  ;3ba1  cd fe 20      9119   9138 
    CP  028h                            ;3ba4  fe 28         9120   9139 
    JP  NZ,SERROR                       ;3ba6  c2 3a 17      9121   9140 
    DEC BC                              ;3ba9  0b            9122   9141 
    PUSH    BC                          ;3baa  c5            9123   9142 
    LD  A,E                             ;3bab  7b            9124   9143 
    OR  0C0h                            ;3bac  f6 c0         9125   9144 
    EX  DE,HL                           ;3bae  eb            9126   9145 
    LD  B,A                             ;3baf  47            9127   9146 
    LD  HL,(VSTART)                     ;3bb0  2a 3b 7a      9128   9147 
GFNLP1: LD  A,(HL)                      ;3bb3  7e            9129   9148 
    OR  A                               ;3bb4  b7            9130   9149 
    JR  Z,FNNOTF                        ;3bb5  28 37         9131   9150 
    CP  B                               ;3bb7  b8            9132   9151 
    JR  NZ,SKIPN1                       ;3bb8  20 17         9133   9152 
    INC HL                              ;3bba  23            9134   9153 
    LD  A,E                             ;3bbb  7b            9135   9154 
    CP  (HL)                            ;3bbc  be            9136   9155 
    LD  A,004h                          ;3bbd  3e 04         9137   9156 
    JR  NZ,SKIPFN                       ;3bbf  20 25         9138   9157 
    INC HL                              ;3bc1  23            9139   9158 
    LD  A,D                             ;3bc2  7a            9140   9159 
    CP  (HL)                            ;3bc3  be            9141   9160 
    LD  A,3                             ;3bc4  3e 03         9142   9161 
    JR  NZ,SKIPFN                       ;3bc6  20 1e         9143   9162 
    INC HL                              ;3bc8  23            9144   9163 
    CALL    INDRCT                      ;3bc9  cd a3 2a      9145   9164 
    LD  A,B                             ;3bcc  78            9146   9165 
    AND 00Fh                            ;3bcd  e6 0f         9147   9166 
    POP BC                              ;3bcf  c1            9148   9167 
    RET                                 ;3bd0  c9            9149   9168 
                                        ;                    9150   9169 ;
SKIPN1: INC A                           ;3bd1  3c            9151   9170 
    JP  P,SKIPN2                        ;3bd2  f2 e4 3b      9152   9171 
    DEC A                               ;3bd5  3d            9153   9172 
    AND 0C0h                            ;3bd6  e6 c0         9154   9173 
    CP  0C0h                            ;3bd8  fe c0         9155   9174 
    LD  A,5                             ;3bda  3e 05         9156   9175 
    JR  Z,SKIPFN                        ;3bdc  28 08         9157   9176 
    INC HL                              ;3bde  23            9158   9177 
    CALL    INDRCT                      ;3bdf  cd a3 2a      9159   9178 
    JR  GFNLP1                          ;3be2  18 cf         9160   9179 
                                        ;                    9161   9180 ;
SKIPN2: INC A                           ;3be4  3c            9162   9181 
    INC A                               ;3be5  3c            9163   9182 
SKIPFN: ADD A,L                         ;3be6  85            9164   9183 
    LD  L,A                             ;3be7  6f            9165   9184 
    LD  A,000h                          ;3be8  3e 00         9166   9185 
    ADC A,H                             ;3bea  8c            9167   9186 
    LD  H,A                             ;3beb  67            9168   9187 
    JR  GFNLP1                          ;3bec  18 c5         9169   9188 
                                        ;                    9170   9189 ;
FNNOTF: LD  A,B                         ;3bee  78            9171   9190 
    AND 00Fh                            ;3bef  e6 0f         9172   9191 
    POP BC                              ;3bf1  c1            9173   9192 
    SCF                                 ;3bf2  37            9174   9193 
    RET                                 ;3bf3  c9            9175   9194 
                                        ;                    9176   9195 ;
FNOPR:  PUSH    HL                      ;3bf4  e5            9177   9196 
    CALL    BCFTCH                      ;3bf5  cd c4 25      9178   9197 
    CALL    GETFUN                      ;3bf8  cd a1 3b      9179   9198 
    JR  C,UNDEFN                        ;3bfb  38 a0         9180   9199 
    CP  003h                            ;3bfd  fe 03         9181   9200 
    JR  Z,STRFNC                        ;3bff  28 05         9182   9201 
    CALL    CONDFL                      ;3c01  cd eb 28      9183   9202 
    JR  ARGFUN                          ;3c04  18 03         9184   9203 
STRFNC: CALL    CONDSR                  ;3c06  cd d9 28      9185   9204 
ARGFUN: EX  DE,HL                       ;3c09  eb            9186   9205 
    LD  HL,(FUNCNS)                     ;3c0a  2a 2f 26      9187   9206 
    EX  (SP),HL                         ;3c0d  e3            9188   9207 
    CALL    CH28H                       ;3c0e  cd 58 2d      9189   9208 
    PUSH    BC                          ;3c11  c5            9190   9209 
    LD  C,E                             ;3c12  4b            9191   9210 
    LD  B,D                             ;3c13  42            9192   9211 
    CALL    CH28H                       ;3c14  cd 58 2d      9193   9212 
    PUSH    BC                          ;3c17  c5            9194   9213 
    EX  DE,HL                           ;3c18  eb            9195   9214 
    LD  HL,00000h                       ;3c19  21 00 00      9196   9215 
    ADD HL,SP                           ;3c1c  39            9197   9216 
    LD  (FUNCNS),HL                     ;3c1d  22 2f 26      9198   9217 
    EX  DE,HL                           ;3c20  eb            9199   9218 
    CALL    SK2829                      ;3c21  cd 1e 27      9200   9219 
    CALL    BCFTCH                      ;3c24  cd c4 25      9201   9220 
    CP  0F5h                            ;3c27  fe f5         9202   9221 
    JP  NZ,SERROR                       ;3c29  c2 3a 17      9203   9222 
    CALL    EXPRSN                      ;3c2c  cd f2 22      9204   9223 
    POP DE                              ;3c2f  d1            9205   9224 
    POP BC                              ;3c30  c1            9206   9225 
    CALL    SK2829                      ;3c31  cd 1e 27      9207   9226 
    POP DE                              ;3c34  d1            9208   9227 
    LD  (FUNCNS),DE                     ;3c35  ed 53 2f 26   9209   9228 
    JP  BCFTCH                          ;3c39  c3 c4 25      9210   9229 
                                        ;                    9211   9230 ;
DFLTUF: LD  A,0                         ;3c3c  3e 00         9212   9231 
    JR  DFLTZR                          ;3c3e  18 11         9213   9232 
                                        ;                    9214   9233 ;
DEFUSR: INC HL                          ;3c40  23            9215   9234 
    CALL    HLFTCH                      ;3c41  cd 87 29      9216   9235 
    CP  0F5h                            ;3c44  fe f5         9217   9236 
    JR  Z,DFLTUF                        ;3c46  28 f4         9218   9237 
    OR  A                               ;3c48  b7            9219   9238 
    JR  Z,USERSE                        ;3c49  28 26         9220   9239 
    CP  00Bh                            ;3c4b  fe 0b         9221   9240 
    JR  NC,USERSE                       ;3c4d  30 22         9222   9241 
    DEC A                               ;3c4f  3d            9223   9242 
    INC HL                              ;3c50  23            9224   9243 
DFLTZR: PUSH    AF                      ;3c51  f5            9225   9244 
    CALL    HLFTCH                      ;3c52  cd 87 29      9226   9245 
    CP  0F5h                            ;3c55  fe f5         9227   9246 
    JR  NZ,USERSE                       ;3c57  20 18         9228   9247 
    INC HL                              ;3c59  23            9229   9248 
    LD  C,L                             ;3c5a  4d            9230   9249 
    LD  B,H                             ;3c5b  44            9231   9250 
    CALL    IHLEXP                      ;3c5c  cd cc 22      9232   9251 
    LD  DE,USRTBL                       ;3c5f  11 a2 30      9233   9252 
    POP AF                              ;3c62  f1            9234   9253 
    ADD A,A                             ;3c63  87            9235   9254 
    ADD A,E                             ;3c64  83            9236   9255 
    LD  E,A                             ;3c65  5f            9237   9256 
    LD  A,0                             ;3c66  3e 00         9238   9257 
    ADC A,D                             ;3c68  8a            9239   9258 
    LD  D,A                             ;3c69  57            9240   9259 
    EX  DE,HL                           ;3c6a  eb            9241   9260 
    LD  (HL),E                          ;3c6b  73            9242   9261 
    INC HL                              ;3c6c  23            9243   9262 
    LD  (HL),D                          ;3c6d  72            9244   9263 
    JP  RETIRQ                          ;3c6e  c3 39 1b      9245   9264 
                                        ;                    9246   9265 ;
USERSE: JP  SERROR                      ;3c71  c3 3a 17      9247   9266 
                                        ;                    9248   9267 ;
USRDFZ: DEC BC                          ;3c74  0b            9249   9268 
    XOR A                               ;3c75  af            9250   9269 
    JR  USRDZE                          ;3c76  18 0f         9251   9270 
                                        ;                    9252   9271 ;
USROPR: CALL    BCFTCH                  ;3c78  cd c4 25      9253   9272 
    CP  028h                            ;3c7b  fe 28         9254   9273 
    JR  Z,USRDFZ                        ;3c7d  28 f5         9255   9274 
    OR  A                               ;3c7f  b7            9256   9275 
    JR  Z,USERSE                        ;3c80  28 ef         9257   9276 
    CP  00Bh                            ;3c82  fe 0b         9258   9277 
    JR  NC,USERSE                       ;3c84  30 eb         9259   9278 
    DEC A                               ;3c86  3d            9260   9279 
USRDZE: PUSH    AF                      ;3c87  f5            9261   9280 
    CALL    BCFTCH                      ;3c88  cd c4 25      9262   9281 
    CP  028h                            ;3c8b  fe 28         9263   9282 
    JR  NZ,USERSE                       ;3c8d  20 e2         9264   9283 
    CALL    EXPRSN                      ;3c8f  cd f2 22      9265   9284 
    CP  029h                            ;3c92  fe 29         9266   9285 
    JR  NZ,USERSE                       ;3c94  20 db         9267   9286 
    POP AF                              ;3c96  f1            9268   9287 
    PUSH    BC                          ;3c97  c5            9269   9288 
    PUSH    HL                          ;3c98  e5            9270   9289 
    ADD A,A                             ;3c99  87            9271   9290 
    LD  DE,USRTBL                       ;3c9a  11 a2 30      9272   9291 
    ADD A,E                             ;3c9d  83            9273   9292 
    LD  E,A                             ;3c9e  5f            9274   9293 
    LD  A,0                             ;3c9f  3e 00         9275   9294 
    ADC A,D                             ;3ca1  8a            9276   9295 
    LD  D,A                             ;3ca2  57            9277   9296 
    EX  DE,HL                           ;3ca3  eb            9278   9297 
    CALL    INDRCT                      ;3ca4  cd a3 2a      9279   9298 
    EX  DE,HL                           ;3ca7  eb            9280   9299 
    LD  A,D                             ;3ca8  7a            9281   9300 
    OR  E                               ;3ca9  b3            9282   9301 
    JP  Z,UNDEFN                        ;3caa  ca 9d 3b      9283   9302 
    LD  A,(IY+0)                        ;3cad  fd 7e 00      9284   9303 
    CP  003h                            ;3cb0  fe 03         9285   9304 
    CALL    Z,INDRCT                    ;3cb2  cc a3 2a      9286   9305 
    PUSH    HL                          ;3cb5  e5            9287   9306 
    LD  HL,USRBCK                       ;3cb6  21 bc 3c      9288   9307 
    EX  (SP),HL                         ;3cb9  e3            9289   9308 
    PUSH    DE                          ;3cba  d5            9290   9309 
    RET                                 ;3cbb  c9            9291   9310 
                                        ;                    9292   9311 ;
USRBCK: POP HL                          ;3cbc  e1            9293   9312 
    POP BC                              ;3cbd  c1            9294   9313 
    JP  BCFTCH                          ;3cbe  c3 c4 25      9295   9314 
                                        ;                    9296   9315 ;
TIME$:  JP  NINS                        ;3cc1  c3 fa 20      9297   9316 
                                        ;                    9298   9317 ;
SCRN$:  PUSH    HL                      ;3cc4  e5            9299   9318 
    CALL    CH28H                       ;3cc5  cd 58 2d      9300   9319 
    DEC IY                              ;3cc8  fd 2b         9301   9320 
    CALL    HLEXP                       ;3cca  cd c7 22      9302   9321 
    CP  02Ch                            ;3ccd  fe 2c         9303   9322 
SCRNER: JP  NZ,SERROR                   ;3ccf  c2 3a 17      9304   9323 
    CALL    HCHECK                      ;3cd2  cd d8 22      9305   9324 
    CP  32                              ;3cd5  fe 20         9306   9325 
SCRIFC: JP  NC,IFCALL                   ;3cd7  d2 36 17      9307   9326 
    LD  E,A                             ;3cda  5f            9308   9327 
    POP HL                              ;3cdb  e1            9309   9328 
    PUSH    HL                          ;3cdc  e5            9310   9329 
    PUSH    DE                          ;3cdd  d5            9311   9330 
    CALL    HLEXP                       ;3cde  cd c7 22      9312   9331 
    CP  02Ch                            ;3ce1  fe 2c         9313   9332 
    JR  NZ,SCRNER                       ;3ce3  20 ea         9314   9333 
    CALL    HCHECK                      ;3ce5  cd d8 22      9315   9334 
    CP  16                              ;3ce8  fe 10         9316   9335 
    JR  NC,SCRIFC                       ;3cea  30 eb         9317   9336 
    POP HL                              ;3cec  e1            9318   9337 
    LD  H,A                             ;3ced  67            9319   9338 
    PUSH    BC                          ;3cee  c5            9320   9339 
    CALL    ADRCA2                      ;3cef  cd 3b 09      9321   9340 
    LD  D,B                             ;3cf2  50            9322   9341 
    LD  E,C                             ;3cf3  59            9323   9342 
    POP BC                              ;3cf4  c1            9324   9343 
    POP HL                              ;3cf5  e1            9325   9344 
    PUSH    HL                          ;3cf6  e5            9326   9345 
    PUSH    DE                          ;3cf7  d5            9327   9346 
    CALL    HLEXP                       ;3cf8  cd c7 22      9328   9347 
    CP  029h                            ;3cfb  fe 29         9329   9348 
    JR  NZ,SCRNER                       ;3cfd  20 d0         9330   9349 
    CALL    HCHECK                      ;3cff  cd d8 22      9331   9350 
    POP HL                              ;3d02  e1            9332   9351 
    POP DE                              ;3d03  d1            9333   9352 
    PUSH    BC                          ;3d04  c5            9334   9353 
    PUSH    DE                          ;3d05  d5            9335   9354 
    PUSH    AF                          ;3d06  f5            9336   9355 
    LD  C,L                             ;3d07  4d            9337   9356 
    LD  B,H                             ;3d08  44            9338   9357 
    LD  H,A                             ;3d09  67            9339   9358 
    LD  DE,KEYBUF                       ;3d0a  11 4f 7a      9340   9359 
    PUSH    DE                          ;3d0d  d5            9341   9360 
SCRNTL: CALL    AINBC                   ;3d0e  cd 94 07      9342   9361 
    OR  A                               ;3d11  b7            9343   9362 
    JR  NZ,L2900                        ;3d12  20 02         9344   9363 
    LD  A,020h                          ;3d14  3e 20         9345   9364 
L2900:  LD  (DE),A                      ;3d16  12            9346   9365 
    INC BC                              ;3d17  03            9347   9366 
    INC DE                              ;3d18  13            9348   9367 
    DEC H                               ;3d19  25            9349   9368 
    JR  NZ,SCRNTL                       ;3d1a  20 f2         9350   9369 
    POP DE                              ;3d1c  d1            9351   9370 
    POP AF                              ;3d1d  f1            9352   9371 
    LD  B,A                             ;3d1e  47            9353   9372 
    POP HL                              ;3d1f  e1            9354   9373 
    PUSH    DE                          ;3d20  d5            9355   9374 
    LD  DE,00008h                       ;3d21  11 08 00      9356   9375 
    ADD HL,DE                           ;3d24  19            9357   9376 
    POP DE                              ;3d25  d1            9358   9377 
    CALL    ENTSTR                      ;3d26  cd 1a 2b      9359   9378 
    INC IY                              ;3d29  fd 23         9360   9379 
    POP BC                              ;3d2b  c1            9361   9380 
    JP  CONDSB                          ;3d2c  c3 b1 25      9362   9381 
                                        ;                    9363   9382 ;
DUMP:   CALL    HLFTCH                  ;3d2f  cd 87 29      9364   9383 
    CP  023h                            ;3d32  fe 23         9365   9384 
    LD  A,0                             ;3d34  3e 00         9366   9385 
    JR  NZ,STDPDV                       ;3d36  20 03         9367   9386 
    INC HL                              ;3d38  23            9368   9387 
    LD  A,2                             ;3d39  3e 02         9369   9388 
STDPDV: LD  (DISFLG),A                  ;3d3b  32 eb 11      9370   9389 
    PUSH    HL                          ;3d3e  e5            9371   9390 
    LD  HL,(VSTART)                     ;3d3f  2a 3b 7a      9372   9391 
DMPLOP: LD  A,(HL)                      ;3d42  7e            9373   9392 
    OR  A                               ;3d43  b7            9374   9393 
    JP  Z,DUMPRT                        ;3d44  ca e4 3d      9375   9394 
    RLCA                                ;3d47  07            9376   9395 
    JR  NC,ONLYVR                       ;3d48  30 38         9377   9396 
    RLCA                                ;3d4a  07            9378   9397 
    JR  NC,ARYSKP                       ;3d4b  30 07         9379   9398 
    INC HL                              ;3d4d  23            9380   9399 
    INC HL                              ;3d4e  23            9381   9400 
    INC HL                              ;3d4f  23            9382   9401 
    INC HL                              ;3d50  23            9383   9402 
    INC HL                              ;3d51  23            9384   9403 
    JR  DMPLOP                          ;3d52  18 ee         9385   9404 
ARYSKP: LD  A,(HL)                      ;3d54  7e            9386   9405 
    INC HL                              ;3d55  23            9387   9406 
    PUSH    HL                          ;3d56  e5            9388   9407 
    INC HL                              ;3d57  23            9389   9408 
    AND 00Fh                            ;3d58  e6 0f         9390   9409 
    CALL    PRDMVR                      ;3d5a  cd eb 3d      9391   9410 
    LD  B,(HL)                          ;3d5d  46            9392   9411 
    INC HL                              ;3d5e  23            9393   9412 
    LD  A,028h                          ;3d5f  3e 28         9394   9413 
ARDSLP: CALL    ACCPRT                  ;3d61  cd 64 08      9395   9414 
    PUSH    HL                          ;3d64  e5            9396   9415 
    CALL    INDRCT                      ;3d65  cd a3 2a      9397   9416 
    PUSH    BC                          ;3d68  c5            9398   9417 
    CALL    FIVEPR                      ;3d69  cd e5 16      9399   9418 
    POP BC                              ;3d6c  c1            9400   9419 
    POP HL                              ;3d6d  e1            9401   9420 
    INC HL                              ;3d6e  23            9402   9421 
    INC HL                              ;3d6f  23            9403   9422 
    LD  A,02Ch                          ;3d70  3e 2c         9404   9423 
    DJNZ    ARDSLP                      ;3d72  10 ed         9405   9424 
    LD  A,029h                          ;3d74  3e 29         9406   9425 
    CALL    ACCPRT                      ;3d76  cd 64 08      9407   9426 
    CALL    CR1                         ;3d79  cd 43 08      9408   9427 
    POP HL                              ;3d7c  e1            9409   9428 
    CALL    INDRCT                      ;3d7d  cd a3 2a      9410   9429 
    JR  DMPLOP                          ;3d80  18 c0         9411   9430 
ONLYVR: PUSH    HL                      ;3d82  e5            9412   9431 
    LD  A,(HL)                          ;3d83  7e            9413   9432 
    PUSH    AF                          ;3d84  f5            9414   9433 
    CALL    PRDMVR                      ;3d85  cd eb 3d      9415   9434 
    LD  A,03Dh                          ;3d88  3e 3d         9416   9435 
    CALL    ACCPRT                      ;3d8a  cd 64 08      9417   9436 
    LD  A,(IY+0)                        ;3d8d  fd 7e 00      9418   9437 
    CP  003h                            ;3d90  fe 03         9419   9438 
    JR  NZ,STRDMP                       ;3d92  20 15         9420   9439 
    LD  B,(HL)                          ;3d94  46            9421   9440 
    INC HL                              ;3d95  23            9422   9441 
    CALL    INDRCT                      ;3d96  cd a3 2a      9423   9442 
    EX  DE,HL                           ;3d99  eb            9424   9443 
    LD  A,022h                          ;3d9a  3e 22         9425   9444 
    CALL    ACCPRT                      ;3d9c  cd 64 08      9426   9445 
    CALL    PRTSDC                      ;3d9f  cd e1 07      9427   9446 
    LD  A,022h                          ;3da2  3e 22         9428   9447 
    CALL    ACCPRT                      ;3da4  cd 64 08      9429   9448 
    JR  NXTDMP                          ;3da7  18 20         9430   9449 
                                        ;                    9431   9450 ;
STRDMP: CP  002h                        ;3da9  fe 02         9432   9451 
    JR  NZ,RALDMP                       ;3dab  20 0e         9433   9452 
    CALL    INDRCT                      ;3dad  cd a3 2a      9434   9453 
    EX  DE,HL                           ;3db0  eb            9435   9454 
    LD  HL,KEYBUF                       ;3db1  21 4f 7a      9436   9455 
    LD  (IY+0),4                        ;3db4  fd 36 00 04   9437   9456 
    CALL    FLTHEX                      ;3db8  cd 02 29      9438   9457 
RALDMP: LD  DE,USINGB                   ;3dbb  11 b1 46      9439   9458 
    PUSH    DE                          ;3dbe  d5            9440   9459 
    CALL    LDIR8                       ;3dbf  cd a6 73      9441   9460 
    POP HL                              ;3dc2  e1            9442   9461 
    CALL    CVNMFL                      ;3dc3  cd 58 5d      9443   9462 
    CALL    PRTSDC                      ;3dc6  cd e1 07      9444   9463 
NXTDMP: CALL    CR1                     ;3dc9  cd 43 08      9445   9464 
    POP AF                              ;3dcc  f1            9446   9465 
    POP HL                              ;3dcd  e1            9447   9466 
    INC A                               ;3dce  3c            9448   9467 
    INC A                               ;3dcf  3c            9449   9468 
    INC A                               ;3dd0  3c            9450   9469 
    LD  E,A                             ;3dd1  5f            9451   9470 
    LD  D,0                             ;3dd2  16 00         9452   9471 
    ADD HL,DE                           ;3dd4  19            9453   9472 
    LD  A,080h                          ;3dd5  3e 80         9454   9473 
    IN  A,(1)                           ;3dd7  db 01         9455   9474 
    AND 004h                            ;3dd9  e6 04         9456   9475 
    CALL    Z,FLSHGT                    ;3ddb  cc 3c 0d      9457   9476 
    CALL    BRKEY                       ;3dde  cd 5b 0c      9458   9477 
    JP  NZ,DMPLOP                       ;3de1  c2 42 3d      9459   9478 
DUMPRT: POP HL                          ;3de4  e1            9460   9479 
    LD  A,1                             ;3de5  3e 01         9461   9480 
    LD  (DISFLG),A                      ;3de7  32 eb 11      9462   9481 
    RET                                 ;3dea  c9            9463   9482 
                                        ;                    9464   9483 ;
PRDMVR: PUSH    AF                      ;3deb  f5            9465   9484 
    INC HL                              ;3dec  23            9466   9485 
    LD  A,(HL)                          ;3ded  7e            9467   9486 
    CALL    ACCPRT                      ;3dee  cd 64 08      9468   9487 
    INC HL                              ;3df1  23            9469   9488 
    LD  A,(HL)                          ;3df2  7e            9470   9489 
    OR  A                               ;3df3  b7            9471   9490 
    JR  NZ,NTNULD                       ;3df4  20 02         9472   9491 
    LD  A,020h                          ;3df6  3e 20         9473   9492 
NTNULD: CALL    ACCPRT                  ;3df8  cd 64 08      9474   9493 
    INC HL                              ;3dfb  23            9475   9494 
    POP AF                              ;3dfc  f1            9476   9495 
    LD  B,021h                          ;3dfd  06 21         9477   9496 
    CP  004h                            ;3dff  fe 04         9478   9497 
    JR  Z,PTVSBL                        ;3e01  28 0c         9479   9498 
    INC B                               ;3e03  04            9480   9499 
    INC B                               ;3e04  04            9481   9500 
    CP  008h                            ;3e05  fe 08         9482   9501 
    JR  Z,PTVSBL                        ;3e07  28 06         9483   9502 
    INC B                               ;3e09  04            9484   9503 
    CP  003h                            ;3e0a  fe 03         9485   9504 
    JR  Z,PTVSBL                        ;3e0c  28 01         9486   9505 
    INC B                               ;3e0e  04            9487   9506 
PTVSBL: LD  IY,(INTSSP)                 ;3e0f  fd 2a 43 7a   9488   9507 
    LD  (IY+0),A                        ;3e13  fd 77 00      9489   9508 
    LD  A,B                             ;3e16  78            9490   9509 
    CALL    ACCPRT                      ;3e17  cd 64 08      9491   9510 
    RET                                 ;3e1a  c9            9492   9511 
                                        ;                    9493   9512 ;
CONSOL: JP  NINS                        ;3e1b  c3 fa 20      9494   9513 
                                        ;                    9495   9514 ;
KLIST:  PUSH    HL                      ;3e1e  e5            9496   9515 
    CALL    CR2                         ;3e1f  cd 23 08      9497   9516 
    LD  C,0                             ;3e22  0e 00         9498   9517 
KLSTLP: LD  A,C                         ;3e24  79            9499   9518 
    CP  009h                            ;3e25  fe 09         9500   9519 
    JR  Z,KLTEN                         ;3e27  28 07         9501   9520 
    ADD A,031h                          ;3e29  c6 31         9502   9521 
    CALL    ACCPRT                      ;3e2b  cd 64 08      9503   9522 
    JR  KLTAB                           ;3e2e  18 09         9504   9523 
KLTEN:  LD  A,031h                      ;3e30  3e 31         9505   9524 
    CALL    ACCPRT                      ;3e32  cd 64 08      9506   9525 
    DEC A                               ;3e35  3d            9507   9526 
    CALL    ACCPRT                      ;3e36  cd 64 08      9508   9527 
KLTAB:  CALL    TABPRT                  ;3e39  cd 02 08      9509   9528 
    LD  A,C                             ;3e3c  79            9510   9529 
    CALL    KEYBCL                      ;3e3d  cd da 3e      9511   9530 
    LD  B,(HL)                          ;3e40  46            9512   9531 
    INC HL                              ;3e41  23            9513   9532 
    XOR A                               ;3e42  af            9514   9533 
    CP  B                               ;3e43  b8            9515   9534 
    JR  Z,KLESC                         ;3e44  28 07         9516   9535 
KLLP1:  LD  A,(HL)                      ;3e46  7e            9517   9536 
    CALL    CTRLPR                      ;3e47  cd 59 3e      9518   9537 
    INC HL                              ;3e4a  23            9519   9538 
    DJNZ    KLLP1                       ;3e4b  10 f9         9520   9539 
KLESC:  CALL    CR2                     ;3e4d  cd 23 08      9521   9540 
    INC C                               ;3e50  0c            9522   9541 
    LD  A,C                             ;3e51  79            9523   9542 
    CP  10                              ;3e52  fe 0a         9524   9543 
    JR  NZ,KLSTLP                       ;3e54  20 ce         9525   9544 
    POP HL                              ;3e56  e1            9526   9545 
    INC HL                              ;3e57  23            9527   9546 
    RET                                 ;3e58  c9            9528   9547 
                                        ;                    9529   9548 ;
CTRLPR: CP  020h                        ;3e59  fe 20         9530   9549 
    JP  NC,ACCPRT                       ;3e5b  d2 64 08      9531   9550 
    PUSH    AF                          ;3e5e  f5            9532   9551 
    LD  A,05Bh                          ;3e5f  3e 5b         9533   9552 
    CALL    ACCPRT                      ;3e61  cd 64 08      9534   9553 
    POP AF                              ;3e64  f1            9535   9554 
    ADD A,040h                          ;3e65  c6 40         9536   9555 
    CALL    ACCPRT                      ;3e67  cd 64 08      9537   9556 
    LD  A,05Dh                          ;3e6a  3e 5d         9538   9557 
    JP  ACCPRT                          ;3e6c  c3 64 08      9539   9558 
                                        ;                    9540   9559 ;
KEYON:  JP  NINS                        ;3e6f  c3 fa 20      9541   9560 
                                        ;                    9542   9561 ;
KEYOFF: JP  NINS                        ;3e72  c3 fa 20      9543   9562 
                                        ;                    9544   9563 ;
KEY:    CALL    HLFTCH                  ;3e75  cd 87 29      9545   9564 
    CP  086h                            ;3e78  fe 86         9546   9565 
    JP  Z,KLIST                         ;3e7a  ca 1e 3e      9547   9566 
    CP  098h                            ;3e7d  fe 98         9548   9567 
    JR  Z,KEYON                         ;3e7f  28 ee         9549   9568 
    CP  09Ch                            ;3e81  fe 9c         9550   9569 
    JR  Z,KEYOFF                        ;3e83  28 ed         9551   9570 
    LD  C,L                             ;3e85  4d            9552   9571 
    LD  B,H                             ;3e86  44            9553   9572 
    CALL    IHLEXP                      ;3e87  cd cc 22      9554   9573 
    CP  02Ch                            ;3e8a  fe 2c         9555   9574 
    JP  NZ,SERROR                       ;3e8c  c2 3a 17      9556   9575 
    CALL    HCHECK                      ;3e8f  cd d8 22      9557   9576 
    CP  11                              ;3e92  fe 0b         9558   9577 
KIFCVX: JP  NC,IFCALL                   ;3e94  d2 36 17      9559   9578 
    OR  A                               ;3e97  b7            9560   9579 
    JR  Z,KBUFST                        ;3e98  28 25         9561   9580 
    DEC A                               ;3e9a  3d            9562   9581 
    CALL    KEYBCL                      ;3e9b  cd da 3e      9563   9582 
    PUSH    HL                          ;3e9e  e5            9564   9583 
    CALL    STREXX                      ;3e9f  cd 9d 45      9565   9584 
    POP DE                              ;3ea2  d1            9566   9585 
    LD  A,(HL)                          ;3ea3  7e            9567   9586 
    CP  16                              ;3ea4  fe 10         9568   9587 
    JR  C,KLNLMT                        ;3ea6  38 02         9569   9588 
    LD  A,15                            ;3ea8  3e 0f         9570   9589 
KLNLMT: LD  (DE),A                      ;3eaa  12            9571   9590 
    INC DE                              ;3eab  13            9572   9591 
    INC HL                              ;3eac  23            9573   9592 
    PUSH    BC                          ;3ead  c5            9574   9593 
    LD  B,A                             ;3eae  47            9575   9594 
    CALL    INDRCT                      ;3eaf  cd a3 2a      9576   9595 
    XOR A                               ;3eb2  af            9577   9596 
    OR  B                               ;3eb3  b0            9578   9597 
    JR  Z,ESCKPT                        ;3eb4  28 06         9579   9598 
KYPTLP: LD  A,(HL)                      ;3eb6  7e            9580   9599 
    LD  (DE),A                          ;3eb7  12            9581   9600 
    INC DE                              ;3eb8  13            9582   9601 
INDRCT1: INC    HL                      ;3eb9  23            9583   9602 
    DJNZ    KYPTLP                      ;3eba  10 fa         9584   9603 
ESCKPT: POP HL                          ;3ebc  e1            9585   9604 
    DEC HL                              ;3ebd  2b            9586   9605 
    RET                                 ;3ebe  c9            9587   9606 
                                        ;                    9588   9607 ;
KBUFST: CALL    STREXX                  ;3ebf  cd 9d 45      9589   9608 
    DEC DE                              ;3ec2  1b            9590   9609 
    INC A                               ;3ec3  3c            9591   9610 
    INC A                               ;3ec4  3c            9592   9611 
    LD  HL,POINT1                       ;3ec5  21 04 12      9593   9612 
    LD  (HL),0                          ;3ec8  36 00         9594   9613 
    CP  040h                            ;3eca  fe 40         9595   9614 ;KEY BUFF LIMIT
    JR  C,KBUFSL                        ;3ecc  38 02         9596   9615 
    LD  A,040h                          ;3ece  3e 40         9597   9616 
KBUFSL: PUSH    BC                      ;3ed0  c5            9598   9617 
    LD  B,A                             ;3ed1  47            9599   9618 
KBUFLP: INC HL                          ;3ed2  23            9600   9619 
    LD  (HL),A                          ;3ed3  77            9601   9620 
    LD  A,(DE)                          ;3ed4  1a            9602   9621 
    INC DE                              ;3ed5  13            9603   9622 
    DJNZ    KBUFLP                      ;3ed6  10 fa         9604   9623 
    JR  ESCKPT                          ;3ed8  18 e2         9605   9624 
                                        ;                    9606   9625 ;
KEYBCL: ADD A,A                         ;3eda  87            9607   9626 
    ADD A,A                             ;3edb  87            9608   9627 
    ADD A,A                             ;3edc  87            9609   9628 
    ADD A,A                             ;3edd  87            9610   9629 
    LD  HL,FUNBUF                       ;3ede  21 66 12      9611   9630 
    ADD A,L                             ;3ee1  85            9612   9631 
    LD  L,A                             ;3ee2  6f            9613   9632 
    LD  A,0                             ;3ee3  3e 00         9614   9633 
    ADC A,H                             ;3ee5  8c            9615   9634 
    LD  H,A                             ;3ee6  67            9616   9635 
    RET                                 ;3ee7  c9            9617   9636 
                                        ;                    9618   9637 ;
CSRLIN: LD  DE,00008h                   ;3ee8  11 08 00      9619   9638 
    ADD HL,DE                           ;3eeb  19            9620   9639 
    LD  A,(CURY)                        ;3eec  3a ee 11      9621   9640 
    LD  E,A                             ;3eef  5f            9622   9641 
    LD  D,0                             ;3ef0  16 00         9623   9642 
    CALL    FLTHEX                      ;3ef2  cd 02 29      9624   9643 
    LD  A,4                             ;3ef5  3e 04         9625   9644 
    CALL    CONDFL                      ;3ef7  cd eb 28      9626   9645 
    JP  BCFTCH                          ;3efa  c3 c4 25      9627   9646 
                                        ;                    9628   9647 ;
LNOADR: PUSH    DE                      ;3efd  d5            9629   9648 
    PUSH    HL                          ;3efe  e5            9630   9649 
    LD  HL,ADRNVC                       ;3eff  21 4f 3f      9631   9650 
    LD  (RETLNV),HL                     ;3f02  22 33 3f      9632   9651 
    JR  MIDRLN                          ;3f05  18 0b         9633   9652 
                                        ;                    9634   9653 ;
RETLNR: POP HL                          ;3f07  e1            9635   9654 
    POP DE                              ;3f08  d1            9636   9655 
    RET                                 ;3f09  c9            9637   9656 
                                        ;                    9638   9657 ;
RETLNO: PUSH    DE                      ;3f0a  d5            9639   9658 
    PUSH    HL                          ;3f0b  e5            9640   9659 
    LD  HL,RELNVC                       ;3f0c  21 35 3f      9641   9660 
    LD  (RETLNV),HL                     ;3f0f  22 33 3f      9642   9661 
MIDRLN: LD  HL,TEXTST                   ;3f12  21 4e 7c      9643   9662 
    DEC HL                              ;3f15  2b            9644   9663 
RTLLOP: INC HL                          ;3f16  23            9645   9664 
    LD  A,(HL)                          ;3f17  7e            9646   9665 
    INC HL                              ;3f18  23            9647   9666 
    OR  (HL)                            ;3f19  b6            9648   9667 
    JR  Z,RETLNR                        ;3f1a  28 eb         9649   9668 
    INC HL                              ;3f1c  23            9650   9669 
    LD  E,(HL)                          ;3f1d  5e            9651   9670 
    INC HL                              ;3f1e  23            9652   9671 
    LD  D,(HL)                          ;3f1f  56            9653   9672 
    LD  (UDLBUF),DE                     ;3f20  ed 53 82 3f   9654   9673 
RETSTL: CALL    IFSKSB                  ;3f24  cd 40 44      9655   9674 
    OR  A                               ;3f27  b7            9656   9675 
    JR  Z,RTLLOP                        ;3f28  28 ec         9657   9676 
    CP  00Bh                            ;3f2a  fe 0b         9658   9677 
    JR  Z,CVRTLN                        ;3f2c  28 04         9659   9678 
    CP  00Ch                            ;3f2e  fe 0c         9660   9679 
    JR  NZ,RETSTL                       ;3f30  20 f2         9661   9680 
                                        ;                    9662   9681 ;
CVRTLN: DEFB    0C3H                    ;3f32  c3            9663   9682 ; JP ?
RETLNV: DEFW    RELNVC                  ;3f33  35 3f         9664   9683 
RELNVC: CP  00Bh                        ;3f35  fe 0b         9665   9684 
    JR  Z,RETSTL                        ;3f37  28 eb         9666   9685 
                                        ;                    9667   9686 ;
CVLNAD: DEC HL                          ;3f39  2b            9668   9687 
    LD  E,(HL)                          ;3f3a  5e            9669   9688 
    INC HL                              ;3f3b  23            9670   9689 
    LD  D,(HL)                          ;3f3c  56            9671   9690 
    PUSH    HL                          ;3f3d  e5            9672   9691 
    EX  DE,HL                           ;3f3e  eb            9673   9692 
    INC HL                              ;3f3f  23            9674   9693 
    INC HL                              ;3f40  23            9675   9694 
    LD  E,(HL)                          ;3f41  5e            9676   9695 
    INC HL                              ;3f42  23            9677   9696 
    LD  D,(HL)                          ;3f43  56            9678   9697 
    POP HL                              ;3f44  e1            9679   9698 
    LD  (HL),D                          ;3f45  72            9680   9699 
    DEC HL                              ;3f46  2b            9681   9700 
    LD  (HL),E                          ;3f47  73            9682   9701 
    DEC HL                              ;3f48  2b            9683   9702 
    LD  (HL),00Bh                       ;3f49  36 0b         9684   9703 
    INC HL                              ;3f4b  23            9685   9704 
    INC HL                              ;3f4c  23            9686   9705 
RTLSHM: JR  RETSTL                      ;3f4d  18 d5         9687   9706 
                                        ;                    9688   9707 ;
ADRNVC: CP  00Ch                        ;3f4f  fe 0c         9689   9708 
    JR  Z,RETSTL                        ;3f51  28 d1         9690   9709 
    DEC HL                              ;3f53  2b            9691   9710 
    PUSH    HL                          ;3f54  e5            9692   9711 
    CALL    INDRCT                      ;3f55  cd a3 2a      9693   9712 
    LD  E,L                             ;3f58  5d            9694   9713 
    LD  D,H                             ;3f59  54            9695   9714 
    CALL    LNOSER                      ;3f5a  cd 8e 3f      9696   9715 
    JR  C,RENNTF                        ;3f5d  38 0b         9697   9716 
    EX  DE,HL                           ;3f5f  eb            9698   9717 
    POP HL                              ;3f60  e1            9699   9718 
    DEC HL                              ;3f61  2b            9700   9719 
    LD  (HL),00Ch                       ;3f62  36 0c         9701   9720 
    INC HL                              ;3f64  23            9702   9721 
    LD  (HL),E                          ;3f65  73            9703   9722 
    INC HL                              ;3f66  23            9704   9723 
    LD  (HL),D                          ;3f67  72            9705   9724 
RTRNAD: JR  RTLSHM                      ;3f68  18 e3         9706   9725 
                                        ;                    9707   9726 ;
RENNTF: EX  DE,HL                       ;3f6a  eb            9708   9727 
    LD  DE,UDLMES                       ;3f6b  11 1f 6a      9709   9728 
    LD  B,21                            ;3f6e  06 15         9710   9729 
    CALL    PRTSDC                      ;3f70  cd e1 07      9711   9730 
    CALL    SPPRT                       ;3f73  cd 62 08      9712   9731 
    CALL    FIVEPR                      ;3f76  cd e5 16      9713   9732 
    LD  DE,INMES                        ;3f79  11 0a 17      9714   9733 
    LD  B,4                             ;3f7c  06 04         9715   9734 
    CALL    PRTSDC                      ;3f7e  cd e1 07      9716   9735 
    DEFB    021H                        ;3f81  21            9717   9736 ; LD HL,?
UDLBUF: DEFS    2                       ;3f82                9718   9737 
    CALL    FIVEPR                      ;3f84  cd e5 16      9719   9738 
    CALL    CR2                         ;3f87  cd 23 08      9720   9739 
    POP HL                              ;3f8a  e1            9721   9740 
    INC HL                              ;3f8b  23            9722   9741 
    JR  RTRNAD                          ;3f8c  18 da         9723   9742 
                                        ;                    9724   9743 ;
LNOSER: PUSH    BC                      ;3f8e  c5            9725   9744 
    PUSH    DE                          ;3f8f  d5            9726   9745 
    EX  DE,HL                           ;3f90  eb            9727   9746 
    LD  HL,TEXTST                       ;3f91  21 4e 7c      9728   9747 
    LD  (TMPUYS),HL                     ;3f94  22 99 3f      9729   9748 
LNOSLP: PUSH    HL                      ;3f97  e5            9730   9749 
    DEFB    021H                        ;3f98  21            9731   9750 ; LD HL,?
TMPUYS: DEFS    2                       ;3f99                9732   9751 
                                        ;                    9733   9752 ;
    POP HL                              ;3f9b  e1            9734   9753 
    LD  (TMPUYS),HL                     ;3f9c  22 99 3f      9735   9754 
    LD  C,(HL)                          ;3f9f  4e            9736   9755 
    INC HL                              ;3fa0  23            9737   9756 
    LD  B,(HL)                          ;3fa1  46            9738   9757 
    LD  A,B                             ;3fa2  78            9739   9758 
    OR  C                               ;3fa3  b1            9740   9759 
    JR  Z,LMIDET1                       ;3fa4  28 1e         9741   9760 
    PUSH    BC                          ;3fa6  c5            9742   9761 
    INC HL                              ;3fa7  23            9743   9762 
    LD  C,(HL)                          ;3fa8  4e            9744   9763 
    INC HL                              ;3fa9  23            9745   9764 
    LD  B,(HL)                          ;3faa  46            9746   9765 
    LD  A,C                             ;3fab  79            9747   9766 
    CP  E                               ;3fac  bb            9748   9767 
    JR  NZ,NOMTCH                       ;3fad  20 0c         9749   9768 
    LD  A,B                             ;3faf  78            9750   9769 
    CP  D                               ;3fb0  ba            9751   9770 
    DEC HL                              ;3fb1  2b            9752   9771 
    DEC HL                              ;3fb2  2b            9753   9772 
    DEC HL                              ;3fb3  2b            9754   9773 
    JR  NZ,NOMTCH                       ;3fb4  20 05         9755   9774 
    POP BC                              ;3fb6  c1            9756   9775 
    OR  A                               ;3fb7  b7            9757   9776 
NTFRET: POP DE                          ;3fb8  d1            9758   9777 
    POP BC                              ;3fb9  c1            9759   9778 
    RET                                 ;3fba  c9            9760   9779 
                                        ;                    9761   9780 ;
NOMTCH: PUSH    DE                      ;3fbb  d5            9762   9781 
    EX  DE,HL                           ;3fbc  eb            9763   9782 
    OR  A                               ;3fbd  b7            9764   9783 
    SBC HL,BC                           ;3fbe  ed 42         9765   9784 
    POP DE                              ;3fc0  d1            9766   9785 
    POP HL                              ;3fc1  e1            9767   9786 
    JR  NC,LNOSLP                       ;3fc2  30 d3         9768   9787 
LMIDET1: SCF                            ;3fc4  37            9769   9788 
    JR  NTFRET                          ;3fc5  18 f1         9770   9789 
                                        ;                    9771   9790 ;
GTSTED: LD  DE,00000h                   ;3fc7  11 00 00      9772   9791 
    LD  BC,0FFFFh                       ;3fca  01 ff ff      9773   9792 
    CALL    HLFTCH                      ;3fcd  cd 87 29      9774   9793 
    OR  A                               ;3fd0  b7            9775   9794 
    RET Z                               ;3fd1  c8            9776   9795 
    CP  03Ah                            ;3fd2  fe 3a         9777   9796 
    RET Z                               ;3fd4  c8            9778   9797 
    CP  02Dh                            ;3fd5  fe 2d         9779   9798 
    JR  Z,GTNXNM                        ;3fd7  28 2c         9780   9799 
    CP  02Ch                            ;3fd9  fe 2c         9781   9800 
    JR  Z,GTNXNM                        ;3fdb  28 28         9782   9801 
    CP  02Eh                            ;3fdd  fe 2e         9783   9802 
    JR  NZ,FSTNUB                       ;3fdf  20 06         9784   9803 
    LD  DE,(EDLINE)                     ;3fe1  ed 5b 2a 37   9785   9804 
    JR  NX2C2D                          ;3fe5  18 09         9786   9805 
FSTNUB: CP  00Bh                        ;3fe7  fe 0b         9787   9806 
GSESER: JP  NZ,SERROR                   ;3fe9  c2 3a 17      9788   9807 
    INC HL                              ;3fec  23            9789   9808 
    LD  E,(HL)                          ;3fed  5e            9790   9809 
    INC HL                              ;3fee  23            9791   9810 
    LD  D,(HL)                          ;3fef  56            9792   9811 
NX2C2D: INC HL                          ;3ff0  23            9793   9812 
    CALL    HLFTCH                      ;3ff1  cd 87 29      9794   9813 
    CP  02Dh                            ;3ff4  fe 2d         9795   9814 
    JR  Z,GTNXNM                        ;3ff6  28 0d         9796   9815 
    CP  02Ch                            ;3ff8  fe 2c         9797   9816 
    JR  Z,GTNXNM                        ;3ffa  28 09         9798   9817 
    LD  C,E                             ;3ffc  4b            9799   9818 
    LD  B,D                             ;3ffd  42            9800   9819 
    OR  A                               ;3ffe  b7            9801   9820 
    RET Z                               ;3fff  c8            9802   9821 
    CP  03AH                            ;4000  fe 3a         9803   9822 
    RET Z                               ;4002  c8            9804   9823 
    JR  GSESER                          ;4003  18 e4         9805   9824 
                                        ;                    9806   9825 ;
GTNXNM: INC HL                          ;4005  23            9807   9826 
    CALL    HLFTCH                      ;4006  cd 87 29      9808   9827 
    OR  A                               ;4009  b7            9809   9828 
    RET Z                               ;400a  c8            9810   9829 
    CP  03Ah                            ;400b  fe 3a         9811   9830 
    RET Z                               ;400d  c8            9812   9831 
    CP  02Eh                            ;400e  fe 2e         9813   9832 
    JR  NZ,GTEDNO                       ;4010  20 06         9814   9833 
    LD  BC,(EDLINE)                     ;4012  ed 4b 2a 37   9815   9834 
    INC HL                              ;4016  23            9816   9835 
    RET                                 ;4017  c9            9817   9836 
                                        ;                    9818   9837 ;
GTEDNO: CP  00Bh                        ;4018  fe 0b         9819   9838 
    JR  NZ,GSESER                       ;401a  20 cd         9820   9839 
    INC HL                              ;401c  23            9821   9840 
    LD  C,(HL)                          ;401d  4e            9822   9841 
    INC HL                              ;401e  23            9823   9842 
    LD  B,(HL)                          ;401f  46            9824   9843 
    INC HL                              ;4020  23            9825   9844 
    RET                                 ;4021  c9            9826   9845 
                                        ;                    9827   9846 ;
EDIT:   CALL    GTSTED                  ;4022  cd c7 3f      9828   9847 
    PUSH    DE                          ;4025  d5            9829   9848 
    EX  DE,HL                           ;4026  eb            9830   9849 
    CALL    LNOSER                      ;4027  cd 8e 3f      9831   9850 
    JP  C,UDFLNO                        ;402a  da dc 43      9832   9851 
    XOR A                               ;402d  af            9833   9852 
    LD  (DISFLG),A                      ;402e  32 eb 11      9834   9853 
    EX  DE,HL                           ;4031  eb            9835   9854 
    POP HL                              ;4032  e1            9836   9855 
    CALL    FIVEPR                      ;4033  cd e5 16      9837   9856 
    CALL    SPPRT                       ;4036  cd 62 08      9838   9857 
    EX  DE,HL                           ;4039  eb            9839   9858 
    LD  DE,4                            ;403a  11 04 00      9840   9859 
    ADD HL,DE                           ;403d  19            9841   9860 
    CALL    ONELST                      ;403e  cd 28 41      9842   9861 
    LD  A,1                             ;4041  3e 01         9843   9862 
    LD  (DISFLG),A                      ;4043  32 eb 11      9844   9863 
EDBKLP: LD  A,29                        ;4046  3e 1d         9845   9864 ;CURLEFT CODE
    CALL    ACCPRT                      ;4048  cd 64 08      9846   9865 
    DJNZ    EDBKLP                      ;404b  10 f9         9847   9866 
    JP  AUTOBK                          ;404d  c3 8b 14      9848   9867 
                                        ;                    9849   9868 ;
SLIST:  PUSH    BC                      ;4050  c5            9850   9869 
    PUSH    DE                          ;4051  d5            9851   9870 
    PUSH    HL                          ;4052  e5            9852   9871 
    LD  HL,SERVEC                       ;4053  21 58 32      9853   9872 
    LD  (SAVEVC),HL                     ;4056  22 f6 40      9854   9873 
    LD  HL,SER0DH                       ;4059  21 89 32      9855   9874 
    JR  SDXSET                          ;405c  18 0c         9856   9875 
                                        ;                    9857   9876 ;
CLIST:  PUSH    BC                      ;405e  c5            9858   9877 
    PUSH    DE                          ;405f  d5            9859   9878 
    PUSH    HL                          ;4060  e5            9860   9879 
    LD  HL,COUTCH                       ;4061  21 f8 40      9861   9880 
    LD  (SAVEVC),HL                     ;4064  22 f6 40      9862   9881 
    LD  HL,COUT0D                       ;4067  21 06 41      9863   9882 
SDXSET: LD  DE,00000h                   ;406a  11 00 00      9864   9883 
    LD  BC,0FFFFh                       ;406d  01 ff ff      9865   9884 
    JR  CLISTM                          ;4070  18 1f         9866   9885 
                                        ;                    9867   9886 ;
LIST#:  CALL    HLFTCH                  ;4072  cd 87 29      9868   9887 
    CP  02Ch                            ;4075  fe 2c         9869   9888 
    JR  NZ,LIST##                       ;4077  20 01         9870   9889 
    INC HL                              ;4079  23            9871   9890 
LIST##: LD  A,2                         ;407a  3e 02         9872   9891 
    JR  LIST#E                          ;407c  18 01         9873   9892 
                                        ;                    9874   9893 ;
LIST:   XOR A                           ;407e  af            9875   9894 
LIST#E: LD  (DISFLG),A                  ;407f  32 eb 11      9876   9895 
    PUSH    BC                          ;4082  c5            9877   9896 
    PUSH    DE                          ;4083  d5            9878   9897 
    CALL    GTSTED                      ;4084  cd c7 3f      9879   9898 
    PUSH    HL                          ;4087  e5            9880   9899 
    LD  HL,CRTVEC                       ;4088  21 fd 40      9881   9900 
    LD  (SAVEVC),HL                     ;408b  22 f6 40      9882   9901 
    LD  HL,CRTCR2                       ;408e  21 0e 41      9883   9902 
CLISTM: LD  (LSCRVC),HL                 ;4091  22 04 41      9884   9903 
    LD  (LISTSN),DE                     ;4094  ed 53 ae 40   9885   9904 
    LD  (LISTEN),BC                     ;4098  ed 43 bc 40   9886   9905 
    LD  HL,TEXTST                       ;409c  21 4e 7c      9887   9906 
LISTLP: LD  E,(HL)                      ;409f  5e            9888   9907 
    INC HL                              ;40a0  23            9889   9908 
    LD  D,(HL)                          ;40a1  56            9890   9909 
    INC HL                              ;40a2  23            9891   9910 
    LD  A,D                             ;40a3  7a            9892   9911 
    OR  E                               ;40a4  b3            9893   9912 
    JR  Z,LISTE'                        ;40a5  28 1e         9894   9913 
    PUSH    DE                          ;40a7  d5            9895   9914 
    LD  E,(HL)                          ;40a8  5e            9896   9915 
    INC HL                              ;40a9  23            9897   9916 
    LD  D,(HL)                          ;40aa  56            9898   9917 
    INC HL                              ;40ab  23            9899   9918 
    PUSH    HL                          ;40ac  e5            9900   9919 
    DEFB    021H                        ;40ad  21            9901   9920 ; LD HL,?
LISTSN: DEFS    2                       ;40ae                9902   9921 
    OR  A                               ;40b0  b7            9903   9922 
    SBC HL,DE                           ;40b1  ed 52         9904   9923 
    JR  C,LISTRT                        ;40b3  38 06         9905   9924 
    JR  Z,LISTRT                        ;40b5  28 04         9906   9925 
    POP HL                              ;40b7  e1            9907   9926 
    POP HL                              ;40b8  e1            9908   9927 
LISTL': JR  LISTLP                      ;40b9  18 e4         9909   9928 
                                        ;                    9910   9929 ;
LISTRT: DEFB    021H                    ;40bb  21            9911   9930 ; LD HL,?
LISTEN: DEFS    2                       ;40bc                9912   9931 
    OR  A                               ;40be  b7            9913   9932 
    SBC HL,DE                           ;40bf  ed 52         9914   9933 
    JR  NC,LOKJMN                       ;40c1  30 04         9915   9934 
    POP HL                              ;40c3  e1            9916   9935 
    POP HL                              ;40c4  e1            9917   9936 
LISTE': JR  LISTED                      ;40c5  18 58         9918   9937 
                                        ;                    9919   9938 ;
LOKJMN: EX  DE,HL                       ;40c7  eb            9920   9939 
    LD  (EDLINE),HL                     ;40c8  22 2a 37      9921   9940 
    LD  DE,KEYBUF                       ;40cb  11 4f 7a      9922   9941 
    CALL    ASCHL                       ;40ce  cd a8 62      9923   9942 
    LD  HL,00005h                       ;40d1  21 05 00      9924   9943 
    ADD HL,DE                           ;40d4  19            9925   9944 
    LD  (HL),020h                       ;40d5  36 20         9926   9945 
    INC HL                              ;40d7  23            9927   9946 
    EX  DE,HL                           ;40d8  eb            9928   9947 
    POP HL                              ;40d9  e1            9929   9948 
    CALL    CVTXIM                      ;40da  cd 3a 65      9930   9949 
    LD  DE,KEYBUF                       ;40dd  11 4f 7a      9931   9950 
    PUSH    BC                          ;40e0  c5            9932   9951 
    LD  B,5                             ;40e1  06 05         9933   9952 
LZSKL:  LD  A,(DE)                      ;40e3  1a            9934   9953 
    CP  030h                            ;40e4  fe 30         9935   9954 
    INC DE                              ;40e6  13            9936   9955 
    JR  NZ,LTSKZR                       ;40e7  20 02         9937   9956 
    DJNZ    LZSKL                       ;40e9  10 f8         9938   9957 
LTSKZR: POP BC                          ;40eb  c1            9939   9958 
    DEC DE                              ;40ec  1b            9940   9959 
    LD  (SERDIS),DE                     ;40ed  ed 53 78 32   9941   9960 
LIST0L: LD  A,(DE)                      ;40f1  1a            9942   9961 
    OR  A                               ;40f2  b7            9943   9962 
    JR  Z,ESCLOT                        ;40f3  28 0e         9944   9963 
    DEFB    0C3H                        ;40f5  c3            9945   9964 ; JP ?
SAVEVC: DEFS    2                       ;40f6                9946   9965 
COUTCH: CALL    CTOUT                   ;40f8  cd 58 45      9947   9966 
    JR  CTIRTR                          ;40fb  18 03         9948   9967 
                                        ;                    9949   9968 ;
CRTVEC: CALL    ACCPRT                  ;40fd  cd 64 08      9950   9969 
CTIRTR: INC DE                          ;4100  13            9951   9970 
    JR  LIST0L                          ;4101  18 ee         9952   9971 
ESCLOT: DEFB    0C3H                    ;4103  c3            9953   9972 ; JP ?
LSCRVC: DEFS    2                       ;4104                9954   9973 
COUT0D: LD  A,00Dh                      ;4106  3e 0d         9955   9974 
    CALL    CTOUT                       ;4108  cd 58 45      9956   9975 
    POP HL                              ;410b  e1            9957   9976 
    JR  LSTCR'                          ;410c  18 04         9958   9977 
CRTCR2: CALL    CR2                     ;410e  cd 23 08      9959   9978 
                                        ;                    9960   9979 ;
LISCRC: POP HL                          ;4111  e1            9961   9980 
LSTCR': LD  A,080h                      ;4112  3e 80         9962   9981 ;SPACE STOP
    IN  A,(1)                           ;4114  db 01         9963   9982 
    AND 4                               ;4116  e6 04         9964   9983 
    JR  Z,LSTCR'                        ;4118  28 f8         9965   9984 
    CALL    BRKEY                       ;411a  cd 5b 0c      9966   9985 
    JR  NZ,LISTL'                       ;411d  20 9a         9967   9986 
                                        ;                    9968   9987 
LISTED: POP HL                          ;411f  e1            9969   9988 
    POP DE                              ;4120  d1            9970   9989 
    POP BC                              ;4121  c1            9971   9990 
    LD  A,1                             ;4122  3e 01         9972   9991 
    LD  (DISFLG),A                      ;4124  32 eb 11      9973   9992 
    RET                                 ;4127  c9            9974   9993 
                                        ;                    9975   9994 ;
ONELST: PUSH    HL                      ;4128  e5            9976   9995 
    LD  DE,KEYBUF                       ;4129  11 4f 7a      9977   9996 
    CALL    CVTXIM                      ;412c  cd 3a 65      9978   9997 
    LD  B,0                             ;412f  06 00         9979   9998 
ONLZLP: LD  A,(DE)                      ;4131  1a            9980   9999 
    OR  A                               ;4132  b7            9981  10000 
    JR  Z,ONLSRT                        ;4133  28 07         9982  10001 
    CALL    ACCPRT                      ;4135  cd 64 08      9983  10002 
    INC DE                              ;4138  13            9984  10003 
    INC B                               ;4139  04            9985  10004 
    JR  ONLZLP                          ;413a  18 f5         9986  10005 
ONLSRT: POP HL                          ;413c  e1            9987  10006 
    RET                                 ;413d  c9            9988  10007 
                                        ;                    9989  10008 ;
UNTIL:  POP DE                          ;413e  d1            9990  10009 
    POP BC                              ;413f  c1            9991  10010 
    PUSH    BC                          ;4140  c5            9992  10011 
    INC B                               ;4141  04            9993  10012 
UNWTRP: LD  A,24                        ;4142  3e 18         9994  10013 
    JP  NZ,ERROR                        ;4144  c2 96 21      9995  10014 
    LD  A,C                             ;4147  79            9996  10015 
    ADD A,6                             ;4148  c6 06         9997  10016 
    JR  NZ,UNWTRP                       ;414a  20 f6         9998  10017 
    PUSH    DE                          ;414c  d5            9999  10018 
    LD  C,L                             ;414d  4d           10000  10019 
    LD  B,H                             ;414e  44           10001  10020 
    CALL    FLEXPR                      ;414f  cd 99 22     10002  10021 
    LD  A,(HL)                          ;4152  7e           10003  10022 
    OR  A                               ;4153  b7           10004  10023 
    LD  L,C                             ;4154  69           10005  10024 
    LD  H,B                             ;4155  60           10006  10025 
    DEC HL                              ;4156  2b           10007  10026 
    JR  NZ,ESCUTL                       ;4157  20 17        10008  10027 
    LD  HL,4                            ;4159  21 04 00     10009  10028 
UNTILM: ADD HL,SP                       ;415c  39           10010  10029 
    LD  E,(HL)                          ;415d  5e           10011  10030 
    INC HL                              ;415e  23           10012  10031 
    LD  D,(HL)                          ;415f  56           10013  10032 
    INC HL                              ;4160  23           10014  10033 
    LD  (LNOBUF),DE                     ;4161  ed 53 cc 16  10015  10034 
    LD  E,(HL)                          ;4165  5e           10016  10035 
    INC HL                              ;4166  23           10017  10036 
    LD  D,(HL)                          ;4167  56           10018  10037 
    LD  (NXTLPT),DE                     ;4168  ed 53 12 16  10019  10038 
    INC HL                              ;416c  23           10020  10039 
    JP  INDRCT                          ;416d  c3 a3 2a     10021  10040 
                                        ;                   10022  10041 ;
ESCUTL: POP IX                          ;4170  dd e1        10023  10042 
    POP BC                              ;4172  c1           10024  10043 
    POP BC                              ;4173  c1           10025  10044 
    POP BC                              ;4174  c1           10026  10045 
    POP BC                              ;4175  c1           10027  10046 
    JP  (IX)                            ;4176  dd e9        10028  10047 
                                        ;                   10029  10048 ;
RETURN: POP IX                          ;4178  dd e1        10030  10049 
RTAGPO: POP BC                          ;417a  c1           10031  10050 
    INC BC                              ;417b  03           10032  10051 
    LD  A,B                             ;417c  78           10033  10052 
    OR  C                               ;417d  b1           10034  10053 
    JR  Z,RTWGOS                        ;417e  28 1d        10035  10054 
    INC BC                              ;4180  03           10036  10055 
    LD  A,B                             ;4181  78           10037  10056 
    OR  C                               ;4182  b1           10038  10057 
    JR  NZ,FPOPRT                       ;4183  20 1e        10039  10058 
    CALL    HLFTCH                      ;4185  cd 87 29     10040  10059 
    EX  DE,HL                           ;4188  eb           10041  10060 
    POP HL                              ;4189  e1           10042  10061 
    LD  (LNOBUF),HL                     ;418a  22 cc 16     10043  10062 
    POP HL                              ;418d  e1           10044  10063 
    LD  (NXTLPT),HL                     ;418e  22 12 16     10045  10064 
    POP HL                              ;4191  e1           10046  10065 
    PUSH    IX                          ;4192  dd e5        10047  10066 
    CP  03Ah                            ;4194  fe 3a        10048  10067 
    RET Z                               ;4196  c8           10049  10068 
    OR  A                               ;4197  b7           10050  10069 
    RET Z                               ;4198  c8           10051  10070 
    EX  DE,HL                           ;4199  eb           10052  10071 
    JP  GOTO                            ;419a  c3 b1 43     10053  10072 
                                        ;                   10054  10073 ;
RTWGOS: LD  A,3                         ;419d  3e 03        10055  10074 
    PUSH    BC                          ;419f  c5           10056  10075 
    JP  ERROR                           ;41a0  c3 96 21     10057  10076 
                                        ;                   10058  10077 ;
FPOPRT: DEC BC                          ;41a3  0b           10059  10078 
    DEC BC                              ;41a4  0b           10060  10079 
    XOR A                               ;41a5  af           10061  10080 
    CP  C                               ;41a6  b9           10062  10081 
    JR  NZ,RTWGOS                       ;41a7  20 f4        10063  10082 
    EX  DE,HL                           ;41a9  eb           10064  10083 
    LD  HL,22                           ;41aa  21 16 00     10065  10084 
    ADD HL,SP                           ;41ad  39           10066  10085 
    LD  SP,HL                           ;41ae  f9           10067  10086 
    EX  DE,HL                           ;41af  eb           10068  10087 
    JR  RTAGPO                          ;41b0  18 c8        10069  10088 
                                        ;                   10070  10089 ;
WHILE:  POP BC                          ;41b2  c1           10071  10090 
    PUSH    HL                          ;41b3  e5           10072  10091 
    EX  DE,HL                           ;41b4  eb           10073  10092 
    LD  HL,(NXTLPT)                     ;41b5  2a 12 16     10074  10093 
    LD  (WHNLPT),HL                     ;41b8  22 d1 41     10075  10094 
    PUSH    HL                          ;41bb  e5           10076  10095 
    LD  HL,(LNOBUF)                     ;41bc  2a cc 16     10077  10096 
    LD  (WHNLBF),HL                     ;41bf  22 d7 41     10078  10097 
    PUSH    HL                          ;41c2  e5           10079  10098 
    LD  HL,0FFF9h                       ;41c3  21 f9 ff     10080  10099 
    PUSH    HL                          ;41c6  e5           10081  10100 
    CALL    MEMCHK                      ;41c7  cd b0 1e     10082  10101 
    EX  DE,HL                           ;41ca  eb           10083  10102 
    DEC HL                              ;41cb  2b           10084  10103 
    CALL    SKIPWH                      ;41cc  cd 0b 42     10085  10104 
    EX  DE,HL                           ;41cf  eb           10086  10105 
    DEFB    021H                        ;41d0  21           10087  10106 ; LD HL,?
WHNLPT: DEFS    2                       ;41d1               10088  10107 
    LD  (NXTLPT),HL                     ;41d3  22 12 16     10089  10108 
    DEFB    021H                        ;41d6  21           10090  10109 ; LD HL,?
WHNLBF: DEFS    2                       ;41d7               10091  10110 
    LD  (LNOBUF),HL                     ;41d9  22 cc 16     10092  10111 
    EX  DE,HL                           ;41dc  eb           10093  10112 
    PUSH    BC                          ;41dd  c5           10094  10113 
    INC HL                              ;41de  23           10095  10114 
WEND:   POP DE                          ;41df  d1           10096  10115 
    POP BC                              ;41e0  c1           10097  10116 
    PUSH    BC                          ;41e1  c5           10098  10117 
    INC B                               ;41e2  04           10099  10118 
WENDER: LD  A,26                        ;41e3  3e 1a        10100  10119 
    JP  NZ,ERROR                        ;41e5  c2 96 21     10101  10120 
    LD  A,007h                          ;41e8  3e 07        10102  10121 
    ADD A,C                             ;41ea  81           10103  10122 
    JR  NZ,WENDER                       ;41eb  20 f6        10104  10123 
    PUSH    DE                          ;41ed  d5           10105  10124 
    PUSH    HL                          ;41ee  e5           10106  10125 
    LD  HL,10                           ;41ef  21 0a 00     10107  10126 
    ADD HL,SP                           ;41f2  39           10108  10127 
    CALL    INDRCT                      ;41f3  cd a3 2a     10109  10128 
    LD  C,L                             ;41f6  4d           10110  10129 
    LD  B,H                             ;41f7  44           10111  10130 
    CALL    FLEXPR                      ;41f8  cd 99 22     10112  10131 
    LD  A,(HL)                          ;41fb  7e           10113  10132 
    OR  A                               ;41fc  b7           10114  10133 
    POP HL                              ;41fd  e1           10115  10134 
    JP  Z,ESCUTL                        ;41fe  ca 70 41     10116  10135 
    PUSH    BC                          ;4201  c5           10117  10136 
    LD  HL,8                            ;4202  21 08 00     10118  10137 
    CALL    UNTILM                      ;4205  cd 5c 41     10119  10138 
    POP HL                              ;4208  e1           10120  10139 
    DEC HL                              ;4209  2b           10121  10140 
    RET                                 ;420a  c9           10122  10141 
                                        ;                   10123  10142 ;
SKIPWH: CALL    IFSKSB                  ;420b  cd 40 44     10124  10143 
    OR  A                               ;420e  b7           10125  10144 
    JR  Z,SKWHEL                        ;420f  28 0c        10126  10145 
    CP  09Eh                            ;4211  fe 9e        10127  10146 
    RET Z                               ;4213  c8           10128  10147 
    CP  09Dh                            ;4214  fe 9d        10129  10148 
    JR  NZ,SKIPWH                       ;4216  20 f3        10130  10149 
    CALL    SKIPWH                      ;4218  cd 0b 42     10131  10150 
    JR  SKIPWH                          ;421b  18 ee        10132  10151 
                                        ;                   10133  10152 ;
SKWHEL: INC HL                          ;421d  23           10134  10153 
    LD  E,(HL)                          ;421e  5e           10135  10154 
    INC HL                              ;421f  23           10136  10155 
    LD  D,(HL)                          ;4220  56           10137  10156 
    INC HL                              ;4221  23           10138  10157 
    LD  A,D                             ;4222  7a           10139  10158 
    OR  E                               ;4223  b3           10140  10159 
    LD  A,25                            ;4224  3e 19        10141  10160 
    JP  Z,ERROR                         ;4226  ca 96 21     10142  10161 
    LD  (WHNLPT),DE                     ;4229  ed 53 d1 41  10143  10162 
    LD  E,(HL)                          ;422d  5e           10144  10163 
    INC HL                              ;422e  23           10145  10164 
    LD  D,(HL)                          ;422f  56           10146  10165 
    LD  (WHNLBF),DE                     ;4230  ed 53 d7 41  10147  10166 
    JR  SKIPWH                          ;4234  18 d5        10148  10167 
                                        ;                   10149  10168 ;
REPTON: LD  DE,200                      ;4236  11 c8 00     10150  10169 
    JR  REPTST                          ;4239  18 03        10151  10170 
                                        ;                   10152  10171 ;
REPOFF: LD  DE,0FFFFh                   ;423b  11 ff ff     10153  10172 
REPTST: LD  (REPTSW),DE                 ;423e  ed 53 c9 0c  10154  10173 
    INC HL                              ;4242  23           10155  10174 
    RET                                 ;4243  c9           10156  10175 
                                        ;                   10157  10176 ;
REPEAT: CALL    HLFTCH                  ;4244  cd 87 29     10158  10177 
    CP  098h                            ;4247  fe 98        10159  10178 
    JR  Z,REPTON                        ;4249  28 eb        10160  10179 
    CP  09Ch                            ;424b  fe 9c        10161  10180 
    JR  Z,REPOFF                        ;424d  28 ec        10162  10181 
    POP BC                              ;424f  c1           10163  10182 
    PUSH    HL                          ;4250  e5           10164  10183 
    EX  DE,HL                           ;4251  eb           10165  10184 
    LD  HL,(NXTLPT)                     ;4252  2a 12 16     10166  10185 
    PUSH    HL                          ;4255  e5           10167  10186 
    LD  HL,(LNOBUF)                     ;4256  2a cc 16     10168  10187 
    PUSH    HL                          ;4259  e5           10169  10188 
    LD  HL,0FFFAh                       ;425a  21 fa ff     10170  10189 ; REPEAT MARK
    PUSH    HL                          ;425d  e5           10171  10190 
    EX  DE,HL                           ;425e  eb           10172  10191 
    PUSH    BC                          ;425f  c5           10173  10192 
    JP  MEMCHK                          ;4260  c3 b0 1e     10174  10193 
                                        ;                   10175  10194 ;
GOSUB:  POP BC                          ;4263  c1           10176  10195 
    CALL    HLFTCH                      ;4264  cd 87 29     10177  10196 
    CP  00Bh                            ;4267  fe 0b        10178  10197 
    JR  Z,GOSNDQ                        ;4269  28 15        10179  10198 
    CP  00Ch                            ;426b  fe 0c        10180  10199 
    JR  Z,GOSNDQ                        ;426d  28 11        10181  10200 
    PUSH    HL                          ;426f  e5           10182  10201 
    PUSH    BC                          ;4270  c5           10183  10202 
    CALL    STREXZ                      ;4271  cd 9b 45     10184  10203 
    DEC BC                              ;4274  0b           10185  10204 
    LD  L,C                             ;4275  69           10186  10205 
    LD  H,B                             ;4276  60           10187  10206 
    POP BC                              ;4277  c1           10188  10207 
    EX  (SP),HL                         ;4278  e3           10189  10208 
    INC HL                              ;4279  23           10190  10209 
    INC HL                              ;427a  23           10191  10210 
    INC HL                              ;427b  23           10192  10211 
    LD  A,022h                          ;427c  3e 22        10193  10212 
    JR  GOSMID                          ;427e  18 04        10194  10213 
GOSNDQ: INC HL                          ;4280  23           10195  10214 
    INC HL                              ;4281  23           10196  10215 
    INC HL                              ;4282  23           10197  10216 
    PUSH    HL                          ;4283  e5           10198  10217 
GOSMID: EX  DE,HL                       ;4284  eb           10199  10218 
    LD  HL,(NXTLPT)                     ;4285  2a 12 16     10200  10219 
    PUSH    HL                          ;4288  e5           10201  10220 
    LD  HL,(LNOBUF)                     ;4289  2a cc 16     10202  10221 
    PUSH    HL                          ;428c  e5           10203  10222 
    LD  HL,0FFFEh                       ;428d  21 fe ff     10204  10223 
    PUSH    HL                          ;4290  e5           10205  10224 
    EX  DE,HL                           ;4291  eb           10206  10225 
    PUSH    BC                          ;4292  c5           10207  10226 
    CALL    MEMCHK                      ;4293  cd b0 1e     10208  10227 
    DEC HL                              ;4296  2b           10209  10228 
    DEC HL                              ;4297  2b           10210  10229 
    JP  MIDLAG                          ;4298  c3 b5 43     10211  10230 
                                        ;                   10212  10231 ;
OGSJMP: PUSH    HL                      ;429b  e5           10213  10232 
    CALL    DATA                        ;429c  cd c8 1c     10214  10233 
    POP DE                              ;429f  d1           10215  10234 
    POP BC                              ;42a0  c1           10216  10235 
    PUSH    HL                          ;42a1  e5           10217  10236 
    EX  DE,HL                           ;42a2  eb           10218  10237 
    CALL    HLFTCH                      ;42a3  cd 87 29     10219  10238 
    INC HL                              ;42a6  23           10220  10239 
    INC HL                              ;42a7  23           10221  10240 
    INC HL                              ;42a8  23           10222  10241 
    JR  GOSMID                          ;42a9  18 d9        10223  10242 
                                        ;                   10224  10243 ;
LBLGOT: DEC HL                          ;42ab  2b           10225  10244 
    CALL    LBLSER                      ;42ac  cd be 42     10226  10245 
    PUSH    HL                          ;42af  e5           10227  10246 
    LD  HL,(LBLNXT)                     ;42b0  2a d3 42     10228  10247 
    LD  (NXTLPT),HL                     ;42b3  22 12 16     10229  10248 
    DEFB    021H                        ;42b6  21           10230  10249 ; LD HL,?
LBLLNO: DEFS    2                       ;42b7               10231  10250 
    LD  (LNOBUF),HL                     ;42b9  22 cc 16     10232  10251 
    POP HL                              ;42bc  e1           10233  10252 
    RET                                 ;42bd  c9           10234  10253 
                                        ;                   10235  10254 ;
LBLSER: CALL    STREXZ                  ;42be  cd 9b 45     10236  10255 
    OR  A                               ;42c1  b7           10237  10256 
    JP  Z,UDFLNO                        ;42c2  ca dc 43     10238  10257 
    LD  (LBLLEN),A                      ;42c5  32 fd 42     10239  10258 
    LD  (LBLDEB),DE                     ;42c8  ed 53 0c 43  10240  10259 
    LD  HL,TEXTST                       ;42cc  21 4e 7c     10241  10260 
    LD  (LBLNXT),HL                     ;42cf  22 d3 42     10242  10261 
LBLSLP: DEFB    021H                    ;42d2  21           10243  10262 ; LD HL,?
LBLNXT: DEFS    2                       ;42d3               10244  10263 
    LD  (CURLPT),HL                     ;42d5  22 53 43     10245  10264 
    LD  E,(HL)                          ;42d8  5e           10246  10265 
    INC HL                              ;42d9  23           10247  10266 
    LD  D,(HL)                          ;42da  56           10248  10267 
    INC HL                              ;42db  23           10249  10268 
    LD  A,D                             ;42dc  7a           10250  10269 
    OR  E                               ;42dd  b3           10251  10270 
    JP  Z,UDFLNO                        ;42de  ca dc 43     10252  10271 
    LD  (LBLNXT),DE                     ;42e1  ed 53 d3 42  10253  10272 
    LD  E,(HL)                          ;42e5  5e           10254  10273 
    INC HL                              ;42e6  23           10255  10274 
    LD  D,(HL)                          ;42e7  56           10256  10275 
    LD  (LBLLNO),DE                     ;42e8  ed 53 b7 42  10257  10276 
NOTLBL: CALL    IFSKSB                  ;42ec  cd 40 44     10258  10277 ; SKIP SMBL
    OR  A                               ;42ef  b7           10259  10278 
    JR  Z,LBLSLP                        ;42f0  28 e0        10260  10279 
    CP  0C2h                            ;42f2  fe c2        10261  10280 
    JR  NZ,NOTLBL                       ;42f4  20 f6        10262  10281 
    INC HL                              ;42f6  23           10263  10282 
    CALL    STREXZ                      ;42f7  cd 9b 45     10264  10283 
    DEC BC                              ;42fa  0b           10265  10284 
    PUSH    BC                          ;42fb  c5           10266  10285 
    DEFB    0FEH                        ;42fc  fe           10267  10286 ; CP ?
LBLLEN: DEFS    1                       ;42fd               10268  10287 
    JR  NZ,LBLNMT                       ;42fe  20 19        10269  10288 
    LD  C,A                             ;4300  4f           10270  10289 
    LD  B,000h                          ;4301  06 00        10271  10290 
    EX  DE,HL                           ;4303  eb           10272  10291 
    LD  DE,KEYBUF                       ;4304  11 4f 7a     10273  10292 
    PUSH    DE                          ;4307  d5           10274  10293 
    LDIR                                ;4308  ed b0        10275  10294 
    LD  B,A                             ;430a  47           10276  10295 
    DEFB    011H                        ;430b  11           10277  10296 ; LD DE,?
LBLDEB: DEFS    2                       ;430c               10278  10297 
    POP HL                              ;430e  e1           10279  10298 
LBLMTL: LD  A,(DE)                      ;430f  1a           10280  10299 
    CP  (HL)                            ;4310  be           10281  10300 
    JR  NZ,LBLNMT                       ;4311  20 06        10282  10301 
    INC HL                              ;4313  23           10283  10302 
    INC DE                              ;4314  13           10284  10303 
    DJNZ    LBLMTL                      ;4315  10 f8        10285  10304 
    POP HL                              ;4317  e1           10286  10305 
    RET                                 ;4318  c9           10287  10306 
                                        ;                   10288  10307 ;
LBLNMT: POP HL                          ;4319  e1           10289  10308 
    DEC HL                              ;431a  2b           10290  10309 
    JR  NOTLBL                          ;431b  18 cf        10291  10310 
                                        ;                   10292  10311 ;
ONERRG: INC HL                          ;431d  23           10293  10312 
    CALL    HLFTCH                      ;431e  cd 87 29     10294  10313 
    CP  081h                            ;4321  fe 81        10295  10314 
    JP  NZ,SERROR                       ;4323  c2 3a 17     10296  10315 
    INC HL                              ;4326  23           10297  10316 
    CALL    HLFTCH                      ;4327  cd 87 29     10298  10317 
    CP  00Bh                            ;432a  fe 0b        10299  10318 
    JR  NZ,ONERDQ                       ;432c  20 1b        10300  10319 
    INC HL                              ;432e  23           10301  10320 
    PUSH    HL                          ;432f  e5           10302  10321 
    CALL    INDRCT                      ;4330  cd a3 2a     10303  10322 
    LD  A,L                             ;4333  7d           10304  10323 
    OR  H                               ;4334  b4           10305  10324 
    JR  Z,OEROFF                        ;4335  28 2f        10306  10325 
    CALL    LNOSER                      ;4337  cd 8e 3f     10307  10326 
    JP  C,UDFLNO                        ;433a  da dc 43     10308  10327 
    LD  (ERRORV),HL                     ;433d  22 83 21     10309  10328 
    LD  A,1                             ;4340  3e 01        10310  10329 
OEROF': LD  (ERRORF),A                  ;4342  32 50 22     10311  10330 
    POP HL                              ;4345  e1           10312  10331 
    INC HL                              ;4346  23           10313  10332 
    INC HL                              ;4347  23           10314  10333 
    RET                                 ;4348  c9           10315  10334 
                                        ;                   10316  10335 ;
ONERDQ: CP  022h                        ;4349  fe 22        10317  10336 
    JP  NZ,UDFLNO                       ;434b  c2 dc 43     10318  10337 
    PUSH    HL                          ;434e  e5           10319  10338 
    CALL    LBLSER                      ;434f  cd be 42     10320  10339 
    DEFB    021H                        ;4352  21           10321  10340 ; LD HL,?
CURLPT: DEFS    2                       ;4353               10322  10341 
    LD  (ERRORV),HL                     ;4355  22 83 21     10323  10342 
    POP HL                              ;4358  e1           10324  10343 
    CALL    IFDQSK                      ;4359  cd 64 44     10325  10344 
    OR  A                               ;435c  b7           10326  10345 
    JR  Z,DQOENB                        ;435d  28 01        10327  10346 
    INC HL                              ;435f  23           10328  10347 
DQOENB: LD  A,1                         ;4360  3e 01        10329  10348 
    LD  (ERRORF),A                      ;4362  32 50 22     10330  10349 
    RET                                 ;4365  c9           10331  10350 
                                        ;                   10332  10351 ;
OEROFF: LD  A,(ERRORF)                  ;4366  3a 50 22     10333  10352 
    CP  002h                            ;4369  fe 02        10334  10353 
    LD  A,0                             ;436b  3e 00        10335  10354 
    JR  NZ,OEROF'                       ;436d  20 d3        10336  10355 
    JP  RESERR                          ;436f  c3 8d 22     10337  10356 
                                        ;                   10338  10357 ;
ON: LD  C,L                             ;4372  4d           10339  10358 
    LD  B,H                             ;4373  44           10340  10359 
    CALL    HLFTCH                      ;4374  cd 87 29     10341  10360 
    CP  0B5h                            ;4377  fe b5        10342  10361 
    JR  Z,ONERRG                        ;4379  28 a2        10343  10362 
    CALL    FLEXPR                      ;437b  cd 99 22     10344  10363 
    LD  DE,OGSJMP                       ;437e  11 9b 42     10345  10364 
    CP  082h                            ;4381  fe 82        10346  10365 
    JR  Z,OGOSUB                        ;4383  28 08        10347  10366 
    LD  DE,GOTO                         ;4385  11 b1 43     10348  10367 
    CP  081h                            ;4388  fe 81        10349  10368 
    JP  NZ,SERROR                       ;438a  c2 3a 17     10350  10369 
OGOSUB: PUSH    DE                      ;438d  d5           10351  10370 
    CALL    HLFLT                       ;438e  cd 67 61     10352  10371 
    JR  C,ODATA                         ;4391  38 18        10353  10372 
    LD  A,H                             ;4393  7c           10354  10373 
    OR  A                               ;4394  b7           10355  10374 
    JR  NZ,ODATA                        ;4395  20 14        10356  10375 
    LD  A,L                             ;4397  7d           10357  10376 
    OR  A                               ;4398  b7           10358  10377 
    JR  Z,ODATA                         ;4399  28 10        10359  10378 
    LD  L,C                             ;439b  69           10360  10379 
    LD  H,B                             ;439c  60           10361  10380 
    LD  B,A                             ;439d  47           10362  10381 
ONLNOS: DEC B                           ;439e  05           10363  10382 
    RET Z                               ;439f  c8           10364  10383 
    CALL    LNRGCK                      ;43a0  cd eb 43     10365  10384 
    CP  02Ch                            ;43a3  fe 2c        10366  10385 
    INC HL                              ;43a5  23           10367  10386 
    JR  Z,ONLNOS                        ;43a6  28 f6        10368  10387 
    DEC HL                              ;43a8  2b           10369  10388 
    POP DE                              ;43a9  d1           10370  10389 
    RET                                 ;43aa  c9           10371  10390 
                                        ;                   10372  10391 ;
ODATA:  POP DE                          ;43ab  d1           10373  10392 
    LD  L,C                             ;43ac  69           10374  10393 
    LD  H,B                             ;43ad  60           10375  10394 
    JP  DATA                            ;43ae  c3 c8 1c     10376  10395 
                                        ;                   10377  10396 ;
GOTO:   CALL    HLFTCH                  ;43b1  cd 87 29     10378  10397 
IFGOTO: INC HL                          ;43b4  23           10379  10398 
MIDLAG: CP  00Ch                        ;43b5  fe 0c        10380  10399 
    JR  NZ,SERGOT                       ;43b7  20 0a        10381  10400 
    CALL    INDRCT                      ;43b9  cd a3 2a     10382  10401 
LNSGOT: LD  (NXTLPT),HL                 ;43bc  22 12 16     10383  10402 ;"
                                        ;                   10384  10403 ;XOR A
                                        ;                   10385  10404 ;LD (CON
    POP BC                              ;43bf  c1           10386  10405 
    JP  NXLINE                          ;43c0  c3 11 16     10387  10406 
                                        ;                   10388  10407 ;
SERGOT: CP  00Bh                        ;43c3  fe 0b        10389  10408 
    JP  NZ,LBLGOT                       ;43c5  c2 ab 42     10390  10409 
    LD  E,(HL)                          ;43c8  5e           10391  10410 
    INC HL                              ;43c9  23           10392  10411 
    LD  D,(HL)                          ;43ca  56           10393  10412 
    EX  DE,HL                           ;43cb  eb           10394  10413 
    CALL    LNOSER                      ;43cc  cd 8e 3f     10395  10414 
    JR  C,UDFLNO                        ;43cf  38 0b        10396  10415 
    EX  DE,HL                           ;43d1  eb           10397  10416 
    LD  (HL),D                          ;43d2  72           10398  10417 
    DEC HL                              ;43d3  2b           10399  10418 
    LD  (HL),E                          ;43d4  73           10400  10419 
    DEC HL                              ;43d5  2b           10401  10420 
    LD  (HL),00Ch                       ;43d6  36 0c        10402  10421 
    EX  DE,HL                           ;43d8  eb           10403  10422 
    JP  LNSGOT                          ;43d9  c3 bc 43     10404  10423 
                                        ;                   10405  10424 ;
UDFLNO: LD  A,8                         ;43dc  3e 08        10406  10425 
    JP  ERROR                           ;43de  c3 96 21     10407  10426 
                                        ;                   10408  10427 ;
ONGDQT: CALL    IFDQSK                  ;43e1  cd 64 44     10409  10428 
    OR  A                               ;43e4  b7           10410  10429 
    JR  Z,HLFVEC                        ;43e5  28 14        10411  10430 
    INC HL                              ;43e7  23           10412  10431 
    JP  HLFTCH                          ;43e8  c3 87 29     10413  10432 
                                        ;                   10414  10433 ;
LNRGCK: CALL    HLFTCH                  ;43eb  cd 87 29     10415  10434 
    CP  022h                            ;43ee  fe 22        10416  10435 
    JR  Z,ONGDQT                        ;43f0  28 ef        10417  10436 
    INC HL                              ;43f2  23           10418  10437 
    INC HL                              ;43f3  23           10419  10438 
    INC HL                              ;43f4  23           10420  10439 
    CP  00Bh                            ;43f5  fe 0b        10421  10440 
    JR  Z,HLFVEC                        ;43f7  28 02        10422  10441 
    CP  00Ch                            ;43f9  fe 0c        10423  10442 
HLFVEC: JP  Z,HLFTCH                    ;43fb  ca 87 29     10424  10443 
    JP  SERROR                          ;43fe  c3 3a 17     10425  10444 
                                        ;                   10426  10445 ;
IF: LD  C,L                             ;4401  4d           10427  10446 
    LD  B,H                             ;4402  44           10428  10447 
    CALL    FLEXPR                      ;4403  cd 99 22     10429  10448 
    EX  AF,AF'                          ;4406  08           10430  10449 
    LD  A,(HL)                          ;4407  7e           10431  10450 
    OR  A                               ;4408  b7           10432  10451 
    LD  L,C                             ;4409  69           10433  10452 
    LD  H,B                             ;440a  60           10434  10453 
    DEC HL                              ;440b  2b           10435  10454 
    JR  Z,IFALSE                        ;440c  28 15        10436  10455 
    EX  AF,AF'                          ;440e  08           10437  10456 
    CP  0E1h                            ;440f  fe e1        10438  10457 
    RET NZ                              ;4411  c0           10439  10458 
ELSEMD: INC HL                          ;4412  23           10440  10459 
    CALL    HLFTCH                      ;4413  cd 87 29     10441  10460 
    CP  00Bh                            ;4416  fe 0b        10442  10461 
    JR  Z,IFGOTO                        ;4418  28 9a        10443  10462 
    CP  00Ch                            ;441a  fe 0c        10444  10463 
    JR  Z,IFGOTO                        ;441c  28 96        10445  10464 
    CP  022h                            ;441e  fe 22        10446  10465 
    JR  Z,IFGOTO                        ;4420  28 92        10447  10466 
    RET                                 ;4422  c9           10448  10467 
                                        ;                   10449  10468 ;
IFALSE: DEC HL                          ;4423  2b           10450  10469 
    CALL    IFSKIP                      ;4424  cd 2d 44     10451  10470 
    JR  NC,ELSEMD                       ;4427  30 e9        10452  10471 
    POP HL                              ;4429  e1           10453  10472 
    JP  NXLINE                          ;442a  c3 11 16     10454  10473 
                                        ;                   10455  10474 ;
IFSKIP: CALL    IFSKSB                  ;442d  cd 40 44     10456  10475 
    OR  A                               ;4430  b7           10457  10476 
    SCF                                 ;4431  37           10458  10477 
    RET Z                               ;4432  c8           10459  10478 
    CP  0B8h                            ;4433  fe b8        10460  10479 
    RET Z                               ;4435  c8           10461  10480 
    CP  08Eh                            ;4436  fe 8e        10462  10481 
    JR  NZ,IFSKIP                       ;4438  20 f3        10463  10482 
IFSKMD: CALL    IFSKIP                  ;443a  cd 2d 44     10464  10483 
    RET C                               ;443d  d8           10465  10484 
    JR  IFSKIP                          ;443e  18 ed        10466  10485 
                                        ;                   10467  10486 ;
IFSKSB: INC HL                          ;4440  23           10468  10487 
    LD  A,(HL)                          ;4441  7e           10469  10488 
    OR  A                               ;4442  b7           10470  10489 
    RET Z                               ;4443  c8           10471  10490 
    CP  0FFh                            ;4444  fe ff        10472  10491 
    JR  Z,FUNCRQ                        ;4446  28 0f        10473  10492 
    CP  022h                            ;4448  fe 22        10474  10493 
    JR  Z,IFDQSK                        ;444a  28 18        10475  10494 
    CP  020h                            ;444c  fe 20        10476  10495 
    RET NC                              ;444e  d0           10477  10496 
    CP  00Bh                            ;444f  fe 0b        10478  10497 
    RET C                               ;4451  d8           10479  10498 
    CP  014h                            ;4452  fe 14        10480  10499 
    JR  NC,ISKFLT                       ;4454  30 03        10481  10500 
    INC HL                              ;4456  23           10482  10501 
FUNCRQ: INC HL                          ;4457  23           10483  10502 
    RET                                 ;4458  c9           10484  10503 
                                        ;                   10485  10504 ;
ISKFLT: AND 00Fh                        ;4459  e6 0f        10486  10505 
    ADD A,L                             ;445b  85           10487  10506 
    LD  L,A                             ;445c  6f           10488  10507 
    LD  A,0                             ;445d  3e 00        10489  10508 
    ADC A,H                             ;445f  8c           10490  10509 
    LD  H,A                             ;4460  67           10491  10510 
    LD  A,020h                          ;4461  3e 20        10492  10511 
    RET                                 ;4463  c9           10493  10512 
                                        ;                   10494  10513 ;
IFDQSK: INC HL                          ;4464  23           10495  10514 
    LD  A,(HL)                          ;4465  7e           10496  10515 
    OR  A                               ;4466  b7           10497  10516 
    RET Z                               ;4467  c8           10498  10517 
    CP  022h                            ;4468  fe 22        10499  10518 
    RET Z                               ;446a  c8           10500  10519 
    JR  IFDQSK                          ;446b  18 f7        10501  10520 
                                        ;                   10502  10521 ;
VPUSH:  LD  C,L                         ;446d  4d           10503  10522 
    LD  B,H                             ;446e  44           10504  10523 
    CALL    ILDRCH                      ;446f  cd 90 3b     10505  10524 
    POP HL                              ;4472  e1           10506  10525 
    LD  (PUSHJV),HL                     ;4473  22 b2 44     10507  10526 
PUSHAG: LD  HL,(INTFAC)                 ;4476  2a 4b 7a     10508  10527 
    LD  IY,(INTSSP)                     ;4479  fd 2a 43 7a  10509  10528 
    LD  (IY+0),0                        ;447d  fd 36 00 00  10510  10529 
    CALL    EXPRSN                      ;4481  cd f2 22     10511  10530 
    EX  AF,AF'                          ;4484  08           10512  10531 
    LD  A,(IY+0)                        ;4485  fd 7e 00     10513  10532 
    CP  003h                            ;4488  fe 03        10514  10533 
    JP  Z,TYPEMS                        ;448a  ca 32 17     10515  10534 
    EX  DE,HL                           ;448d  eb           10516  10535 
    LD  HL,0FFF8h                       ;448e  21 f8 ff     10517  10536 
    ADD HL,SP                           ;4491  39           10518  10537 
    LD  SP,HL                           ;4492  f9           10519  10538 
    PUSH    BC                          ;4493  c5           10520  10539 
    CALL    CLRFAC                      ;4494  cd a9 28     10521  10540 
    LD  B,A                             ;4497  47           10522  10541 
    LD  C,A                             ;4498  4f           10523  10542 
PUTSTRL:LD  A,(DE)                      ;4499  1a           10524  10543 
    LD  (HL),A                          ;449a  77           10525  10544 
    INC HL                              ;449b  23           10526  10545 
    INC DE                              ;449c  13           10527  10546 
    DJNZ    PUTSTRL                     ;449d  10 fa        10528  10547 
    LD  D,C                             ;449f  51           10529  10548 
    POP BC                              ;44a0  c1           10530  10549 
    LD  E,0FDh                          ;44a1  1e fd        10531  10550 
    PUSH    DE                          ;44a3  d5           10532  10551 
    EX  AF,AF'                          ;44a4  08           10533  10552 
    PUSH    AF                          ;44a5  f5           10534  10553 
    CALL    MEMCHK                      ;44a6  cd b0 1e     10535  10554 
    POP AF                              ;44a9  f1           10536  10555 
PUSHL1: CP  02Ch                        ;44aa  fe 2c        10537  10556 
    JR  Z,PUSHAG                        ;44ac  28 c8        10538  10557 
    LD  L,C                             ;44ae  69           10539  10558 
    LD  H,B                             ;44af  60           10540  10559 
RETVCP: DEC HL                          ;44b0  2b           10541  10560 
    DEFB    0C3H                        ;44b1  c3           10542  10561 ; JP ?
PUSHJV: DEFS    2                       ;44b2               10543  10562 
                                        ;                   10544  10563 ;
VPOP:   LD  C,L                         ;44b4  4d           10545  10564 
    LD  B,H                             ;44b5  44           10546  10565 
    CALL    ILDRCH                      ;44b6  cd 90 3b     10547  10566 
    POP HL                              ;44b9  e1           10548  10567 
    LD  (PUSHJV),HL                     ;44ba  22 b2 44     10549  10568 
POPLOP: CALL    GETVAC                  ;44bd  cd d3 1e     10550  10569 
    POP DE                              ;44c0  d1           10551  10570 
    CP  002h                            ;44c1  fe 02        10552  10571 
    JR  Z,INTPOP                        ;44c3  28 32        10553  10572 
    CP  003h                            ;44c5  fe 03        10554  10573 
    JP  Z,TYPEMS                        ;44c7  ca 32 17     10555  10574 
    CP  D                               ;44ca  ba           10556  10575 
    JR  NZ,STKEMP                       ;44cb  20 25        10557  10576 
    LD  A,E                             ;44cd  7b           10558  10577 
    CP  0FDh                            ;44ce  fe fd        10559  10578 
    JR  NZ,STKEMP                       ;44d0  20 20        10560  10579 
    LD  A,D                             ;44d2  7a           10561  10580 
    EX  DE,HL                           ;44d3  eb           10562  10581 
    LD  HL,00000h                       ;44d4  21 00 00     10563  10582 
    ADD HL,SP                           ;44d7  39           10564  10583 
    PUSH    BC                          ;44d8  c5           10565  10584 
    LD  B,A                             ;44d9  47           10566  10585 
POPTRL: LD  A,(HL)                      ;44da  7e           10567  10586 
    LD  (DE),A                          ;44db  12           10568  10587 
    INC HL                              ;44dc  23           10569  10588 
    INC DE                              ;44dd  13           10570  10589 
    DJNZ    POPTRL                      ;44de  10 fa        10571  10590 
    POP BC                              ;44e0  c1           10572  10591 
INTPOR: LD  HL,8                        ;44e1  21 08 00     10573  10592 
    ADD HL,SP                           ;44e4  39           10574  10593 
    LD  SP,HL                           ;44e5  f9           10575  10594 
HEXCUL1: CALL   BCFTCH                  ;44e6  cd c4 25     10576  10595 
    CP  02Ch                            ;44e9  fe 2c        10577  10596 
    JR  Z,POPLOP                        ;44eb  28 d0        10578  10597 
    LD  L,C                             ;44ed  69           10579  10598 
    LD  H,B                             ;44ee  60           10580  10599 
    JP  RETVCP                          ;44ef  c3 b0 44     10581  10600 
                                        ;                   10582  10601 ;
STKEMP: LD  A,30                        ;44f2  3e 1e        10583  10602 
    JP  ERROR                           ;44f4  c3 96 21     10584  10603 
                                        ;                   10585  10604 ;
INTPOP: LD  A,D                         ;44f7  7a           10586  10605 
    CP  003h                            ;44f8  fe 03        10587  10606 
    JR  Z,STKEMP                        ;44fa  28 f6        10588  10607 
    LD  A,E                             ;44fc  7b           10589  10608 
    CP  0FDh                            ;44fd  fe fd        10590  10609 
    JR  NZ,STKEMP                       ;44ff  20 f1        10591  10610 
    LD  A,D                             ;4501  7a           10592  10611 
    EX  DE,HL                           ;4502  eb           10593  10612 
    LD  HL,00000h                       ;4503  21 00 00     10594  10613 
    ADD HL,SP                           ;4506  39           10595  10614 
    CALL    HLFLTO                      ;4507  cd 97 2d     10596  10615 
    EX  DE,HL                           ;450a  eb           10597  10616 
    LD  (HL),E                          ;450b  73           10598  10617 
    INC HL                              ;450c  23           10599  10618 
    LD  (HL),D                          ;450d  72           10600  10619 
    DEC HL                              ;450e  2b           10601  10620 
    JR  INTPOR                          ;450f  18 d0        10602  10621 
                                        ;                   10603  10622 ;
BUFCLR: PUSH    HL                      ;4511  e5           10604  10623 
    LD  HL,0                            ;4512  21 00 00     10605  10624 
    LD  (LNG),HL                        ;4515  22 27 45     10606  10625 
    LD  HL,CTBUF                        ;4518  21 b1 45     10607  10626 
    LD  (ADRES),HL                      ;451b  22 24 45     10608  10627 
    XOR A                               ;451e  af           10609  10628 
    JR  CTRET'                          ;451f  18 31        10610  10629 
                                        ;                   10611  10630 ;
CTINP:  PUSH    HL                      ;4521  e5           10612  10631 
    PUSH    BC                          ;4522  c5           10613  10632 
    DEFB    021H                        ;4523  21           10614  10633 ; LD HL,?
ADRES:  DEFW    CTBUF                   ;4524  b1 45        10615  10634 
    DEFB    001H                        ;4526  01           10616  10635 ; LD BC,?
LNG:    DEFS    2                       ;4527               10617  10636 
    LD  A,B                             ;4529  78           10618  10637 
    OR  C                               ;452a  b1           10619  10638 
    JR  NZ,CTINP1                       ;452b  20 1a        10620  10639 
    LD  HL,CTBUF                        ;452d  21 b1 45     10621  10640 
    LD  (ADRES),HL                      ;4530  22 24 45     10622  10641 
    LD  (MTADRS),HL                     ;4533  22 aa 13     10623  10642 
    LD  BC,00100H                       ;4536  01 00 01     10624  10643 
    LD  (LNG),BC                        ;4539  ed 43 27 45  10625  10644 
    LD  (MTBYTE),BC                     ;453d  ed 43 a8 13  10626  10645 
    CALL    MLOAD                       ;4541  cd 34 01     10627  10646 
    JP  C,CTERR                         ;4544  da 54 45     10628  10647 
CTINP1: LD  A,(HL)                      ;4547  7e           10629  10648 
    INC HL                              ;4548  23           10630  10649 
    DEC BC                              ;4549  0b           10631  10650 
    LD  (ADRES),HL                      ;454a  22 24 45     10632  10651 
    LD  (LNG),BC                        ;454d  ed 43 27 45  10633  10652 
CTRETN: POP BC                          ;4551  c1           10634  10653 
CTRET': POP HL                          ;4552  e1           10635  10654 
    RET                                 ;4553  c9           10636  10655 
                                        ;                   10637  10656 ;
CTERR:  POP HL                          ;4554  e1           10638  10657 
    POP BC                              ;4555  c1           10639  10658 
    SCF                                 ;4556  37           10640  10659 
    RET                                 ;4557  c9           10641  10660 
                                        ;                   10642  10661 ;
CTOUT:  PUSH    BC                      ;4558  c5           10643  10662 
    PUSH    HL                          ;4559  e5           10644  10663 
    LD  HL,(ADRES)                      ;455a  2a 24 45     10645  10664 
    LD  BC,(LNG)                        ;455d  ed 4b 27 45  10646  10665 
    LD  (HL),A                          ;4561  77           10647  10666 
    INC HL                              ;4562  23           10648  10667 
    INC BC                              ;4563  03           10649  10668 
    LD  (ADRES),HL                      ;4564  22 24 45     10650  10669 
    LD  A,B                             ;4567  78           10651  10670 
    CP  1                               ;4568  fe 01        10652  10671 
    JR  NZ,CTOUT1                       ;456a  20 10        10653  10672 
    LD  HL,CTBUF                        ;456c  21 b1 45     10654  10673 
    LD  (MTADRS),HL                     ;456f  22 aa 13     10655  10674 
    LD  (MTBYTE),BC                     ;4572  ed 43 a8 13  10656  10675 
    CALL    MSAVE                       ;4576  cd b6 00     10657  10676 
    LD  BC,0                            ;4579  01 00 00     10658  10677 
CTOUT1: LD  (LNG),BC                    ;457c  ed 43 27 45  10659  10678 
    LD  (ADRES),HL                      ;4580  22 24 45     10660  10679 
    OR  A                               ;4583  b7           10661  10680 
    JR  CTRETN                          ;4584  18 cb        10662  10681 
                                        ;                   10663  10682 ;
CTCLOS: PUSH    BC                      ;4586  c5           10664  10683 
    PUSH    HL                          ;4587  e5           10665  10684 
    LD  HL,CTBUF                        ;4588  21 b1 45     10666  10685 
    LD  (MTADRS),HL                     ;458b  22 aa 13     10667  10686 
    LD  HL,00100H                       ;458e  21 00 01     10668  10687 
    LD  (MTBYTE),HL                     ;4591  22 a8 13     10669  10688 
    CALL    MSAVE                       ;4594  cd b6 00     10670  10689 
    JR  C,CTERR                         ;4597  38 bb        10671  10690 
    JR  CTRETN                          ;4599  18 b6        10672  10691 
                                        ;                   10673  10692 ;
STREXZ: LD  C,L                         ;459b  4d           10674  10693 
    LD  B,H                             ;459c  44           10675  10694 
STREXX: LD  HL,(INTFAC)                 ;459d  2a 4b 7a     10676  10695 
    LD  IY,(INTSSP)                     ;45a0  fd 2a 43 7a  10677  10696 
    LD  (IY+0),0                        ;45a4  fd 36 00 00  10678  10697 
    CALL    STEXPR                      ;45a8  cd b2 22     10679  10698 
    CALL    CONDMZ                      ;45ab  cd f6 6b     10680  10699 
    JP  CVDSAD                          ;45ae  c3 0e 17     10681  10700 
                                        ;                   10682  10701 ;
CTBUF:  DEFW    $FLOAT                  ;45b1  c0 6b        10683  10702 
    DEFW    $EDIT                       ;45b3  1b 63        10684  10703 
    DEFW    ADDDEG                      ;45b5  4a 5b        10685  10704 ; $CONV hard coding
    DEFW    00000h                      ;45b7  00 00        10686  10705 ; $IOCS hard coding
    DEFW    $ERTXT                      ;45b9  b2 69        10687  10706 
    DEFW    VSTART                      ;45bb  3b 7a        10688  10707 ; $WORK hard coding 
    DEFW    LDIR1                       ;45bd  a3 73        10689  10708 ; $FUNC hard coding
    DEFS    242                         ;45bf               10690  10709 
USINGB: DEFS    26                      ;46b1               10691  10710 
                                        ;                   10692  10711 ;
                                        ;                   10693  10712 ;	CHAIN	,GRAPH
                                        ;                   10694  10713 ;
                                        ;                   10695  10714 ; GRAPH
                                        ;                   10696  10715 ;
                                        ;                   10697  10716 ;
DEFCHR: INC HL                          ;46cb  23           10698  10717 
    LD  A,(GMODEF)                      ;46cc  3a 06 1c     10699  10718 
    CP  2                               ;46cf  fe 02        10700  10719 
    JP  NC,IFCALL                       ;46d1  d2 36 17     10701  10720 
    CALL    HLFTCH                      ;46d4  cd 87 29     10702  10721 
    CP  028h                            ;46d7  fe 28        10703  10722 
    JP  NZ,SERROR                       ;46d9  c2 3a 17     10704  10723 
    INC HL                              ;46dc  23           10705  10724 
    LD  C,L                             ;46dd  4d           10706  10725 
    LD  B,H                             ;46de  44           10707  10726 
    CALL    IHLEXP                      ;46df  cd cc 22     10708  10727 
    CALL    CH29H                       ;46e2  cd 66 2d     10709  10728 
    CALL    HCHECK                      ;46e5  cd d8 22     10710  10729 
    CP  080h                            ;46e8  fe 80        10711  10730 
    JP  C,IFCALL                        ;46ea  da 36 17     10712  10731 
    CP  0E0h                            ;46ed  fe e0        10713  10732 
    JP  NC,IFCALL                       ;46ef  d2 36 17     10714  10733 
    AND 07Fh                            ;46f2  e6 7f        10715  10734 
    PUSH    AF                          ;46f4  f5           10716  10735 
    CALL    BCFTCH                      ;46f5  cd c4 25     10717  10736 
    CP  0F5h                            ;46f8  fe f5        10718  10737 
    JP  NZ,SERROR                       ;46fa  c2 3a 17     10719  10738 
    CALL    STREXX                      ;46fd  cd 9d 45     10720  10739 
    CP  12                              ;4700  fe 0c        10721  10740 
    JP  NZ,IFCALL                       ;4702  c2 36 17     10722  10741 
    LD  H,A                             ;4705  67           10723  10742 
    POP AF                              ;4706  f1           10724  10743 
    PUSH    BC                          ;4707  c5           10725  10744 
    PUSH    HL                          ;4708  e5           10726  10745 
    LD  L,A                             ;4709  6f           10727  10746 
    LD  H,0                             ;470a  26 00        10728  10747 
    ADD HL,HL                           ;470c  29           10729  10748 
    ADD HL,HL                           ;470d  29           10730  10749 
    ADD HL,HL                           ;470e  29           10731  10750 
    ADD HL,HL                           ;470f  29           10732  10751 
    LD  BC,01000h                       ;4710  01 00 10     10733  10752 
    ADD HL,BC                           ;4713  09           10734  10753 
    LD  C,L                             ;4714  4d           10735  10754 
    LD  B,H                             ;4715  44           10736  10755 
    POP HL                              ;4716  e1           10737  10756 
DEFCHL: LD  A,(DE)                      ;4717  1a           10738  10757 
    OUT (C),A                           ;4718  ed 79        10739  10758 
    INC DE                              ;471a  13           10740  10759 
    INC BC                              ;471b  03           10741  10760 
    DEC H                               ;471c  25           10742  10761 
    JR  NZ,DEFCHL                       ;471d  20 f8        10743  10762 
    POP HL                              ;471f  e1           10744  10763 
    DEC HL                              ;4720  2b           10745  10764 
    RET                                 ;4721  c9           10746  10765 
                                        ;                   10747  10766 ;
                                        ;                   10748  10767 ;
SOUND:  LD  B,H                         ;4722  44           10749  10768 
    LD  C,L                             ;4723  4d           10750  10769 
    CALL    IHLEXP                      ;4724  cd cc 22     10751  10770 
    CALL    CH2CH                       ;4727  cd 61 2d     10752  10771 
    CALL    HCHECK                      ;472a  cd d8 22     10753  10772 
    CP  14                              ;472d  fe 0e        10754  10773 
    JP  NC,IFCALL                       ;472f  d2 36 17     10755  10774 
    PUSH    AF                          ;4732  f5           10756  10775 
    CALL    IHLEXP                      ;4733  cd cc 22     10757  10776 
    CALL    HCHECK                      ;4736  cd d8 22     10758  10777 
    POP HL                              ;4739  e1           10759  10778 
    LD  L,A                             ;473a  6f           10760  10779 
    PUSH    BC                          ;473b  c5           10761  10780 
    LD  BC,04000h                       ;473c  01 00 40     10762  10781 
    OUT (C),H                           ;473f  ed 61        10763  10782 
    INC C                               ;4741  0c           10764  10783 
    OUT (C),L                           ;4742  ed 69        10765  10784 
    POP BC                              ;4744  c1           10766  10785 
    JP  RETIRQ                          ;4745  c3 39 1b     10767  10786 
                                        ;                   10768  10787 ;
BEEPOP: LD  B,H                         ;4748  44           10769  10788 
    LD  C,L                             ;4749  4d           10770  10789 
    CALL    EDCEK                       ;474a  cd 6f 49     10771  10790 
    JR  Z,BEEP                          ;474d  28 29        10772  10791 
    CALL    IBYTE                       ;474f  cd df 22     10773  10792 
    CP  128                             ;4752  fe 80        10774  10793 
    JP  NC,IFCALL                       ;4754  d2 36 17     10775  10794 
    LD  D,A                             ;4757  57           10776  10795 
    LD  E,0                             ;4758  1e 00        10777  10796 
    DEC BC                              ;475a  0b           10778  10797 
    CALL    EDCEK                       ;475b  cd 6f 49     10779  10798 
    JR  Z,BEEPA                         ;475e  28 12        10780  10799 
    CP  02Ch                            ;4760  fe 2c        10781  10800 
    JP  NZ,SERROR                       ;4762  c2 3a 17     10782  10801 
    INC BC                              ;4765  03           10783  10802 
    PUSH    DE                          ;4766  d5           10784  10803 
    CALL    IBYTE                       ;4767  cd df 22     10785  10804 
    POP DE                              ;476a  d1           10786  10805 
    CP  3                               ;476b  fe 03        10787  10806 
    JP  NC,IFCALL                       ;476d  d2 36 17     10788  10807 
    DEC BC                              ;4770  0b           10789  10808 
    LD  E,A                             ;4771  5f           10790  10809 
BEEPA:  PUSH    BC                      ;4772  c5           10791  10810 
    CALL    SOUNDS                      ;4773  cd 99 10     10792  10811 ;D,E
    POP HL                              ;4776  e1           10793  10812 
    RET                                 ;4777  c9           10794  10813 
                                        ;                   10795  10814 ;
BEEP:   PUSH    BC                      ;4778  c5           10796  10815 
    CALL    BELL                        ;4779  cd ca 06     10797  10816 
    LD  BC,04000h                       ;477c  01 00 40     10798  10817 
    LD  A,7                             ;477f  3e 07        10799  10818 
    OUT (C),A                           ;4781  ed 79        10800  10819 
    INC C                               ;4783  0c           10801  10820 
    IN  A,(C)                           ;4784  ed 78        10802  10821 
    OR  03Fh                            ;4786  f6 3f        10803  10822 
    OUT (C),A                           ;4788  ed 79        10804  10823 
    POP HL                              ;478a  e1           10805  10824 
    RET                                 ;478b  c9           10806  10825 
                                        ;                   10807  10826 ;
PLAY:   LD  C,L                         ;478c  4d           10808  10827 
    LD  B,H                             ;478d  44           10809  10828 
    CALL    SETSSP                      ;478e  cd f9 21     10810  10829 
    LD  (IY+0),0                        ;4791  fd 36 00 00  10811  10830 
    CALL    EXPRSN                      ;4795  cd f2 22     10812  10831 
    LD  A,(IY+0)                        ;4798  fd 7e 00     10813  10832 
    CP  003h                            ;479b  fe 03        10814  10833 
    JR  NZ,TEMPO                        ;479d  20 20        10815  10834 
    CALL    CONDMZ                      ;479f  cd f6 6b     10816  10835 
    CALL    CVDSAD                      ;47a2  cd 0e 17     10817  10836 
    PUSH    BC                          ;47a5  c5           10818  10837 
    LD  B,A                             ;47a6  47           10819  10838 
    OR  A                               ;47a7  b7           10820  10839 
    JR  Z,ESCPLY                        ;47a8  28 12        10821  10840 
    LD  HL,KEYBUF                       ;47aa  21 4f 7a     10822  10841 
    PUSH    HL                          ;47ad  e5           10823  10842 
    LD  C,B                             ;47ae  48           10824  10843 
KBSTMS: LD  A,(DE)                      ;47af  1a           10825  10844 
    LD  (HL),A                          ;47b0  77           10826  10845 
    INC DE                              ;47b1  13           10827  10846 
    INC HL                              ;47b2  23           10828  10847 
    DJNZ    KBSTMS                      ;47b3  10 fa        10829  10848 
    LD  (HL),03Ah                       ;47b5  36 3a        10830  10849 
    LD  B,C                             ;47b7  41           10831  10850 
    POP DE                              ;47b8  d1           10832  10851 
    CALL    MUSIC                       ;47b9  cd cd 0e     10833  10852 
ESCPLY: POP HL                          ;47bc  e1           10834  10853 
    DEC HL                              ;47bd  2b           10835  10854 
    RET                                 ;47be  c9           10836  10855 
                                        ;                   10837  10856 ;
TEMPO:  EX  DE,HL                       ;47bf  eb           10838  10857 
    LD  HL,KEYBUF                       ;47c0  21 4f 7a     10839  10858 
    PUSH    HL                          ;47c3  e5           10840  10859 
    LD  (IY+0),4                        ;47c4  fd 36 00 04  10841  10860 
    LD  (HL),08Dh                       ;47c8  36 8d        10842  10861 
    INC HL                              ;47ca  23           10843  10862 
    LD  (HL),06Ah                       ;47cb  36 6a        10844  10863 
    INC HL                              ;47cd  23           10845  10864 
    LD  (HL),060h                       ;47ce  36 60        10846  10865 
    INC HL                              ;47d0  23           10847  10866 
    LD  (HL),0                          ;47d1  36 00        10848  10867 
    POP HL                              ;47d3  e1           10849  10868 
    PUSH    BC                          ;47d4  c5           10850  10869 
    CALL    DIV                         ;47d5  cd bd 70     10851  10870 
    CALL    HLFLTO                      ;47d8  cd 97 2d     10852  10871 
    CALL    HCHECK                      ;47db  cd d8 22     10853  10872 
    OR  A                               ;47de  b7           10854  10873 
    JP  Z,IFCALL                        ;47df  ca 36 17     10855  10874 
    CALL    XTEMPO                      ;47e2  cd 95 10     10856  10875 
    POP BC                              ;47e5  c1           10857  10876 
    JP  RETIRQ                          ;47e6  c3 39 1b     10858  10877 
                                        ;                   10859  10878 ;
                                        ;                   10860  10879 ;
COLOR:  LD  C,L                         ;47e9  4d           10861  10880 
    LD  B,H                             ;47ea  44           10862  10881 
    CALL    IBYTE                       ;47eb  cd df 22     10863  10882 
    CP  9                               ;47ee  fe 09        10864  10883 
    JP  NC,IFCALL                       ;47f0  d2 36 17     10865  10884 
    LD  (COLORF),A                      ;47f3  32 80 11     10866  10885 
    DEC BC                              ;47f6  0b           10867  10886 
    LD  L,C                             ;47f7  69           10868  10887 
    LD  H,B                             ;47f8  60           10869  10888 
    RET                                 ;47f9  c9           10870  10889 
                                        ;                   10871  10890 ;
                                        ;                   10872  10891 ;
PRESET: CALL    PSETXY                  ;47fa  cd 24 49     10873  10892 
    XOR A                               ;47fd  af           10874  10893 
    LD  (GCOLOR),A                      ;47fe  32 81 11     10875  10894 
    JR  L33F0                           ;4801  18 03        10876  10895 
PSET:                                   ;                   10877  10896 
    CALL    PSETXY                      ;4803  cd 24 49     10878  10897 ;(X,Y,C)
L33F0:  PUSH    BC                      ;4806  c5           10879  10898 
    CALL    PSETSB                      ;4807  cd 0c 48     10880  10899 
    POP HL                              ;480a  e1           10881  10900 
    RET                                 ;480b  c9           10882  10901 
                                        ;                   10883  10902 ;
                                        ;                   10884  10903 ;
                                        ;                   10885  10904 ;
                                        ;                   10886  10905 ;  PSET(RESET(DE,HL)
PSETSB: CALL    CULADR                  ;480c  cd 23 48     10887  10906 
    RET C                               ;480f  d8           10888  10907 
    PUSH    HL                          ;4810  e5           10889  10908 
    LD  HL,CULTBL                       ;4811  21 1b 48     10890  10909 
    ADD HL,DE                           ;4814  19           10891  10910 
    LD  E,(HL)                          ;4815  5e           10892  10911 
    INC HL                              ;4816  23           10893  10912 
    LD  D,(HL)                          ;4817  56           10894  10913 
    EX  DE,HL                           ;4818  eb           10895  10914 
    EX  (SP),HL                         ;4819  e3           10896  10915 
    RET                                 ;481a  c9           10897  10916 
                                        ;                   10898  10917 ;
CULTBL: DEFW    CULAD0                  ;481b  4e 48        10899  10918 ;TEXT0
    DEFW    CULAD1                      ;481d  93 48        10900  10919 ;TEXT1
    DEFW    CULAD3                      ;481f  da 48        10901  10920 ;GRAPHIC2,3
    DEFW    CULAD5                      ;4821  05 49        10902  10921 ;GRAPHIC4,5
                                        ;                   10903  10922 ;
                                        ;                   10904  10923 ;
CULADR: PUSH    HL                      ;4823  e5           10905  10924 
SCRNYE: LD  BC, 04764h                  ;4824  01 64 47     10906  10925 ;LIMIT Y
    ADD HL,BC                           ;4827  09           10907  10926 
    JR  C,CULERR                        ;4828  38 07        10908  10927 
    EX  DE,HL                           ;482a  eb           10909  10928 
    PUSH    HL                          ;482b  e5           10910  10929 
SCRNXE: LD  BC, 0472Ch                  ;482c  01 2c 47     10911  10930 ;LIMIT X
    ADD HL,BC                           ;482f  09           10912  10931 
    POP DE                              ;4830  d1           10913  10932 
CULERR: POP HL                          ;4831  e1           10914  10933 
    RET C                               ;4832  d8           10915  10934 
CALADR: JP  CALAD0                      ;4833  c3 36 48     10916  10935 
                                        ;                   10917  10936 ;
CALAD0: LD  BC,(CHRSTA)                 ;4836  ed 4b d6 0a  10918  10937 
    LD  A,L                             ;483a  7d           10919  10938 
    RES 0,L                             ;483b  cb 85        10920  10939 
    ADD HL,HL                           ;483d  29           10921  10940 
    ADD HL,HL                           ;483e  29           10922  10941 
    ADD HL,HL                           ;483f  29           10923  10942 
    ADD HL,HL                           ;4840  29           10924  10943 
    AND 1                               ;4841  e6 01        10925  10944 
    SRL E                               ;4843  cb 3b        10926  10945 
    CCF                                 ;4845  3f           10927  10946 
    RLA                                 ;4846  17           10928  10947 
    ADD HL,DE                           ;4847  19           10929  10948 
    ADD HL,BC                           ;4848  09           10930  10949 
    LD  DE,00000h                       ;4849  11 00 00     10931  10950 
    OR  A                               ;484c  b7           10932  10951 
    RET                                 ;484d  c9           10933  10952 
                                        ;                   10934  10953 ;
CULAD0: LD  C,L                         ;484e  4d           10935  10954 
    LD  B,H                             ;484f  44           10936  10955 
    SET 3,B                             ;4850  cb d8        10937  10956 ;
    LD  E,4                             ;4852  1e 04        10938  10957 ;
    OUT (C),E                           ;4854  ed 59        10939  10958 ;
    LD  E,1                             ;4856  1e 01        10940  10959 
    OR  A                               ;4858  b7           10941  10960 
    JR  Z,L344A                         ;4859  28 05        10942  10961 
L3445:  RLC E                           ;485b  cb 03        10943  10962 
    DEC A                               ;485d  3d           10944  10963 
    JR  NZ,L3445                        ;485e  20 fb        10945  10964 
L344A:  LD  A,(GCOLOR)                  ;4860  3a 81 11     10946  10965 
    OR  A                               ;4863  b7           10947  10966 
    JP  Z,PRESOK                        ;4864  ca c0 48     10948  10967 
    DEC A                               ;4867  3d           10949  10968 
    AND 7                               ;4868  e6 07        10950  10969 
    RLCA                                ;486a  07           10951  10970 
    RLCA                                ;486b  07           10952  10971 
    RLCA                                ;486c  07           10953  10972 
    RLCA                                ;486d  07           10954  10973 
    OR  E                               ;486e  b3           10955  10974 
    LD  E,A                             ;486f  5f           10956  10975 
    LD  D,00Fh                          ;4870  16 0f        10957  10976 
    JP  PSTRES                          ;4872  c3 1b 49     10958  10977 
                                        ;                   10959  10978 ;
CALAD1: LD  BC,(CHRSTA)                 ;4875  ed 4b d6 0a  10960  10979 
    LD  A,L                             ;4879  7d           10961  10980 
    LD  L,0FFh                          ;487a  2e ff        10962  10981 
CALA21: INC L                           ;487c  2c           10963  10982 
    SUB 3                               ;487d  d6 03        10964  10983 
    JR  NC,CALA21                       ;487f  30 fb        10965  10984 
    ADD A,3                             ;4881  c6 03        10966  10985 
    SRL E                               ;4883  cb 3b        10967  10986 
    CCF                                 ;4885  3f           10968  10987 
    RLA                                 ;4886  17           10969  10988 
    ADD HL,HL                           ;4887  29           10970  10989 
    ADD HL,HL                           ;4888  29           10971  10990 
    ADD HL,HL                           ;4889  29           10972  10991 
    ADD HL,HL                           ;488a  29           10973  10992 
    ADD HL,HL                           ;488b  29           10974  10993 
    ADD HL,DE                           ;488c  19           10975  10994 
    ADD HL,BC                           ;488d  09           10976  10995 
    LD  DE,00002h                       ;488e  11 02 00     10977  10996 
    OR  A                               ;4891  b7           10978  10997 
    RET                                 ;4892  c9           10979  10998 
                                        ;                   10980  10999 ;
CULAD1: LD  C,L                         ;4893  4d           10981  11000 
    LD  B,H                             ;4894  44           10982  11001 
    SET 3,B                             ;4895  cb d8        10983  11002 
    LD  D,00Ch                          ;4897  16 0c        10984  11003 
    OUT (C),D                           ;4899  ed 51        10985  11004 
    LD  E,1                             ;489b  1e 01        10986  11005 
    OR  A                               ;489d  b7           10987  11006 
    JR  Z,L348F                         ;489e  28 05        10988  11007 
L348A:  RLC E                           ;48a0  cb 03        10989  11008 
    DEC A                               ;48a2  3d           10990  11009 
    JR  NZ,L348A                        ;48a3  20 fb        10991  11010 
L348F:  LD  A,(GCOLOR)                  ;48a5  3a 81 11     10992  11011 
    OR  A                               ;48a8  b7           10993  11012 
    JP  Z,PRESOK                        ;48a9  ca c0 48     10994  11013 
    DEC A                               ;48ac  3d           10995  11014 
    CP  4                               ;48ad  fe 04        10996  11015 
    JR  C,L349F                         ;48af  38 04        10997  11016 
    SET 1,D                             ;48b1  cb ca        10998  11017 
    OUT (C),D                           ;48b3  ed 51        10999  11018 
L349F:  AND 003h                        ;48b5  e6 03        11000  11019 
    RRCA                                ;48b7  0f           11001  11020 
    RRCA                                ;48b8  0f           11002  11021 
    OR  E                               ;48b9  b3           11003  11022 
    LD  E,A                             ;48ba  5f           11004  11023 
    LD  D,03Fh                          ;48bb  16 3f        11005  11024 
    JP  PSTRES                          ;48bd  c3 1b 49     11006  11025 
                                        ;                   11007  11026 ;
PRESOK: LD  C,L                         ;48c0  4d           11008  11027 
    LD  B,H                             ;48c1  44           11009  11028 
    IN  L,(C)                           ;48c2  ed 68        11010  11029 
    LD  A,E                             ;48c4  7b           11011  11030 
    CPL                                 ;48c5  2f           11012  11031 
    AND L                               ;48c6  a5           11013  11032 
    OUT (C),A                           ;48c7  ed 79        11014  11033 
    RET                                 ;48c9  c9           11015  11034 
                                        ;                   11016  11035 ;
                                        ;                   11017  11036 ;
CALAD2:                                 ;                   11018  11037 
CALAD3: ADD HL,HL                       ;48ca  29           11019  11038 
    ADD HL,HL                           ;48cb  29           11020  11039 
    ADD HL,HL                           ;48cc  29           11021  11040 
    ADD HL,HL                           ;48cd  29           11022  11041 
    ADD HL,HL                           ;48ce  29           11023  11042 
    LD  A,E                             ;48cf  7b           11024  11043 
    SRL E                               ;48d0  cb 3b        11025  11044 
    SRL E                               ;48d2  cb 3b        11026  11045 
    ADD HL,DE                           ;48d4  19           11027  11046 
    LD  DE,00004h                       ;48d5  11 04 00     11028  11047 
    OR  A                               ;48d8  b7           11029  11048 
    RET                                 ;48d9  c9           11030  11049 
                                        ;                   11031  11050 ;
CULAD3: AND 003h                        ;48da  e6 03        11032  11051 
    INC A                               ;48dc  3c           11033  11052 
    LD  B,A                             ;48dd  47           11034  11053 
    LD  A,(GCOLOR)                      ;48de  3a 81 11     11035  11054 
    AND 003h                            ;48e1  e6 03        11036  11055 
    LD  E,A                             ;48e3  5f           11037  11056 
    LD  D,0FCh                          ;48e4  16 fc        11038  11057 
CALA31: RRC E                           ;48e6  cb 0b        11039  11058 
    RRC E                               ;48e8  cb 0b        11040  11059 
    RRC D                               ;48ea  cb 0a        11041  11060 
    RRC D                               ;48ec  cb 0a        11042  11061 
    DJNZ    CALA31                      ;48ee  10 f6        11043  11062 
    JP  PSTRES                          ;48f0  c3 1b 49     11044  11063 
                                        ;                   11045  11064 ;
CALAD4:                                 ;                   11046  11065 
CALAD5: ADD HL,HL                       ;48f3  29           11047  11066 
    ADD HL,HL                           ;48f4  29           11048  11067 
    ADD HL,HL                           ;48f5  29           11049  11068 
    ADD HL,HL                           ;48f6  29           11050  11069 
    ADD HL,HL                           ;48f7  29           11051  11070 
    LD  A,E                             ;48f8  7b           11052  11071 
    SRL E                               ;48f9  cb 3b        11053  11072 
    SRL E                               ;48fb  cb 3b        11054  11073 
    SRL E                               ;48fd  cb 3b        11055  11074 
    ADD HL,DE                           ;48ff  19           11056  11075 
    LD  DE,00006H                       ;4900  11 06 00     11057  11076 
    OR  A                               ;4903  b7           11058  11077 
    RET                                 ;4904  c9           11059  11078 
                                        ;                   11060  11079 ;
CULAD5: AND 7                           ;4905  e6 07        11061  11080 
    LD  E,080h                          ;4907  1e 80        11062  11081 
    OR  A                               ;4909  b7           11063  11082 
    JR  Z,L34FB                         ;490a  28 05        11064  11083 
L34F6:  RRC E                           ;490c  cb 0b        11065  11084 
    DEC A                               ;490e  3d           11066  11085 
    JR  NZ,L34F6                        ;490f  20 fb        11067  11086 
L34FB:  LD  A,(GCOLOR)                  ;4911  3a 81 11     11068  11087 
    AND 001h                            ;4914  e6 01        11069  11088 
    JP  Z,PRESOK                        ;4916  ca c0 48     11070  11089 
    LD  D,0FFh                          ;4919  16 ff        11071  11090 
                                        ;                   11072  11091 ;
PSTRES: LD  C,L                         ;491b  4d           11073  11092 
    LD  B,H                             ;491c  44           11074  11093 
    IN  A,(C)                           ;491d  ed 78        11075  11094 
    AND D                               ;491f  a2           11076  11095 
    OR  E                               ;4920  b3           11077  11096 
    OUT (C),A                           ;4921  ed 79        11078  11097 
    RET                                 ;4923  c9           11079  11098 
                                        ;                   11080  11099 ;
PSETXY: LD  C,L                         ;4924  4d           11081  11100 
    LD  B,H                             ;4925  44           11082  11101 
    CALL    SETXY3                      ;4926  cd 4d 49     11083  11102 
    CP  029h                            ;4929  fe 29        11084  11103 ;)
    JR  Z,COLFST                        ;492b  28 1b        11085  11104 
    CALL    CH2CH                       ;492d  cd 61 2d     11086  11105 
    PUSH    DE                          ;4930  d5           11087  11106 
    PUSH    HL                          ;4931  e5           11088  11107 
    CALL    IHLEXP                      ;4932  cd cc 22     11089  11108 
    CP  029h                            ;4935  fe 29        11090  11109 ;)
    JP  NZ,SERROR                       ;4937  c2 3a 17     11091  11110 
    CALL    HCHECK                      ;493a  cd d8 22     11092  11111 
    CP  9                               ;493d  fe 09        11093  11112 
    JP  NC,IFCALL                       ;493f  d2 36 17     11094  11113 
    POP HL                              ;4942  e1           11095  11114 
    POP DE                              ;4943  d1           11096  11115 
COLFSL: LD  (GCOLOR),A                  ;4944  32 81 11     11097  11116 
    RET                                 ;4947  c9           11098  11117 
COLFST: LD  A,(COLORF)                  ;4948  3a 80 11     11099  11118 
    JR  COLFSL                          ;494b  18 f7        11100  11119 
                                        ;                   11101  11120 ;
SETXY3: CALL    BCFTCH                  ;494d  cd c4 25     11102  11121 
    CP  028h                            ;4950  fe 28        11103  11122 ;(
    JP  NZ,SERROR                       ;4952  c2 3a 17     11104  11123 
    CALL    IHLEXP                      ;4955  cd cc 22     11105  11124 
    PUSH    HL                          ;4958  e5           11106  11125 
    CALL    CH2CH                       ;4959  cd 61 2d     11107  11126 
    CALL    IHLEXP                      ;495c  cd cc 22     11108  11127 
    POP DE                              ;495f  d1           11109  11128 
    RET                                 ;4960  c9           11110  11129 
                                        ;                   11111  11130 ;
                                        ;                   11112  11131 ;
SETXY2: CALL    SETXY3                  ;4961  cd 4d 49     11113  11132 
    CALL    CH29H                       ;4964  cd 66 2d     11114  11133 
BCFTC2: LD  A,(BC)                      ;4967  0a           11115  11134 
    CP  020h                            ;4968  fe 20        11116  11135 
    RET NZ                              ;496a  c0           11117  11136 
    INC BC                              ;496b  03           11118  11137 
    JR  BCFTC2                          ;496c  18 f9        11119  11138 
                                        ;                   11120  11139 ;
                                        ;                   11121  11140 ;
EDCEKL: INC BC                          ;496e  03           11122  11141 
EDCEK:  LD  A,(BC)                      ;496f  0a           11123  11142 
    CP  020h                            ;4970  fe 20        11124  11143 
    JR  Z,EDCEKL                        ;4972  28 fa        11125  11144 
    OR  A                               ;4974  b7           11126  11145 
    RET Z                               ;4975  c8           11127  11146 
    CP  03Ah                            ;4976  fe 3a        11128  11147 
    RET                                 ;4978  c9           11129  11148 
                                        ;                   11130  11149 ;
                                        ;                   11131  11150 ;
LINE@:  CALL    COLFST                  ;4979  cd 48 49     11132  11151 
    DEC BC                              ;497c  0b           11133  11152 
    CALL    BCFTC2                      ;497d  cd 67 49     11134  11153 
    CP  0F9h                            ;4980  fe f9        11135  11154 ;-
    JR  NZ,NOMLIN                       ;4982  20 0e        11136  11155 
    LD  HL,(LINEXE+1)                   ;4984  2a 45 4a     11137  11156 
    LD  (LINEXS+1),HL                   ;4987  22 40 4a     11138  11157 
    LD  HL,(LINEYE+1)                   ;498a  2a 62 4a     11139  11158 
    LD  (LINEYS+1),HL                   ;498d  22 5d 4a     11140  11159 
    JR  ENDLIN                          ;4990  18 0e        11141  11160 
NOMLIN: CALL    SETXY2                  ;4992  cd 61 49     11142  11161 
    LD  (LINEXS+1),DE                   ;4995  ed 53 40 4a  11143  11162 
    LD  (LINEYS+1),HL                   ;4999  22 5d 4a     11144  11163 
    CP  0F9h                            ;499c  fe f9        11145  11164 
    JR  NZ,LIMODE                       ;499e  20 10        11146  11165 
ENDLIN: INC BC                          ;49a0  03           11147  11166 
    CALL    SETXY2                      ;49a1  cd 61 49     11148  11167 
    LD  (LINEXE+1),DE                   ;49a4  ed 53 45 4a  11149  11168 
    LD  (LINEYE+1),HL                   ;49a8  22 62 4a     11150  11169 
    CP  0F9h                            ;49ab  fe f9        11151  11170 ;-
    JP  Z,NINS                          ;49ad  ca fa 20     11152  11171 ;CONNECT
LIMODE: CP  02Ch                        ;49b0  fe 2c        11153  11172 ;,
    JP  NZ,SERROR                       ;49b2  c2 3a 17     11154  11173 
    INC BC                              ;49b5  03           11155  11174 
    CALL    BCFTC2                      ;49b6  cd 67 49     11156  11175 
    CP  0C7h                            ;49b9  fe c7        11157  11176 ;PSET
    JR  Z,MDST2                         ;49bb  28 16        11158  11177 
    CP  0C8h                            ;49bd  fe c8        11159  11178 ;PRESET
    LD  A,0                             ;49bf  3e 00        11160  11179 
    JR  Z,MDST22                        ;49c1  28 37        11161  11180 
CHRMD1: CALL    STREXX                  ;49c3  cd 9d 45     11162  11181 
    OR  A                               ;49c6  b7           11163  11182 
    JR  Z,L35B4                         ;49c7  28 01        11164  11183 
    LD  A,(DE)                          ;49c9  1a           11165  11184 
L35B4:  DEC BC                          ;49ca  0b           11166  11185 
    LD  (CHRCOD+1),A                    ;49cb  32 da 4b     11167  11186 
    LD  HL,TEXTSB                       ;49ce  21 c7 4b     11168  11187 
    JR  MDST3                           ;49d1  18 04        11169  11188 
MDST2:  INC BC                          ;49d3  03           11170  11189 
    LD  HL,PSETSB                       ;49d4  21 0c 48     11171  11190 
MDST3:  LD  (LINEMD+1),HL               ;49d7  22 b9 4a     11172  11191 
    LD  (BOXMD+1),HL                    ;49da  22 4f 4b     11173  11192 
    LD  DE,LINESB                       ;49dd  11 7d 4a     11174  11193 
    CALL    EDCEK                       ;49e0  cd 6f 49     11175  11194 
    JR  Z,LINE1                         ;49e3  28 3a        11176  11195 
    CALL    CH2CH                       ;49e5  cd 61 2d     11177  11196 
    INC BC                              ;49e8  03           11178  11197 
    CALL    BCFTC2                      ;49e9  cd 67 49     11179  11198 
    CP  042h                            ;49ec  fe 42        11180  11199 ;B/BF
    JR  Z,BBFLMD                        ;49ee  28 22        11181  11200 
    CALL    IBYTE                       ;49f0  cd df 22     11182  11201 
    CP  9                               ;49f3  fe 09        11183  11202 
    JP  NC,IFCALL                       ;49f5  d2 36 17     11184  11203 
    DEC BC                              ;49f8  0b           11185  11204 
    DEC BC                              ;49f9  0b           11186  11205 
MDST22: LD  (GCOLOR),A                  ;49fa  32 81 11     11187  11206 
    INC BC                              ;49fd  03           11188  11207 
    LD  DE,LINESB                       ;49fe  11 7d 4a     11189  11208 
    CALL    EDCEK                       ;4a01  cd 6f 49     11190  11209 
    JR  Z,LINE1                         ;4a04  28 19        11191  11210 
    CALL    CH2CH                       ;4a06  cd 61 2d     11192  11211 
    INC BC                              ;4a09  03           11193  11212 
    CALL    BCFTC2                      ;4a0a  cd 67 49     11194  11213 
    CP  042h                            ;4a0d  fe 42        11195  11214 ;B/BF
    JP  NZ,SERROR                       ;4a0f  c2 3a 17     11196  11215 
BBFLMD: LD  DE,BOX                      ;4a12  11 01 4b     11197  11216 
    INC BC                              ;4a15  03           11198  11217 
    LD  A,(BC)                          ;4a16  0a           11199  11218 
    CP  046h                            ;4a17  fe 46        11200  11219 ;F
    JR  NZ,LINE1                        ;4a19  20 04        11201  11220 
    INC BC                              ;4a1b  03           11202  11221 
    LD  DE,BOXFUL                       ;4a1c  11 5b 4b     11203  11222 
LINE1:  LD  (LNBOXF+1),DE               ;4a1f  ed 53 7b 4a  11204  11223 
    PUSH    BC                          ;4a23  c5           11205  11224 
    CALL    LINES1                      ;4a24  cd 2b 4a     11206  11225 
    POP BC                              ;4a27  c1           11207  11226 
    LD  L,C                             ;4a28  69           11208  11227 
    LD  H,B                             ;4a29  60           11209  11228 
    RET                                 ;4a2a  c9           11210  11229 
                                        ;                   11211  11230 ;
LINES1: LD  HL,0                        ;4a2b  21 00 00     11212  11231 
    LD  (YINC1+1),HL                    ;4a2e  22 cb 4a     11213  11232 
    LD  (YINC3+1),HL                    ;4a31  22 bf 4a     11214  11233 
    LD  BC,08000h                       ;4a34  01 00 80     11215  11234 
    LD  (YMOD+1),BC                     ;4a37  ed 43 aa 4a  11216  11235 
    LD  (XMOD+1),BC                     ;4a3b  ed 43 a7 4a  11217  11236 
LINEXS: LD  HL,0                        ;4a3f  21 00 00     11218  11237 ;(XS
    ADD HL,BC                           ;4a42  09           11219  11238 
    EX  DE,HL                           ;4a43  eb           11220  11239 
LINEXE: LD  HL,255                      ;4a44  21 ff 00     11221  11240 ;-,XE
    ADD HL,BC                           ;4a47  09           11222  11241 
    OR  A                               ;4a48  b7           11223  11242 
    SBC HL,DE                           ;4a49  ed 52        11224  11243 
    LD  DE,1                            ;4a4b  11 01 00     11225  11244 
    JR  NC,LINEL0                       ;4a4e  30 06        11226  11245 
    EX  DE,HL                           ;4a50  eb           11227  11246 
    SBC HL,DE                           ;4a51  ed 52        11228  11247 
    LD  DE,0FFFFh                       ;4a53  11 ff ff     11229  11248 
LINEL0: PUSH    HL                      ;4a56  e5           11230  11249 
    LD  (XINC0+1),DE                    ;4a57  ed 53 d2 4a  11231  11250 
    LD  A,E                             ;4a5b  7b           11232  11251 
LINEYS: LD  HL,0                        ;4a5c  21 00 00     11233  11252 ;(,YS)
    ADD HL,BC                           ;4a5f  09           11234  11253 
    EX  DE,HL                           ;4a60  eb           11235  11254 
LINEYE: LD  HL,192                      ;4a61  21 c0 00     11236  11255 ;-,YE)
    ADD HL,BC                           ;4a64  09           11237  11256 
    OR  A                               ;4a65  b7           11238  11257 
    SBC HL,DE                           ;4a66  ed 52        11239  11258 
    LD  DE,1                            ;4a68  11 01 00     11240  11259 
    JR  NC,LINEL1                       ;4a6b  30 06        11241  11260 
    EX  DE,HL                           ;4a6d  eb           11242  11261 
    SBC HL,DE                           ;4a6e  ed 52        11243  11262 
    LD  DE,0FFFFh                       ;4a70  11 ff ff     11244  11263 
LINEL1: LD  (YINC2+1),DE                ;4a73  ed 53 c4 4a  11245  11264 
    LD  B,A                             ;4a77  47           11246  11265 
    LD  C,E                             ;4a78  4b           11247  11266 
    POP DE                              ;4a79  d1           11248  11267 
LNBOXF: JP  LINESB                      ;4a7a  c3 7d 4a     11249  11268 ;BOX/BOXFUL
LINESB: PUSH    HL                      ;4a7d  e5           11250  11269 
    SBC HL,DE                           ;4a7e  ed 52        11251  11270 
    POP HL                              ;4a80  e1           11252  11271 
    PUSH    DE                          ;4a81  d5           11253  11272 
    JR  Z,LINEL2                        ;4a82  28 20        11254  11273 
    JR  NC,LINEL3                       ;4a84  30 58        11255  11274 
    CALL    DIVH$D                      ;4a86  cd 90 4b     11256  11275 
    DEC C                               ;4a89  0d           11257  11276 
    LD  DE,0                            ;4a8a  11 00 00     11258  11277 
    JR  Z,LINEL4                        ;4a8d  28 0e        11259  11278 
    XOR A                               ;4a8f  af           11260  11279 
    EX  DE,HL                           ;4a90  eb           11261  11280 
    SBC HL,DE                           ;4a91  ed 52        11262  11281 
    LD  DE,07F7Fh                       ;4a93  11 7f 7f     11263  11282 
    LD  (YMOD+1),DE                     ;4a96  ed 53 aa 4a  11264  11283 
    LD  DE,0FFFFh                       ;4a9a  11 ff ff     11265  11284 
LINEL4: LD  (YINC2+1),DE                ;4a9d  ed 53 c4 4a  11266  11285 
    LD  (YINC3+1),HL                    ;4aa1  22 bf 4a     11267  11286 
LINEL2: POP BC                          ;4aa4  c1           11268  11287 
    EXX                                 ;4aa5  d9           11269  11288 
XMOD:   LD  DE,08000h                   ;4aa6  11 00 80     11270  11289 
YMOD:   LD  HL,08000h                   ;4aa9  21 00 80     11271  11290 
    EXX                                 ;4aac  d9           11272  11291 
    LD  DE,(LINEXS+1)                   ;4aad  ed 5b 40 4a  11273  11292 
    LD  HL,(LINEYS+1)                   ;4ab1  2a 5d 4a     11274  11293 
    INC BC                              ;4ab4  03           11275  11294 
LINELP: PUSH    BC                      ;4ab5  c5           11276  11295 
    PUSH    DE                          ;4ab6  d5           11277  11296 
    PUSH    HL                          ;4ab7  e5           11278  11297 
LINEMD: CALL    PSETSB                  ;4ab8  cd 0c 48     11279  11298 ;PSETTX
    POP HL                              ;4abb  e1           11280  11299 
    POP DE                              ;4abc  d1           11281  11300 
    EXX                                 ;4abd  d9           11282  11301 
YINC3:  LD  BC,00000h                   ;4abe  01 00 00     11283  11302 
    ADD HL,BC                           ;4ac1  09           11284  11303 
    EXX                                 ;4ac2  d9           11285  11304 
YINC2:  LD  BC,00001h                   ;4ac3  01 01 00     11286  11305 
    ADC HL,BC                           ;4ac6  ed 4a        11287  11306 
    EXX                                 ;4ac8  d9           11288  11307 
    EX  DE,HL                           ;4ac9  eb           11289  11308 
YINC1:  LD  BC,00000h                   ;4aca  01 00 00     11290  11309 
    ADD HL,BC                           ;4acd  09           11291  11310 
    EX  DE,HL                           ;4ace  eb           11292  11311 
    EXX                                 ;4acf  d9           11293  11312 
    EX  DE,HL                           ;4ad0  eb           11294  11313 
XINC0:  LD  BC,00001h                   ;4ad1  01 01 00     11295  11314 
    ADC HL,BC                           ;4ad4  ed 4a        11296  11315 
    EX  DE,HL                           ;4ad6  eb           11297  11316 
    POP BC                              ;4ad7  c1           11298  11317 
    DEC BC                              ;4ad8  0b           11299  11318 
    LD  A,B                             ;4ad9  78           11300  11319 
    OR  C                               ;4ada  b1           11301  11320 
    JR  NZ,LINELP                       ;4adb  20 d8        11302  11321 
    RET                                 ;4add  c9           11303  11322 
                                        ;                   11304  11323 ;
LINEL3: LD  E,L                         ;4ade  5d           11305  11324 
    LD  D,H                             ;4adf  54           11306  11325 
    EX  (SP),HL                         ;4ae0  e3           11307  11326 
    CALL    DIVH$D                      ;4ae1  cd 90 4b     11308  11327 
    DEC B                               ;4ae4  05           11309  11328 
    LD  DE,0                            ;4ae5  11 00 00     11310  11329 
    JR  Z,LINEL5                        ;4ae8  28 0e        11311  11330 
    XOR A                               ;4aea  af           11312  11331 
    EX  DE,HL                           ;4aeb  eb           11313  11332 
    SBC HL,DE                           ;4aec  ed 52        11314  11333 
    LD  DE,07F7Fh                       ;4aee  11 7f 7f     11315  11334 
    LD  (XMOD+1),DE                     ;4af1  ed 53 a7 4a  11316  11335 
    LD  DE,0FFFFh                       ;4af5  11 ff ff     11317  11336 
LINEL5: LD  (XINC0+1),DE                ;4af8  ed 53 d2 4a  11318  11337 
    LD  (YINC1+1),HL                    ;4afc  22 cb 4a     11319  11338 
    JR  LINEL2                          ;4aff  18 a3        11320  11339 
                                        ;                   11321  11340 ;
                                        ;                   11322  11341 ; BOX
BOX:    PUSH    DE                      ;4b01  d5           11323  11342 
    PUSH    BC                          ;4b02  c5           11324  11343 
    LD  A,023h                          ;4b03  3e 23        11325  11344 
    DEC C                               ;4b05  0d           11326  11345 
    JR  Z,BOXYAD                        ;4b06  28 02        11327  11346 
    LD  A,02Bh                          ;4b08  3e 2b        11328  11347 
BOXYAD: LD  (XBOXAD),A                  ;4b0a  32 55 4b     11329  11348 
    PUSH    HL                          ;4b0d  e5           11330  11349 
    POP BC                              ;4b0e  c1           11331  11350 
    LD  DE,(LINEXS+1)                   ;4b0f  ed 5b 40 4a  11332  11351 
    LD  HL,(LINEYS+1)                   ;4b13  2a 5d 4a     11333  11352 
    PUSH    BC                          ;4b16  c5           11334  11353 
    PUSH    HL                          ;4b17  e5           11335  11354 
    CALL    LINEY                       ;4b18  cd 45 4b     11336  11355 
    POP HL                              ;4b1b  e1           11337  11356 
    POP BC                              ;4b1c  c1           11338  11357 
    LD  DE,(LINEXE+1)                   ;4b1d  ed 5b 45 4a  11339  11358 
    CALL    LINEY                       ;4b21  cd 45 4b     11340  11359 
    POP BC                              ;4b24  c1           11341  11360 
    LD  A,013h                          ;4b25  3e 13        11342  11361 
    DEC B                               ;4b27  05           11343  11362 
    JR  Z,BOXXAD                        ;4b28  28 02        11344  11363 
    LD  A,01Bh                          ;4b2a  3e 1b        11345  11364 
BOXXAD: LD  (XBOXAD),A                  ;4b2c  32 55 4b     11346  11365 
    POP BC                              ;4b2f  c1           11347  11366 
    INC BC                              ;4b30  03           11348  11367 
    LD  DE,(LINEXS+1)                   ;4b31  ed 5b 40 4a  11349  11368 
    LD  HL,(LINEYS+1)                   ;4b35  2a 5d 4a     11350  11369 
    PUSH    BC                          ;4b38  c5           11351  11370 
    PUSH    DE                          ;4b39  d5           11352  11371 
    CALL    LINEX                       ;4b3a  cd 56 4b     11353  11372 
    POP DE                              ;4b3d  d1           11354  11373 
    POP BC                              ;4b3e  c1           11355  11374 
    LD  HL,(LINEYE+1)                   ;4b3f  2a 62 4a     11356  11375 
    JP  LINEX                           ;4b42  c3 56 4b     11357  11376 
LINEY:  LD  A,B                         ;4b45  78           11358  11377 
    OR  C                               ;4b46  b1           11359  11378 
    RET Z                               ;4b47  c8           11360  11379 
    JP  BOXDEC                          ;4b48  c3 54 4b     11361  11380 
BOXLOP: PUSH    HL                      ;4b4b  e5           11362  11381 
    PUSH    DE                          ;4b4c  d5           11363  11382 
    PUSH    BC                          ;4b4d  c5           11364  11383 
BOXMD:  CALL    PSETSB                  ;4b4e  cd 0c 48     11365  11384 ;PSETTX
    POP BC                              ;4b51  c1           11366  11385 
    POP DE                              ;4b52  d1           11367  11386 
    POP HL                              ;4b53  e1           11368  11387 
BOXDEC: DEC BC                          ;4b54  0b           11369  11388 
XBOXAD: NOP                             ;4b55  00           11370  11389 ;INC/DEL DEL/HL
LINEX:  LD  A,B                         ;4b56  78           11371  11390 
    OR  C                               ;4b57  b1           11372  11391 
    JR  NZ,BOXLOP                       ;4b58  20 f1        11373  11392 
    RET                                 ;4b5a  c9           11374  11393 
                                        ;                   11375  11394 ;
                                        ;                   11376  11395 ;
                                        ;                   11377  11396 ; BOX FU
BOXFUL: LD  A,013h                      ;4b5b  3e 13        11378  11397 
    DEC B                               ;4b5d  05           11379  11398 
    JR  Z,FULAD1                        ;4b5e  28 02        11380  11399 
    LD  A,01Bh                          ;4b60  3e 1b        11381  11400 
FULAD1: LD  (XBOXAD),A                  ;4b62  32 55 4b     11382  11401 
    LD  A,023h                          ;4b65  3e 23        11383  11402 
    DEC C                               ;4b67  0d           11384  11403 
    JR  Z,FULAD2                        ;4b68  28 02        11385  11404 
    LD  A,02Bh                          ;4b6a  3e 2b        11386  11405 
FULAD2: LD  (FULINC),A                  ;4b6c  32 88 4b     11387  11406 
    PUSH    HL                          ;4b6f  e5           11388  11407 
    POP BC                              ;4b70  c1           11389  11408 
    INC BC                              ;4b71  03           11390  11409 
    EX  DE,HL                           ;4b72  eb           11391  11410 
    INC HL                              ;4b73  23           11392  11411 
    LD  (LINEBC+1),HL                   ;4b74  22 81 4b     11393  11412 
    LD  DE,(LINEXS+1)                   ;4b77  ed 5b 40 4a  11394  11413 
    LD  HL,(LINEYS+1)                   ;4b7b  2a 5d 4a     11395  11414 
FULLOP: PUSH    DE                      ;4b7e  d5           11396  11415 
    PUSH    BC                          ;4b7f  c5           11397  11416 
LINEBC: LD  BC,00001h                   ;4b80  01 01 00     11398  11417 
    CALL    LINEX                       ;4b83  cd 56 4b     11399  11418 
    POP BC                              ;4b86  c1           11400  11419 
    POP DE                              ;4b87  d1           11401  11420 
FULINC: INC HL                          ;4b88  23           11402  11421 
    DEC BC                              ;4b89  0b           11403  11422 
    LD  A,B                             ;4b8a  78           11404  11423 
    OR  C                               ;4b8b  b1           11405  11424 
    JP  NZ,FULLOP                       ;4b8c  c2 7e 4b     11406  11425 
    RET                                 ;4b8f  c9           11407  11426 
                                        ;                   11408  11427 ;
DIVH$D: LD  A,H                         ;4b90  7c           11409  11428 
    OR  L                               ;4b91  b5           11410  11429 
    RET Z                               ;4b92  c8           11411  11430 
    PUSH    BC                          ;4b93  c5           11412  11431 
    LD  A,17                            ;4b94  3e 11        11413  11432 
    EXX                                 ;4b96  d9           11414  11433 
    LD  HL,0                            ;4b97  21 00 00     11415  11434 
    LD  DE,0                            ;4b9a  11 00 00     11416  11435 
    EXX                                 ;4b9d  d9           11417  11436 
DIVLP:  PUSH    HL                      ;4b9e  e5           11418  11437 
    OR  A                               ;4b9f  b7           11419  11438 
    SBC HL,DE                           ;4ba0  ed 52        11420  11439 
    EXX                                 ;4ba2  d9           11421  11440 
    PUSH    HL                          ;4ba3  e5           11422  11441 
    SBC HL,DE                           ;4ba4  ed 52        11423  11442 
    JR  C,DIV01                         ;4ba6  38 06        11424  11443 
    EX  (SP),HL                         ;4ba8  e3           11425  11444 
    POP HL                              ;4ba9  e1           11426  11445 
    EXX                                 ;4baa  d9           11427  11446 
    EX  (SP),HL                         ;4bab  e3           11428  11447 
    EXX                                 ;4bac  d9           11429  11448 
    PUSH    HL                          ;4bad  e5           11430  11449 
DIV01:  POP HL                          ;4bae  e1           11431  11450 
    EXX                                 ;4baf  d9           11432  11451 
    POP HL                              ;4bb0  e1           11433  11452 
    CCF                                 ;4bb1  3f           11434  11453 
    RL  C                               ;4bb2  cb 11        11435  11454 
    RL  B                               ;4bb4  cb 10        11436  11455 
    SLA L                               ;4bb6  cb 25        11437  11456 
    RL  H                               ;4bb8  cb 14        11438  11457 
    EXX                                 ;4bba  d9           11439  11458 
    RL  L                               ;4bbb  cb 15        11440  11459 
    RL  H                               ;4bbd  cb 14        11441  11460 
    EXX                                 ;4bbf  d9           11442  11461 
    DEC A                               ;4bc0  3d           11443  11462 
    JR  NZ,DIVLP                        ;4bc1  20 db        11444  11463 
    LD  L,C                             ;4bc3  69           11445  11464 
    LD  H,B                             ;4bc4  60           11446  11465 
    POP BC                              ;4bc5  c1           11447  11466 
    RET                                 ;4bc6  c9           11448  11467 
                                        ;                   11449  11468 ;
                                        ;                   11450  11469 ;
TEXTSB: XOR A                           ;4bc7  af           11451  11470 
    CP  D                               ;4bc8  ba           11452  11471 
    RET NZ                              ;4bc9  c0           11453  11472 
    CP  H                               ;4bca  bc           11454  11473 
    RET NZ                              ;4bcb  c0           11455  11474 
    LD  D,L                             ;4bcc  55           11456  11475 
    LD  A,E                             ;4bcd  7b           11457  11476 
    CP  32                              ;4bce  fe 20        11458  11477 
    RET NC                              ;4bd0  d0           11459  11478 
    LD  A,D                             ;4bd1  7a           11460  11479 
    CP  16                              ;4bd2  fe 10        11461  11480 
    RET NC                              ;4bd4  d0           11462  11481 
    EX  DE,HL                           ;4bd5  eb           11463  11482 
    CALL    ADRCA2                      ;4bd6  cd 3b 09     11464  11483 
CHRCOD: LD  A,041h                      ;4bd9  3e 41        11465  11484 ;"A"
    JP  BCOUTA                          ;4bdb  c3 3f 0a     11466  11485 
                                        ;                   11467  11486 ;
CIRCLE: LD  C,L                         ;4bde  4d           11468  11487 
    LD  B,H                             ;4bdf  44           11469  11488 
    CALL    SETXY2                      ;4be0  cd 61 49     11470  11489 
    CALL    CH2CH                       ;4be3  cd 61 2d     11471  11490 
    INC BC                              ;4be6  03           11472  11491 
    LD  (SINSX+1),DE                    ;4be7  ed 53 9f 4d  11473  11492 
    LD  (SINSY+1),HL                    ;4beb  22 a6 4d     11474  11493 
    LD  A,(BC)                          ;4bee  0a           11475  11494 
    CP  05Bh                            ;4bef  fe 5b        11476  11495 ;[
    JR  NZ,CIRRST                       ;4bf1  20 13        11477  11496 
    INC BC                              ;4bf3  03           11478  11497 
    CALL    IHLEXP                      ;4bf4  cd cc 22     11479  11498 
    CALL    CH2CH                       ;4bf7  cd 61 2d     11480  11499 
    PUSH    HL                          ;4bfa  e5           11481  11500 
    CALL    IHLEXP                      ;4bfb  cd cc 22     11482  11501 
    CP  05Dh                            ;4bfe  fe 5d        11483  11502 ;]
    JP  NZ,SERROR                       ;4c00  c2 3a 17     11484  11503 
    POP DE                              ;4c03  d1           11485  11504 
    JR  CRRROK                          ;4c04  18 06        11486  11505 
CIRRST: CALL    IHLEXP                  ;4c06  cd cc 22     11487  11506 
    DEC BC                              ;4c09  0b           11488  11507 
    LD  D,H                             ;4c0a  54           11489  11508 
    LD  E,L                             ;4c0b  5d           11490  11509 
CRRROK: LD  (SINRX+1),DE                ;4c0c  ed 53 cc 4d  11491  11510 
    LD  (SINRY+1),HL                    ;4c10  22 d2 4d     11492  11511 
    CALL    EDCEK                       ;4c13  cd 6f 49     11493  11512 
    LD  HL,10                           ;4c16  21 0a 00     11494  11513 
    JR  Z,POLYE1                        ;4c19  28 45        11495  11514 
    CALL    CH2CH                       ;4c1b  cd 61 2d     11496  11515 
    INC BC                              ;4c1e  03           11497  11516 
    CALL    IHLEXP                      ;4c1f  cd cc 22     11498  11517 
    LD  (SIND+1),HL                     ;4c22  22 ba 4c     11499  11518 
    DEC BC                              ;4c25  0b           11500  11519 
    CALL    EDCEK                       ;4c26  cd 6f 49     11501  11520 
    JR  Z,POLYE2                        ;4c29  28 38        11502  11521 
    INC BC                              ;4c2b  03           11503  11522 
    LD  A,(BC)                          ;4c2c  0a           11504  11523 
    CP  02Ch                            ;4c2d  fe 2c        11505  11524 
    LD  A,(COLORF)                      ;4c2f  3a 80 11     11506  11525 
    JR  Z,SKPCOL                        ;4c32  28 09        11507  11526 
    CALL    IBYTE                       ;4c34  cd df 22     11508  11527 
    CP  9                               ;4c37  fe 09        11509  11528 
    JP  NC,IFCALL                       ;4c39  d2 36 17     11510  11529 
    DEC BC                              ;4c3c  0b           11511  11530 
SKPCOL: LD  (GCOLOR),A                  ;4c3d  32 81 11     11512  11531 
    LD  A,(BC)                          ;4c40  0a           11513  11532 
    CALL    EDCEK                       ;4c41  cd 6f 49     11514  11533 
    JR  Z,POLYE3                        ;4c44  28 23        11515  11534 
    CALL    CH2CH                       ;4c46  cd 61 2d     11516  11535 
    INC BC                              ;4c49  03           11517  11536 
    CALL    IHLEXP                      ;4c4a  cd cc 22     11518  11537 
    LD  (SINSTA+1),HL                   ;4c4d  22 a6 4c     11519  11538 
    DEC BC                              ;4c50  0b           11520  11539 
    CALL    EDCEK                       ;4c51  cd 6f 49     11521  11540 
    JR  Z,POLYE4                        ;4c54  28 19        11522  11541 
    CALL    CH2CH                       ;4c56  cd 61 2d     11523  11542 
    INC BC                              ;4c59  03           11524  11543 
    CALL    IHLEXP                      ;4c5a  cd cc 22     11525  11544 
    DEC BC                              ;4c5d  0b           11526  11545 
    JR  POLYE5                          ;4c5e  18 12        11527  11546 
                                        ;                   11528  11547 ;
POLYE1: LD  (SIND+1),HL                 ;4c60  22 ba 4c     11529  11548 
POLYE2: LD  A,(COLORF)                  ;4c63  3a 80 11     11530  11549 
    LD  (GCOLOR),A                      ;4c66  32 81 11     11531  11550 
POLYE3: LD  HL,0                        ;4c69  21 00 00     11532  11551 
    LD  (SINSTA+1),HL                   ;4c6c  22 a6 4c     11533  11552 
POLYE4: LD  HL,360                      ;4c6f  21 68 01     11534  11553 
POLYE5: LD  (SINEND+1),HL               ;4c72  22 c3 4c     11535  11554 
    PUSH    BC                          ;4c75  c5           11536  11555 
    LD  HL,LINESB                       ;4c76  21 7d 4a     11537  11556 
    LD  (LNBOXF+1),HL                   ;4c79  22 7b 4a     11538  11557 
    LD  HL,PSETSB                       ;4c7c  21 0c 48     11539  11558 
    LD  (LINEMD+1),HL                   ;4c7f  22 b9 4a     11540  11559 
    LD  HL,(SIND+1)                     ;4c82  2a ba 4c     11541  11560 
    LD  A,H                             ;4c85  7c           11542  11561 
    OR  L                               ;4c86  b5           11543  11562 
    JR  Z,POLYLN                        ;4c87  28 05        11544  11563 
    CALL    SINSTA                      ;4c89  cd a5 4c     11545  11564 
    POP HL                              ;4c8c  e1           11546  11565 
    RET                                 ;4c8d  c9           11547  11566 
POLYLN: LD  HL,(SINSX+1)                ;4c8e  2a 9f 4d     11548  11567 
    LD  (LINEXS+1),HL                   ;4c91  22 40 4a     11549  11568 
    LD  HL,(SINSY+1)                    ;4c94  2a a6 4d     11550  11569 
    LD  (LINEYS+1),HL                   ;4c97  22 5d 4a     11551  11570 
    LD  HL,(SINSTA+1)                   ;4c9a  2a a6 4c     11552  11571 
    CALL    SINXYS                      ;4c9d  cd d5 4c     11553  11572 
    CALL    LINES1                      ;4ca0  cd 2b 4a     11554  11573 
    POP HL                              ;4ca3  e1           11555  11574 
    RET                                 ;4ca4  c9           11556  11575 
                                        ;                   11557  11576 ;
SINSTA: LD  HL,0                        ;4ca5  21 00 00     11558  11577 ;DEG START
    PUSH    HL                          ;4ca8  e5           11559  11578 
    CALL    SINXYS                      ;4ca9  cd d5 4c     11560  11579 
CIRCLP: LD  HL,(LINEXE+1)               ;4cac  2a 45 4a     11561  11580 
    LD  (LINEXS+1),HL                   ;4caf  22 40 4a     11562  11581 
    LD  HL,(LINEYE+1)                   ;4cb2  2a 62 4a     11563  11582 
    LD  (LINEYS+1),HL                   ;4cb5  22 5d 4a     11564  11583 
    POP HL                              ;4cb8  e1           11565  11584 
SIND:   LD  BC,00001h                   ;4cb9  01 01 00     11566  11585 ;DEG STEP
    ADD HL,BC                           ;4cbc  09           11567  11586 
    PUSH    HL                          ;4cbd  e5           11568  11587 
    LD  BC,08000h                       ;4cbe  01 00 80     11569  11588 
    ADD HL,BC                           ;4cc1  09           11570  11589 
SINEND: LD  DE,360                      ;4cc2  11 68 01     11571  11590 ;DEG END
    EX  DE,HL                           ;4cc5  eb           11572  11591 
    ADD HL,BC                           ;4cc6  09           11573  11592 
    OR  A                               ;4cc7  b7           11574  11593 
    SBC HL,DE                           ;4cc8  ed 52        11575  11594 
    POP HL                              ;4cca  e1           11576  11595 
    RET C                               ;4ccb  d8           11577  11596 
    PUSH    HL                          ;4ccc  e5           11578  11597 
    CALL    SINXYS                      ;4ccd  cd d5 4c     11579  11598 
    CALL    LINES1                      ;4cd0  cd 2b 4a     11580  11599 
    JR  CIRCLP                          ;4cd3  18 d7        11581  11600 
                                        ;                   11582  11601 ;
SINXYS: BIT 7,H                         ;4cd5  cb 7c        11583  11602 ;HL=DEG
    JR  Z,SIN!                          ;4cd7  28 08        11584  11603 
    LD  DE,360                          ;4cd9  11 68 01     11585  11604 
L38C6:  ADD HL,DE                       ;4cdc  19           11586  11605 
    JR  NC,L38C6                        ;4cdd  30 fd        11587  11606 
    JR  SINOK                           ;4cdf  18 0a        11588  11607 
SIN!:   LD  DE,0FE98h                   ;4ce1  11 98 fe     11589  11608 ;-360
L38CE:  ADD HL,DE                       ;4ce4  19           11590  11609 
    JR  C,L38CE                         ;4ce5  38 fd        11591  11610 
    LD  DE,360                          ;4ce7  11 68 01     11592  11611 
    ADD HL,DE                           ;4cea  19           11593  11612 
SINOK:  LD  A,H                         ;4ceb  7c           11594  11613 
    OR  L                               ;4cec  b5           11595  11614 
    JP  Z,SIN00                         ;4ced  ca 7a 4d     11596  11615 
    LD  DE,1                            ;4cf0  11 01 00     11597  11616 
    LD  BC,90                           ;4cf3  01 5a 00     11598  11617 
    SBC HL,BC                           ;4cf6  ed 42        11599  11618 
    JP  Z,SIN90                         ;4cf8  ca 7f 4d     11600  11619 
    JR  C,SIN45                         ;4cfb  38 13        11601  11620 
    SBC HL,BC                           ;4cfd  ed 42        11602  11621 
    JP  Z,SIN180                        ;4cff  ca 84 4d     11603  11622 
    JR  C,SIN135                        ;4d02  38 14        11604  11623 
    SBC HL,BC                           ;4d04  ed 42        11605  11624 
    JP  Z,SIN270                        ;4d06  ca 89 4d     11606  11625 
    JR  C,SIN225                        ;4d09  38 13        11607  11626 
    LD  BC,00000h                       ;4d0b  01 00 00     11608  11627 ;X>0,Y>0
    JR  SINOK1                          ;4d0e  18 14        11609  11628 
SIN45:  EX  DE,HL                       ;4d10  eb           11610  11629 ;0-90
    SBC HL,DE                           ;4d11  ed 52        11611  11630 
    LD  BC,000FFh                       ;4d13  01 ff 00     11612  11631 ;X>0,Y<0
    JR  SINOK1                          ;4d16  18 0c        11613  11632 
SIN135: ADD HL,BC                       ;4d18  09           11614  11633 ;180-90
    LD  BC,0FFFFh                       ;4d19  01 ff ff     11615  11634 ;X<0,Y<0
    JR  SINOK1                          ;4d1c  18 06        11616  11635 
SIN225: EX  DE,HL                       ;4d1e  eb           11617  11636 
    SBC HL,DE                           ;4d1f  ed 52        11618  11637 
    LD  BC,0FF00h                       ;4d21  01 00 ff     11619  11638 ;X<0,Y>0
SINOK1: ADD HL,HL                       ;4d24  29           11620  11639 
    EX  DE,HL                           ;4d25  eb           11621  11640 
    LD  A,B                             ;4d26  78           11622  11641 
    LD  (XMULHI+1),A                    ;4d27  32 5d 4d     11623  11642 
    LD  A,C                             ;4d2a  79           11624  11643 
    LD  (YMULHI+1),A                    ;4d2b  32 6b 4d     11625  11644 
    LD  HL,SINTBL                       ;4d2e  21 0b 4e     11626  11645 
    ADD HL,DE                           ;4d31  19           11627  11646 
    LD  A,(HL)                          ;4d32  7e           11628  11647 
    INC HL                              ;4d33  23           11629  11648 
    LD  H,(HL)                          ;4d34  66           11630  11649 
    LD  L,A                             ;4d35  6f           11631  11650 
    INC B                               ;4d36  04           11632  11651 
    JR  NZ,SINXOK                       ;4d37  20 08        11633  11652 
    PUSH    DE                          ;4d39  d5           11634  11653 
    LD  DE,0                            ;4d3a  11 00 00     11635  11654 
    EX  DE,HL                           ;4d3d  eb           11636  11655 
    SBC HL,DE                           ;4d3e  ed 52        11637  11656 
    POP DE                              ;4d40  d1           11638  11657 
SINXOK: LD  (XMULLO+1),HL               ;4d41  22 61 4d     11639  11658 
    LD  HL,COSTBL                       ;4d44  21 bf 4e     11640  11659 
    OR  A                               ;4d47  b7           11641  11660 
    SBC HL,DE                           ;4d48  ed 52        11642  11661 
    LD  A,(HL)                          ;4d4a  7e           11643  11662 
    INC HL                              ;4d4b  23           11644  11663 
    LD  H,(HL)                          ;4d4c  66           11645  11664 
    LD  L,A                             ;4d4d  6f           11646  11665 
    INC C                               ;4d4e  0c           11647  11666 
    JR  NZ,SINYOK                       ;4d4f  20 08        11648  11667 
    PUSH    DE                          ;4d51  d5           11649  11668 
    LD  DE,0                            ;4d52  11 00 00     11650  11669 
    EX  DE,HL                           ;4d55  eb           11651  11670 
    SBC HL,DE                           ;4d56  ed 52        11652  11671 
    POP DE                              ;4d58  d1           11653  11672 
SINYOK: LD  (YMULLO+1),HL               ;4d59  22 6f 4d     11654  11673 
XMULHI: LD  L,0                         ;4d5c  2e 00        11655  11674 
    LD  H,L                             ;4d5e  65           11656  11675 
    EXX                                 ;4d5f  d9           11657  11676 
XMULLO: LD  HL,0                        ;4d60  21 00 00     11658  11677 
    EXX                                 ;4d63  d9           11659  11678 
    CALL    DEHLMX                      ;4d64  cd ca 4d     11660  11679 
    LD  (SINXAD+1),HL                   ;4d67  22 9b 4d     11661  11680 
YMULHI: LD  L,0                         ;4d6a  2e 00        11662  11681 
    LD  H,L                             ;4d6c  65           11663  11682 
    EXX                                 ;4d6d  d9           11664  11683 
YMULLO: LD  HL,0                        ;4d6e  21 00 00     11665  11684 
    EXX                                 ;4d71  d9           11666  11685 
    CALL    DEHLMY                      ;4d72  cd d0 4d     11667  11686 
    LD  (SINYAD+1),HL                   ;4d75  22 a9 4d     11668  11687 
    JR  SINXAD                          ;4d78  18 20        11669  11688 
SIN00:  LD  BC,00100H                   ;4d7a  01 00 01     11670  11689 ;X=1,Y=0
    JR  SINJST                          ;4d7d  18 0d        11671  11690 
SIN90:  LD  BC,000FFh                   ;4d7f  01 ff 00     11672  11691 ;X=0,Y=-1
    JR  SINJST                          ;4d82  18 08        11673  11692 
SIN180: LD  BC,0FF00h                   ;4d84  01 00 ff     11674  11693 ;X=0,Y=0
    JR  SINJST                          ;4d87  18 03        11675  11694 
SIN270: LD  BC,00001h                   ;4d89  01 01 00     11676  11695 ;X=0,Y=1
SINJST: LD  A,B                         ;4d8c  78           11677  11696 
    CALL    RMULAX                      ;4d8d  cd bb 4d     11678  11697 
    LD  (SINXAD+1),HL                   ;4d90  22 9b 4d     11679  11698 
    LD  A,C                             ;4d93  79           11680  11699 
    CALL    RMULAY                      ;4d94  cd b0 4d     11681  11700 
    LD  (SINYAD+1),HL                   ;4d97  22 a9 4d     11682  11701 
SINXAD: LD  HL,00000h                   ;4d9a  21 00 00     11683  11702 ;ADD X
WIDTH3: NOP                             ;4d9d  00           11684  11703 ;40/ADD HL,HL
SINSX:                                  ;                   11685  11704 
    LD  DE,00000h                       ;4d9e  11 00 00     11686  11705 ;CENTER X
    ADD HL,DE                           ;4da1  19           11687  11706 
    LD  (LINEXE+1),HL                   ;4da2  22 45 4a     11688  11707 
SINSY:  LD  HL,00000h                   ;4da5  21 00 00     11689  11708 ;CENTER Y
SINYAD: LD  DE,00000h                   ;4da8  11 00 00     11690  11709 ;ADD Y
    ADD HL,DE                           ;4dab  19           11691  11710 
    LD  (LINEYE+1),HL                   ;4dac  22 62 4a     11692  11711 
    RET                                 ;4daf  c9           11693  11712 
                                        ;                   11694  11713 ;
RMULAY: LD  HL,0                        ;4db0  21 00 00     11695  11714 
    OR  A                               ;4db3  b7           11696  11715 
    RET Z                               ;4db4  c8           11697  11716 
    EX  DE,HL                           ;4db5  eb           11698  11717 
    LD  HL,(SINRY+1)                    ;4db6  2a d2 4d     11699  11718 
    JR  RMULXY                          ;4db9  18 09        11700  11719 
RMULAX: LD  HL,0                        ;4dbb  21 00 00     11701  11720 
    OR  A                               ;4dbe  b7           11702  11721 
    RET Z                               ;4dbf  c8           11703  11722 
    EX  DE,HL                           ;4dc0  eb           11704  11723 
    LD  HL,(SINRX+1)                    ;4dc1  2a cc 4d     11705  11724 
RMULXY: INC A                           ;4dc4  3c           11706  11725 
    RET NZ                              ;4dc5  c0           11707  11726 
    EX  DE,HL                           ;4dc6  eb           11708  11727 
    SBC HL,DE                           ;4dc7  ed 52        11709  11728 
    RET                                 ;4dc9  c9           11710  11729 
                                        ;                   11711  11730 ;
DEHLMX: EXX                             ;4dca  d9           11712  11731 
SINRX:  LD  BC,00001h                   ;4dcb  01 01 00     11713  11732 ;XR
    JR  DEHLMS                          ;4dce  18 04        11714  11733 
DEHLMY: EXX                             ;4dd0  d9           11715  11734 
SINRY:  LD  BC,00001h                   ;4dd1  01 01 00     11716  11735 ;YR
DEHLMS: LD  DE,0                        ;4dd4  11 00 00     11717  11736 
    EXX                                 ;4dd7  d9           11718  11737 
    LD  B,16                            ;4dd8  06 10        11719  11738 
    LD  DE,0                            ;4dda  11 00 00     11720  11739 
MULOP1: EXX                             ;4ddd  d9           11721  11740 
    EX  DE,HL                           ;4dde  eb           11722  11741 
    ADD HL,HL                           ;4ddf  29           11723  11742 
    EX  DE,HL                           ;4de0  eb           11724  11743 
    EXX                                 ;4de1  d9           11725  11744 
    EX  DE,HL                           ;4de2  eb           11726  11745 
    ADC HL,HL                           ;4de3  ed 6a        11727  11746 
    EX  DE,HL                           ;4de5  eb           11728  11747 
    EXX                                 ;4de6  d9           11729  11748 
    SLA C                               ;4de7  cb 21        11730  11749 
    RL  B                               ;4de9  cb 10        11731  11750 
    JR  NC,MULOP2                       ;4deb  30 09        11732  11751 
    EX  DE,HL                           ;4ded  eb           11733  11752 
    ADD HL,DE                           ;4dee  19           11734  11753 
    EX  DE,HL                           ;4def  eb           11735  11754 
    EXX                                 ;4df0  d9           11736  11755 
    EX  DE,HL                           ;4df1  eb           11737  11756 
    ADC HL,DE                           ;4df2  ed 5a        11738  11757 
    EX  DE,HL                           ;4df4  eb           11739  11758 
    EXX                                 ;4df5  d9           11740  11759 
MULOP2: EXX                             ;4df6  d9           11741  11760 
    DJNZ    MULOP1                      ;4df7  10 e4        11742  11761 
    LD  A,080h                          ;4df9  3e 80        11743  11762 
    BIT 7,D                             ;4dfb  cb 7a        11744  11763 
    EXX                                 ;4dfd  d9           11745  11764 
    JR  Z,MULOP3                        ;4dfe  28 01        11746  11765 
    CPL                                 ;4e00  2f           11747  11766 
MULOP3: LD  H,A                         ;4e01  67           11748  11767 
    LD  L,A                             ;4e02  6f           11749  11768 
    ADD HL,DE                           ;4e03  19           11750  11769 
    EXX                                 ;4e04  d9           11751  11770 
    LD  HL,0                            ;4e05  21 00 00     11752  11771 
    ADC HL,DE                           ;4e08  ed 5a        11753  11772 
    RET                                 ;4e0a  c9           11754  11773 
                                        ;                   11755  11774 ;
SINTBL: DEFW    0                       ;4e0b  00 00        11756  11775 
    DEFW    00478H                      ;4e0d  78 04        11757  11776 
    DEFW    008F0H                      ;4e0f  f0 08        11758  11777 
    DEFW    00D66H                      ;4e11  66 0d        11759  11778 
    DEFW    011DCH                      ;4e13  dc 11        11760  11779 
    DEFW    01650H                      ;4e15  50 16        11761  11780 
    DEFW    01AC3H                      ;4e17  c3 1a        11762  11781 
    DEFW    01F33H                      ;4e19  33 1f        11763  11782 
    DEFW    023A1H                      ;4e1b  a1 23        11764  11783 
    DEFW    0280CH                      ;4e1d  0c 28        11765  11784 
    DEFW    02C75H                      ;4e1f  75 2c        11766  11785 
    DEFW    030D9H                      ;4e21  d9 30        11767  11786 
    DEFW    0353AH                      ;4e23  3a 35        11768  11787 
    DEFW    03997H                      ;4e25  97 39        11769  11788 
    DEFW    03DEFH                      ;4e27  ef 3d        11770  11789 
    DEFW    04242H                      ;4e29  42 42        11771  11790 
    DEFW    04691H                      ;4e2b  91 46        11772  11791 
    DEFW    04AD9H                      ;4e2d  d9 4a        11773  11792 
    DEFW    04F1CH                      ;4e2f  1c 4f        11774  11793 
    DEFW    05359H                      ;4e31  59 53        11775  11794 
    DEFW    0578FH                      ;4e33  8f 57        11776  11795 
    DEFW    05BBEH                      ;4e35  be 5b        11777  11796 
    DEFW    05FE7H                      ;4e37  e7 5f        11778  11797 
    DEFW    06407H                      ;4e39  07 64        11779  11798 
    DEFW    06820H                      ;4e3b  20 68        11780  11799 
    DEFW    06C2FH                      ;4e3d  2f 6c        11781  11800 
    DEFW    07039H                      ;4e3f  39 70        11782  11801 
    DEFW    07439H                      ;4e41  39 74        11783  11802 
    DEFW    07830H                      ;4e43  30 78        11784  11803 
    DEFW    07C1DH                      ;4e45  1d 7c        11785  11804 
    DEFW    08000H                      ;4e47  00 80        11786  11805 
    DEFW    083DAH                      ;4e49  da 83        11787  11806 
    DEFW    087A9H                      ;4e4b  a9 87        11788  11807 
    DEFW    08B6EH                      ;4e4d  6e 8b        11789  11808 
    DEFW    08F28H                      ;4e4f  28 8f        11790  11809 
    DEFW    092D6H                      ;4e51  d6 92        11791  11810 
    DEFW    09679H                      ;4e53  79 96        11792  11811 
    DEFW    09A11H                      ;4e55  11 9a        11793  11812 
    DEFW    09D9CH                      ;4e57  9c 9d        11794  11813 
    DEFW    0A11BH                      ;4e59  1b a1        11795  11814 
    DEFW    0A48EH                      ;4e5b  8e a4        11796  11815 
    DEFW    0A7F4H                      ;4e5d  f4 a7        11797  11816 
    DEFW    0AB4CH                      ;4e5f  4c ab        11798  11817 
    DEFW    0AE98H                      ;4e61  98 ae        11799  11818 
    DEFW    0B1F0H                      ;4e63  f0 b1        11800  11819 
    DEFW    0B58BH                      ;4e65  8b b5        11801  11820 
    DEFW    0B840H                      ;4e67  40 b8        11802  11821 
    DEFW    0BB50H                      ;4e69  50 bb        11803  11822 
    DEFW    0BE3FH                      ;4e6b  3f be        11804  11823 
    DEFW    0C135H                      ;4e6d  35 c1        11805  11824 
    DEFW    0C41CH                      ;4e6f  1c c4        11806  11825 
    DEFW    0C6F3H                      ;4e71  f3 c6        11807  11826 
    DEFW    0C9BBH                      ;4e73  bb c9        11808  11827 
    DEFW    0CC74H                      ;4e75  74 cc        11809  11828 
    DEFW    0CF1CH                      ;4e77  1c cf        11810  11829 
    DEFW    0D1B4H                      ;4e79  b4 d1        11811  11830 
    DEFW    0D43CH                      ;4e7b  3c d4        11812  11831 
    DEFW    0D6B3H                      ;4e7d  b3 d6        11813  11832 
    DEFW    0D91AH                      ;4e7f  1a d9        11814  11833 
    DEFW    0DB70H                      ;4e81  70 db        11815  11834 
    DEFW    0DDB4H                      ;4e83  b4 dd        11816  11835 
    DEFW    0DF40H                      ;4e85  40 df        11817  11836 
    DEFW    0E1E0H                      ;4e87  e0 e1        11818  11837 
    DEFW    0E497H                      ;4e89  97 e4        11819  11838 
    DEFW    0E61BH                      ;4e8b  1b e6        11820  11839 
    DEFW    0E804H                      ;4e8d  04 e8        11821  11840 
    DEFW    0E9DEH                      ;4e8f  de e9        11822  11841 
    DEFW    0EBA7H                      ;4e91  a7 eb        11823  11842 
    DEFW    0ED5CH                      ;4e93  5c ed        11824  11843 
    DEFW    0EEFFH                      ;4e95  ff ee        11825  11844 
    DEFW    0F090H                      ;4e97  90 f0        11826  11845 
    DEFW    0F20EH                      ;4e99  0e f2        11827  11846 
    DEFW    0F379H                      ;4e9b  79 f3        11828  11847 
    DEFW    0F4D1H                      ;4e9d  d1 f4        11829  11848 
    DEFW    0F616H                      ;4e9f  16 f6        11830  11849 
    DEFW    0F747H                      ;4ea1  47 f7        11831  11850 
    DEFW    0F866H                      ;4ea3  66 f8        11832  11851 
    DEFW    0F971H                      ;4ea5  71 f9        11833  11852 
    DEFW    0FA68H                      ;4ea7  68 fa        11834  11853 
    DEFW    0FB4CH                      ;4ea9  4c fb        11835  11854 
    DEFW    0FC1DH                      ;4eab  1d fc        11836  11855 
    DEFW    0FCD9H                      ;4ead  d9 fc        11837  11856 
    DEFW    0FD83H                      ;4eaf  83 fd        11838  11857 
    DEFW    0FE18H                      ;4eb1  18 fe        11839  11858 
    DEFW    0FE99H                      ;4eb3  99 fe        11840  11859 
    DEFW    0FF07H                      ;4eb5  07 ff        11841  11860 
    DEFW    0FF61H                      ;4eb7  61 ff        11842  11861 
    DEFW    0FFA7H                      ;4eb9  a7 ff        11843  11862 
    DEFW    0FFD8H                      ;4ebb  d8 ff        11844  11863 
    DEFW    0FFF6H                      ;4ebd  f6 ff        11845  11864 
COSTBL: DEFW    0                       ;4ebf  00 00        11846  11865 
                                        ;                   11847  11866 ;
PAINT:  LD  C,L                         ;4ec1  4d           11848  11867 
    LD  B,H                             ;4ec2  44           11849  11868 
    CALL    SETXY2                      ;4ec3  cd 61 49     11850  11869 
    PUSH    HL                          ;4ec6  e5           11851  11870 ;Y
    PUSH    DE                          ;4ec7  d5           11852  11871 ;X
    LD  HL,PACOLB                       ;4ec8  21 1f 50     11853  11872 
    LD  D,9                             ;4ecb  16 09        11854  11873 
    LD  A,(COLORF)                      ;4ecd  3a 80 11     11855  11874 
    LD  (HL),A                          ;4ed0  77           11856  11875 
    CALL    PACOLS                      ;4ed1  cd 03 4f     11857  11876 
    LD  HL,PACOLB                       ;4ed4  21 1f 50     11858  11877 
    LD  E,8                             ;4ed7  1e 08        11859  11878 
    LD  A,(HL)                          ;4ed9  7e           11860  11879 
PACINT: INC HL                          ;4eda  23           11861  11880 
    LD  (HL),A                          ;4edb  77           11862  11881 
    DEC E                               ;4edc  1d           11863  11882 
    JR  NZ,PACINT                       ;4edd  20 fb        11864  11883 
    LD  HL,PACOLB+1                     ;4edf  21 20 50     11865  11884 
    JR  L3AD1                           ;4ee2  18 03        11866  11885 
PACOSL: CALL    PACOLS                  ;4ee4  cd 03 4f     11867  11886 
L3AD1:  DEC D                           ;4ee7  15           11868  11887 
    JR  NZ,PACOSL                       ;4ee8  20 fa        11869  11888 
    LD  HL,PSETSB                       ;4eea  21 0c 48     11870  11889 
    LD  (BOXMD+1),HL                    ;4eed  22 4f 4b     11871  11890 
    LD  A,013h                          ;4ef0  3e 13        11872  11891 
    LD  (XBOXAD),A                      ;4ef2  32 55 4b     11873  11892 
    LD  A,(PACOLB)                      ;4ef5  3a 1f 50     11874  11893 
    LD  (GCOLOR),A                      ;4ef8  32 81 11     11875  11894 
    POP DE                              ;4efb  d1           11876  11895 
    POP HL                              ;4efc  e1           11877  11896 
    PUSH    BC                          ;4efd  c5           11878  11897 
    CALL    PAINTS                      ;4efe  cd 1f 4f     11879  11898 
    POP HL                              ;4f01  e1           11880  11899 
    RET                                 ;4f02  c9           11881  11900 
                                        ;                   11882  11901 ;
PACOLS: CALL    EDCEK                   ;4f03  cd 6f 49     11883  11902 
    JR  Z,PACEND                        ;4f06  28 14        11884  11903 
    CALL    CH2CH                       ;4f08  cd 61 2d     11885  11904 
    INC BC                              ;4f0b  03           11886  11905 
    PUSH    DE                          ;4f0c  d5           11887  11906 
    PUSH    HL                          ;4f0d  e5           11888  11907 
    CALL    IBYTE                       ;4f0e  cd df 22     11889  11908 
    POP HL                              ;4f11  e1           11890  11909 
    POP DE                              ;4f12  d1           11891  11910 
    CP  9                               ;4f13  fe 09        11892  11911 
    JP  NC,IFCALL                       ;4f15  d2 36 17     11893  11912 
    LD  (HL),A                          ;4f18  77           11894  11913 
    INC HL                              ;4f19  23           11895  11914 
    DEC BC                              ;4f1a  0b           11896  11915 
    RET                                 ;4f1b  c9           11897  11916 
PACEND: LD  D,1                         ;4f1c  16 01        11898  11917 
    RET                                 ;4f1e  c9           11899  11918 
                                        ;                   11900  11919 ;
                                        ;                   11901  11920 ;
PAINTS: LD  BC,08000h                   ;4f1f  01 00 80     11902  11921 
    PUSH    BC                          ;4f22  c5           11903  11922 
    PUSH    HL                          ;4f23  e5           11904  11923 
    PUSH    DE                          ;4f24  d5           11905  11924 
                                        ;                   11906  11925 ;
PAIN01: POP DE                          ;4f25  d1           11907  11926 
    POP HL                              ;4f26  e1           11908  11927 
    XOR A                               ;4f27  af           11909  11928 
    CP  E                               ;4f28  bb           11910  11929 
    JR  NZ,PAIN02                       ;4f29  20 06        11911  11930 
    LD  A,080h                          ;4f2b  3e 80        11912  11931 
    CP  D                               ;4f2d  ba           11913  11932 
    JR  NZ,PAIN02                       ;4f2e  20 01        11914  11933 
    JP  (HL)                            ;4f30  e9           11915  11934 
                                        ;                   11916  11935 ;
PAIN02: CALL    POICEK                  ;4f31  cd 87 4f     11917  11936 
    JP  Z,PAIN01                        ;4f34  ca 25 4f     11918  11937 
PAIN03: DEC DE                          ;4f37  1b           11919  11938 ;X=X-1
    CALL    POICEK                      ;4f38  cd 87 4f     11920  11939 
    JR  NZ,PAIN03                       ;4f3b  20 fa        11921  11940 
    INC DE                              ;4f3d  13           11922  11941 
    LD  BC,00000h                       ;4f3e  01 00 00     11923  11942 ;FLG CLR
    PUSH    DE                          ;4f41  d5           11924  11943 
    EXX                                 ;4f42  d9           11925  11944 
    POP DE                              ;4f43  d1           11926  11945 ;DE'=STERT X (START의 오타?)
    EXX                                 ;4f44  d9           11927  11946 
PAIN11: CALL    POICEK                  ;4f45  cd 87 4f     11928  11947 
    JR  Z,PAIN04                        ;4f48  28 2d        11929  11948 
    DEC HL                              ;4f4a  2b           11930  11949 ;UP LINE CHECK
    CALL    POICEK                      ;4f4b  cd 87 4f     11931  11950 
    JR  Z,PAIN05                        ;4f4e  28 0c        11932  11951 
    DEC B                               ;4f50  05           11933  11952 
    JR  Z,PAIN06                        ;4f51  28 05        11934  11953 
    PUSH    HL                          ;4f53  e5           11935  11954 ;NEXT POINT SET
    PUSH    DE                          ;4f54  d5           11936  11955 
    CALL    MEMCHK                      ;4f55  cd b0 1e     11937  11956 ;SP CHK
PAIN06: LD  B,1                         ;4f58  06 01        11938  11957 ;UP FLAG SET
    JR  PAIN07                          ;4f5a  18 02        11939  11958 
PAIN05: LD  B,0                         ;4f5c  06 00        11940  11959 ;UP FLAG CLR
PAIN07: INC HL                          ;4f5e  23           11941  11960 ;
    INC HL                              ;4f5f  23           11942  11961 ;DOUN LINE CHECK (DOWN의 오타?)
    CALL    POICEK                      ;4f60  cd 87 4f     11943  11962 
    JR  Z,PAIN08                        ;4f63  28 0c        11944  11963 
    DEC C                               ;4f65  0d           11945  11964 
    JR  Z,PAIN09                        ;4f66  28 05        11946  11965 
    PUSH    HL                          ;4f68  e5           11947  11966 ;NEXT POINT SET
    PUSH    DE                          ;4f69  d5           11948  11967 
    CALL    MEMCHK                      ;4f6a  cd b0 1e     11949  11968 ;SP CHK
PAIN09: LD  C,1                         ;4f6d  0e 01        11950  11969 ;DOUN FLG SET
    JR  PAIN10                          ;4f6f  18 02        11951  11970 
PAIN08: LD  C,0                         ;4f71  0e 00        11952  11971 ;DOUN FLG CLR
PAIN10: DEC HL                          ;4f73  2b           11953  11972 
    INC DE                              ;4f74  13           11954  11973 ;X=X+1
    JR  PAIN11                          ;4f75  18 ce        11955  11974 
                                        ;                   11956  11975 ;
PAIN04: PUSH    HL                      ;4f77  e5           11957  11976 
    PUSH    DE                          ;4f78  d5           11958  11977 
    EXX                                 ;4f79  d9           11959  11978 
    POP HL                              ;4f7a  e1           11960  11979 
    OR  A                               ;4f7b  b7           11961  11980 
    SBC HL,DE                           ;4f7c  ed 52        11962  11981 
    LD  C,L                             ;4f7e  4d           11963  11982 
    LD  B,H                             ;4f7f  44           11964  11983 
    POP HL                              ;4f80  e1           11965  11984 
    CALL    LINEX                       ;4f81  cd 56 4b     11966  11985 
    JP  PAIN01                          ;4f84  c3 25 4f     11967  11986 
                                        ;                   11968  11987 ;
POICEK: PUSH    BC                      ;4f87  c5           11969  11988 
    PUSH    DE                          ;4f88  d5           11970  11989 
    PUSH    HL                          ;4f89  e5           11971  11990 
    CALL    CULADR                      ;4f8a  cd 23 48     11972  11991 
    JR  C,POIZER                        ;4f8d  38 0a        11973  11992 
    EX  DE,HL                           ;4f8f  eb           11974  11993 
    LD  BC,POITBL                       ;4f90  01 9e 4f     11975  11994 
    ADD HL,BC                           ;4f93  09           11976  11995 
    LD  C,(HL)                          ;4f94  4e           11977  11996 
    INC HL                              ;4f95  23           11978  11997 
    LD  B,(HL)                          ;4f96  46           11979  11998 
    PUSH    BC                          ;4f97  c5           11980  11999 
    RET                                 ;4f98  c9           11981  12000 
                                        ;                   11982  12001 ;
POIZER: XOR A                           ;4f99  af           11983  12002 
POINRT: POP HL                          ;4f9a  e1           11984  12003 
    POP DE                              ;4f9b  d1           11985  12004 
    POP BC                              ;4f9c  c1           11986  12005 
    RET                                 ;4f9d  c9           11987  12006 
                                        ;                   11988  12007 ;
POITBL: DEFW    POIST0                  ;4f9e  a6 4f        11989  12008 
    DEFW    POIST1                      ;4fa0  cf 4f        11990  12009 
    DEFW    POIST3                      ;4fa2  f4 4f        11991  12010 
    DEFW    POIST5                      ;4fa4  0c 50        11992  12011 
                                        ;                   11993  12012 ;
POIST0: LD  C,E                         ;4fa6  4b           11994  12013 
    LD  B,D                             ;4fa7  42           11995  12014 
    IN  E,(C)                           ;4fa8  ed 58        11996  12015 
    RLCA                                ;4faa  07           11997  12016 
    RLCA                                ;4fab  07           11998  12017 
    RLCA                                ;4fac  07           11999  12018 
    AND 038h                            ;4fad  e6 38        12000  12019 
    ADD A,043h                          ;4faf  c6 43        12001  12020 
    LD  (BTTST1+1),A                    ;4fb1  32 b6 4f     12002  12021 
    XOR A                               ;4fb4  af           12003  12022 
BTTST1: BIT 0,E                         ;4fb5  cb 43        12004  12023 
    JR  Z,POINCK                        ;4fb7  28 08        12005  12024 
    LD  A,E                             ;4fb9  7b           12006  12025 
    RRCA                                ;4fba  0f           12007  12026 
    RRCA                                ;4fbb  0f           12008  12027 
    RRCA                                ;4fbc  0f           12009  12028 
    RRCA                                ;4fbd  0f           12010  12029 
    AND 00Fh                            ;4fbe  e6 0f        12011  12030 
    INC A                               ;4fc0  3c           12012  12031 
POINCK: LD  HL,PACOLB                   ;4fc1  21 1f 50     12013  12032 
    LD  B,9                             ;4fc4  06 09        12014  12033 
POINC1: CP  (HL)                        ;4fc6  be           12015  12034 
    JR  Z,POICKR                        ;4fc7  28 03        12016  12035 
    INC HL                              ;4fc9  23           12017  12036 
    DJNZ    POINC1                      ;4fca  10 fa        12018  12037 
POICKR: JP  POINRT                      ;4fcc  c3 9a 4f     12019  12038 
                                        ;                   12020  12039 ;
POIST1: LD  C,E                         ;4fcf  4b           12021  12040 
    LD  B,D                             ;4fd0  42           12022  12041 
    IN  E,(C)                           ;4fd1  ed 58        12023  12042 
    RLCA                                ;4fd3  07           12024  12043 
    RLCA                                ;4fd4  07           12025  12044 
    RLCA                                ;4fd5  07           12026  12045 
    AND 038h                            ;4fd6  e6 38        12027  12046 
    ADD A,043h                          ;4fd8  c6 43        12028  12047 
    LD  (BTTST2+1),A                    ;4fda  32 df 4f     12029  12048 
    XOR A                               ;4fdd  af           12030  12049 
BTTST2: BIT 0,E                         ;4fde  cb 43        12031  12050 
    JR  Z,POINCK                        ;4fe0  28 df        12032  12051 
    LD  A,E                             ;4fe2  7b           12033  12052 
    RLCA                                ;4fe3  07           12034  12053 
    RLCA                                ;4fe4  07           12035  12054 
    AND 3                               ;4fe5  e6 03        12036  12055 
    INC A                               ;4fe7  3c           12037  12056 
    SET 3,B                             ;4fe8  cb d8        12038  12057 
    IN  D,(C)                           ;4fea  ed 50        12039  12058 
    BIT 1,D                             ;4fec  cb 4a        12040  12059 
    JR  Z,POINCK                        ;4fee  28 d1        12041  12060 
    ADD A,4                             ;4ff0  c6 04        12042  12061 
    JR  POINCK                          ;4ff2  18 cd        12043  12062 
                                        ;                   12044  12063 ;
POIST3: LD  C,E                         ;4ff4  4b           12045  12064 
    LD  B,D                             ;4ff5  42           12046  12065 
    IN  E,(C)                           ;4ff6  ed 58        12047  12066 
    AND 3                               ;4ff8  e6 03        12048  12067 
    JR  Z,POIS33                        ;4ffa  28 07        12049  12068 
POIS3L: RL  E                           ;4ffc  cb 13        12050  12069 
    RL  E                               ;4ffe  cb 13        12051  12070 
    DEC A                               ;5000  3d           12052  12071 
    JR  NZ,POIS3L                       ;5001  20 f9        12053  12072 
POIS33: XOR A                           ;5003  af           12054  12073 
    RL  E                               ;5004  cb 13        12055  12074 
    RLA                                 ;5006  17           12056  12075 
    RL  E                               ;5007  cb 13        12057  12076 
    RLA                                 ;5009  17           12058  12077 
    JR  POINCK                          ;500a  18 b5        12059  12078 
                                        ;                   12060  12079 ;
POIST5: LD  C,E                         ;500c  4b           12061  12080 
    LD  B,D                             ;500d  42           12062  12081 
    IN  E,(C)                           ;500e  ed 58        12063  12082 
    AND 7                               ;5010  e6 07        12064  12083 
    JR  Z,POIS55                        ;5012  28 05        12065  12084 
POIS5L: RL  E                           ;5014  cb 13        12066  12085 
    DEC A                               ;5016  3d           12067  12086 
    JR  NZ,POIS5L                       ;5017  20 fb        12068  12087 
POIS55: XOR A                           ;5019  af           12069  12088 
    RL  E                               ;501a  cb 13        12070  12089 
    RLA                                 ;501c  17           12071  12090 
    JR  POINCK                          ;501d  18 a2        12072  12091 
                                        ;                   12073  12092 ;
                                        ;                   12074  12093 ;
PACOLB: DEFS    9                       ;501f               12075  12094 
                                        ;                   12076  12095 ;
PATTEN: LD  A,(GMODEF)                  ;5028  3a 06 1c     12077  12096 
    CP  4                               ;502b  fe 04        12078  12097 
    JP  C,IFCALL                        ;502d  da 36 17     12079  12098 
    LD  C,L                             ;5030  4d           12080  12099 
    LD  B,H                             ;5031  44           12081  12100 
    CALL    SETXY2                      ;5032  cd 61 49     12082  12101 
    CALL    CH2CH                       ;5035  cd 61 2d     12083  12102 
    LD  (PATX+1),DE                     ;5038  ed 53 73 50  12084  12103 
    LD  (PATY+1),HL                     ;503c  22 79 50     12085  12104 
    INC BC                              ;503f  03           12086  12105 
    CALL    IHLEXP                      ;5040  cd cc 22     12087  12106 
    CALL    CH2CH                       ;5043  cd 61 2d     12088  12107 
    LD  A,H                             ;5046  7c           12089  12108 
    OR  A                               ;5047  b7           12090  12109 
    LD  DE,0FFE0h                       ;5048  11 e0 ff     12091  12110 
    JR  Z,PATOK1                        ;504b  28 0c        12092  12111 
    CP  0FFh                            ;504d  fe ff        12093  12112 
    JP  NZ,IFCALL                       ;504f  c2 36 17     12094  12113 
    LD  DE,00020h                       ;5052  11 20 00     12095  12114 
    LD  A,L                             ;5055  7d           12096  12115 
    NEG                                 ;5056  ed 44        12097  12116 
    LD  L,A                             ;5058  6f           12098  12117 
PATOK1: LD  (PATYAD+1),DE               ;5059  ed 53 a6 50  12099  12118 
    LD  A,L                             ;505d  7d           12100  12119 
    OR  A                               ;505e  b7           12101  12120 
    JP  Z,IFCALL                        ;505f  ca 36 17     12102  12121 
    LD  (PATYLN+1),A                    ;5062  32 9d 50     12103  12122 
    CALL    STREXX                      ;5065  cd 9d 45     12104  12123 
    PUSH    BC                          ;5068  c5           12105  12124 
    LD  B,A                             ;5069  47           12106  12125 
    OR  A                               ;506a  b7           12107  12126 
    CALL    NZ,PATSUB                   ;506b  c4 71 50     12108  12127 
    POP HL                              ;506e  e1           12109  12128 
    DEC HL                              ;506f  2b           12110  12129 
    RET                                 ;5070  c9           12111  12130 
                                        ;                   12112  12131 ;
PATSUB: EXX                             ;5071  d9           12113  12132 
PATX:   LD  DE,0                        ;5072  11 00 00     12114  12133 
    LD  A,D                             ;5075  7a           12115  12134 
    OR  A                               ;5076  b7           12116  12135 
    RET NZ                              ;5077  c0           12117  12136 
PATY:   LD  HL,0                        ;5078  21 00 00     12118  12137 
    LD  A,H                             ;507b  7c           12119  12138 
    OR  A                               ;507c  b7           12120  12139 
    RET NZ                              ;507d  c0           12121  12140 
    LD  A,L                             ;507e  7d           12122  12141 
    CP  192                             ;507f  fe c0        12123  12142 
    RET NC                              ;5081  d0           12124  12143 
    ADD HL,HL                           ;5082  29           12125  12144 
    ADD HL,HL                           ;5083  29           12126  12145 
    ADD HL,HL                           ;5084  29           12127  12146 
    ADD HL,HL                           ;5085  29           12128  12147 
    ADD HL,HL                           ;5086  29           12129  12148 
    LD  A,E                             ;5087  7b           12130  12149 
    SRL E                               ;5088  cb 3b        12131  12150 
    SRL E                               ;508a  cb 3b        12132  12151 
    SRL E                               ;508c  cb 3b        12133  12152 
    ADD HL,DE                           ;508e  19           12134  12153 
    LD  C,L                             ;508f  4d           12135  12154 
    LD  B,H                             ;5090  44           12136  12155 
    AND 7                               ;5091  e6 07        12137  12156 
    LD  D,080h                          ;5093  16 80        12138  12157 
    JR  Z,PATYLN                        ;5095  28 05        12139  12158 
L3C81:  SRL D                           ;5097  cb 3a        12140  12159 
    DEC A                               ;5099  3d           12141  12160 
    JR  NZ,L3C81                        ;509a  20 fb        12142  12161 
PATYLN: LD  E,1                         ;509c  1e 01        12143  12162 
    PUSH    BC                          ;509e  c5           12144  12163 
PATLP1: EXX                             ;509f  d9           12145  12164 
    LD  A,(DE)                          ;50a0  1a           12146  12165 
    EXX                                 ;50a1  d9           12147  12166 
    CALL    PATST                       ;50a2  cd ba 50     12148  12167 
PATYAD: LD  HL,00020h                   ;50a5  21 20 00     12149  12168 
    ADD HL,BC                           ;50a8  09           12150  12169 
    LD  C,L                             ;50a9  4d           12151  12170 
    LD  B,H                             ;50aa  44           12152  12171 
    EXX                                 ;50ab  d9           12153  12172 
    INC DE                              ;50ac  13           12154  12173 
    DEC B                               ;50ad  05           12155  12174 
    JR  Z,PATEND                        ;50ae  28 08        12156  12175 
    EXX                                 ;50b0  d9           12157  12176 
    DEC E                               ;50b1  1d           12158  12177 
    JR  NZ,PATLP1                       ;50b2  20 eb        12159  12178 
    POP BC                              ;50b4  c1           12160  12179 
    INC BC                              ;50b5  03           12161  12180 
    JR  PATYLN                          ;50b6  18 e4        12162  12181 
PATEND: POP BC                          ;50b8  c1           12163  12182 
    RET                                 ;50b9  c9           12164  12183 
                                        ;                   12165  12184 ;
PATST:  PUSH    BC                      ;50ba  c5           12166  12185 
    PUSH    DE                          ;50bb  d5           12167  12186 
    LD  L,A                             ;50bc  6f           12168  12187 
    LD  H,8                             ;50bd  26 08        12169  12188 
PATSTL: RLC L                           ;50bf  cb 05        12170  12189 
    JR  NC,L3CB2                        ;50c1  30 05        12171  12190 
    IN  A,(C)                           ;50c3  ed 78        12172  12191 
    OR  D                               ;50c5  b2           12173  12192 
    OUT (C),A                           ;50c6  ed 79        12174  12193 
L3CB2:  RRC D                           ;50c8  cb 0a        12175  12194 
    JR  NC,L3CB7                        ;50ca  30 01        12176  12195 
    INC BC                              ;50cc  03           12177  12196 
L3CB7:  DEC H                           ;50cd  25           12178  12197 
    JR  NZ,PATSTL                       ;50ce  20 ef        12179  12198 
    POP DE                              ;50d0  d1           12180  12199 
    POP BC                              ;50d1  c1           12181  12200 
    RET                                 ;50d2  c9           12182  12201 
                                        ;                   12183  12202 ;
                                        ;                   12184  12203 ;
                                        ;                   12185  12204 ;
HCOPY:  PUSH    HL                      ;50d3  e5           12186  12205 
    LD  A,01Bh                          ;50d4  3e 1b        12187  12206 ;ESC
    CALL    PRINTR                      ;50d6  cd 87 08     12188  12207 
    LD  A,041h                          ;50d9  3e 41        12189  12208 ;A
    CALL    PRINTR                      ;50db  cd 87 08     12190  12209 
    LD  A,007h                          ;50de  3e 07        12191  12210 ;7
    CALL    PRINTR                      ;50e0  cd 87 08     12192  12211 
    LD  A,(GMODEF)                      ;50e3  3a 06 1c     12193  12212 
    CP  2                               ;50e6  fe 02        12194  12213 
    JR  NC,COPYGM                       ;50e8  30 0c        12195  12214 
    LD  HL,COPYTX                       ;50ea  21 aa 51     12196  12215 
    LD  DE,COPYTA                       ;50ed  11 6f 51     12197  12216 
    LD  BC,(CHRSTA)                     ;50f0  ed 4b d6 0a  12198  12217 
    JR  COPYM4                          ;50f4  18 09        12199  12218 
COPYGM: LD  HL,COPYGR                   ;50f6  21 95 51     12200  12219 
    LD  DE,COPYGA                       ;50f9  11 6b 51     12201  12220 
    LD  BC,0                            ;50fc  01 00 00     12202  12221 
COPYM4: LD  (COPYM2+1),HL               ;50ff  22 10 51     12203  12222 
    LD  (COPYM3+1),DE                   ;5102  ed 53 4d 51  12204  12223 
    LD  D,0                             ;5106  16 00        12205  12224 
HCOPY1: CALL    PRTESC                  ;5108  cd 7e 51     12206  12225 
    LD  E,32                            ;510b  1e 20        12207  12226 
HCOPY2: PUSH    BC                      ;510d  c5           12208  12227 
    PUSH    DE                          ;510e  d5           12209  12228 
COPYM2: CALL    COPYGR                  ;510f  cd 95 51     12210  12229 
    LD  B,8                             ;5112  06 08        12211  12230 
HCOPY3: XOR A                           ;5114  af           12212  12231 
    RLCA                                ;5115  07           12213  12232 
    RLCA                                ;5116  07           12214  12233 
    RLC E                               ;5117  cb 03        12215  12234 
    JR  NC,L3D07                        ;5119  30 02        12216  12235 
    ADD A,3                             ;511b  c6 03        12217  12236 
L3D07:  RLCA                            ;511d  07           12218  12237 
    RLCA                                ;511e  07           12219  12238 
    RLC D                               ;511f  cb 02        12220  12239 
    JR  NC,L3D0F                        ;5121  30 02        12221  12240 
    ADD A,3                             ;5123  c6 03        12222  12241 
L3D0F:  RLCA                            ;5125  07           12223  12242 
    RLCA                                ;5126  07           12224  12243 
    RLC L                               ;5127  cb 05        12225  12244 
    JR  NC,L3D17                        ;5129  30 02        12226  12245 
    ADD A,3                             ;512b  c6 03        12227  12246 
L3D17:  RLCA                            ;512d  07           12228  12247 
    RLCA                                ;512e  07           12229  12248 
    RLC H                               ;512f  cb 04        12230  12249 
    JR  NC,L3D1F                        ;5131  30 02        12231  12250 
    ADD A,3                             ;5133  c6 03        12232  12251 
L3D1F:  EXX                             ;5135  d9           12233  12252 
    PUSH    AF                          ;5136  f5           12234  12253 
    CALL    PRINTR                      ;5137  cd 87 08     12235  12254 
    POP AF                              ;513a  f1           12236  12255 
    PUSH    AF                          ;513b  f5           12237  12256 
    CALL    PRINTR                      ;513c  cd 87 08     12238  12257 
    POP AF                              ;513f  f1           12239  12258 
    CALL    PRINTR                      ;5140  cd 87 08     12240  12259 
    EXX                                 ;5143  d9           12241  12260 
    DJNZ    HCOPY3                      ;5144  10 ce        12242  12261 
    POP DE                              ;5146  d1           12243  12262 
    POP BC                              ;5147  c1           12244  12263 
    INC BC                              ;5148  03           12245  12264 
    DEC E                               ;5149  1d           12246  12265 
    JR  NZ,HCOPY2                       ;514a  20 c1        12247  12266 
COPYM3: CALL    COPYGA                  ;514c  cd 6b 51     12248  12267 
    ADD HL,BC                           ;514f  09           12249  12268 
    LD  C,L                             ;5150  4d           12250  12269 
    LD  B,H                             ;5151  44           12251  12270 
    LD  A,00Ah                          ;5152  3e 0a        12252  12271 
    EXX                                 ;5154  d9           12253  12272 
    CALL    PRINTR                      ;5155  cd 87 08     12254  12273 
    EXX                                 ;5158  d9           12255  12274 
    INC D                               ;5159  14           12256  12275 
    LD  A,D                             ;515a  7a           12257  12276 
    CP  48                              ;515b  fe 30        12258  12277 
    JR  NZ,HCOPY1                       ;515d  20 a9        12259  12278 
    LD  A,01Bh                          ;515f  3e 1b        12260  12279 
    CALL    PRINTR                      ;5161  cd 87 08     12261  12280 
    LD  A,032h                          ;5164  3e 32        12262  12281 
    CALL    PRINTR                      ;5166  cd 87 08     12263  12282 
    POP HL                              ;5169  e1           12264  12283 
    RET                                 ;516a  c9           12265  12284 
                                        ;                   12266  12285 ;
COPYGA: LD  HL,00060h                   ;516b  21 60 00     12267  12286 
    RET                                 ;516e  c9           12268  12287 
                                        ;                   12269  12288 ;
COPYTA: LD  A,D                         ;516f  7a           12270  12289 
COPYTL: SUB 3                           ;5170  d6 03        12271  12290 
    JR  NC,COPYTL                       ;5172  30 fc        12272  12291 
    CP  0FFh                            ;5174  fe ff        12273  12292 
    LD  HL,0                            ;5176  21 00 00     12274  12293 
    RET Z                               ;5179  c8           12275  12294 
    LD  HL,0FFE0h                       ;517a  21 e0 ff     12276  12295 
    RET                                 ;517d  c9           12277  12296 
                                        ;                   12278  12297 ;
PRTESC: EXX                             ;517e  d9           12279  12298 
    LD  A,01Bh                          ;517f  3e 1b        12280  12299 
    CALL    PRINTR                      ;5181  cd 87 08     12281  12300 
    LD  A,04Ch                          ;5184  3e 4c        12282  12301 ;L
    CALL    PRINTR                      ;5186  cd 87 08     12283  12302 
    LD  A,0                             ;5189  3e 00        12284  12303 
    CALL    PRINTR                      ;518b  cd 87 08     12285  12304 
    LD  A,3                             ;518e  3e 03        12286  12305 
    CALL    PRINTR                      ;5190  cd 87 08     12287  12306 
    EXX                                 ;5193  d9           12288  12307 
    RET                                 ;5194  c9           12289  12308 
                                        ;                   12290  12309 ;
COPYGR: IN  E,(C)                       ;5195  ed 58        12291  12310 
    LD  A,020h                          ;5197  3e 20        12292  12311 
    ADD A,C                             ;5199  81           12293  12312 
    LD  C,A                             ;519a  4f           12294  12313 
    IN  D,(C)                           ;519b  ed 50        12295  12314 
    LD  A,020h                          ;519d  3e 20        12296  12315 
    ADD A,C                             ;519f  81           12297  12316 
    LD  C,A                             ;51a0  4f           12298  12317 
    IN  L,(C)                           ;51a1  ed 68        12299  12318 
    LD  A,020h                          ;51a3  3e 20        12300  12319 
    ADD A,C                             ;51a5  81           12301  12320 
    LD  C,A                             ;51a6  4f           12302  12321 
    IN  H,(C)                           ;51a7  ed 60        12303  12322 
    RET                                 ;51a9  c9           12304  12323 
                                        ;                   12305  12324 ;
                                        ;                   12306  12325 ;
                                        ;                   12307  12326 ;
COPYTX: IN  H,(C)                       ;51aa  ed 60        12308  12327 
    SET 3,B                             ;51ac  cb d8        12309  12328 
    IN  A,(C)                           ;51ae  ed 78        12310  12329 
    AND 00Fh                            ;51b0  e6 0f        12311  12330 
    SUB 4                               ;51b2  d6 04        12312  12331 
    JR  C,ROMTX                         ;51b4  38 3f        12313  12332 
    SUB 4                               ;51b6  d6 04        12314  12333 
    JR  C,LGR22                         ;51b8  38 1d        12315  12334 
    SUB 4                               ;51ba  d6 04        12316  12335 
    JR  C,RAMTX                         ;51bc  38 53        12317  12336 
    LD  A,D                             ;51be  7a           12318  12337 
SUB3L:  SUB 3                           ;51bf  d6 03        12319  12338 
    JR  NC,SUB3L                        ;51c1  30 fc        12320  12339 
    ADD A,3                             ;51c3  c6 03        12321  12340 
    LD  B,A                             ;51c5  47           12322  12341 
    INC B                               ;51c6  04           12323  12342 
    JR  L3DB7                           ;51c7  18 04        12324  12343 
LGR23L: RRC H                           ;51c9  cb 0c        12325  12344 
    RRC H                               ;51cb  cb 0c        12326  12345 
L3DB7:  DJNZ    LGR23L                  ;51cd  10 fa        12327  12346 
LGR223: CALL    RRCHAS                  ;51cf  cd 3d 52     12328  12347 
    LD  E,A                             ;51d2  5f           12329  12348 
    LD  D,A                             ;51d3  57           12330  12349 
    LD  L,A                             ;51d4  6f           12331  12350 
    LD  H,A                             ;51d5  67           12332  12351 
    RET                                 ;51d6  c9           12333  12352 
                                        ;                   12334  12353 ;
LGR22:  LD  A,D                         ;51d7  7a           12335  12354 
SUB3L1: SUB 3                           ;51d8  d6 03        12336  12355 
    JR  NC,SUB3L1                       ;51da  30 fc        12337  12356 
    ADD A,3                             ;51dc  c6 03        12338  12357 
    JR  Z,LGR223                        ;51de  28 ef        12339  12358 
    CP  2                               ;51e0  fe 02        12340  12359 
    JR  NZ,LGR232                       ;51e2  20 06        12341  12360 
    RRC H                               ;51e4  cb 0c        12342  12361 
    RRC H                               ;51e6  cb 0c        12343  12362 
    JR  LGR223                          ;51e8  18 e5        12344  12363 
LGR232: CALL    RRCHAS                  ;51ea  cd 3d 52     12345  12364 
    LD  E,A                             ;51ed  5f           12346  12365 
    LD  D,A                             ;51ee  57           12347  12366 
    CALL    RRCHAS                      ;51ef  cd 3d 52     12348  12367 
    LD  L,A                             ;51f2  6f           12349  12368 
    LD  H,A                             ;51f3  67           12350  12369 
    RET                                 ;51f4  c9           12351  12370 
                                        ;                   12352  12371 ;
ROMTX:  LD  A,H                         ;51f5  7c           12353  12372 
    AND 07Fh                            ;51f6  e6 7f        12354  12373 
    SUB 020h                            ;51f8  d6 20        12355  12374 
    JR  NC,L3DE7                        ;51fa  30 01        12356  12375 
    XOR A                               ;51fc  af           12357  12376 
L3DE7:  LD  H,A                         ;51fd  67           12358  12377 
    CALL    TXCULC                      ;51fe  cd 26 52     12359  12378 
    LD  D,0                             ;5201  16 00        12360  12379 
    ADD HL,DE                           ;5203  19           12361  12380 
    LD  DE,CGCHR                        ;5204  11 4a 52     12362  12381 
    ADD HL,DE                           ;5207  19           12363  12382 
    LD  E,(HL)                          ;5208  5e           12364  12383 
    INC HL                              ;5209  23           12365  12384 
    LD  D,(HL)                          ;520a  56           12366  12385 
    INC HL                              ;520b  23           12367  12386 
    LD  A,(HL)                          ;520c  7e           12368  12387 
    INC HL                              ;520d  23           12369  12388 
    LD  H,(HL)                          ;520e  66           12370  12389 
    LD  L,A                             ;520f  6f           12371  12390 
    RET                                 ;5210  c9           12372  12391 
                                        ;                   12373  12392 ;
RAMTX:  CALL    TXCULC                  ;5211  cd 26 52     12374  12393 
    ADD HL,BC                           ;5214  09           12375  12394 
    LD  D,010h                          ;5215  16 10        12376  12395 
    ADD HL,DE                           ;5217  19           12377  12396 
    LD  C,L                             ;5218  4d           12378  12397 
    LD  B,H                             ;5219  44           12379  12398 
    IN  E,(C)                           ;521a  ed 58        12380  12399 
    INC BC                              ;521c  03           12381  12400 
    IN  D,(C)                           ;521d  ed 50        12382  12401 
    INC BC                              ;521f  03           12383  12402 
    IN  L,(C)                           ;5220  ed 68        12384  12403 
    INC BC                              ;5222  03           12385  12404 
    IN  H,(C)                           ;5223  ed 60        12386  12405 
    RET                                 ;5225  c9           12387  12406 
                                        ;                   12388  12407 ;
TXCULC: LD  A,D                         ;5226  7a           12389  12408 
SUB3L2: SUB 3                           ;5227  d6 03        12390  12409 
    JR  NC,SUB3L2                       ;5229  30 fc        12391  12410 
    ADD A,003h                          ;522b  c6 03        12392  12411 
    RLCA                                ;522d  07           12393  12412 
    RLCA                                ;522e  07           12394  12413 
    LD  E,A                             ;522f  5f           12395  12414 
    LD  A,H                             ;5230  7c           12396  12415 
    AND 07Fh                            ;5231  e6 7f        12397  12416 
    LD  L,A                             ;5233  6f           12398  12417 
    LD  H,0                             ;5234  26 00        12399  12418 
    ADD HL,HL                           ;5236  29           12400  12419 
    ADD HL,HL                           ;5237  29           12401  12420 
    LD  C,L                             ;5238  4d           12402  12421 
    LD  B,H                             ;5239  44           12403  12422 
    ADD HL,HL                           ;523a  29           12404  12423 
    ADD HL,BC                           ;523b  09           12405  12424 
    RET                                 ;523c  c9           12406  12425 
                                        ;                   12407  12426 ;
RRCHAS: XOR A                           ;523d  af           12408  12427 
    RRC H                               ;523e  cb 0c        12409  12428 
    JR  NC,L3E2E                        ;5240  30 02        12410  12429 
    LD  A,00Fh                          ;5242  3e 0f        12411  12430 
L3E2E:  RRC H                           ;5244  cb 0c        12412  12431 
    RET NC                              ;5246  d0           12413  12432 
    ADD A,0F0h                          ;5247  c6 f0        12414  12433 
    RET                                 ;5249  c9           12415  12434 
                                        ;                   12416  12435 
                                        ;                   12417  12436 ;
                                        ;                   12418  12437 ;	ORG	0524AH
                                        ;                   12419  12438 ;    
CGCHR:                                  ;                   12420  12439 
                                        ;                   12421  12440 ;CHR$(&H20)
    DEFB    000H                        ;524a  00           12422  12441 
    DEFB    000H                        ;524b  00           12423  12442 
    DEFB    000H                        ;524c  00           12424  12443 
    DEFB    000H                        ;524d  00           12425  12444 
    DEFB    000H                        ;524e  00           12426  12445 
    DEFB    000H                        ;524f  00           12427  12446 
    DEFB    000H                        ;5250  00           12428  12447 
    DEFB    000H                        ;5251  00           12429  12448 
    DEFB    000H                        ;5252  00           12430  12449 
    DEFB    000H                        ;5253  00           12431  12450 
    DEFB    000H                        ;5254  00           12432  12451 
    DEFB    000H                        ;5255  00           12433  12452 
                                        ;                   12434  12453 ;
                                        ;                   12435  12454 ;CHR$(&H21)
    DEFB    000H                        ;5256  00           12436  12455 
    DEFB    000H                        ;5257  00           12437  12456 
    DEFB    010H                        ;5258  10           12438  12457 
    DEFB    010H                        ;5259  10           12439  12458 
    DEFB    010H                        ;525a  10           12440  12459 
    DEFB    010H                        ;525b  10           12441  12460 
    DEFB    010H                        ;525c  10           12442  12461 
    DEFB    000H                        ;525d  00           12443  12462 
    DEFB    010H                        ;525e  10           12444  12463 
    DEFB    000H                        ;525f  00           12445  12464 
    DEFB    000H                        ;5260  00           12446  12465 
    DEFB    000H                        ;5261  00           12447  12466 
                                        ;                   12448  12467 ;
                                        ;                   12449  12468 ;CHR$(&H22)
    DEFB    000H                        ;5262  00           12450  12469 
    DEFB    000H                        ;5263  00           12451  12470 
    DEFB    028H                        ;5264  28           12452  12471 
    DEFB    028H                        ;5265  28           12453  12472 
    DEFB    028H                        ;5266  28           12454  12473 
    DEFB    000H                        ;5267  00           12455  12474 
    DEFB    000H                        ;5268  00           12456  12475 
    DEFB    000H                        ;5269  00           12457  12476 
    DEFB    000H                        ;526a  00           12458  12477 
    DEFB    000H                        ;526b  00           12459  12478 
    DEFB    000H                        ;526c  00           12460  12479 
    DEFB    000H                        ;526d  00           12461  12480 
                                        ;                   12462  12481 ;
                                        ;                   12463  12482 ;CHR$(&H23)
    DEFB    000H                        ;526e  00           12464  12483 
    DEFB    000H                        ;526f  00           12465  12484 
    DEFB    024H                        ;5270  24           12466  12485 
    DEFB    024H                        ;5271  24           12467  12486 
    DEFB    07EH                        ;5272  7e           12468  12487 
    DEFB    024H                        ;5273  24           12469  12488 
    DEFB    07EH                        ;5274  7e           12470  12489 
    DEFB    024H                        ;5275  24           12471  12490 
    DEFB    024H                        ;5276  24           12472  12491 
    DEFB    000H                        ;5277  00           12473  12492 
    DEFB    000H                        ;5278  00           12474  12493 
    DEFB    000H                        ;5279  00           12475  12494 
                                        ;                   12476  12495 ;
                                        ;                   12477  12496 ;CHR$(&H24)
    DEFB    000H                        ;527a  00           12478  12497 
    DEFB    000H                        ;527b  00           12479  12498 
    DEFB    010H                        ;527c  10           12480  12499 
    DEFB    03CH                        ;527d  3c           12481  12500 
    DEFB    050H                        ;527e  50           12482  12501 
    DEFB    038H                        ;527f  38           12483  12502 
    DEFB    014H                        ;5280  14           12484  12503 
    DEFB    078H                        ;5281  78           12485  12504 
    DEFB    010H                        ;5282  10           12486  12505 
    DEFB    000H                        ;5283  00           12487  12506 
    DEFB    000H                        ;5284  00           12488  12507 
    DEFB    000H                        ;5285  00           12489  12508 
                                        ;                   12490  12509 ;
                                        ;                   12491  12510 ;CHR$(&H25)
    DEFB    000H                        ;5286  00           12492  12511 
    DEFB    000H                        ;5287  00           12493  12512 
    DEFB    000H                        ;5288  00           12494  12513 
    DEFB    062H                        ;5289  62           12495  12514 
    DEFB    064H                        ;528a  64           12496  12515 
    DEFB    008H                        ;528b  08           12497  12516 
    DEFB    010H                        ;528c  10           12498  12517 
    DEFB    026H                        ;528d  26           12499  12518 
    DEFB    046H                        ;528e  46           12500  12519 
    DEFB    000H                        ;528f  00           12501  12520 
    DEFB    000H                        ;5290  00           12502  12521 
    DEFB    000H                        ;5291  00           12503  12522 
                                        ;                   12504  12523 ;
                                        ;                   12505  12524 ;CHR$(&H26)
    DEFB    000H                        ;5292  00           12506  12525 
    DEFB    000H                        ;5293  00           12507  12526 
    DEFB    030H                        ;5294  30           12508  12527 
    DEFB    048H                        ;5295  48           12509  12528 
    DEFB    048H                        ;5296  48           12510  12529 
    DEFB    030H                        ;5297  30           12511  12530 
    DEFB    04AH                        ;5298  4a           12512  12531 
    DEFB    044H                        ;5299  44           12513  12532 
    DEFB    03AH                        ;529a  3a           12514  12533 
    DEFB    000H                        ;529b  00           12515  12534 
    DEFB    000H                        ;529c  00           12516  12535 
    DEFB    000H                        ;529d  00           12517  12536 
                                        ;                   12518  12537 ;
                                        ;                   12519  12538 ;CHR$(&H27)	'
    DEFB    000H                        ;529e  00           12520  12539 
    DEFB    000H                        ;529f  00           12521  12540 
    DEFB    030H                        ;52a0  30           12522  12541 
    DEFB    010H                        ;52a1  10           12523  12542 
    DEFB    020H                        ;52a2  20           12524  12543 
    DEFB    000H                        ;52a3  00           12525  12544 
    DEFB    000H                        ;52a4  00           12526  12545 
    DEFB    000H                        ;52a5  00           12527  12546 
    DEFB    000H                        ;52a6  00           12528  12547 
    DEFB    000H                        ;52a7  00           12529  12548 
    DEFB    000H                        ;52a8  00           12530  12549 
    DEFB    000H                        ;52a9  00           12531  12550 
                                        ;                   12532  12551 ;
                                        ;                   12533  12552 ;CHR$(&H28)	(
    DEFB    000H                        ;52aa  00           12534  12553 
    DEFB    000H                        ;52ab  00           12535  12554 
    DEFB    008H                        ;52ac  08           12536  12555 
    DEFB    010H                        ;52ad  10           12537  12556 
    DEFB    020H                        ;52ae  20           12538  12557 
    DEFB    020H                        ;52af  20           12539  12558 
    DEFB    020H                        ;52b0  20           12540  12559 
    DEFB    010H                        ;52b1  10           12541  12560 
    DEFB    008H                        ;52b2  08           12542  12561 
    DEFB    000H                        ;52b3  00           12543  12562 
    DEFB    000H                        ;52b4  00           12544  12563 
    DEFB    000H                        ;52b5  00           12545  12564 
                                        ;                   12546  12565 ;
                                        ;                   12547  12566 ;CHR$(&H29)	)
    DEFB    000H                        ;52b6  00           12548  12567 
    DEFB    000H                        ;52b7  00           12549  12568 
    DEFB    020H                        ;52b8  20           12550  12569 
    DEFB    010H                        ;52b9  10           12551  12570 
    DEFB    008H                        ;52ba  08           12552  12571 
    DEFB    008H                        ;52bb  08           12553  12572 
    DEFB    008H                        ;52bc  08           12554  12573 
    DEFB    010H                        ;52bd  10           12555  12574 
    DEFB    020H                        ;52be  20           12556  12575 
    DEFB    000H                        ;52bf  00           12557  12576 
    DEFB    000H                        ;52c0  00           12558  12577 
    DEFB    000H                        ;52c1  00           12559  12578 
                                        ;                   12560  12579 ;
                                        ;                   12561  12580 ;CHR$(&H2A)	*
    DEFB    000H                        ;52c2  00           12562  12581 
    DEFB    000H                        ;52c3  00           12563  12582 
    DEFB    010H                        ;52c4  10           12564  12583 
    DEFB    054H                        ;52c5  54           12565  12584 
    DEFB    038H                        ;52c6  38           12566  12585 
    DEFB    07CH                        ;52c7  7c           12567  12586 
    DEFB    038H                        ;52c8  38           12568  12587 
    DEFB    054H                        ;52c9  54           12569  12588 
    DEFB    010H                        ;52ca  10           12570  12589 
    DEFB    000H                        ;52cb  00           12571  12590 
    DEFB    000H                        ;52cc  00           12572  12591 
    DEFB    000H                        ;52cd  00           12573  12592 
                                        ;                   12574  12593 ;
                                        ;                   12575  12594 ;CHR$(&H2B)	+
    DEFB    000H                        ;52ce  00           12576  12595 
    DEFB    000H                        ;52cf  00           12577  12596 
    DEFB    000H                        ;52d0  00           12578  12597 
    DEFB    010H                        ;52d1  10           12579  12598 
    DEFB    010H                        ;52d2  10           12580  12599 
    DEFB    07CH                        ;52d3  7c           12581  12600 
    DEFB    010H                        ;52d4  10           12582  12601 
    DEFB    010H                        ;52d5  10           12583  12602 
    DEFB    000H                        ;52d6  00           12584  12603 
    DEFB    000H                        ;52d7  00           12585  12604 
    DEFB    000H                        ;52d8  00           12586  12605 
    DEFB    000H                        ;52d9  00           12587  12606 
                                        ;                   12588  12607 ;
                                        ;                   12589  12608 ;CHR$(&H2C)	,
    DEFB    000H                        ;52da  00           12590  12609 
    DEFB    000H                        ;52db  00           12591  12610 
    DEFB    000H                        ;52dc  00           12592  12611 
    DEFB    000H                        ;52dd  00           12593  12612 
    DEFB    000H                        ;52de  00           12594  12613 
    DEFB    000H                        ;52df  00           12595  12614 
    DEFB    030H                        ;52e0  30           12596  12615 
    DEFB    010H                        ;52e1  10           12597  12616 
    DEFB    020H                        ;52e2  20           12598  12617 
    DEFB    000H                        ;52e3  00           12599  12618 
    DEFB    000H                        ;52e4  00           12600  12619 
    DEFB    000H                        ;52e5  00           12601  12620 
                                        ;                   12602  12621 ;
                                        ;                   12603  12622 ;CHR$(&H2D)	-
    DEFB    000H                        ;52e6  00           12604  12623 
    DEFB    000H                        ;52e7  00           12605  12624 
    DEFB    000H                        ;52e8  00           12606  12625 
    DEFB    000H                        ;52e9  00           12607  12626 
    DEFB    000H                        ;52ea  00           12608  12627 
    DEFB    07CH                        ;52eb  7c           12609  12628 
    DEFB    000H                        ;52ec  00           12610  12629 
    DEFB    000H                        ;52ed  00           12611  12630 
    DEFB    000H                        ;52ee  00           12612  12631 
    DEFB    000H                        ;52ef  00           12613  12632 
    DEFB    000H                        ;52f0  00           12614  12633 
    DEFB    000H                        ;52f1  00           12615  12634 
                                        ;                   12616  12635 ;
                                        ;                   12617  12636 ;CHR$(&H2E)	.
    DEFB    000H                        ;52f2  00           12618  12637 
    DEFB    000H                        ;52f3  00           12619  12638 
    DEFB    000H                        ;52f4  00           12620  12639 
    DEFB    000H                        ;52f5  00           12621  12640 
    DEFB    000H                        ;52f6  00           12622  12641 
    DEFB    000H                        ;52f7  00           12623  12642 
    DEFB    030H                        ;52f8  30           12624  12643 
    DEFB    030H                        ;52f9  30           12625  12644 
    DEFB    000H                        ;52fa  00           12626  12645 
    DEFB    000H                        ;52fb  00           12627  12646 
    DEFB    000H                        ;52fc  00           12628  12647 
    DEFB    000H                        ;52fd  00           12629  12648 
                                        ;                   12630  12649 ;
                                        ;                   12631  12650 ;CHR$(&H2F)	/
    DEFB    000H                        ;52fe  00           12632  12651 
    DEFB    000H                        ;52ff  00           12633  12652 
    DEFB    000H                        ;5300  00           12634  12653 
    DEFB    002H                        ;5301  02           12635  12654 
    DEFB    004H                        ;5302  04           12636  12655 
    DEFB    008H                        ;5303  08           12637  12656 
    DEFB    010H                        ;5304  10           12638  12657 
    DEFB    020H                        ;5305  20           12639  12658 
    DEFB    040H                        ;5306  40           12640  12659 
    DEFB    000H                        ;5307  00           12641  12660 
    DEFB    000H                        ;5308  00           12642  12661 
    DEFB    000H                        ;5309  00           12643  12662 
                                        ;                   12644  12663 ;
                                        ;                   12645  12664 ;CHR$(&H30)	0
    DEFB    000H                        ;530a  00           12646  12665 
    DEFB    000H                        ;530b  00           12647  12666 
    DEFB    03CH                        ;530c  3c           12648  12667 
    DEFB    042H                        ;530d  42           12649  12668 
    DEFB    046H                        ;530e  46           12650  12669 
    DEFB    05AH                        ;530f  5a           12651  12670 
    DEFB    062H                        ;5310  62           12652  12671 
    DEFB    042H                        ;5311  42           12653  12672 
    DEFB    03CH                        ;5312  3c           12654  12673 
    DEFB    000H                        ;5313  00           12655  12674 
    DEFB    000H                        ;5314  00           12656  12675 
    DEFB    000H                        ;5315  00           12657  12676 
                                        ;                   12658  12677 ;
                                        ;                   12659  12678 ;CHR$(&H31)	1
    DEFB    000H                        ;5316  00           12660  12679 
    DEFB    000H                        ;5317  00           12661  12680 
    DEFB    010H                        ;5318  10           12662  12681 
    DEFB    030H                        ;5319  30           12663  12682 
    DEFB    050H                        ;531a  50           12664  12683 
    DEFB    010H                        ;531b  10           12665  12684 
    DEFB    010H                        ;531c  10           12666  12685 
    DEFB    010H                        ;531d  10           12667  12686 
    DEFB    07CH                        ;531e  7c           12668  12687 
    DEFB    000H                        ;531f  00           12669  12688 
    DEFB    000H                        ;5320  00           12670  12689 
    DEFB    000H                        ;5321  00           12671  12690 
                                        ;                   12672  12691 ;
                                        ;                   12673  12692 ;CHR$(&H32)	2
    DEFB    000H                        ;5322  00           12674  12693 
    DEFB    000H                        ;5323  00           12675  12694 
    DEFB    03CH                        ;5324  3c           12676  12695 
    DEFB    042H                        ;5325  42           12677  12696 
    DEFB    002H                        ;5326  02           12678  12697 
    DEFB    00CH                        ;5327  0c           12679  12698 
    DEFB    030H                        ;5328  30           12680  12699 
    DEFB    040H                        ;5329  40           12681  12700 
    DEFB    07EH                        ;532a  7e           12682  12701 
    DEFB    000H                        ;532b  00           12683  12702 
    DEFB    000H                        ;532c  00           12684  12703 
    DEFB    000H                        ;532d  00           12685  12704 
                                        ;                   12686  12705 ;
                                        ;                   12687  12706 ;CHR$(&H33)	3
    DEFB    000H                        ;532e  00           12688  12707 
    DEFB    000H                        ;532f  00           12689  12708 
    DEFB    03CH                        ;5330  3c           12690  12709 
    DEFB    042H                        ;5331  42           12691  12710 
    DEFB    002H                        ;5332  02           12692  12711 
    DEFB    03CH                        ;5333  3c           12693  12712 
    DEFB    002H                        ;5334  02           12694  12713 
    DEFB    042H                        ;5335  42           12695  12714 
    DEFB    03CH                        ;5336  3c           12696  12715 
    DEFB    000H                        ;5337  00           12697  12716 
    DEFB    000H                        ;5338  00           12698  12717 
    DEFB    000H                        ;5339  00           12699  12718 
                                        ;                   12700  12719 ;
                                        ;                   12701  12720 ;CHR$(&H34)	4
    DEFB    000H                        ;533a  00           12702  12721 
    DEFB    000H                        ;533b  00           12703  12722 
    DEFB    004H                        ;533c  04           12704  12723 
    DEFB    00CH                        ;533d  0c           12705  12724 
    DEFB    014H                        ;533e  14           12706  12725 
    DEFB    024H                        ;533f  24           12707  12726 
    DEFB    07EH                        ;5340  7e           12708  12727 
    DEFB    004H                        ;5341  04           12709  12728 
    DEFB    004H                        ;5342  04           12710  12729 
    DEFB    000H                        ;5343  00           12711  12730 
    DEFB    000H                        ;5344  00           12712  12731 
    DEFB    000H                        ;5345  00           12713  12732 
                                        ;                   12714  12733 ;
                                        ;                   12715  12734 ;CHR$(&H35)	5
    DEFB    000H                        ;5346  00           12716  12735 
    DEFB    000H                        ;5347  00           12717  12736 
    DEFB    07EH                        ;5348  7e           12718  12737 
    DEFB    040H                        ;5349  40           12719  12738 
    DEFB    078H                        ;534a  78           12720  12739 
    DEFB    004H                        ;534b  04           12721  12740 
    DEFB    002H                        ;534c  02           12722  12741 
    DEFB    044H                        ;534d  44           12723  12742 
    DEFB    038H                        ;534e  38           12724  12743 
    DEFB    000H                        ;534f  00           12725  12744 
    DEFB    000H                        ;5350  00           12726  12745 
    DEFB    000H                        ;5351  00           12727  12746 
                                        ;                   12728  12747 ;
                                        ;                   12729  12748 ;CHR$(&H36)	6
    DEFB    000H                        ;5352  00           12730  12749 
    DEFB    000H                        ;5353  00           12731  12750 
    DEFB    01CH                        ;5354  1c           12732  12751 
    DEFB    020H                        ;5355  20           12733  12752 
    DEFB    040H                        ;5356  40           12734  12753 
    DEFB    07CH                        ;5357  7c           12735  12754 
    DEFB    042H                        ;5358  42           12736  12755 
    DEFB    042H                        ;5359  42           12737  12756 
    DEFB    03CH                        ;535a  3c           12738  12757 
    DEFB    000H                        ;535b  00           12739  12758 
    DEFB    000H                        ;535c  00           12740  12759 
    DEFB    000H                        ;535d  00           12741  12760 
                                        ;                   12742  12761 ;
                                        ;                   12743  12762 ;CHR$(&H37)	7
    DEFB    000H                        ;535e  00           12744  12763 
    DEFB    000H                        ;535f  00           12745  12764 
    DEFB    07EH                        ;5360  7e           12746  12765 
    DEFB    042H                        ;5361  42           12747  12766 
    DEFB    004H                        ;5362  04           12748  12767 
    DEFB    008H                        ;5363  08           12749  12768 
    DEFB    010H                        ;5364  10           12750  12769 
    DEFB    010H                        ;5365  10           12751  12770 
    DEFB    010H                        ;5366  10           12752  12771 
    DEFB    000H                        ;5367  00           12753  12772 
    DEFB    000H                        ;5368  00           12754  12773 
    DEFB    000H                        ;5369  00           12755  12774 
                                        ;                   12756  12775 ;
                                        ;                   12757  12776 ;CHR$(&H38)	8
    DEFB    000H                        ;536a  00           12758  12777 
    DEFB    000H                        ;536b  00           12759  12778 
    DEFB    03CH                        ;536c  3c           12760  12779 
    DEFB    042H                        ;536d  42           12761  12780 
    DEFB    042H                        ;536e  42           12762  12781 
    DEFB    03CH                        ;536f  3c           12763  12782 
    DEFB    042H                        ;5370  42           12764  12783 
    DEFB    042H                        ;5371  42           12765  12784 
    DEFB    03CH                        ;5372  3c           12766  12785 
    DEFB    000H                        ;5373  00           12767  12786 
    DEFB    000H                        ;5374  00           12768  12787 
    DEFB    000H                        ;5375  00           12769  12788 
                                        ;                   12770  12789 ;
                                        ;                   12771  12790 ;CHR$(&H39)	9
    DEFB    000H                        ;5376  00           12772  12791 
    DEFB    000H                        ;5377  00           12773  12792 
    DEFB    03CH                        ;5378  3c           12774  12793 
    DEFB    042H                        ;5379  42           12775  12794 
    DEFB    042H                        ;537a  42           12776  12795 
    DEFB    03EH                        ;537b  3e           12777  12796 
    DEFB    002H                        ;537c  02           12778  12797 
    DEFB    004H                        ;537d  04           12779  12798 
    DEFB    038H                        ;537e  38           12780  12799 
    DEFB    000H                        ;537f  00           12781  12800 
    DEFB    000H                        ;5380  00           12782  12801 
    DEFB    000H                        ;5381  00           12783  12802 
                                        ;                   12784  12803 ;
                                        ;                   12785  12804 ;CHR$(&H3A)	:
    DEFB    000H                        ;5382  00           12786  12805 
    DEFB    000H                        ;5383  00           12787  12806 
    DEFB    000H                        ;5384  00           12788  12807 
    DEFB    030H                        ;5385  30           12789  12808 
    DEFB    030H                        ;5386  30           12790  12809 
    DEFB    000H                        ;5387  00           12791  12810 
    DEFB    030H                        ;5388  30           12792  12811 
    DEFB    030H                        ;5389  30           12793  12812 
    DEFB    000H                        ;538a  00           12794  12813 
    DEFB    000H                        ;538b  00           12795  12814 
    DEFB    000H                        ;538c  00           12796  12815 
    DEFB    000H                        ;538d  00           12797  12816 
                                        ;                   12798  12817 ;
                                        ;                   12799  12818 ;CHR$(&H3B)	;
    DEFB    000H                        ;538e  00           12800  12819 
    DEFB    000H                        ;538f  00           12801  12820 
    DEFB    000H                        ;5390  00           12802  12821 
    DEFB    030H                        ;5391  30           12803  12822 
    DEFB    030H                        ;5392  30           12804  12823 
    DEFB    000H                        ;5393  00           12805  12824 
    DEFB    030H                        ;5394  30           12806  12825 
    DEFB    010H                        ;5395  10           12807  12826 
    DEFB    020H                        ;5396  20           12808  12827 
    DEFB    000H                        ;5397  00           12809  12828 
    DEFB    000H                        ;5398  00           12810  12829 
    DEFB    000H                        ;5399  00           12811  12830 
                                        ;                   12812  12831 ;
                                        ;                   12813  12832 ;CHR$(&H3C)	<
    DEFB    000H                        ;539a  00           12814  12833 
    DEFB    000H                        ;539b  00           12815  12834 
    DEFB    00EH                        ;539c  0e           12816  12835 
    DEFB    018H                        ;539d  18           12817  12836 
    DEFB    030H                        ;539e  30           12818  12837 
    DEFB    060H                        ;539f  60           12819  12838 
    DEFB    030H                        ;53a0  30           12820  12839 
    DEFB    018H                        ;53a1  18           12821  12840 
    DEFB    00EH                        ;53a2  0e           12822  12841 
    DEFB    000H                        ;53a3  00           12823  12842 
    DEFB    000H                        ;53a4  00           12824  12843 
    DEFB    000H                        ;53a5  00           12825  12844 
                                        ;                   12826  12845 ;
                                        ;                   12827  12846 ;CHR$(&H3D)	=
    DEFB    000H                        ;53a6  00           12828  12847 
    DEFB    000H                        ;53a7  00           12829  12848 
    DEFB    000H                        ;53a8  00           12830  12849 
    DEFB    000H                        ;53a9  00           12831  12850 
    DEFB    07EH                        ;53aa  7e           12832  12851 
    DEFB    000H                        ;53ab  00           12833  12852 
    DEFB    07EH                        ;53ac  7e           12834  12853 
    DEFB    000H                        ;53ad  00           12835  12854 
    DEFB    000H                        ;53ae  00           12836  12855 
    DEFB    000H                        ;53af  00           12837  12856 
    DEFB    000H                        ;53b0  00           12838  12857 
    DEFB    000H                        ;53b1  00           12839  12858 
                                        ;                   12840  12859 ;
                                        ;                   12841  12860 ;CHR$(&H3E)	>
    DEFB    000H                        ;53b2  00           12842  12861 
    DEFB    000H                        ;53b3  00           12843  12862 
    DEFB    070H                        ;53b4  70           12844  12863 
    DEFB    018H                        ;53b5  18           12845  12864 
    DEFB    00CH                        ;53b6  0c           12846  12865 
    DEFB    006H                        ;53b7  06           12847  12866 
    DEFB    00CH                        ;53b8  0c           12848  12867 
    DEFB    018H                        ;53b9  18           12849  12868 
    DEFB    070H                        ;53ba  70           12850  12869 
    DEFB    000H                        ;53bb  00           12851  12870 
    DEFB    000H                        ;53bc  00           12852  12871 
    DEFB    000H                        ;53bd  00           12853  12872 
                                        ;                   12854  12873 ;
                                        ;                   12855  12874 ;CHR$(&H3F)	?
    DEFB    000H                        ;53be  00           12856  12875 
    DEFB    000H                        ;53bf  00           12857  12876 
    DEFB    03CH                        ;53c0  3c           12858  12877 
    DEFB    042H                        ;53c1  42           12859  12878 
    DEFB    002H                        ;53c2  02           12860  12879 
    DEFB    00CH                        ;53c3  0c           12861  12880 
    DEFB    010H                        ;53c4  10           12862  12881 
    DEFB    000H                        ;53c5  00           12863  12882 
    DEFB    010H                        ;53c6  10           12864  12883 
    DEFB    000H                        ;53c7  00           12865  12884 
    DEFB    000H                        ;53c8  00           12866  12885 
    DEFB    000H                        ;53c9  00           12867  12886 
                                        ;                   12868  12887 ;
                                        ;                   12869  12888 ;CHR$(&H40)	@
    DEFB    000H                        ;53ca  00           12870  12889 
    DEFB    000H                        ;53cb  00           12871  12890 
    DEFB    01CH                        ;53cc  1c           12872  12891 
    DEFB    022H                        ;53cd  22           12873  12892 
    DEFB    04AH                        ;53ce  4a           12874  12893 
    DEFB    056H                        ;53cf  56           12875  12894 
    DEFB    04CH                        ;53d0  4c           12876  12895 
    DEFB    020H                        ;53d1  20           12877  12896 
    DEFB    01EH                        ;53d2  1e           12878  12897 
    DEFB    000H                        ;53d3  00           12879  12898 
    DEFB    000H                        ;53d4  00           12880  12899 
    DEFB    000H                        ;53d5  00           12881  12900 
                                        ;                   12882  12901 ;
                                        ;                   12883  12902 ;CHR$(&H41)	A
    DEFB    000H                        ;53d6  00           12884  12903 
    DEFB    000H                        ;53d7  00           12885  12904 
    DEFB    018H                        ;53d8  18           12886  12905 
    DEFB    024H                        ;53d9  24           12887  12906 
    DEFB    042H                        ;53da  42           12888  12907 
    DEFB    07EH                        ;53db  7e           12889  12908 
    DEFB    042H                        ;53dc  42           12890  12909 
    DEFB    042H                        ;53dd  42           12891  12910 
    DEFB    042H                        ;53de  42           12892  12911 
    DEFB    000H                        ;53df  00           12893  12912 
    DEFB    000H                        ;53e0  00           12894  12913 
    DEFB    000H                        ;53e1  00           12895  12914 
                                        ;                   12896  12915 ;
                                        ;                   12897  12916 ;CHR$(&H42)	B
    DEFB    000H                        ;53e2  00           12898  12917 
    DEFB    000H                        ;53e3  00           12899  12918 
    DEFB    07CH                        ;53e4  7c           12900  12919 
    DEFB    042H                        ;53e5  42           12901  12920 
    DEFB    042H                        ;53e6  42           12902  12921 
    DEFB    07CH                        ;53e7  7c           12903  12922 
    DEFB    042H                        ;53e8  42           12904  12923 
    DEFB    042H                        ;53e9  42           12905  12924 
    DEFB    07CH                        ;53ea  7c           12906  12925 
    DEFB    000H                        ;53eb  00           12907  12926 
    DEFB    000H                        ;53ec  00           12908  12927 
    DEFB    000H                        ;53ed  00           12909  12928 
                                        ;                   12910  12929 ;
                                        ;                   12911  12930 ;CHR$(&H43)	C
    DEFB    000H                        ;53ee  00           12912  12931 
    DEFB    000H                        ;53ef  00           12913  12932 
    DEFB    01CH                        ;53f0  1c           12914  12933 
    DEFB    022H                        ;53f1  22           12915  12934 
    DEFB    040H                        ;53f2  40           12916  12935 
    DEFB    040H                        ;53f3  40           12917  12936 
    DEFB    040H                        ;53f4  40           12918  12937 
    DEFB    022H                        ;53f5  22           12919  12938 
    DEFB    01CH                        ;53f6  1c           12920  12939 
    DEFB    000H                        ;53f7  00           12921  12940 
    DEFB    000H                        ;53f8  00           12922  12941 
    DEFB    000H                        ;53f9  00           12923  12942 
                                        ;                   12924  12943 ;
                                        ;                   12925  12944 ;CHR$(&H44)	D
    DEFB    000H                        ;53fa  00           12926  12945 
    DEFB    000H                        ;53fb  00           12927  12946 
    DEFB    078H                        ;53fc  78           12928  12947 
    DEFB    024H                        ;53fd  24           12929  12948 
    DEFB    022H                        ;53fe  22           12930  12949 
    DEFB    022H                        ;53ff  22           12931  12950 
    DEFB    022H                        ;5400  22           12932  12951 
    DEFB    024H                        ;5401  24           12933  12952 
    DEFB    078H                        ;5402  78           12934  12953 
    DEFB    000H                        ;5403  00           12935  12954 
    DEFB    000H                        ;5404  00           12936  12955 
    DEFB    000H                        ;5405  00           12937  12956 
                                        ;                   12938  12957 ;
                                        ;                   12939  12958 ;CHR$(&H45)	E
    DEFB    000H                        ;5406  00           12940  12959 
    DEFB    000H                        ;5407  00           12941  12960 
    DEFB    07EH                        ;5408  7e           12942  12961 
    DEFB    040H                        ;5409  40           12943  12962 
    DEFB    040H                        ;540a  40           12944  12963 
    DEFB    078H                        ;540b  78           12945  12964 
    DEFB    040H                        ;540c  40           12946  12965 
    DEFB    040H                        ;540d  40           12947  12966 
    DEFB    07EH                        ;540e  7e           12948  12967 
    DEFB    000H                        ;540f  00           12949  12968 
    DEFB    000H                        ;5410  00           12950  12969 
    DEFB    000H                        ;5411  00           12951  12970 
                                        ;                   12952  12971 ;
                                        ;                   12953  12972 ;CHR$(&H46)	F
    DEFB    000H                        ;5412  00           12954  12973 
    DEFB    000H                        ;5413  00           12955  12974 
    DEFB    07EH                        ;5414  7e           12956  12975 
    DEFB    040H                        ;5415  40           12957  12976 
    DEFB    040H                        ;5416  40           12958  12977 
    DEFB    078H                        ;5417  78           12959  12978 
    DEFB    040H                        ;5418  40           12960  12979 
    DEFB    040H                        ;5419  40           12961  12980 
    DEFB    040H                        ;541a  40           12962  12981 
    DEFB    000H                        ;541b  00           12963  12982 
    DEFB    000H                        ;541c  00           12964  12983 
    DEFB    000H                        ;541d  00           12965  12984 
                                        ;                   12966  12985 ;
                                        ;                   12967  12986 ;CHR$(&H47)	G
    DEFB    000H                        ;541e  00           12968  12987 
    DEFB    000H                        ;541f  00           12969  12988 
    DEFB    01CH                        ;5420  1c           12970  12989 
    DEFB    022H                        ;5421  22           12971  12990 
    DEFB    040H                        ;5422  40           12972  12991 
    DEFB    04EH                        ;5423  4e           12973  12992 
    DEFB    042H                        ;5424  42           12974  12993 
    DEFB    022H                        ;5425  22           12975  12994 
    DEFB    01CH                        ;5426  1c           12976  12995 
    DEFB    000H                        ;5427  00           12977  12996 
    DEFB    000H                        ;5428  00           12978  12997 
    DEFB    000H                        ;5429  00           12979  12998 
                                        ;                   12980  12999 ;
                                        ;                   12981  13000 ;CHR$(&H48)	H
    DEFB    000H                        ;542a  00           12982  13001 
    DEFB    000H                        ;542b  00           12983  13002 
    DEFB    042H                        ;542c  42           12984  13003 
    DEFB    042H                        ;542d  42           12985  13004 
    DEFB    042H                        ;542e  42           12986  13005 
    DEFB    07EH                        ;542f  7e           12987  13006 
    DEFB    042H                        ;5430  42           12988  13007 
    DEFB    042H                        ;5431  42           12989  13008 
    DEFB    042H                        ;5432  42           12990  13009 
    DEFB    000H                        ;5433  00           12991  13010 
    DEFB    000H                        ;5434  00           12992  13011 
    DEFB    000H                        ;5435  00           12993  13012 
                                        ;                   12994  13013 ;
                                        ;                   12995  13014 ;CHR$(&H49)	I
    DEFB    000H                        ;5436  00           12996  13015 
    DEFB    000H                        ;5437  00           12997  13016 
    DEFB    038H                        ;5438  38           12998  13017 
    DEFB    010H                        ;5439  10           12999  13018 
    DEFB    010H                        ;543a  10           13000  13019 
    DEFB    010H                        ;543b  10           13001  13020 
    DEFB    010H                        ;543c  10           13002  13021 
    DEFB    010H                        ;543d  10           13003  13022 
    DEFB    038H                        ;543e  38           13004  13023 
    DEFB    000H                        ;543f  00           13005  13024 
    DEFB    000H                        ;5440  00           13006  13025 
    DEFB    000H                        ;5441  00           13007  13026 
                                        ;                   13008  13027 ;
                                        ;                   13009  13028 ;CHR$(&H4A)	J
    DEFB    000H                        ;5442  00           13010  13029 
    DEFB    000H                        ;5443  00           13011  13030 
    DEFB    00EH                        ;5444  0e           13012  13031 
    DEFB    004H                        ;5445  04           13013  13032 
    DEFB    004H                        ;5446  04           13014  13033 
    DEFB    004H                        ;5447  04           13015  13034 
    DEFB    004H                        ;5448  04           13016  13035 
    DEFB    044H                        ;5449  44           13017  13036 
    DEFB    038H                        ;544a  38           13018  13037 
    DEFB    000H                        ;544b  00           13019  13038 
    DEFB    000H                        ;544c  00           13020  13039 
    DEFB    000H                        ;544d  00           13021  13040 
                                        ;                   13022  13041 ;
                                        ;                   13023  13042 ;CHR$(&H4B)	K
    DEFB    000H                        ;544e  00           13024  13043 
    DEFB    000H                        ;544f  00           13025  13044 
    DEFB    042H                        ;5450  42           13026  13045 
    DEFB    044H                        ;5451  44           13027  13046 
    DEFB    048H                        ;5452  48           13028  13047 
    DEFB    070H                        ;5453  70           13029  13048 
    DEFB    048H                        ;5454  48           13030  13049 
    DEFB    044H                        ;5455  44           13031  13050 
    DEFB    042H                        ;5456  42           13032  13051 
    DEFB    000H                        ;5457  00           13033  13052 
    DEFB    000H                        ;5458  00           13034  13053 
    DEFB    000H                        ;5459  00           13035  13054 
                                        ;                   13036  13055 ;
                                        ;                   13037  13056 ;CHR$(&H4C)	L
    DEFB    000H                        ;545a  00           13038  13057 
    DEFB    000H                        ;545b  00           13039  13058 
    DEFB    040H                        ;545c  40           13040  13059 
    DEFB    040H                        ;545d  40           13041  13060 
    DEFB    040H                        ;545e  40           13042  13061 
    DEFB    040H                        ;545f  40           13043  13062 
    DEFB    040H                        ;5460  40           13044  13063 
    DEFB    040H                        ;5461  40           13045  13064 
    DEFB    07EH                        ;5462  7e           13046  13065 
    DEFB    000H                        ;5463  00           13047  13066 
    DEFB    000H                        ;5464  00           13048  13067 
    DEFB    000H                        ;5465  00           13049  13068 
                                        ;                   13050  13069 ;
                                        ;                   13051  13070 ;CHR$(&H4D)	M
    DEFB    000H                        ;5466  00           13052  13071 
    DEFB    000H                        ;5467  00           13053  13072 
    DEFB    042H                        ;5468  42           13054  13073 
    DEFB    066H                        ;5469  66           13055  13074 
    DEFB    05AH                        ;546a  5a           13056  13075 
    DEFB    05AH                        ;546b  5a           13057  13076 
    DEFB    042H                        ;546c  42           13058  13077 
    DEFB    042H                        ;546d  42           13059  13078 
    DEFB    042H                        ;546e  42           13060  13079 
    DEFB    000H                        ;546f  00           13061  13080 
    DEFB    000H                        ;5470  00           13062  13081 
    DEFB    000H                        ;5471  00           13063  13082 
                                        ;                   13064  13083 ;
                                        ;                   13065  13084 ;CHR$(&H4E)	N
    DEFB    000H                        ;5472  00           13066  13085 
    DEFB    000H                        ;5473  00           13067  13086 
    DEFB    042H                        ;5474  42           13068  13087 
    DEFB    062H                        ;5475  62           13069  13088 
    DEFB    052H                        ;5476  52           13070  13089 
    DEFB    04AH                        ;5477  4a           13071  13090 
    DEFB    046H                        ;5478  46           13072  13091 
    DEFB    042H                        ;5479  42           13073  13092 
    DEFB    042H                        ;547a  42           13074  13093 
    DEFB    000H                        ;547b  00           13075  13094 
    DEFB    000H                        ;547c  00           13076  13095 
    DEFB    000H                        ;547d  00           13077  13096 
                                        ;                   13078  13097 ;
                                        ;                   13079  13098 ;CHR$(&H4F)	O
    DEFB    000H                        ;547e  00           13080  13099 
    DEFB    000H                        ;547f  00           13081  13100 
    DEFB    018H                        ;5480  18           13082  13101 
    DEFB    024H                        ;5481  24           13083  13102 
    DEFB    042H                        ;5482  42           13084  13103 
    DEFB    042H                        ;5483  42           13085  13104 
    DEFB    042H                        ;5484  42           13086  13105 
    DEFB    024H                        ;5485  24           13087  13106 
    DEFB    018H                        ;5486  18           13088  13107 
    DEFB    000H                        ;5487  00           13089  13108 
    DEFB    000H                        ;5488  00           13090  13109 
    DEFB    000H                        ;5489  00           13091  13110 
                                        ;                   13092  13111 ;
                                        ;                   13093  13112 ;CHR$(&H50)	P
    DEFB    000H                        ;548a  00           13094  13113 
    DEFB    000H                        ;548b  00           13095  13114 
    DEFB    07CH                        ;548c  7c           13096  13115 
    DEFB    042H                        ;548d  42           13097  13116 
    DEFB    042H                        ;548e  42           13098  13117 
    DEFB    07CH                        ;548f  7c           13099  13118 
    DEFB    040H                        ;5490  40           13100  13119 
    DEFB    040H                        ;5491  40           13101  13120 
    DEFB    040H                        ;5492  40           13102  13121 
    DEFB    000H                        ;5493  00           13103  13122 
    DEFB    000H                        ;5494  00           13104  13123 
    DEFB    000H                        ;5495  00           13105  13124 
                                        ;                   13106  13125 ;
                                        ;                   13107  13126 ;CHR$(&H51)	Q
    DEFB    000H                        ;5496  00           13108  13127 
    DEFB    000H                        ;5497  00           13109  13128 
    DEFB    018H                        ;5498  18           13110  13129 
    DEFB    024H                        ;5499  24           13111  13130 
    DEFB    042H                        ;549a  42           13112  13131 
    DEFB    042H                        ;549b  42           13113  13132 
    DEFB    04AH                        ;549c  4a           13114  13133 
    DEFB    024H                        ;549d  24           13115  13134 
    DEFB    01AH                        ;549e  1a           13116  13135 
    DEFB    000H                        ;549f  00           13117  13136 
    DEFB    000H                        ;54a0  00           13118  13137 
    DEFB    000H                        ;54a1  00           13119  13138 
                                        ;                   13120  13139 ;
                                        ;                   13121  13140 ;CHR$(&H52)	R
    DEFB    000H                        ;54a2  00           13122  13141 
    DEFB    000H                        ;54a3  00           13123  13142 
    DEFB    07CH                        ;54a4  7c           13124  13143 
    DEFB    042H                        ;54a5  42           13125  13144 
    DEFB    042H                        ;54a6  42           13126  13145 
    DEFB    07CH                        ;54a7  7c           13127  13146 
    DEFB    048H                        ;54a8  48           13128  13147 
    DEFB    044H                        ;54a9  44           13129  13148 
    DEFB    042H                        ;54aa  42           13130  13149 
    DEFB    000H                        ;54ab  00           13131  13150 
    DEFB    000H                        ;54ac  00           13132  13151 
    DEFB    000H                        ;54ad  00           13133  13152 
                                        ;                   13134  13153 ;
                                        ;                   13135  13154 ;CHR$(&H53)	S
    DEFB    000H                        ;54ae  00           13136  13155 
    DEFB    000H                        ;54af  00           13137  13156 
    DEFB    03CH                        ;54b0  3c           13138  13157 
    DEFB    042H                        ;54b1  42           13139  13158 
    DEFB    040H                        ;54b2  40           13140  13159 
    DEFB    03CH                        ;54b3  3c           13141  13160 
    DEFB    002H                        ;54b4  02           13142  13161 
    DEFB    042H                        ;54b5  42           13143  13162 
    DEFB    03CH                        ;54b6  3c           13144  13163 
    DEFB    000H                        ;54b7  00           13145  13164 
    DEFB    000H                        ;54b8  00           13146  13165 
    DEFB    000H                        ;54b9  00           13147  13166 
                                        ;                   13148  13167 ;
                                        ;                   13149  13168 ;CHR$(&H54)	T
    DEFB    000H                        ;54ba  00           13150  13169 
    DEFB    000H                        ;54bb  00           13151  13170 
    DEFB    07CH                        ;54bc  7c           13152  13171 
    DEFB    010H                        ;54bd  10           13153  13172 
    DEFB    010H                        ;54be  10           13154  13173 
    DEFB    010H                        ;54bf  10           13155  13174 
    DEFB    010H                        ;54c0  10           13156  13175 
    DEFB    010H                        ;54c1  10           13157  13176 
    DEFB    010H                        ;54c2  10           13158  13177 
    DEFB    000H                        ;54c3  00           13159  13178 
    DEFB    000H                        ;54c4  00           13160  13179 
    DEFB    000H                        ;54c5  00           13161  13180 
                                        ;                   13162  13181 ;
                                        ;                   13163  13182 ;CHR$(&H55)	U
    DEFB    000H                        ;54c6  00           13164  13183 
    DEFB    000H                        ;54c7  00           13165  13184 
    DEFB    042H                        ;54c8  42           13166  13185 
    DEFB    042H                        ;54c9  42           13167  13186 
    DEFB    042H                        ;54ca  42           13168  13187 
    DEFB    042H                        ;54cb  42           13169  13188 
    DEFB    042H                        ;54cc  42           13170  13189 
    DEFB    042H                        ;54cd  42           13171  13190 
    DEFB    03CH                        ;54ce  3c           13172  13191 
    DEFB    000H                        ;54cf  00           13173  13192 
    DEFB    000H                        ;54d0  00           13174  13193 
    DEFB    000H                        ;54d1  00           13175  13194 
                                        ;                   13176  13195 ;
                                        ;                   13177  13196 ;CHR$(&H56)	V
    DEFB    000H                        ;54d2  00           13178  13197 
    DEFB    000H                        ;54d3  00           13179  13198 
    DEFB    042H                        ;54d4  42           13180  13199 
    DEFB    042H                        ;54d5  42           13181  13200 
    DEFB    042H                        ;54d6  42           13182  13201 
    DEFB    024H                        ;54d7  24           13183  13202 
    DEFB    024H                        ;54d8  24           13184  13203 
    DEFB    018H                        ;54d9  18           13185  13204 
    DEFB    018H                        ;54da  18           13186  13205 
    DEFB    000H                        ;54db  00           13187  13206 
    DEFB    000H                        ;54dc  00           13188  13207 
    DEFB    000H                        ;54dd  00           13189  13208 
                                        ;                   13190  13209 ;
                                        ;                   13191  13210 ;CHR$(&H57)	W
    DEFB    000H                        ;54de  00           13192  13211 
    DEFB    000H                        ;54df  00           13193  13212 
    DEFB    042H                        ;54e0  42           13194  13213 
    DEFB    042H                        ;54e1  42           13195  13214 
    DEFB    042H                        ;54e2  42           13196  13215 
    DEFB    05AH                        ;54e3  5a           13197  13216 
    DEFB    05AH                        ;54e4  5a           13198  13217 
    DEFB    066H                        ;54e5  66           13199  13218 
    DEFB    042H                        ;54e6  42           13200  13219 
    DEFB    000H                        ;54e7  00           13201  13220 
    DEFB    000H                        ;54e8  00           13202  13221 
    DEFB    000H                        ;54e9  00           13203  13222 
                                        ;                   13204  13223 ;
                                        ;                   13205  13224 ;CHR$(&H58)	X
    DEFB    000H                        ;54ea  00           13206  13225 
    DEFB    000H                        ;54eb  00           13207  13226 
    DEFB    042H                        ;54ec  42           13208  13227 
    DEFB    042H                        ;54ed  42           13209  13228 
    DEFB    024H                        ;54ee  24           13210  13229 
    DEFB    018H                        ;54ef  18           13211  13230 
    DEFB    024H                        ;54f0  24           13212  13231 
    DEFB    042H                        ;54f1  42           13213  13232 
    DEFB    042H                        ;54f2  42           13214  13233 
    DEFB    000H                        ;54f3  00           13215  13234 
    DEFB    000H                        ;54f4  00           13216  13235 
    DEFB    000H                        ;54f5  00           13217  13236 
                                        ;                   13218  13237 ;
                                        ;                   13219  13238 ;CHR$(&H59)	Y
    DEFB    000H                        ;54f6  00           13220  13239 
    DEFB    000H                        ;54f7  00           13221  13240 
    DEFB    044H                        ;54f8  44           13222  13241 
    DEFB    044H                        ;54f9  44           13223  13242 
    DEFB    044H                        ;54fa  44           13224  13243 
    DEFB    038H                        ;54fb  38           13225  13244 
    DEFB    010H                        ;54fc  10           13226  13245 
    DEFB    010H                        ;54fd  10           13227  13246 
    DEFB    010H                        ;54fe  10           13228  13247 
    DEFB    000H                        ;54ff  00           13229  13248 
    DEFB    000H                        ;5500  00           13230  13249 
    DEFB    000H                        ;5501  00           13231  13250 
                                        ;                   13232  13251 ;
                                        ;                   13233  13252 ;CHR$(&H5A)	Z
    DEFB    000H                        ;5502  00           13234  13253 
    DEFB    000H                        ;5503  00           13235  13254 
    DEFB    07EH                        ;5504  7e           13236  13255 
    DEFB    002H                        ;5505  02           13237  13256 
    DEFB    004H                        ;5506  04           13238  13257 
    DEFB    018H                        ;5507  18           13239  13258 
    DEFB    020H                        ;5508  20           13240  13259 
    DEFB    040H                        ;5509  40           13241  13260 
    DEFB    07EH                        ;550a  7e           13242  13261 
    DEFB    000H                        ;550b  00           13243  13262 
    DEFB    000H                        ;550c  00           13244  13263 
    DEFB    000H                        ;550d  00           13245  13264 
                                        ;                   13246  13265 ;
                                        ;                   13247  13266 ;CHR$(&H5B)	[
    DEFB    000H                        ;550e  00           13248  13267 
    DEFB    000H                        ;550f  00           13249  13268 
    DEFB    03CH                        ;5510  3c           13250  13269 
    DEFB    020H                        ;5511  20           13251  13270 
    DEFB    020H                        ;5512  20           13252  13271 
    DEFB    020H                        ;5513  20           13253  13272 
    DEFB    020H                        ;5514  20           13254  13273 
    DEFB    020H                        ;5515  20           13255  13274 
    DEFB    03CH                        ;5516  3c           13256  13275 
    DEFB    000H                        ;5517  00           13257  13276 
    DEFB    000H                        ;5518  00           13258  13277 
    DEFB    000H                        ;5519  00           13259  13278 
                                        ;                   13260  13279 ;
                                        ;                   13261  13280 ;CHR$(&H5C)
    DEFB    000H                        ;551a  00           13262  13281 
    DEFB    080H                        ;551b  80           13263  13282 
    DEFB    080H                        ;551c  80           13264  13283 
    DEFB    040H                        ;551d  40           13265  13284 
    DEFB    020H                        ;551e  20           13266  13285 
    DEFB    010H                        ;551f  10           13267  13286 
    DEFB    008H                        ;5520  08           13268  13287 
    DEFB    004H                        ;5521  04           13269  13288 
    DEFB    002H                        ;5522  02           13270  13289 
    DEFB    001H                        ;5523  01           13271  13290 
    DEFB    001H                        ;5524  01           13272  13291 
    DEFB    000H                        ;5525  00           13273  13292 
                                        ;                   13274  13293 ;
                                        ;                   13275  13294 ;CHR$(&H5D)	]
    DEFB    000H                        ;5526  00           13276  13295 
    DEFB    000H                        ;5527  00           13277  13296 
    DEFB    078H                        ;5528  78           13278  13297 
    DEFB    008H                        ;5529  08           13279  13298 
    DEFB    008H                        ;552a  08           13280  13299 
    DEFB    008H                        ;552b  08           13281  13300 
    DEFB    008H                        ;552c  08           13282  13301 
    DEFB    008H                        ;552d  08           13283  13302 
    DEFB    078H                        ;552e  78           13284  13303 
    DEFB    000H                        ;552f  00           13285  13304 
    DEFB    000H                        ;5530  00           13286  13305 
    DEFB    000H                        ;5531  00           13287  13306 
                                        ;                   13288  13307 ;
                                        ;                   13289  13308 ;CHR$(&H5E)	↑
    DEFB    000H                        ;5532  00           13290  13309 
    DEFB    000H                        ;5533  00           13291  13310 
    DEFB    010H                        ;5534  10           13292  13311 
    DEFB    028H                        ;5535  28           13293  13312 
    DEFB    044H                        ;5536  44           13294  13313 
    DEFB    010H                        ;5537  10           13295  13314 
    DEFB    010H                        ;5538  10           13296  13315 
    DEFB    010H                        ;5539  10           13297  13316 
    DEFB    010H                        ;553a  10           13298  13317 
    DEFB    000H                        ;553b  00           13299  13318 
    DEFB    000H                        ;553c  00           13300  13319 
    DEFB    000H                        ;553d  00           13301  13320 
                                        ;                   13302  13321 ;
                                        ;                   13303  13322 ;CHR$(&H5F)	←
    DEFB    000H                        ;553e  00           13304  13323 
    DEFB    000H                        ;553f  00           13305  13324 
    DEFB    020H                        ;5540  20           13306  13325 
    DEFB    040H                        ;5541  40           13307  13326 
    DEFB    0FEH                        ;5542  fe           13308  13327 
    DEFB    040H                        ;5543  40           13309  13328 
    DEFB    020H                        ;5544  20           13310  13329 
    DEFB    000H                        ;5545  00           13311  13330 
    DEFB    000H                        ;5546  00           13312  13331 
    DEFB    000H                        ;5547  00           13313  13332 
    DEFB    000H                        ;5548  00           13314  13333 
    DEFB    000H                        ;5549  00           13315  13334 
                                        ;                   13316  13335 ;
                                        ;                   13317  13336 ;
                                        ;                   13318  13337 ;
$CGBUF:                                 ;                   13319  13338 
                                        ;                   13320  13339 ;
                                        ;                   13321  13340 ;CHR$(&H80)
    DEFB    000H                        ;554a  00           13322  13341 
    DEFB    000H                        ;554b  00           13323  13342 
    DEFB    000H                        ;554c  00           13324  13343 
    DEFB    000H                        ;554d  00           13325  13344 
    DEFB    000H                        ;554e  00           13326  13345 
    DEFB    000H                        ;554f  00           13327  13346 
    DEFB    000H                        ;5550  00           13328  13347 
    DEFB    000H                        ;5551  00           13329  13348 
    DEFB    000H                        ;5552  00           13330  13349 
    DEFB    000H                        ;5553  00           13331  13350 
    DEFB    000H                        ;5554  00           13332  13351 
    DEFB    000H                        ;5555  00           13333  13352 
                                        ;                   13334  13353 ;
                                        ;                   13335  13354 ;CHR$(&H81)
    DEFB    000H                        ;5556  00           13336  13355 
    DEFB    000H                        ;5557  00           13337  13356 
    DEFB    000H                        ;5558  00           13338  13357 
    DEFB    03CH                        ;5559  3c           13339  13358 
    DEFB    042H                        ;555a  42           13340  13359 
    DEFB    042H                        ;555b  42           13341  13360 
    DEFB    042H                        ;555c  42           13342  13361 
    DEFB    042H                        ;555d  42           13343  13362 
    DEFB    03CH                        ;555e  3c           13344  13363 
    DEFB    000H                        ;555f  00           13345  13364 
    DEFB    000H                        ;5560  00           13346  13365 
    DEFB    000H                        ;5561  00           13347  13366 
                                        ;                   13348  13367 ;
                                        ;                   13349  13368 ;CHR$(&H82)
    DEFB    000H                        ;5562  00           13350  13369 
    DEFB    000H                        ;5563  00           13351  13370 
    DEFB    000H                        ;5564  00           13352  13371 
    DEFB    03CH                        ;5565  3c           13353  13372 
    DEFB    07EH                        ;5566  7e           13354  13373 
    DEFB    07EH                        ;5567  7e           13355  13374 
    DEFB    07EH                        ;5568  7e           13356  13375 
    DEFB    07EH                        ;5569  7e           13357  13376 
    DEFB    03CH                        ;556a  3c           13358  13377 
    DEFB    000H                        ;556b  00           13359  13378 
    DEFB    000H                        ;556c  00           13360  13379 
    DEFB    000H                        ;556d  00           13361  13380 
                                        ;                   13362  13381 ;
                                        ;                   13363  13382 ;CHR$(&H83)
    DEFB    000H                        ;556e  00           13364  13383 
    DEFB    000H                        ;556f  00           13365  13384 
    DEFB    000H                        ;5570  00           13366  13385 
    DEFB    008H                        ;5571  08           13367  13386 
    DEFB    008H                        ;5572  08           13368  13387 
    DEFB    008H                        ;5573  08           13369  13388 
    DEFB    02AH                        ;5574  2a           13370  13389 
    DEFB    01CH                        ;5575  1c           13371  13390 
    DEFB    008H                        ;5576  08           13372  13391 
    DEFB    000H                        ;5577  00           13373  13392 
    DEFB    000H                        ;5578  00           13374  13393 
    DEFB    000H                        ;5579  00           13375  13394 
                                        ;                   13376  13395 ;
                                        ;                   13377  13396 ;CHR$(&H84)
    DEFB    000H                        ;557a  00           13378  13397 
    DEFB    000H                        ;557b  00           13379  13398 
    DEFB    000H                        ;557c  00           13380  13399 
    DEFB    008H                        ;557d  08           13381  13400 
    DEFB    004H                        ;557e  04           13382  13401 
    DEFB    07EH                        ;557f  7e           13383  13402 
    DEFB    004H                        ;5580  04           13384  13403 
    DEFB    008H                        ;5581  08           13385  13404 
    DEFB    000H                        ;5582  00           13386  13405 
    DEFB    000H                        ;5583  00           13387  13406 
    DEFB    000H                        ;5584  00           13388  13407 
    DEFB    000H                        ;5585  00           13389  13408 
                                        ;                   13390  13409 ;
                                        ;                   13391  13410 ;CHR$(&H85)
    DEFB    000H                        ;5586  00           13392  13411 
    DEFB    000H                        ;5587  00           13393  13412 
    DEFB    000H                        ;5588  00           13394  13413 
    DEFB    000H                        ;5589  00           13395  13414 
    DEFB    000H                        ;558a  00           13396  13415 
    DEFB    0F0H                        ;558b  f0           13397  13416 
    DEFB    010H                        ;558c  10           13398  13417 
    DEFB    010H                        ;558d  10           13399  13418 
    DEFB    010H                        ;558e  10           13400  13419 
    DEFB    010H                        ;558f  10           13401  13420 
    DEFB    010H                        ;5590  10           13402  13421 
    DEFB    010H                        ;5591  10           13403  13422 
                                        ;                   13404  13423 ;
                                        ;                   13405  13424 ;CHR$(&H86)
    DEFB    010H                        ;5592  10           13406  13425 
    DEFB    010H                        ;5593  10           13407  13426 
    DEFB    010H                        ;5594  10           13408  13427 
    DEFB    010H                        ;5595  10           13409  13428 
    DEFB    010H                        ;5596  10           13410  13429 
    DEFB    0F0H                        ;5597  f0           13411  13430 
    DEFB    000H                        ;5598  00           13412  13431 
    DEFB    000H                        ;5599  00           13413  13432 
    DEFB    000H                        ;559a  00           13414  13433 
    DEFB    000H                        ;559b  00           13415  13434 
    DEFB    000H                        ;559c  00           13416  13435 
    DEFB    000H                        ;559d  00           13417  13436 
                                        ;                   13418  13437 ;
                                        ;                   13419  13438 ;CHR$(&H87)
    DEFB    000H                        ;559e  00           13420  13439 
    DEFB    000H                        ;559f  00           13421  13440 
    DEFB    000H                        ;55a0  00           13422  13441 
    DEFB    000H                        ;55a1  00           13423  13442 
    DEFB    000H                        ;55a2  00           13424  13443 
    DEFB    01FH                        ;55a3  1f           13425  13444 
    DEFB    010H                        ;55a4  10           13426  13445 
    DEFB    010H                        ;55a5  10           13427  13446 
    DEFB    010H                        ;55a6  10           13428  13447 
    DEFB    010H                        ;55a7  10           13429  13448 
    DEFB    010H                        ;55a8  10           13430  13449 
    DEFB    010H                        ;55a9  10           13431  13450 
                                        ;                   13432  13451 ;
                                        ;                   13433  13452 ;CHR$(&H88)
    DEFB    010H                        ;55aa  10           13434  13453 
    DEFB    010H                        ;55ab  10           13435  13454 
    DEFB    010H                        ;55ac  10           13436  13455 
    DEFB    010H                        ;55ad  10           13437  13456 
    DEFB    010H                        ;55ae  10           13438  13457 
    DEFB    01FH                        ;55af  1f           13439  13458 
    DEFB    000H                        ;55b0  00           13440  13459 
    DEFB    000H                        ;55b1  00           13441  13460 
    DEFB    000H                        ;55b2  00           13442  13461 
    DEFB    000H                        ;55b3  00           13443  13462 
    DEFB    000H                        ;55b4  00           13444  13463 
    DEFB    000H                        ;55b5  00           13445  13464 
                                        ;                   13446  13465 ;
                                        ;                   13447  13466 ;CHR$(&H89)
    DEFB    010H                        ;55b6  10           13448  13467 
    DEFB    010H                        ;55b7  10           13449  13468 
    DEFB    010H                        ;55b8  10           13450  13469 
    DEFB    010H                        ;55b9  10           13451  13470 
    DEFB    010H                        ;55ba  10           13452  13471 
    DEFB    0FFH                        ;55bb  ff           13453  13472 
    DEFB    010H                        ;55bc  10           13454  13473 
    DEFB    010H                        ;55bd  10           13455  13474 
    DEFB    010H                        ;55be  10           13456  13475 
    DEFB    010H                        ;55bf  10           13457  13476 
    DEFB    010H                        ;55c0  10           13458  13477 
    DEFB    010H                        ;55c1  10           13459  13478 
                                        ;                   13460  13479 ;
                                        ;                   13461  13480 ;CHR$(&H8A)
    DEFB    010H                        ;55c2  10           13462  13481 
    DEFB    010H                        ;55c3  10           13463  13482 
    DEFB    010H                        ;55c4  10           13464  13483 
    DEFB    010H                        ;55c5  10           13465  13484 
    DEFB    010H                        ;55c6  10           13466  13485 
    DEFB    010H                        ;55c7  10           13467  13486 
    DEFB    010H                        ;55c8  10           13468  13487 
    DEFB    010H                        ;55c9  10           13469  13488 
    DEFB    010H                        ;55ca  10           13470  13489 
    DEFB    010H                        ;55cb  10           13471  13490 
    DEFB    010H                        ;55cc  10           13472  13491 
    DEFB    010H                        ;55cd  10           13473  13492 
                                        ;                   13474  13493 ;
                                        ;                   13475  13494 ;CHR$(&H8B)
    DEFB    000H                        ;55ce  00           13476  13495 
    DEFB    000H                        ;55cf  00           13477  13496 
    DEFB    000H                        ;55d0  00           13478  13497 
    DEFB    000H                        ;55d1  00           13479  13498 
    DEFB    000H                        ;55d2  00           13480  13499 
    DEFB    0FFH                        ;55d3  ff           13481  13500 
    DEFB    000H                        ;55d4  00           13482  13501 
    DEFB    000H                        ;55d5  00           13483  13502 
    DEFB    000H                        ;55d6  00           13484  13503 
    DEFB    000H                        ;55d7  00           13485  13504 
    DEFB    000H                        ;55d8  00           13486  13505 
    DEFB    000H                        ;55d9  00           13487  13506 
                                        ;                   13488  13507 ;
                                        ;                   13489  13508 ;CHR$(&H8C)
    DEFB    010H                        ;55da  10           13490  13509 
    DEFB    010H                        ;55db  10           13491  13510 
    DEFB    010H                        ;55dc  10           13492  13511 
    DEFB    010H                        ;55dd  10           13493  13512 
    DEFB    010H                        ;55de  10           13494  13513 
    DEFB    0FFH                        ;55df  ff           13495  13514 
    DEFB    000H                        ;55e0  00           13496  13515 
    DEFB    000H                        ;55e1  00           13497  13516 
    DEFB    000H                        ;55e2  00           13498  13517 
    DEFB    000H                        ;55e3  00           13499  13518 
    DEFB    000H                        ;55e4  00           13500  13519 
    DEFB    000H                        ;55e5  00           13501  13520 
                                        ;                   13502  13521 ;
                                        ;                   13503  13522 ;CHR$(&H8D)
    DEFB    000H                        ;55e6  00           13504  13523 
    DEFB    000H                        ;55e7  00           13505  13524 
    DEFB    000H                        ;55e8  00           13506  13525 
    DEFB    000H                        ;55e9  00           13507  13526 
    DEFB    000H                        ;55ea  00           13508  13527 
    DEFB    0FFH                        ;55eb  ff           13509  13528 
    DEFB    010H                        ;55ec  10           13510  13529 
    DEFB    010H                        ;55ed  10           13511  13530 
    DEFB    010H                        ;55ee  10           13512  13531 
    DEFB    010H                        ;55ef  10           13513  13532 
    DEFB    010H                        ;55f0  10           13514  13533 
    DEFB    010H                        ;55f1  10           13515  13534 
                                        ;                   13516  13535 ;
                                        ;                   13517  13536 ;CHR$(&H8E)
    DEFB    010H                        ;55f2  10           13518  13537 
    DEFB    010H                        ;55f3  10           13519  13538 
    DEFB    010H                        ;55f4  10           13520  13539 
    DEFB    010H                        ;55f5  10           13521  13540 
    DEFB    010H                        ;55f6  10           13522  13541 
    DEFB    0F0H                        ;55f7  f0           13523  13542 
    DEFB    010H                        ;55f8  10           13524  13543 
    DEFB    010H                        ;55f9  10           13525  13544 
    DEFB    010H                        ;55fa  10           13526  13545 
    DEFB    010H                        ;55fb  10           13527  13546 
    DEFB    010H                        ;55fc  10           13528  13547 
    DEFB    010H                        ;55fd  10           13529  13548 
                                        ;                   13530  13549 ;
                                        ;                   13531  13550 ;CHR$(&H8F)
    DEFB    010H                        ;55fe  10           13532  13551 
    DEFB    010H                        ;55ff  10           13533  13552 
    DEFB    010H                        ;5600  10           13534  13553 
    DEFB    010H                        ;5601  10           13535  13554 
    DEFB    010H                        ;5602  10           13536  13555 
    DEFB    01FH                        ;5603  1f           13537  13556 
    DEFB    010H                        ;5604  10           13538  13557 
    DEFB    010H                        ;5605  10           13539  13558 
    DEFB    010H                        ;5606  10           13540  13559 
    DEFB    010H                        ;5607  10           13541  13560 
    DEFB    010H                        ;5608  10           13542  13561 
    DEFB    010H                        ;5609  10           13543  13562 
                                        ;                   13544  13563 ;
                                        ;                   13545  13564 ;CHR$(&H90)
    DEFB    000H                        ;560a  00           13546  13565 
    DEFB    072H                        ;560b  72           13547  13566 
    DEFB    08AH                        ;560c  8a           13548  13567 
    DEFB    08AH                        ;560d  8a           13549  13568 
    DEFB    072H                        ;560e  72           13550  13569 
    DEFB    002H                        ;560f  02           13551  13570 
    DEFB    03EH                        ;5610  3e           13552  13571 
    DEFB    002H                        ;5611  02           13553  13572 
    DEFB    03EH                        ;5612  3e           13554  13573 
    DEFB    020H                        ;5613  20           13555  13574 
    DEFB    03EH                        ;5614  3e           13556  13575 
    DEFB    000H                        ;5615  00           13557  13576 
                                        ;                   13558  13577 ;
                                        ;                   13559  13578 ;CHR$(&H91)
    DEFB    000H                        ;5616  00           13560  13579 
    DEFB    072H                        ;5617  72           13561  13580 
    DEFB    08AH                        ;5618  8a           13562  13581 
    DEFB    072H                        ;5619  72           13563  13582 
    DEFB    0FAH                        ;561a  fa           13564  13583 
    DEFB    02EH                        ;561b  2e           13565  13584 
    DEFB    042H                        ;561c  42           13566  13585 
    DEFB    03EH                        ;561d  3e           13567  13586 
    DEFB    03EH                        ;561e  3e           13568  13587 
    DEFB    020H                        ;561f  20           13569  13588 
    DEFB    03EH                        ;5620  3e           13570  13589 
    DEFB    000H                        ;5621  00           13571  13590 
                                        ;                   13572  13591 ;
                                        ;                   13573  13592 ;CHR$(&H92)
    DEFB    000H                        ;5622  00           13574  13593 
    DEFB    022H                        ;5623  22           13575  13594 
    DEFB    022H                        ;5624  22           13576  13595 
    DEFB    0FAH                        ;5625  fa           13577  13596 
    DEFB    002H                        ;5626  02           13578  13597 
    DEFB    072H                        ;5627  72           13579  13598 
    DEFB    08BH                        ;5628  8b           13580  13599 
    DEFB    08AH                        ;5629  8a           13581  13600 
    DEFB    072H                        ;562a  72           13582  13601 
    DEFB    022H                        ;562b  22           13583  13602 
    DEFB    0FAH                        ;562c  fa           13584  13603 
    DEFB    000H                        ;562d  00           13585  13604 
                                        ;                   13586  13605 ;
                                        ;                   13587  13606 ;CHR$(&H93)
    DEFB    000H                        ;562e  00           13588  13607 
    DEFB    010H                        ;562f  10           13589  13608 
    DEFB    010H                        ;5630  10           13590  13609 
    DEFB    028H                        ;5631  28           13591  13610 
    DEFB    044H                        ;5632  44           13592  13611 
    DEFB    082H                        ;5633  82           13593  13612 
    DEFB    000H                        ;5634  00           13594  13613 
    DEFB    0FEH                        ;5635  fe           13595  13614 
    DEFB    010H                        ;5636  10           13596  13615 
    DEFB    010H                        ;5637  10           13597  13616 
    DEFB    010H                        ;5638  10           13598  13617 
    DEFB    010H                        ;5639  10           13599  13618 
                                        ;                   13600  13619 ;
                                        ;                   13601  13620 ;CHR$(&H94)
    DEFB    000H                        ;563a  00           13602  13621 
    DEFB    07CH                        ;563b  7c           13603  13622 
    DEFB    044H                        ;563c  44           13604  13623 
    DEFB    07CH                        ;563d  7c           13605  13624 
    DEFB    010H                        ;563e  10           13606  13625 
    DEFB    0FEH                        ;563f  fe           13607  13626 
    DEFB    000H                        ;5640  00           13608  13627 
    DEFB    07CH                        ;5641  7c           13609  13628 
    DEFB    004H                        ;5642  04           13610  13629 
    DEFB    004H                        ;5643  04           13611  13630 
    DEFB    004H                        ;5644  04           13612  13631 
    DEFB    000H                        ;5645  00           13613  13632 
                                        ;                   13614  13633 ;
                                        ;                   13615  13634 ;CHR$(&H95)
    DEFB    000H                        ;5646  00           13616  13635 
    DEFB    07CH                        ;5647  7c           13617  13636 
    DEFB    004H                        ;5648  04           13618  13637 
    DEFB    004H                        ;5649  04           13619  13638 
    DEFB    000H                        ;564a  00           13620  13639 
    DEFB    0FEH                        ;564b  fe           13621  13640 
    DEFB    000H                        ;564c  00           13622  13641 
    DEFB    07CH                        ;564d  7c           13623  13642 
    DEFB    044H                        ;564e  44           13624  13643 
    DEFB    044H                        ;564f  44           13625  13644 
    DEFB    07CH                        ;5650  7c           13626  13645 
    DEFB    000H                        ;5651  00           13627  13646 
                                        ;                   13628  13647 ;
                                        ;                   13629  13648 ;CHR$(&H96)
    DEFB    000H                        ;5652  00           13630  13649 
    DEFB    07CH                        ;5653  7c           13631  13650 
    DEFB    040H                        ;5654  40           13632  13651 
    DEFB    078H                        ;5655  78           13633  13652 
    DEFB    040H                        ;5656  40           13634  13653 
    DEFB    040H                        ;5657  40           13635  13654 
    DEFB    07CH                        ;5658  7c           13636  13655 
    DEFB    010H                        ;5659  10           13637  13656 
    DEFB    010H                        ;565a  10           13638  13657 
    DEFB    010H                        ;565b  10           13639  13658 
    DEFB    0FEH                        ;565c  fe           13640  13659 
    DEFB    000H                        ;565d  00           13641  13660 
                                        ;                   13642  13661 ;
                                        ;                   13643  13662 ;CHR$(&H97)
    DEFB    000H                        ;565e  00           13644  13663 
    DEFB    082H                        ;565f  82           13645  13664 
    DEFB    08EH                        ;5660  8e           13646  13665 
    DEFB    082H                        ;5661  82           13647  13666 
    DEFB    08EH                        ;5662  8e           13648  13667 
    DEFB    082H                        ;5663  82           13649  13668 
    DEFB    0FAH                        ;5664  fa           13650  13669 
    DEFB    002H                        ;5665  02           13651  13670 
    DEFB    040H                        ;5666  40           13652  13671 
    DEFB    040H                        ;5667  40           13653  13672 
    DEFB    07EH                        ;5668  7e           13654  13673 
    DEFB    000H                        ;5669  00           13655  13674 
                                        ;                   13656  13675 ;
                                        ;                   13657  13676 ;CHR$(&H98)
    DEFB    000H                        ;566a  00           13658  13677 
    DEFB    002H                        ;566b  02           13659  13678 
    DEFB    022H                        ;566c  22           13660  13679 
    DEFB    022H                        ;566d  22           13661  13680 
    DEFB    022H                        ;566e  22           13662  13681 
    DEFB    052H                        ;566f  52           13663  13682 
    DEFB    052H                        ;5670  52           13664  13683 
    DEFB    08AH                        ;5671  8a           13665  13684 
    DEFB    08AH                        ;5672  8a           13666  13685 
    DEFB    002H                        ;5673  02           13667  13686 
    DEFB    002H                        ;5674  02           13668  13687 
    DEFB    000H                        ;5675  00           13669  13688 
                                        ;                   13670  13689 ;
                                        ;                   13671  13690 ;CHR$(&H99)
    DEFB    000H                        ;5676  00           13672  13691 
    DEFB    044H                        ;5677  44           13673  13692 
    DEFB    07CH                        ;5678  7c           13674  13693 
    DEFB    044H                        ;5679  44           13675  13694 
    DEFB    07CH                        ;567a  7c           13676  13695 
    DEFB    000H                        ;567b  00           13677  13696 
    DEFB    0FEH                        ;567c  fe           13678  13697 
    DEFB    010H                        ;567d  10           13679  13698 
    DEFB    050H                        ;567e  50           13680  13699 
    DEFB    040H                        ;567f  40           13681  13700 
    DEFB    07CH                        ;5680  7c           13682  13701 
    DEFB    000H                        ;5681  00           13683  13702 
                                        ;                   13684  13703 ;
                                        ;                   13685  13704 ;CHR$(&H9A)
    DEFB    000H                        ;5682  00           13686  13705 
    DEFB    010H                        ;5683  10           13687  13706 
    DEFB    010H                        ;5684  10           13688  13707 
    DEFB    0FEH                        ;5685  fe           13689  13708 
    DEFB    028H                        ;5686  28           13690  13709 
    DEFB    044H                        ;5687  44           13691  13710 
    DEFB    082H                        ;5688  82           13692  13711 
    DEFB    010H                        ;5689  10           13693  13712 
    DEFB    010H                        ;568a  10           13694  13713 
    DEFB    010H                        ;568b  10           13695  13714 
    DEFB    0FEH                        ;568c  fe           13696  13715 
    DEFB    000H                        ;568d  00           13697  13716 
                                        ;                   13698  13717 ;
                                        ;                   13699  13718 ;CHR$(&H9B)
    DEFB    000H                        ;568e  00           13700  13719 
    DEFB    001H                        ;568f  01           13701  13720 
    DEFB    005H                        ;5690  05           13702  13721 
    DEFB    0F5H                        ;5691  f5           13703  13722 
    DEFB    015H                        ;5692  15           13704  13723 
    DEFB    015H                        ;5693  15           13705  13724 
    DEFB    017H                        ;5694  17           13706  13725 
    DEFB    025H                        ;5695  25           13707  13726 
    DEFB    045H                        ;5696  45           13708  13727 
    DEFB    085H                        ;5697  85           13709  13728 
    DEFB    005H                        ;5698  05           13710  13729 
    DEFB    000H                        ;5699  00           13711  13730 
                                        ;                   13712  13731 ;
                                        ;                   13713  13732 ;CHR$(&H9C)
    DEFB    000H                        ;569a  00           13714  13733 
    DEFB    001H                        ;569b  01           13715  13734 
    DEFB    005H                        ;569c  05           13716  13735 
    DEFB    0F5H                        ;569d  f5           13717  13736 
    DEFB    085H                        ;569e  85           13718  13737 
    DEFB    085H                        ;569f  85           13719  13738 
    DEFB    087H                        ;56a0  87           13720  13739 
    DEFB    085H                        ;56a1  85           13721  13740 
    DEFB    0F5H                        ;56a2  f5           13722  13741 
    DEFB    005H                        ;56a3  05           13723  13742 
    DEFB    005H                        ;56a4  05           13724  13743 
    DEFB    000H                        ;56a5  00           13725  13744 
                                        ;                   13726  13745 ;
                                        ;                   13727  13746 ;CHR$(&H9D)
    DEFB    000H                        ;56a6  00           13728  13747 
    DEFB    002H                        ;56a7  02           13729  13748 
    DEFB    072H                        ;56a8  72           13730  13749 
    DEFB    08AH                        ;56a9  8a           13731  13750 
    DEFB    08AH                        ;56aa  8a           13732  13751 
    DEFB    08AH                        ;56ab  8a           13733  13752 
    DEFB    072H                        ;56ac  72           13734  13753 
    DEFB    002H                        ;56ad  02           13735  13754 
    DEFB    042H                        ;56ae  42           13736  13755 
    DEFB    040H                        ;56af  40           13737  13756 
    DEFB    07EH                        ;56b0  7e           13738  13757 
    DEFB    000H                        ;56b1  00           13739  13758 
                                        ;                   13740  13759 ;
                                        ;                   13741  13760 ;CHR$(&H9E)
    DEFB    000H                        ;56b2  00           13742  13761 
    DEFB    000H                        ;56b3  00           13743  13762 
    DEFB    07CH                        ;56b4  7c           13744  13763 
    DEFB    040H                        ;56b5  40           13745  13764 
    DEFB    040H                        ;56b6  40           13746  13765 
    DEFB    040H                        ;56b7  40           13747  13766 
    DEFB    07CH                        ;56b8  7c           13748  13767 
    DEFB    010H                        ;56b9  10           13749  13768 
    DEFB    010H                        ;56ba  10           13750  13769 
    DEFB    010H                        ;56bb  10           13751  13770 
    DEFB    0FEH                        ;56bc  fe           13752  13771 
    DEFB    000H                        ;56bd  00           13753  13772 
                                        ;                   13754  13773 ;
                                        ;                   13755  13774 ;CHR$(&H9F)
    DEFB    000H                        ;56be  00           13756  13775 
    DEFB    002H                        ;56bf  02           13757  13776 
    DEFB    072H                        ;56c0  72           13758  13777 
    DEFB    08AH                        ;56c1  8a           13759  13778 
    DEFB    072H                        ;56c2  72           13760  13779 
    DEFB    0FAH                        ;56c3  fa           13761  13780 
    DEFB    02EH                        ;56c4  2e           13762  13781 
    DEFB    042H                        ;56c5  42           13763  13782 
    DEFB    022H                        ;56c6  22           13764  13783 
    DEFB    020H                        ;56c7  20           13765  13784 
    DEFB    03EH                        ;56c8  3e           13766  13785 
    DEFB    000H                        ;56c9  00           13767  13786 
                                        ;                   13768  13787 ;
                                        ;                   13769  13788 ;CHR$(&HA0)
    DEFB    000H                        ;56ca  00           13770  13789 
    DEFB    000H                        ;56cb  00           13771  13790 
    DEFB    000H                        ;56cc  00           13772  13791 
    DEFB    03EH                        ;56cd  3e           13773  13792 
    DEFB    022H                        ;56ce  22           13774  13793 
    DEFB    03EH                        ;56cf  3e           13775  13794 
    DEFB    022H                        ;56d0  22           13776  13795 
    DEFB    03EH                        ;56d1  3e           13777  13796 
    DEFB    000H                        ;56d2  00           13778  13797 
    DEFB    000H                        ;56d3  00           13779  13798 
    DEFB    000H                        ;56d4  00           13780  13799 
    DEFB    000H                        ;56d5  00           13781  13800 
                                        ;                   13782  13801 ;
                                        ;                   13783  13802 ;CHR$(&HA1)
    DEFB    000H                        ;56d6  00           13784  13803 
    DEFB    000H                        ;56d7  00           13785  13804 
    DEFB    03EH                        ;56d8  3e           13786  13805 
    DEFB    022H                        ;56d9  22           13787  13806 
    DEFB    03EH                        ;56da  3e           13788  13807 
    DEFB    022H                        ;56db  22           13789  13808 
    DEFB    03EH                        ;56dc  3e           13790  13809 
    DEFB    022H                        ;56dd  22           13791  13810 
    DEFB    042H                        ;56de  42           13792  13811 
    DEFB    000H                        ;56df  00           13793  13812 
    DEFB    000H                        ;56e0  00           13794  13813 
    DEFB    000H                        ;56e1  00           13795  13814 
                                        ;                   13796  13815 ;
                                        ;                   13797  13816 ;CHR$(&HA2)
    DEFB    000H                        ;56e2  00           13798  13817 
    DEFB    000H                        ;56e3  00           13799  13818 
    DEFB    010H                        ;56e4  10           13800  13819 
    DEFB    054H                        ;56e5  54           13801  13820 
    DEFB    054H                        ;56e6  54           13802  13821 
    DEFB    010H                        ;56e7  10           13803  13822 
    DEFB    028H                        ;56e8  28           13804  13823 
    DEFB    044H                        ;56e9  44           13805  13824 
    DEFB    082H                        ;56ea  82           13806  13825 
    DEFB    000H                        ;56eb  00           13807  13826 
    DEFB    000H                        ;56ec  00           13808  13827 
    DEFB    000H                        ;56ed  00           13809  13828 
                                        ;                   13810  13829 ;
                                        ;                   13811  13830 ;CHR$(&HA3)
    DEFB    000H                        ;56ee  00           13812  13831 
    DEFB    000H                        ;56ef  00           13813  13832 
    DEFB    010H                        ;56f0  10           13814  13833 
    DEFB    012H                        ;56f1  12           13815  13834 
    DEFB    0FCH                        ;56f2  fc           13816  13835 
    DEFB    038H                        ;56f3  38           13817  13836 
    DEFB    034H                        ;56f4  34           13818  13837 
    DEFB    052H                        ;56f5  52           13819  13838 
    DEFB    091H                        ;56f6  91           13820  13839 
    DEFB    000H                        ;56f7  00           13821  13840 
    DEFB    000H                        ;56f8  00           13822  13841 
    DEFB    000H                        ;56f9  00           13823  13842 
                                        ;                   13824  13843 ;
                                        ;                   13825  13844 ;CHR$(&HA4)
    DEFB    000H                        ;56fa  00           13826  13845 
    DEFB    000H                        ;56fb  00           13827  13846 
    DEFB    010H                        ;56fc  10           13828  13847 
    DEFB    010H                        ;56fd  10           13829  13848 
    DEFB    0FEH                        ;56fe  fe           13830  13849 
    DEFB    010H                        ;56ff  10           13831  13850 
    DEFB    038H                        ;5700  38           13832  13851 
    DEFB    054H                        ;5701  54           13833  13852 
    DEFB    092H                        ;5702  92           13834  13853 
    DEFB    000H                        ;5703  00           13835  13854 
    DEFB    000H                        ;5704  00           13836  13855 
    DEFB    000H                        ;5705  00           13837  13856 
                                        ;                   13838  13857 ;
                                        ;                   13839  13858 ;CHR$(&HA5)
    DEFB    000H                        ;5706  00           13840  13859 
    DEFB    000H                        ;5707  00           13841  13860 
    DEFB    010H                        ;5708  10           13842  13861 
    DEFB    028H                        ;5709  28           13843  13862 
    DEFB    07CH                        ;570a  7c           13844  13863 
    DEFB    092H                        ;570b  92           13845  13864 
    DEFB    07CH                        ;570c  7c           13846  13865 
    DEFB    054H                        ;570d  54           13847  13866 
    DEFB    0FEH                        ;570e  fe           13848  13867 
    DEFB    000H                        ;570f  00           13849  13868 
    DEFB    000H                        ;5710  00           13850  13869 
    DEFB    000H                        ;5711  00           13851  13870 
                                        ;                   13852  13871 ;
                                        ;                   13853  13872 ;CHR$(&HA6)
    DEFB    000H                        ;5712  00           13854  13873 
    DEFB    000H                        ;5713  00           13855  13874 
    DEFB    010H                        ;5714  10           13856  13875 
    DEFB    010H                        ;5715  10           13857  13876 
    DEFB    010H                        ;5716  10           13858  13877 
    DEFB    07CH                        ;5717  7c           13859  13878 
    DEFB    010H                        ;5718  10           13860  13879 
    DEFB    010H                        ;5719  10           13861  13880 
    DEFB    0FEH                        ;571a  fe           13862  13881 
    DEFB    000H                        ;571b  00           13863  13882 
    DEFB    000H                        ;571c  00           13864  13883 
    DEFB    000H                        ;571d  00           13865  13884 
                                        ;                   13866  13885 ;
                                        ;                   13867  13886 ;CHR$(&HA7)
    DEFB    000H                        ;571e  00           13868  13887 
    DEFB    000H                        ;571f  00           13869  13888 
    DEFB    020H                        ;5720  20           13870  13889 
    DEFB    07EH                        ;5721  7e           13871  13890 
    DEFB    080H                        ;5722  80           13872  13891 
    DEFB    07CH                        ;5723  7c           13873  13892 
    DEFB    050H                        ;5724  50           13874  13893 
    DEFB    0FEH                        ;5725  fe           13875  13894 
    DEFB    010H                        ;5726  10           13876  13895 
    DEFB    000H                        ;5727  00           13877  13896 
    DEFB    000H                        ;5728  00           13878  13897 
    DEFB    000H                        ;5729  00           13879  13898 
                                        ;                   13880  13899 ;
                                        ;                   13881  13900 ;CHR$(&HA8)
    DEFB    000H                        ;572a  00           13882  13901 
    DEFB    000H                        ;572b  00           13883  13902 
    DEFB    008H                        ;572c  08           13884  13903 
    DEFB    0FCH                        ;572d  fc           13885  13904 
    DEFB    0A8H                        ;572e  a8           13886  13905 
    DEFB    0FEH                        ;572f  fe           13887  13906 
    DEFB    0A4H                        ;5730  a4           13888  13907 
    DEFB    0FEH                        ;5731  fe           13889  13908 
    DEFB    014H                        ;5732  14           13890  13909 
    DEFB    004H                        ;5733  04           13891  13910 
    DEFB    000H                        ;5734  00           13892  13911 
    DEFB    000H                        ;5735  00           13893  13912 
                                        ;                   13894  13913 ;
                                        ;                   13895  13914 ;CHR$(&HA9)
    DEFB    000H                        ;5736  00           13896  13915 
    DEFB    000H                        ;5737  00           13897  13916 
    DEFB    010H                        ;5738  10           13898  13917 
    DEFB    028H                        ;5739  28           13899  13918 
    DEFB    044H                        ;573a  44           13900  13919 
    DEFB    0FEH                        ;573b  fe           13901  13920 
    DEFB    014H                        ;573c  14           13902  13921 
    DEFB    024H                        ;573d  24           13903  13922 
    DEFB    048H                        ;573e  48           13904  13923 
    DEFB    000H                        ;573f  00           13905  13924 
    DEFB    000H                        ;5740  00           13906  13925 
    DEFB    000H                        ;5741  00           13907  13926 
                                        ;                   13908  13927 ;
                                        ;                   13909  13928 ;CHR$(&HAA)
    DEFB    000H                        ;5742  00           13910  13929 
    DEFB    000H                        ;5743  00           13911  13930 
    DEFB    074H                        ;5744  74           13912  13931 
    DEFB    024H                        ;5745  24           13913  13932 
    DEFB    0F5H                        ;5746  f5           13914  13933 
    DEFB    065H                        ;5747  65           13915  13934 
    DEFB    0B2H                        ;5748  b2           13916  13935 
    DEFB    0A4H                        ;5749  a4           13917  13936 
    DEFB    028H                        ;574a  28           13918  13937 
    DEFB    000H                        ;574b  00           13919  13938 
    DEFB    000H                        ;574c  00           13920  13939 
    DEFB    000H                        ;574d  00           13921  13940 
                                        ;                   13922  13941 ;
                                        ;                   13923  13942 ;CHR$(&HAB)
    DEFB    000H                        ;574e  00           13924  13943 
    DEFB    000H                        ;574f  00           13925  13944 
    DEFB    010H                        ;5750  10           13926  13945 
    DEFB    010H                        ;5751  10           13927  13946 
    DEFB    010H                        ;5752  10           13928  13947 
    DEFB    054H                        ;5753  54           13929  13948 
    DEFB    092H                        ;5754  92           13930  13949 
    DEFB    030H                        ;5755  30           13931  13950 
    DEFB    010H                        ;5756  10           13932  13951 
    DEFB    000H                        ;5757  00           13933  13952 
    DEFB    000H                        ;5758  00           13934  13953 
    DEFB    000H                        ;5759  00           13935  13954 
                                        ;                   13936  13955 ;
                                        ;                   13937  13956 ;CHR$(&HAC)
    DEFB    000H                        ;575a  00           13938  13957 
    DEFB    000H                        ;575b  00           13939  13958 
    DEFB    010H                        ;575c  10           13940  13959 
    DEFB    010H                        ;575d  10           13941  13960 
    DEFB    0FEH                        ;575e  fe           13942  13961 
    DEFB    010H                        ;575f  10           13943  13962 
    DEFB    028H                        ;5760  28           13944  13963 
    DEFB    044H                        ;5761  44           13945  13964 
    DEFB    082H                        ;5762  82           13946  13965 
    DEFB    000H                        ;5763  00           13947  13966 
    DEFB    000H                        ;5764  00           13948  13967 
    DEFB    000H                        ;5765  00           13949  13968 
                                        ;                   13950  13969 ;
                                        ;                   13951  13970 ;CHR$(&HAD)
    DEFB    000H                        ;5766  00           13952  13971 
    DEFB    000H                        ;5767  00           13953  13972 
    DEFB    000H                        ;5768  00           13954  13973 
    DEFB    010H                        ;5769  10           13955  13974 
    DEFB    010H                        ;576a  10           13956  13975 
    DEFB    010H                        ;576b  10           13957  13976 
    DEFB    028H                        ;576c  28           13958  13977 
    DEFB    044H                        ;576d  44           13959  13978 
    DEFB    082H                        ;576e  82           13960  13979 
    DEFB    000H                        ;576f  00           13961  13980 
    DEFB    000H                        ;5770  00           13962  13981 
    DEFB    000H                        ;5771  00           13963  13982 
                                        ;                   13964  13983 ;
                                        ;                   13965  13984 ;CHR$(&HAE)
    DEFB    000H                        ;5772  00           13966  13985 
    DEFB    000H                        ;5773  00           13967  13986 
    DEFB    010H                        ;5774  10           13968  13987 
    DEFB    028H                        ;5775  28           13969  13988 
    DEFB    07CH                        ;5776  7c           13970  13989 
    DEFB    082H                        ;5777  82           13971  13990 
    DEFB    07CH                        ;5778  7c           13972  13991 
    DEFB    044H                        ;5779  44           13973  13992 
    DEFB    07CH                        ;577a  7c           13974  13993 
    DEFB    000H                        ;577b  00           13975  13994 
    DEFB    000H                        ;577c  00           13976  13995 
    DEFB    000H                        ;577d  00           13977  13996 
                                        ;                   13978  13997 ;
                                        ;                   13979  13998 ;CHR$(&HAF)
    DEFB    000H                        ;577e  00           13980  13999 
    DEFB    000H                        ;577f  00           13981  14000 
    DEFB    03CH                        ;5780  3c           13982  14001 
    DEFB    044H                        ;5781  44           13983  14002 
    DEFB    0A8H                        ;5782  a8           13984  14003 
    DEFB    010H                        ;5783  10           13985  14004 
    DEFB    03EH                        ;5784  3e           13986  14005 
    DEFB    0E2H                        ;5785  e2           13987  14006 
    DEFB    03EH                        ;5786  3e           13988  14007 
    DEFB    000H                        ;5787  00           13989  14008 
    DEFB    000H                        ;5788  00           13990  14009 
    DEFB    000H                        ;5789  00           13991  14010 
                                        ;                   13992  14011 ;
                                        ;                   13993  14012 ;CHR$(&H90)
    DEFB    000H                        ;578a  00           13994  14013 
    DEFB    000H                        ;578b  00           13995  14014 
    DEFB    000H                        ;578c  00           13996  14015 
    DEFB    008H                        ;578d  08           13997  14016 
    DEFB    07FH                        ;578e  7f           13998  14017 
    DEFB    008H                        ;578f  08           13999  14018 
    DEFB    07FH                        ;5790  7f           14000  14019 
    DEFB    008H                        ;5791  08           14001  14020 
    DEFB    000H                        ;5792  00           14002  14021 
    DEFB    000H                        ;5793  00           14003  14022 
    DEFB    000H                        ;5794  00           14004  14023 
    DEFB    000H                        ;5795  00           14005  14024 
                                        ;                   14006  14025 ;
                                        ;                   14007  14026 ;CHR$(&HB1)
    DEFB    000H                        ;5796  00           14008  14027 
    DEFB    000H                        ;5797  00           14009  14028 
    DEFB    006H                        ;5798  06           14010  14029 
    DEFB    018H                        ;5799  18           14011  14030 
    DEFB    020H                        ;579a  20           14012  14031 
    DEFB    018H                        ;579b  18           14013  14032 
    DEFB    006H                        ;579c  06           14014  14033 
    DEFB    000H                        ;579d  00           14015  14034 
    DEFB    03EH                        ;579e  3e           14016  14035 
    DEFB    000H                        ;579f  00           14017  14036 
    DEFB    000H                        ;57a0  00           14018  14037 
    DEFB    000H                        ;57a1  00           14019  14038 
                                        ;                   14020  14039 ;
                                        ;                   14021  14040 ;CHR$(&HB2)
    DEFB    000H                        ;57a2  00           14022  14041 
    DEFB    000H                        ;57a3  00           14023  14042 
    DEFB    030H                        ;57a4  30           14024  14043 
    DEFB    00CH                        ;57a5  0c           14025  14044 
    DEFB    002H                        ;57a6  02           14026  14045 
    DEFB    00CH                        ;57a7  0c           14027  14046 
    DEFB    030H                        ;57a8  30           14028  14047 
    DEFB    000H                        ;57a9  00           14029  14048 
    DEFB    03EH                        ;57aa  3e           14030  14049 
    DEFB    000H                        ;57ab  00           14031  14050 
    DEFB    000H                        ;57ac  00           14032  14051 
    DEFB    000H                        ;57ad  00           14033  14052 
                                        ;                   14034  14053 ;
                                        ;                   14035  14054 ;CHR$(&HB3)
    DEFB    000H                        ;57ae  00           14036  14055 
    DEFB    000H                        ;57af  00           14037  14056 
    DEFB    008H                        ;57b0  08           14038  14057 
    DEFB    008H                        ;57b1  08           14039  14058 
    DEFB    03EH                        ;57b2  3e           14040  14059 
    DEFB    008H                        ;57b3  08           14041  14060 
    DEFB    008H                        ;57b4  08           14042  14061 
    DEFB    000H                        ;57b5  00           14043  14062 
    DEFB    03EH                        ;57b6  3e           14044  14063 
    DEFB    000H                        ;57b7  00           14045  14064 
    DEFB    000H                        ;57b8  00           14046  14065 
    DEFB    000H                        ;57b9  00           14047  14066 
                                        ;                   14048  14067 ;
                                        ;                   14049  14068 ;CHR$(&HB4)
    DEFB    000H                        ;57ba  00           14050  14069 
    DEFB    000H                        ;57bb  00           14051  14070 
    DEFB    000H                        ;57bc  00           14052  14071 
    DEFB    022H                        ;57bd  22           14053  14072 
    DEFB    014H                        ;57be  14           14054  14073 
    DEFB    008H                        ;57bf  08           14055  14074 
    DEFB    014H                        ;57c0  14           14056  14075 
    DEFB    022H                        ;57c1  22           14057  14076 
    DEFB    000H                        ;57c2  00           14058  14077 
    DEFB    000H                        ;57c3  00           14059  14078 
    DEFB    000H                        ;57c4  00           14060  14079 
    DEFB    000H                        ;57c5  00           14061  14080 
                                        ;                   14062  14081 ;
                                        ;                   14063  14082 ;CHR$(&HB5)
    DEFB    000H                        ;57c6  00           14064  14083 
    DEFB    000H                        ;57c7  00           14065  14084 
    DEFB    000H                        ;57c8  00           14066  14085 
    DEFB    03EH                        ;57c9  3e           14067  14086 
    DEFB    049H                        ;57ca  49           14068  14087 
    DEFB    07FH                        ;57cb  7f           14069  14088 
    DEFB    049H                        ;57cc  49           14070  14089 
    DEFB    03EH                        ;57cd  3e           14071  14090 
    DEFB    000H                        ;57ce  00           14072  14091 
    DEFB    000H                        ;57cf  00           14073  14092 
    DEFB    000H                        ;57d0  00           14074  14093 
    DEFB    000H                        ;57d1  00           14075  14094 
                                        ;                   14076  14095 ;
                                        ;                   14077  14096 ;CHR$(&HB6)
    DEFB    000H                        ;57d2  00           14078  14097 
    DEFB    000H                        ;57d3  00           14079  14098 
    DEFB    000H                        ;57d4  00           14080  14099 
    DEFB    000H                        ;57d5  00           14081  14100 
    DEFB    000H                        ;57d6  00           14082  14101 
    DEFB    008H                        ;57d7  08           14083  14102 
    DEFB    000H                        ;57d8  00           14084  14103 
    DEFB    000H                        ;57d9  00           14085  14104 
    DEFB    000H                        ;57da  00           14086  14105 
    DEFB    000H                        ;57db  00           14087  14106 
    DEFB    000H                        ;57dc  00           14088  14107 
    DEFB    000H                        ;57dd  00           14089  14108 
                                        ;                   14090  14109 ;
                                        ;                   14091  14110 ;CHR$(&HB7)
    DEFB    000H                        ;57de  00           14092  14111 
    DEFB    000H                        ;57df  00           14093  14112 
    DEFB    000H                        ;57e0  00           14094  14113 
    DEFB    000H                        ;57e1  00           14095  14114 
    DEFB    008H                        ;57e2  08           14096  14115 
    DEFB    014H                        ;57e3  14           14097  14116 
    DEFB    022H                        ;57e4  22           14098  14117 
    DEFB    07FH                        ;57e5  7f           14099  14118 
    DEFB    000H                        ;57e6  00           14100  14119 
    DEFB    000H                        ;57e7  00           14101  14120 
    DEFB    000H                        ;57e8  00           14102  14121 
    DEFB    000H                        ;57e9  00           14103  14122 
                                        ;                   14104  14123 ;
                                        ;                   14105  14124 ;CHR$(&HB8)
    DEFB    000H                        ;57ea  00           14106  14125 
    DEFB    000H                        ;57eb  00           14107  14126 
    DEFB    000H                        ;57ec  00           14108  14127 
    DEFB    000H                        ;57ed  00           14109  14128 
    DEFB    07FH                        ;57ee  7f           14110  14129 
    DEFB    022H                        ;57ef  22           14111  14130 
    DEFB    014H                        ;57f0  14           14112  14131 
    DEFB    008H                        ;57f1  08           14113  14132 
    DEFB    000H                        ;57f2  00           14114  14133 
    DEFB    000H                        ;57f3  00           14115  14134 
    DEFB    000H                        ;57f4  00           14116  14135 
    DEFB    000H                        ;57f5  00           14117  14136 
                                        ;                   14118  14137 ;
                                        ;                   14119  14138 ;CHR$(&HB9)
    DEFB    000H                        ;57f6  00           14120  14139 
    DEFB    000H                        ;57f7  00           14121  14140 
    DEFB    000H                        ;57f8  00           14122  14141 
    DEFB    000H                        ;57f9  00           14123  14142 
    DEFB    000H                        ;57fa  00           14124  14143 
    DEFB    008H                        ;57fb  08           14125  14144 
    DEFB    000H                        ;57fc  00           14126  14145 
    DEFB    000H                        ;57fd  00           14127  14146 
    DEFB    022H                        ;57fe  22           14128  14147 
    DEFB    000H                        ;57ff  00           14129  14148 
    DEFB    000H                        ;5800  00           14130  14149 
    DEFB    000H                        ;5801  00           14131  14150 
                                        ;                   14132  14151 ;
                                        ;                   14133  14152 ;CHR$(&HBA)
    DEFB    000H                        ;5802  00           14134  14153 
    DEFB    000H                        ;5803  00           14135  14154 
    DEFB    008H                        ;5804  08           14136  14155 
    DEFB    000H                        ;5805  00           14137  14156 
    DEFB    008H                        ;5806  08           14138  14157 
    DEFB    008H                        ;5807  08           14139  14158 
    DEFB    008H                        ;5808  08           14140  14159 
    DEFB    008H                        ;5809  08           14141  14160 
    DEFB    008H                        ;580a  08           14142  14161 
    DEFB    000H                        ;580b  00           14143  14162 
    DEFB    000H                        ;580c  00           14144  14163 
    DEFB    000H                        ;580d  00           14145  14164 
                                        ;                   14146  14165 ;
                                        ;                   14147  14166 ;CHR$(&HBB)
    DEFB    000H                        ;580e  00           14148  14167 
    DEFB    000H                        ;580f  00           14149  14168 
    DEFB    000H                        ;5810  00           14150  14169 
    DEFB    000H                        ;5811  00           14151  14170 
    DEFB    000H                        ;5812  00           14152  14171 
    DEFB    022H                        ;5813  22           14153  14172 
    DEFB    000H                        ;5814  00           14154  14173 
    DEFB    000H                        ;5815  00           14155  14174 
    DEFB    008H                        ;5816  08           14156  14175 
    DEFB    000H                        ;5817  00           14157  14176 
    DEFB    000H                        ;5818  00           14158  14177 
    DEFB    000H                        ;5819  00           14159  14178 
                                        ;                   14160  14179 ;
                                        ;                   14161  14180 ;CHR$(&HBC)
    DEFB    00CH                        ;581a  0c           14162  14181 
    DEFB    010H                        ;581b  10           14163  14182 
    DEFB    010H                        ;581c  10           14164  14183 
    DEFB    010H                        ;581d  10           14165  14184 
    DEFB    010H                        ;581e  10           14166  14185 
    DEFB    010H                        ;581f  10           14167  14186 
    DEFB    010H                        ;5820  10           14168  14187 
    DEFB    010H                        ;5821  10           14169  14188 
    DEFB    010H                        ;5822  10           14170  14189 
    DEFB    010H                        ;5823  10           14171  14190 
    DEFB    010H                        ;5824  10           14172  14191 
    DEFB    060H                        ;5825  60           14173  14192 
                                        ;                   14174  14193 ;
                                        ;                   14175  14194 ;CHR$(&HBD)
    DEFB    000H                        ;5826  00           14176  14195 
    DEFB    00FH                        ;5827  0f           14177  14196 
    DEFB    008H                        ;5828  08           14178  14197 
    DEFB    008H                        ;5829  08           14179  14198 
    DEFB    008H                        ;582a  08           14180  14199 
    DEFB    048H                        ;582b  48           14181  14200 
    DEFB    0A8H                        ;582c  a8           14182  14201 
    DEFB    018H                        ;582d  18           14183  14202 
    DEFB    008H                        ;582e  08           14184  14203 
    DEFB    000H                        ;582f  00           14185  14204 
    DEFB    000H                        ;5830  00           14186  14205 
    DEFB    000H                        ;5831  00           14187  14206 
                                        ;                   14188  14207 ;
                                        ;                   14189  14208 ;CHR$(&HBE)
    DEFB    000H                        ;5832  00           14190  14209 
    DEFB    000H                        ;5833  00           14191  14210 
    DEFB    000H                        ;5834  00           14192  14211 
    DEFB    07EH                        ;5835  7e           14193  14212 
    DEFB    020H                        ;5836  20           14194  14213 
    DEFB    010H                        ;5837  10           14195  14214 
    DEFB    020H                        ;5838  20           14196  14215 
    DEFB    07EH                        ;5839  7e           14197  14216 
    DEFB    000H                        ;583a  00           14198  14217 
    DEFB    000H                        ;583b  00           14199  14218 
    DEFB    000H                        ;583c  00           14200  14219 
    DEFB    000H                        ;583d  00           14201  14220 
                                        ;                   14202  14221 ;
                                        ;                   14203  14222 ;CHR$(&HBF)
    DEFB    000H                        ;583e  00           14204  14223 
    DEFB    000H                        ;583f  00           14205  14224 
    DEFB    000H                        ;5840  00           14206  14225 
    DEFB    03EH                        ;5841  3e           14207  14226 
    DEFB    014H                        ;5842  14           14208  14227 
    DEFB    014H                        ;5843  14           14209  14228 
    DEFB    014H                        ;5844  14           14210  14229 
    DEFB    014H                        ;5845  14           14211  14230 
    DEFB    000H                        ;5846  00           14212  14231 
    DEFB    000H                        ;5847  00           14213  14232 
    DEFB    000H                        ;5848  00           14214  14233 
    DEFB    000H                        ;5849  00           14215  14234 
                                        ;                   14216  14235 ;
                                        ;                   14217  14236 ;CHR$(&HC0)
    DEFB    000H                        ;584a  00           14218  14237 
    DEFB    060H                        ;584b  60           14219  14238 
    DEFB    090H                        ;584c  90           14220  14239 
    DEFB    090H                        ;584d  90           14221  14240 
    DEFB    090H                        ;584e  90           14222  14241 
    DEFB    060H                        ;584f  60           14223  14242 
    DEFB    000H                        ;5850  00           14224  14243 
    DEFB    000H                        ;5851  00           14225  14244 
    DEFB    000H                        ;5852  00           14226  14245 
    DEFB    000H                        ;5853  00           14227  14246 
    DEFB    000H                        ;5854  00           14228  14247 
    DEFB    000H                        ;5855  00           14229  14248 
                                        ;                   14230  14249 ;
                                        ;                   14231  14250 ;CHR$(&HC1)
    DEFB    000H                        ;5856  00           14232  14251 
    DEFB    020H                        ;5857  20           14233  14252 
    DEFB    060H                        ;5858  60           14234  14253 
    DEFB    020H                        ;5859  20           14235  14254 
    DEFB    020H                        ;585a  20           14236  14255 
    DEFB    020H                        ;585b  20           14237  14256 
    DEFB    000H                        ;585c  00           14238  14257 
    DEFB    000H                        ;585d  00           14239  14258 
    DEFB    000H                        ;585e  00           14240  14259 
    DEFB    000H                        ;585f  00           14241  14260 
    DEFB    000H                        ;5860  00           14242  14261 
    DEFB    000H                        ;5861  00           14243  14262 
                                        ;                   14244  14263 ;
                                        ;                   14245  14264 ;CHR$(&HC2)
    DEFB    000H                        ;5862  00           14246  14265 
    DEFB    060H                        ;5863  60           14247  14266 
    DEFB    090H                        ;5864  90           14248  14267 
    DEFB    020H                        ;5865  20           14249  14268 
    DEFB    040H                        ;5866  40           14250  14269 
    DEFB    0F0H                        ;5867  f0           14251  14270 
    DEFB    000H                        ;5868  00           14252  14271 
    DEFB    000H                        ;5869  00           14253  14272 
    DEFB    000H                        ;586a  00           14254  14273 
    DEFB    000H                        ;586b  00           14255  14274 
    DEFB    000H                        ;586c  00           14256  14275 
    DEFB    000H                        ;586d  00           14257  14276 
                                        ;                   14258  14277 ;
                                        ;                   14259  14278 ;CHR$(&HC3)
    DEFB    000H                        ;586e  00           14260  14279 
    DEFB    060H                        ;586f  60           14261  14280 
    DEFB    090H                        ;5870  90           14262  14281 
    DEFB    020H                        ;5871  20           14263  14282 
    DEFB    090H                        ;5872  90           14264  14283 
    DEFB    060H                        ;5873  60           14265  14284 
    DEFB    000H                        ;5874  00           14266  14285 
    DEFB    000H                        ;5875  00           14267  14286 
    DEFB    000H                        ;5876  00           14268  14287 
    DEFB    000H                        ;5877  00           14269  14288 
    DEFB    000H                        ;5878  00           14270  14289 
    DEFB    000H                        ;5879  00           14271  14290 
                                        ;                   14272  14291 ;
                                        ;                   14273  14292 ;CHR$(&HC4)
    DEFB    000H                        ;587a  00           14274  14293 
    DEFB    060H                        ;587b  60           14275  14294 
    DEFB    0A0H                        ;587c  a0           14276  14295 
    DEFB    0A0H                        ;587d  a0           14277  14296 
    DEFB    0F0H                        ;587e  f0           14278  14297 
    DEFB    020H                        ;587f  20           14279  14298 
    DEFB    000H                        ;5880  00           14280  14299 
    DEFB    000H                        ;5881  00           14281  14300 
    DEFB    000H                        ;5882  00           14282  14301 
    DEFB    000H                        ;5883  00           14283  14302 
    DEFB    000H                        ;5884  00           14284  14303 
    DEFB    000H                        ;5885  00           14285  14304 
                                        ;                   14286  14305 ;
                                        ;                   14287  14306 ;CHR$(&HC5)
    DEFB    000H                        ;5886  00           14288  14307 
    DEFB    0F0H                        ;5887  f0           14289  14308 
    DEFB    080H                        ;5888  80           14290  14309 
    DEFB    0F0H                        ;5889  f0           14291  14310 
    DEFB    010H                        ;588a  10           14292  14311 
    DEFB    0E0H                        ;588b  e0           14293  14312 
    DEFB    000H                        ;588c  00           14294  14313 
    DEFB    000H                        ;588d  00           14295  14314 
    DEFB    000H                        ;588e  00           14296  14315 
    DEFB    000H                        ;588f  00           14297  14316 
    DEFB    000H                        ;5890  00           14298  14317 
    DEFB    000H                        ;5891  00           14299  14318 
                                        ;                   14300  14319 ;
                                        ;                   14301  14320 ;CHR$(&HC6)
    DEFB    000H                        ;5892  00           14302  14321 
    DEFB    060H                        ;5893  60           14303  14322 
    DEFB    080H                        ;5894  80           14304  14323 
    DEFB    0F0H                        ;5895  f0           14305  14324 
    DEFB    090H                        ;5896  90           14306  14325 
    DEFB    060H                        ;5897  60           14307  14326 
    DEFB    000H                        ;5898  00           14308  14327 
    DEFB    000H                        ;5899  00           14309  14328 
    DEFB    000H                        ;589a  00           14310  14329 
    DEFB    000H                        ;589b  00           14311  14330 
    DEFB    000H                        ;589c  00           14312  14331 
    DEFB    000H                        ;589d  00           14313  14332 
                                        ;                   14314  14333 ;
                                        ;                   14315  14334 ;CHR$(&HC7)
    DEFB    000H                        ;589e  00           14316  14335 
    DEFB    0F0H                        ;589f  f0           14317  14336 
    DEFB    010H                        ;58a0  10           14318  14337 
    DEFB    020H                        ;58a1  20           14319  14338 
    DEFB    020H                        ;58a2  20           14320  14339 
    DEFB    020H                        ;58a3  20           14321  14340 
    DEFB    000H                        ;58a4  00           14322  14341 
    DEFB    000H                        ;58a5  00           14323  14342 
    DEFB    000H                        ;58a6  00           14324  14343 
    DEFB    000H                        ;58a7  00           14325  14344 
    DEFB    000H                        ;58a8  00           14326  14345 
    DEFB    000H                        ;58a9  00           14327  14346 
                                        ;                   14328  14347 ;
                                        ;                   14329  14348 ;CHR$(&HC8)
    DEFB    000H                        ;58aa  00           14330  14349 
    DEFB    060H                        ;58ab  60           14331  14350 
    DEFB    090H                        ;58ac  90           14332  14351 
    DEFB    060H                        ;58ad  60           14333  14352 
    DEFB    090H                        ;58ae  90           14334  14353 
    DEFB    060H                        ;58af  60           14335  14354 
    DEFB    000H                        ;58b0  00           14336  14355 
    DEFB    000H                        ;58b1  00           14337  14356 
    DEFB    000H                        ;58b2  00           14338  14357 
    DEFB    000H                        ;58b3  00           14339  14358 
    DEFB    000H                        ;58b4  00           14340  14359 
    DEFB    000H                        ;58b5  00           14341  14360 
                                        ;                   14342  14361 ;
                                        ;                   14343  14362 ;CHR$(&HC9)
    DEFB    000H                        ;58b6  00           14344  14363 
    DEFB    060H                        ;58b7  60           14345  14364 
    DEFB    090H                        ;58b8  90           14346  14365 
    DEFB    0F0H                        ;58b9  f0           14347  14366 
    DEFB    010H                        ;58ba  10           14348  14367 
    DEFB    060H                        ;58bb  60           14349  14368 
    DEFB    000H                        ;58bc  00           14350  14369 
    DEFB    000H                        ;58bd  00           14351  14370 
    DEFB    000H                        ;58be  00           14352  14371 
    DEFB    000H                        ;58bf  00           14353  14372 
    DEFB    000H                        ;58c0  00           14354  14373 
    DEFB    000H                        ;58c1  00           14355  14374 
                                        ;                   14356  14375 ;
                                        ;                   14357  14376 ;CHR$(&HCA)
    DEFB    000H                        ;58c2  00           14358  14377 
    DEFB    000H                        ;58c3  00           14359  14378 
    DEFB    000H                        ;58c4  00           14360  14379 
    DEFB    000H                        ;58c5  00           14361  14380 
    DEFB    002H                        ;58c6  02           14362  14381 
    DEFB    034H                        ;58c7  34           14363  14382 
    DEFB    048H                        ;58c8  48           14364  14383 
    DEFB    048H                        ;58c9  48           14365  14384 
    DEFB    036H                        ;58ca  36           14366  14385 
    DEFB    000H                        ;58cb  00           14367  14386 
    DEFB    000H                        ;58cc  00           14368  14387 
    DEFB    000H                        ;58cd  00           14369  14388 
                                        ;                   14370  14389 ;
                                        ;                   14371  14390 ;CHR$(&HCB)
    DEFB    000H                        ;58ce  00           14372  14391 
    DEFB    000H                        ;58cf  00           14373  14392 
    DEFB    018H                        ;58d0  18           14374  14393 
    DEFB    024H                        ;58d1  24           14375  14394 
    DEFB    038H                        ;58d2  38           14376  14395 
    DEFB    024H                        ;58d3  24           14377  14396 
    DEFB    024H                        ;58d4  24           14378  14397 
    DEFB    038H                        ;58d5  38           14379  14398 
    DEFB    020H                        ;58d6  20           14380  14399 
    DEFB    000H                        ;58d7  00           14381  14400 
    DEFB    000H                        ;58d8  00           14382  14401 
    DEFB    000H                        ;58d9  00           14383  14402 
                                        ;                   14384  14403 ;
                                        ;                   14385  14404 ;CHR$(&HCC)
    DEFB    000H                        ;58da  00           14386  14405 
    DEFB    000H                        ;58db  00           14387  14406 
    DEFB    000H                        ;58dc  00           14388  14407 
    DEFB    000H                        ;58dd  00           14389  14408 
    DEFB    04EH                        ;58de  4e           14390  14409 
    DEFB    030H                        ;58df  30           14391  14410 
    DEFB    020H                        ;58e0  20           14392  14411 
    DEFB    020H                        ;58e1  20           14393  14412 
    DEFB    020H                        ;58e2  20           14394  14413 
    DEFB    000H                        ;58e3  00           14395  14414 
    DEFB    000H                        ;58e4  00           14396  14415 
    DEFB    000H                        ;58e5  00           14397  14416 
                                        ;                   14398  14417 ;
                                        ;                   14399  14418 ;CHR$(&HCD)
    DEFB    000H                        ;58e6  00           14400  14419 
    DEFB    000H                        ;58e7  00           14401  14420 
    DEFB    018H                        ;58e8  18           14402  14421 
    DEFB    024H                        ;58e9  24           14403  14422 
    DEFB    024H                        ;58ea  24           14404  14423 
    DEFB    03CH                        ;58eb  3c           14405  14424 
    DEFB    024H                        ;58ec  24           14406  14425 
    DEFB    024H                        ;58ed  24           14407  14426 
    DEFB    018H                        ;58ee  18           14408  14427 
    DEFB    000H                        ;58ef  00           14409  14428 
    DEFB    000H                        ;58f0  00           14410  14429 
    DEFB    000H                        ;58f1  00           14411  14430 
                                        ;                   14412  14431 ;
                                        ;                   14413  14432 ;CHR$(&HCE)
    DEFB    000H                        ;58f2  00           14414  14433 
    DEFB    000H                        ;58f3  00           14415  14434 
    DEFB    01CH                        ;58f4  1c           14416  14435 
    DEFB    020H                        ;58f5  20           14417  14436 
    DEFB    020H                        ;58f6  20           14418  14437 
    DEFB    018H                        ;58f7  18           14419  14438 
    DEFB    024H                        ;58f8  24           14420  14439 
    DEFB    024H                        ;58f9  24           14421  14440 
    DEFB    018H                        ;58fa  18           14422  14441 
    DEFB    000H                        ;58fb  00           14423  14442 
    DEFB    000H                        ;58fc  00           14424  14443 
    DEFB    000H                        ;58fd  00           14425  14444 
                                        ;                   14426  14445 ;
                                        ;                   14427  14446 ;CHR$(&HCF)
    DEFB    000H                        ;58fe  00           14428  14447 
    DEFB    000H                        ;58ff  00           14429  14448 
    DEFB    000H                        ;5900  00           14430  14449 
    DEFB    008H                        ;5901  08           14431  14450 
    DEFB    01CH                        ;5902  1c           14432  14451 
    DEFB    02AH                        ;5903  2a           14433  14452 
    DEFB    02AH                        ;5904  2a           14434  14453 
    DEFB    01CH                        ;5905  1c           14435  14454 
    DEFB    008H                        ;5906  08           14436  14455 
    DEFB    000H                        ;5907  00           14437  14456 
    DEFB    000H                        ;5908  00           14438  14457 
    DEFB    000H                        ;5909  00           14439  14458 
                                        ;                   14440  14459 ;
                                        ;                   14441  14460 ;CHR$(&HD0)
    DEFB    080H                        ;590a  80           14442  14461 
    DEFB    040H                        ;590b  40           14443  14462 
    DEFB    040H                        ;590c  40           14444  14463 
    DEFB    020H                        ;590d  20           14445  14464 
    DEFB    010H                        ;590e  10           14446  14465 
    DEFB    010H                        ;590f  10           14447  14466 
    DEFB    008H                        ;5910  08           14448  14467 
    DEFB    004H                        ;5911  04           14449  14468 
    DEFB    004H                        ;5912  04           14450  14469 
    DEFB    002H                        ;5913  02           14451  14470 
    DEFB    001H                        ;5914  01           14452  14471 
    DEFB    001H                        ;5915  01           14453  14472 
                                        ;                   14454  14473 ;
                                        ;                   14455  14474 ;CHR$(&HD1)
    DEFB    000H                        ;5916  00           14456  14475 
    DEFB    000H                        ;5917  00           14457  14476 
    DEFB    000H                        ;5918  00           14458  14477 
    DEFB    000H                        ;5919  00           14459  14478 
    DEFB    000H                        ;591a  00           14460  14479 
    DEFB    000H                        ;591b  00           14461  14480 
    DEFB    0FEH                        ;591c  fe           14462  14481 
    DEFB    000H                        ;591d  00           14463  14482 
    DEFB    000H                        ;591e  00           14464  14483 
    DEFB    000H                        ;591f  00           14465  14484 
    DEFB    000H                        ;5920  00           14466  14485 
    DEFB    000H                        ;5921  00           14467  14486 
                                        ;                   14468  14487 ;
                                        ;                   14469  14488 ;CHR$(&HD2)
    DEFB    000H                        ;5922  00           14470  14489 
    DEFB    000H                        ;5923  00           14471  14490 
    DEFB    000H                        ;5924  00           14472  14491 
    DEFB    000H                        ;5925  00           14473  14492 
    DEFB    000H                        ;5926  00           14474  14493 
    DEFB    07CH                        ;5927  7c           14475  14494 
    DEFB    000H                        ;5928  00           14476  14495 
    DEFB    000H                        ;5929  00           14477  14496 
    DEFB    0FEH                        ;592a  fe           14478  14497 
    DEFB    000H                        ;592b  00           14479  14498 
    DEFB    000H                        ;592c  00           14480  14499 
    DEFB    000H                        ;592d  00           14481  14500 
                                        ;                   14482  14501 ;
                                        ;                   14483  14502 ;CHR$(&HD3)
    DEFB    000H                        ;592e  00           14484  14503 
    DEFB    000H                        ;592f  00           14485  14504 
    DEFB    000H                        ;5930  00           14486  14505 
    DEFB    000H                        ;5931  00           14487  14506 
    DEFB    07CH                        ;5932  7c           14488  14507 
    DEFB    000H                        ;5933  00           14489  14508 
    DEFB    07CH                        ;5934  7c           14490  14509 
    DEFB    000H                        ;5935  00           14491  14510 
    DEFB    0FEH                        ;5936  fe           14492  14511 
    DEFB    000H                        ;5937  00           14493  14512 
    DEFB    000H                        ;5938  00           14494  14513 
    DEFB    000H                        ;5939  00           14495  14514 
                                        ;                   14496  14515 ;
                                        ;                   14497  14516 ;CHR$(&HD4)
    DEFB    000H                        ;593a  00           14498  14517 
    DEFB    000H                        ;593b  00           14499  14518 
    DEFB    000H                        ;593c  00           14500  14519 
    DEFB    000H                        ;593d  00           14501  14520 
    DEFB    0FEH                        ;593e  fe           14502  14521 
    DEFB    0AAH                        ;593f  aa           14503  14522 
    DEFB    0AAH                        ;5940  aa           14504  14523 
    DEFB    0AAH                        ;5941  aa           14505  14524 
    DEFB    0FEH                        ;5942  fe           14506  14525 
    DEFB    000H                        ;5943  00           14507  14526 
    DEFB    000H                        ;5944  00           14508  14527 
    DEFB    000H                        ;5945  00           14509  14528 
                                        ;                   14510  14529 ;
                                        ;                   14511  14530 ;CHR$(&HD5)
    DEFB    000H                        ;5946  00           14512  14531 
    DEFB    000H                        ;5947  00           14513  14532 
    DEFB    000H                        ;5948  00           14514  14533 
    DEFB    07CH                        ;5949  7c           14515  14534 
    DEFB    010H                        ;594a  10           14516  14535 
    DEFB    07CH                        ;594b  7c           14517  14536 
    DEFB    014H                        ;594c  14           14518  14537 
    DEFB    014H                        ;594d  14           14519  14538 
    DEFB    0FEH                        ;594e  fe           14520  14539 
    DEFB    000H                        ;594f  00           14521  14540 
    DEFB    000H                        ;5950  00           14522  14541 
    DEFB    000H                        ;5951  00           14523  14542 
                                        ;                   14524  14543 ;
                                        ;                   14525  14544 ;CHR$(&HD6)
    DEFB    000H                        ;5952  00           14526  14545 
    DEFB    000H                        ;5953  00           14527  14546 
    DEFB    010H                        ;5954  10           14528  14547 
    DEFB    010H                        ;5955  10           14529  14548 
    DEFB    0FEH                        ;5956  fe           14530  14549 
    DEFB    000H                        ;5957  00           14531  14550 
    DEFB    028H                        ;5958  28           14532  14551 
    DEFB    044H                        ;5959  44           14533  14552 
    DEFB    082H                        ;595a  82           14534  14553 
    DEFB    000H                        ;595b  00           14535  14554 
    DEFB    000H                        ;595c  00           14536  14555 
    DEFB    000H                        ;595d  00           14537  14556 
                                        ;                   14538  14557 ;
                                        ;                   14539  14558 ;CHR$(&HD7)
    DEFB    000H                        ;595e  00           14540  14559 
    DEFB    000H                        ;595f  00           14541  14560 
    DEFB    020H                        ;5960  20           14542  14561 
    DEFB    020H                        ;5961  20           14543  14562 
    DEFB    020H                        ;5962  20           14544  14563 
    DEFB    0FEH                        ;5963  fe           14545  14564 
    DEFB    020H                        ;5964  20           14546  14565 
    DEFB    020H                        ;5965  20           14547  14566 
    DEFB    03EH                        ;5966  3e           14548  14567 
    DEFB    000H                        ;5967  00           14549  14568 
    DEFB    000H                        ;5968  00           14550  14569 
    DEFB    000H                        ;5969  00           14551  14570 
                                        ;                   14552  14571 ;
                                        ;                   14553  14572 ;CHR$(&HD8)
    DEFB    000H                        ;596a  00           14554  14573 
    DEFB    000H                        ;596b  00           14555  14574 
    DEFB    000H                        ;596c  00           14556  14575 
    DEFB    000H                        ;596d  00           14557  14576 
    DEFB    000H                        ;596e  00           14558  14577 
    DEFB    028H                        ;596f  28           14559  14578 
    DEFB    044H                        ;5970  44           14560  14579 
    DEFB    082H                        ;5971  82           14561  14580 
    DEFB    000H                        ;5972  00           14562  14581 
    DEFB    000H                        ;5973  00           14563  14582 
    DEFB    000H                        ;5974  00           14564  14583 
    DEFB    000H                        ;5975  00           14565  14584 
                                        ;                   14566  14585 ;
                                        ;                   14567  14586 ;CHR$(&HD9)
    DEFB    000H                        ;5976  00           14568  14587 
    DEFB    000H                        ;5977  00           14569  14588 
    DEFB    020H                        ;5978  20           14570  14589 
    DEFB    020H                        ;5979  20           14571  14590 
    DEFB    0FCH                        ;597a  fc           14572  14591 
    DEFB    024H                        ;597b  24           14573  14592 
    DEFB    024H                        ;597c  24           14574  14593 
    DEFB    044H                        ;597d  44           14575  14594 
    DEFB    086H                        ;597e  86           14576  14595 
    DEFB    000H                        ;597f  00           14577  14596 
    DEFB    000H                        ;5980  00           14578  14597 
    DEFB    000H                        ;5981  00           14579  14598 
                                        ;                   14580  14599 ;
                                        ;                   14581  14600 ;CHR$(&HDA)
    DEFB    000H                        ;5982  00           14582  14601 
    DEFB    000H                        ;5983  00           14583  14602 
    DEFB    000H                        ;5984  00           14584  14603 
    DEFB    000H                        ;5985  00           14585  14604 
    DEFB    036H                        ;5986  36           14586  14605 
    DEFB    049H                        ;5987  49           14587  14606 
    DEFB    036H                        ;5988  36           14588  14607 
    DEFB    000H                        ;5989  00           14589  14608 
    DEFB    000H                        ;598a  00           14590  14609 
    DEFB    000H                        ;598b  00           14591  14610 
    DEFB    000H                        ;598c  00           14592  14611 
    DEFB    000H                        ;598d  00           14593  14612 
                                        ;                   14594  14613 ;
                                        ;                   14595  14614 ;CHR$(&HDB)
    DEFB    000H                        ;598e  00           14596  14615 
    DEFB    000H                        ;598f  00           14597  14616 
    DEFB    018H                        ;5990  18           14598  14617 
    DEFB    020H                        ;5991  20           14599  14618 
    DEFB    018H                        ;5992  18           14600  14619 
    DEFB    024H                        ;5993  24           14601  14620 
    DEFB    018H                        ;5994  18           14602  14621 
    DEFB    004H                        ;5995  04           14603  14622 
    DEFB    018H                        ;5996  18           14604  14623 
    DEFB    000H                        ;5997  00           14605  14624 
    DEFB    000H                        ;5998  00           14606  14625 
    DEFB    000H                        ;5999  00           14607  14626 
                                        ;                   14608  14627 ;
                                        ;                   14609  14628 ;CHR$(&HDC)
    DEFB    000H                        ;599a  00           14610  14629 
    DEFB    000H                        ;599b  00           14611  14630 
    DEFB    008H                        ;599c  08           14612  14631 
    DEFB    022H                        ;599d  22           14613  14632 
    DEFB    014H                        ;599e  14           14614  14633 
    DEFB    049H                        ;599f  49           14615  14634 
    DEFB    014H                        ;59a0  14           14616  14635 
    DEFB    022H                        ;59a1  22           14617  14636 
    DEFB    008H                        ;59a2  08           14618  14637 
    DEFB    000H                        ;59a3  00           14619  14638 
    DEFB    000H                        ;59a4  00           14620  14639 
    DEFB    000H                        ;59a5  00           14621  14640 
                                        ;                   14622  14641 ;
                                        ;                   14623  14642 ;CHR$(&HDD)
    DEFB    000H                        ;59a6  00           14624  14643 
    DEFB    000H                        ;59a7  00           14625  14644 
    DEFB    000H                        ;59a8  00           14626  14645 
    DEFB    038H                        ;59a9  38           14627  14646 
    DEFB    000H                        ;59aa  00           14628  14647 
    DEFB    07CH                        ;59ab  7c           14629  14648 
    DEFB    010H                        ;59ac  10           14630  14649 
    DEFB    010H                        ;59ad  10           14631  14650 
    DEFB    010H                        ;59ae  10           14632  14651 
    DEFB    000H                        ;59af  00           14633  14652 
    DEFB    000H                        ;59b0  00           14634  14653 
    DEFB    000H                        ;59b1  00           14635  14654 
                                        ;                   14636  14655 ;
                                        ;                   14637  14656 ;CHR$(&HDE)
    DEFB    000H                        ;59b2  00           14638  14657 
    DEFB    060H                        ;59b3  60           14639  14658 
    DEFB    090H                        ;59b4  90           14640  14659 
    DEFB    06EH                        ;59b5  6e           14641  14660 
    DEFB    011H                        ;59b6  11           14642  14661 
    DEFB    010H                        ;59b7  10           14643  14662 
    DEFB    010H                        ;59b8  10           14644  14663 
    DEFB    011H                        ;59b9  11           14645  14664 
    DEFB    00EH                        ;59ba  0e           14646  14665 
    DEFB    000H                        ;59bb  00           14647  14666 
    DEFB    000H                        ;59bc  00           14648  14667 
    DEFB    000H                        ;59bd  00           14649  14668 
                                        ;                   14650  14669 ;
                                        ;                   14651  14670 ;CHR$(&HDF)
    DEFB    001H                        ;59be  01           14652  14671 
    DEFB    002H                        ;59bf  02           14653  14672 
    DEFB    002H                        ;59c0  02           14654  14673 
    DEFB    004H                        ;59c1  04           14655  14674 
    DEFB    008H                        ;59c2  08           14656  14675 
    DEFB    008H                        ;59c3  08           14657  14676 
    DEFB    010H                        ;59c4  10           14658  14677 
    DEFB    020H                        ;59c5  20           14659  14678 
    DEFB    020H                        ;59c6  20           14660  14679 
    DEFB    040H                        ;59c7  40           14661  14680 
    DEFB    080H                        ;59c8  80           14662  14681 
    DEFB    080H                        ;59c9  80           14663  14682 
                                        ;                   14664  14683 ;
                                        ;                   14665  14684 ;CHR$(&HE0)
    DEFB    000H                        ;59ca  00           14666  14685 
    DEFB    000H                        ;59cb  00           14667  14686 
    DEFB    020H                        ;59cc  20           14668  14687 
    DEFB    010H                        ;59cd  10           14669  14688 
    DEFB    008H                        ;59ce  08           14670  14689 
    DEFB    000H                        ;59cf  00           14671  14690 
    DEFB    000H                        ;59d0  00           14672  14691 
    DEFB    000H                        ;59d1  00           14673  14692 
    DEFB    000H                        ;59d2  00           14674  14693 
    DEFB    000H                        ;59d3  00           14675  14694 
    DEFB    000H                        ;59d4  00           14676  14695 
    DEFB    000H                        ;59d5  00           14677  14696 
                                        ;                   14678  14697 ;
                                        ;                   14679  14698 ;CHR$(&HE1)
    DEFB    000H                        ;59d6  00           14680  14699 
    DEFB    000H                        ;59d7  00           14681  14700 
    DEFB    000H                        ;59d8  00           14682  14701 
    DEFB    000H                        ;59d9  00           14683  14702 
    DEFB    03CH                        ;59da  3c           14684  14703 
    DEFB    002H                        ;59db  02           14685  14704 
    DEFB    01EH                        ;59dc  1e           14686  14705 
    DEFB    022H                        ;59dd  22           14687  14706 
    DEFB    01FH                        ;59de  1f           14688  14707 
    DEFB    000H                        ;59df  00           14689  14708 
    DEFB    000H                        ;59e0  00           14690  14709 
    DEFB    000H                        ;59e1  00           14691  14710 
                                        ;                   14692  14711 ;
                                        ;                   14693  14712 ;CHR$(&HE2)
    DEFB    000H                        ;59e2  00           14694  14713 
    DEFB    000H                        ;59e3  00           14695  14714 
    DEFB    020H                        ;59e4  20           14696  14715 
    DEFB    020H                        ;59e5  20           14697  14716 
    DEFB    02CH                        ;59e6  2c           14698  14717 
    DEFB    032H                        ;59e7  32           14699  14718 
    DEFB    022H                        ;59e8  22           14700  14719 
    DEFB    032H                        ;59e9  32           14701  14720 
    DEFB    02CH                        ;59ea  2c           14702  14721 
    DEFB    000H                        ;59eb  00           14703  14722 
    DEFB    000H                        ;59ec  00           14704  14723 
    DEFB    000H                        ;59ed  00           14705  14724 
                                        ;                   14706  14725 ;
                                        ;                   14707  14726 ;CHR$(&HE3)
    DEFB    000H                        ;59ee  00           14708  14727 
    DEFB    000H                        ;59ef  00           14709  14728 
    DEFB    000H                        ;59f0  00           14710  14729 
    DEFB    000H                        ;59f1  00           14711  14730 
    DEFB    01CH                        ;59f2  1c           14712  14731 
    DEFB    022H                        ;59f3  22           14713  14732 
    DEFB    020H                        ;59f4  20           14714  14733 
    DEFB    022H                        ;59f5  22           14715  14734 
    DEFB    01CH                        ;59f6  1c           14716  14735 
    DEFB    000H                        ;59f7  00           14717  14736 
    DEFB    000H                        ;59f8  00           14718  14737 
    DEFB    000H                        ;59f9  00           14719  14738 
                                        ;                   14720  14739 ;
                                        ;                   14721  14740 ;CHR$(&HE4)
    DEFB    000H                        ;59fa  00           14722  14741 
    DEFB    000H                        ;59fb  00           14723  14742 
    DEFB    002H                        ;59fc  02           14724  14743 
    DEFB    002H                        ;59fd  02           14725  14744 
    DEFB    01AH                        ;59fe  1a           14726  14745 
    DEFB    026H                        ;59ff  26           14727  14746 
    DEFB    022H                        ;5a00  22           14728  14747 
    DEFB    026H                        ;5a01  26           14729  14748 
    DEFB    01AH                        ;5a02  1a           14730  14749 
    DEFB    000H                        ;5a03  00           14731  14750 
    DEFB    000H                        ;5a04  00           14732  14751 
    DEFB    000H                        ;5a05  00           14733  14752 
                                        ;                   14734  14753 ;
                                        ;                   14735  14754 ;CHR$(&HE5)
    DEFB    000H                        ;5a06  00           14736  14755 
    DEFB    000H                        ;5a07  00           14737  14756 
    DEFB    000H                        ;5a08  00           14738  14757 
    DEFB    000H                        ;5a09  00           14739  14758 
    DEFB    01CH                        ;5a0a  1c           14740  14759 
    DEFB    022H                        ;5a0b  22           14741  14760 
    DEFB    03EH                        ;5a0c  3e           14742  14761 
    DEFB    020H                        ;5a0d  20           14743  14762 
    DEFB    01EH                        ;5a0e  1e           14744  14763 
    DEFB    000H                        ;5a0f  00           14745  14764 
    DEFB    000H                        ;5a10  00           14746  14765 
    DEFB    000H                        ;5a11  00           14747  14766 
                                        ;                   14748  14767 ;
                                        ;                   14749  14768 ;CHR$(&HE6)
    DEFB    000H                        ;5a12  00           14750  14769 
    DEFB    000H                        ;5a13  00           14751  14770 
    DEFB    00CH                        ;5a14  0c           14752  14771 
    DEFB    010H                        ;5a15  10           14753  14772 
    DEFB    010H                        ;5a16  10           14754  14773 
    DEFB    07CH                        ;5a17  7c           14755  14774 
    DEFB    010H                        ;5a18  10           14756  14775 
    DEFB    010H                        ;5a19  10           14757  14776 
    DEFB    010H                        ;5a1a  10           14758  14777 
    DEFB    000H                        ;5a1b  00           14759  14778 
    DEFB    000H                        ;5a1c  00           14760  14779 
    DEFB    000H                        ;5a1d  00           14761  14780 
                                        ;                   14762  14781 ;
                                        ;                   14763  14782 ;CHR$(&HE7)
    DEFB    000H                        ;5a1e  00           14764  14783 
    DEFB    000H                        ;5a1f  00           14765  14784 
    DEFB    000H                        ;5a20  00           14766  14785 
    DEFB    000H                        ;5a21  00           14767  14786 
    DEFB    01AH                        ;5a22  1a           14768  14787 
    DEFB    026H                        ;5a23  26           14769  14788 
    DEFB    022H                        ;5a24  22           14770  14789 
    DEFB    026H                        ;5a25  26           14771  14790 
    DEFB    01AH                        ;5a26  1a           14772  14791 
    DEFB    002H                        ;5a27  02           14773  14792 
    DEFB    01CH                        ;5a28  1c           14774  14793 
    DEFB    000H                        ;5a29  00           14775  14794 
                                        ;                   14776  14795 ;
                                        ;                   14777  14796 ;CHR$(&HE8)
    DEFB    000H                        ;5a2a  00           14778  14797 
    DEFB    000H                        ;5a2b  00           14779  14798 
    DEFB    020H                        ;5a2c  20           14780  14799 
    DEFB    020H                        ;5a2d  20           14781  14800 
    DEFB    02CH                        ;5a2e  2c           14782  14801 
    DEFB    032H                        ;5a2f  32           14783  14802 
    DEFB    022H                        ;5a30  22           14784  14803 
    DEFB    022H                        ;5a31  22           14785  14804 
    DEFB    022H                        ;5a32  22           14786  14805 
    DEFB    000H                        ;5a33  00           14787  14806 
    DEFB    000H                        ;5a34  00           14788  14807 
    DEFB    000H                        ;5a35  00           14789  14808 
                                        ;                   14790  14809 ;
                                        ;                   14791  14810 ;CHR$(&HE9)
    DEFB    000H                        ;5a36  00           14792  14811 
    DEFB    000H                        ;5a37  00           14793  14812 
    DEFB    008H                        ;5a38  08           14794  14813 
    DEFB    000H                        ;5a39  00           14795  14814 
    DEFB    018H                        ;5a3a  18           14796  14815 
    DEFB    008H                        ;5a3b  08           14797  14816 
    DEFB    008H                        ;5a3c  08           14798  14817 
    DEFB    008H                        ;5a3d  08           14799  14818 
    DEFB    01CH                        ;5a3e  1c           14800  14819 
    DEFB    000H                        ;5a3f  00           14801  14820 
    DEFB    000H                        ;5a40  00           14802  14821 
    DEFB    000H                        ;5a41  00           14803  14822 
                                        ;                   14804  14823 ;
                                        ;                   14805  14824 ;CHR$(&HEA)
    DEFB    000H                        ;5a42  00           14806  14825 
    DEFB    000H                        ;5a43  00           14807  14826 
    DEFB    004H                        ;5a44  04           14808  14827 
    DEFB    000H                        ;5a45  00           14809  14828 
    DEFB    00CH                        ;5a46  0c           14810  14829 
    DEFB    004H                        ;5a47  04           14811  14830 
    DEFB    004H                        ;5a48  04           14812  14831 
    DEFB    004H                        ;5a49  04           14813  14832 
    DEFB    024H                        ;5a4a  24           14814  14833 
    DEFB    018H                        ;5a4b  18           14815  14834 
    DEFB    000H                        ;5a4c  00           14816  14835 
    DEFB    000H                        ;5a4d  00           14817  14836 
                                        ;                   14818  14837 ;
                                        ;                   14819  14838 ;CHR$(&HEB)
    DEFB    000H                        ;5a4e  00           14820  14839 
    DEFB    000H                        ;5a4f  00           14821  14840 
    DEFB    020H                        ;5a50  20           14822  14841 
    DEFB    020H                        ;5a51  20           14823  14842 
    DEFB    022H                        ;5a52  22           14824  14843 
    DEFB    024H                        ;5a53  24           14825  14844 
    DEFB    028H                        ;5a54  28           14826  14845 
    DEFB    034H                        ;5a55  34           14827  14846 
    DEFB    022H                        ;5a56  22           14828  14847 
    DEFB    000H                        ;5a57  00           14829  14848 
    DEFB    000H                        ;5a58  00           14830  14849 
    DEFB    000H                        ;5a59  00           14831  14850 
                                        ;                   14832  14851 ;
                                        ;                   14833  14852 ;CHR$(&HEC)
    DEFB    000H                        ;5a5a  00           14834  14853 
    DEFB    000H                        ;5a5b  00           14835  14854 
    DEFB    018H                        ;5a5c  18           14836  14855 
    DEFB    008H                        ;5a5d  08           14837  14856 
    DEFB    008H                        ;5a5e  08           14838  14857 
    DEFB    008H                        ;5a5f  08           14839  14858 
    DEFB    008H                        ;5a60  08           14840  14859 
    DEFB    008H                        ;5a61  08           14841  14860 
    DEFB    01CH                        ;5a62  1c           14842  14861 
    DEFB    000H                        ;5a63  00           14843  14862 
    DEFB    000H                        ;5a64  00           14844  14863 
    DEFB    000H                        ;5a65  00           14845  14864 
                                        ;                   14846  14865 ;
                                        ;                   14847  14866 ;CHR$(&HED)
    DEFB    000H                        ;5a66  00           14848  14867 
    DEFB    000H                        ;5a67  00           14849  14868 
    DEFB    000H                        ;5a68  00           14850  14869 
    DEFB    000H                        ;5a69  00           14851  14870 
    DEFB    076H                        ;5a6a  76           14852  14871 
    DEFB    049H                        ;5a6b  49           14853  14872 
    DEFB    049H                        ;5a6c  49           14854  14873 
    DEFB    049H                        ;5a6d  49           14855  14874 
    DEFB    049H                        ;5a6e  49           14856  14875 
    DEFB    000H                        ;5a6f  00           14857  14876 
    DEFB    000H                        ;5a70  00           14858  14877 
    DEFB    000H                        ;5a71  00           14859  14878 
                                        ;                   14860  14879 ;
                                        ;                   14861  14880 ;CHR$(&HEE)
    DEFB    000H                        ;5a72  00           14862  14881 
    DEFB    000H                        ;5a73  00           14863  14882 
    DEFB    000H                        ;5a74  00           14864  14883 
    DEFB    000H                        ;5a75  00           14865  14884 
    DEFB    02CH                        ;5a76  2c           14866  14885 
    DEFB    032H                        ;5a77  32           14867  14886 
    DEFB    022H                        ;5a78  22           14868  14887 
    DEFB    022H                        ;5a79  22           14869  14888 
    DEFB    022H                        ;5a7a  22           14870  14889 
    DEFB    000H                        ;5a7b  00           14871  14890 
    DEFB    000H                        ;5a7c  00           14872  14891 
    DEFB    000H                        ;5a7d  00           14873  14892 
                                        ;                   14874  14893 ;
                                        ;                   14875  14894 ;CHR$(&HEF)
    DEFB    000H                        ;5a7e  00           14876  14895 
    DEFB    000H                        ;5a7f  00           14877  14896 
    DEFB    000H                        ;5a80  00           14878  14897 
    DEFB    000H                        ;5a81  00           14879  14898 
    DEFB    01CH                        ;5a82  1c           14880  14899 
    DEFB    022H                        ;5a83  22           14881  14900 
    DEFB    022H                        ;5a84  22           14882  14901 
    DEFB    022H                        ;5a85  22           14883  14902 
    DEFB    01CH                        ;5a86  1c           14884  14903 
    DEFB    000H                        ;5a87  00           14885  14904 
    DEFB    000H                        ;5a88  00           14886  14905 
    DEFB    000H                        ;5a89  00           14887  14906 
                                        ;                   14888  14907 ;
                                        ;                   14889  14908 ;CHR$(&HF0)
    DEFB    000H                        ;5a8a  00           14890  14909 
    DEFB    000H                        ;5a8b  00           14891  14910 
    DEFB    000H                        ;5a8c  00           14892  14911 
    DEFB    000H                        ;5a8d  00           14893  14912 
    DEFB    02CH                        ;5a8e  2c           14894  14913 
    DEFB    032H                        ;5a8f  32           14895  14914 
    DEFB    022H                        ;5a90  22           14896  14915 
    DEFB    032H                        ;5a91  32           14897  14916 
    DEFB    02CH                        ;5a92  2c           14898  14917 
    DEFB    020H                        ;5a93  20           14899  14918 
    DEFB    020H                        ;5a94  20           14900  14919 
    DEFB    000H                        ;5a95  00           14901  14920 
                                        ;                   14902  14921 ;
                                        ;                   14903  14922 ;CHR$(&HF1)
    DEFB    000H                        ;5a96  00           14904  14923 
    DEFB    000H                        ;5a97  00           14905  14924 
    DEFB    000H                        ;5a98  00           14906  14925 
    DEFB    000H                        ;5a99  00           14907  14926 
    DEFB    01AH                        ;5a9a  1a           14908  14927 
    DEFB    026H                        ;5a9b  26           14909  14928 
    DEFB    022H                        ;5a9c  22           14910  14929 
    DEFB    026H                        ;5a9d  26           14911  14930 
    DEFB    01AH                        ;5a9e  1a           14912  14931 
    DEFB    002H                        ;5a9f  02           14913  14932 
    DEFB    002H                        ;5aa0  02           14914  14933 
    DEFB    000H                        ;5aa1  00           14915  14934 
                                        ;                   14916  14935 ;
                                        ;                   14917  14936 ;CHR$(&HF2)
    DEFB    000H                        ;5aa2  00           14918  14937 
    DEFB    000H                        ;5aa3  00           14919  14938 
    DEFB    000H                        ;5aa4  00           14920  14939 
    DEFB    000H                        ;5aa5  00           14921  14940 
    DEFB    02EH                        ;5aa6  2e           14922  14941 
    DEFB    030H                        ;5aa7  30           14923  14942 
    DEFB    020H                        ;5aa8  20           14924  14943 
    DEFB    020H                        ;5aa9  20           14925  14944 
    DEFB    020H                        ;5aaa  20           14926  14945 
    DEFB    000H                        ;5aab  00           14927  14946 
    DEFB    000H                        ;5aac  00           14928  14947 
    DEFB    000H                        ;5aad  00           14929  14948 
                                        ;                   14930  14949 ;
                                        ;                   14931  14950 ;CHR$(&HF3)
    DEFB    000H                        ;5aae  00           14932  14951 
    DEFB    000H                        ;5aaf  00           14933  14952 
    DEFB    000H                        ;5ab0  00           14934  14953 
    DEFB    000H                        ;5ab1  00           14935  14954 
    DEFB    01EH                        ;5ab2  1e           14936  14955 
    DEFB    020H                        ;5ab3  20           14937  14956 
    DEFB    01CH                        ;5ab4  1c           14938  14957 
    DEFB    002H                        ;5ab5  02           14939  14958 
    DEFB    03CH                        ;5ab6  3c           14940  14959 
    DEFB    000H                        ;5ab7  00           14941  14960 
    DEFB    000H                        ;5ab8  00           14942  14961 
    DEFB    000H                        ;5ab9  00           14943  14962 
                                        ;                   14944  14963 ;
                                        ;                   14945  14964 ;CHR$(&HF4)
    DEFB    000H                        ;5aba  00           14946  14965 
    DEFB    000H                        ;5abb  00           14947  14966 
    DEFB    010H                        ;5abc  10           14948  14967 
    DEFB    010H                        ;5abd  10           14949  14968 
    DEFB    038H                        ;5abe  38           14950  14969 
    DEFB    010H                        ;5abf  10           14951  14970 
    DEFB    010H                        ;5ac0  10           14952  14971 
    DEFB    012H                        ;5ac1  12           14953  14972 
    DEFB    00CH                        ;5ac2  0c           14954  14973 
    DEFB    000H                        ;5ac3  00           14955  14974 
    DEFB    000H                        ;5ac4  00           14956  14975 
    DEFB    000H                        ;5ac5  00           14957  14976 
                                        ;                   14958  14977 ;
                                        ;                   14959  14978 ;CHR$(&HF5)
    DEFB    000H                        ;5ac6  00           14960  14979 
    DEFB    000H                        ;5ac7  00           14961  14980 
    DEFB    000H                        ;5ac8  00           14962  14981 
    DEFB    000H                        ;5ac9  00           14963  14982 
    DEFB    022H                        ;5aca  22           14964  14983 
    DEFB    022H                        ;5acb  22           14965  14984 
    DEFB    022H                        ;5acc  22           14966  14985 
    DEFB    026H                        ;5acd  26           14967  14986 
    DEFB    01AH                        ;5ace  1a           14968  14987 
    DEFB    000H                        ;5acf  00           14969  14988 
    DEFB    000H                        ;5ad0  00           14970  14989 
    DEFB    000H                        ;5ad1  00           14971  14990 
                                        ;                   14972  14991 ;
                                        ;                   14973  14992 ;CHR$(&HF6)
    DEFB    000H                        ;5ad2  00           14974  14993 
    DEFB    000H                        ;5ad3  00           14975  14994 
    DEFB    000H                        ;5ad4  00           14976  14995 
    DEFB    000H                        ;5ad5  00           14977  14996 
    DEFB    022H                        ;5ad6  22           14978  14997 
    DEFB    022H                        ;5ad7  22           14979  14998 
    DEFB    022H                        ;5ad8  22           14980  14999 
    DEFB    014H                        ;5ad9  14           14981  15000 
    DEFB    008H                        ;5ada  08           14982  15001 
    DEFB    000H                        ;5adb  00           14983  15002 
    DEFB    000H                        ;5adc  00           14984  15003 
    DEFB    000H                        ;5add  00           14985  15004 
                                        ;                   14986  15005 ;
                                        ;                   14987  15006 ;CHR$(&HF7)
    DEFB    000H                        ;5ade  00           14988  15007 
    DEFB    000H                        ;5adf  00           14989  15008 
    DEFB    000H                        ;5ae0  00           14990  15009 
    DEFB    000H                        ;5ae1  00           14991  15010 
    DEFB    049H                        ;5ae2  49           14992  15011 
    DEFB    049H                        ;5ae3  49           14993  15012 
    DEFB    049H                        ;5ae4  49           14994  15013 
    DEFB    049H                        ;5ae5  49           14995  15014 
    DEFB    036H                        ;5ae6  36           14996  15015 
    DEFB    000H                        ;5ae7  00           14997  15016 
    DEFB    000H                        ;5ae8  00           14998  15017 
    DEFB    000H                        ;5ae9  00           14999  15018 
                                        ;                   15000  15019 ;
                                        ;                   15001  15020 ;CHR$(&HF8)
    DEFB    000H                        ;5aea  00           15002  15021 
    DEFB    000H                        ;5aeb  00           15003  15022 
    DEFB    000H                        ;5aec  00           15004  15023 
    DEFB    000H                        ;5aed  00           15005  15024 
    DEFB    022H                        ;5aee  22           15006  15025 
    DEFB    014H                        ;5aef  14           15007  15026 
    DEFB    008H                        ;5af0  08           15008  15027 
    DEFB    014H                        ;5af1  14           15009  15028 
    DEFB    022H                        ;5af2  22           15010  15029 
    DEFB    000H                        ;5af3  00           15011  15030 
    DEFB    000H                        ;5af4  00           15012  15031 
    DEFB    000H                        ;5af5  00           15013  15032 
                                        ;                   15014  15033 ;
                                        ;                   15015  15034 ;CHR$(&HF9)
    DEFB    000H                        ;5af6  00           15016  15035 
    DEFB    000H                        ;5af7  00           15017  15036 
    DEFB    000H                        ;5af8  00           15018  15037 
    DEFB    000H                        ;5af9  00           15019  15038 
    DEFB    022H                        ;5afa  22           15020  15039 
    DEFB    022H                        ;5afb  22           15021  15040 
    DEFB    022H                        ;5afc  22           15022  15041 
    DEFB    026H                        ;5afd  26           15023  15042 
    DEFB    01AH                        ;5afe  1a           15024  15043 
    DEFB    002H                        ;5aff  02           15025  15044 
    DEFB    01CH                        ;5b00  1c           15026  15045 
    DEFB    000H                        ;5b01  00           15027  15046 
                                        ;                   15028  15047 ;
                                        ;                   15029  15048 ;CHR$(&HFA)
    DEFB    000H                        ;5b02  00           15030  15049 
    DEFB    000H                        ;5b03  00           15031  15050 
    DEFB    000H                        ;5b04  00           15032  15051 
    DEFB    000H                        ;5b05  00           15033  15052 
    DEFB    03EH                        ;5b06  3e           15034  15053 
    DEFB    004H                        ;5b07  04           15035  15054 
    DEFB    008H                        ;5b08  08           15036  15055 
    DEFB    010H                        ;5b09  10           15037  15056 
    DEFB    03EH                        ;5b0a  3e           15038  15057 
    DEFB    000H                        ;5b0b  00           15039  15058 
    DEFB    000H                        ;5b0c  00           15040  15059 
    DEFB    000H                        ;5b0d  00           15041  15060 
                                        ;                   15042  15061 ;
                                        ;                   15043  15062 ;CHR$(&HFB)
    DEFB    000H                        ;5b0e  00           15044  15063 
    DEFB    000H                        ;5b0f  00           15045  15064 
    DEFB    008H                        ;5b10  08           15046  15065 
    DEFB    010H                        ;5b11  10           15047  15066 
    DEFB    010H                        ;5b12  10           15048  15067 
    DEFB    020H                        ;5b13  20           15049  15068 
    DEFB    010H                        ;5b14  10           15050  15069 
    DEFB    010H                        ;5b15  10           15051  15070 
    DEFB    008H                        ;5b16  08           15052  15071 
    DEFB    000H                        ;5b17  00           15053  15072 
    DEFB    000H                        ;5b18  00           15054  15073 
    DEFB    000H                        ;5b19  00           15055  15074 
                                        ;                   15056  15075 ;
                                        ;                   15057  15076 ;CHR$(&HFC)
    DEFB    000H                        ;5b1a  00           15058  15077 
    DEFB    000H                        ;5b1b  00           15059  15078 
    DEFB    000H                        ;5b1c  00           15060  15079 
    DEFB    054H                        ;5b1d  54           15061  15080 
    DEFB    0FEH                        ;5b1e  fe           15062  15081 
    DEFB    054H                        ;5b1f  54           15063  15082 
    DEFB    0FEH                        ;5b20  fe           15064  15083 
    DEFB    054H                        ;5b21  54           15065  15084 
    DEFB    028H                        ;5b22  28           15066  15085 
    DEFB    000H                        ;5b23  00           15067  15086 
    DEFB    000H                        ;5b24  00           15068  15087 
    DEFB    000H                        ;5b25  00           15069  15088 
                                        ;                   15070  15089 ;
                                        ;                   15071  15090 ;CHR$(&HFD)
    DEFB    000H                        ;5b26  00           15072  15091 
    DEFB    000H                        ;5b27  00           15073  15092 
    DEFB    010H                        ;5b28  10           15074  15093 
    DEFB    008H                        ;5b29  08           15075  15094 
    DEFB    008H                        ;5b2a  08           15076  15095 
    DEFB    004H                        ;5b2b  04           15077  15096 
    DEFB    008H                        ;5b2c  08           15078  15097 
    DEFB    008H                        ;5b2d  08           15079  15098 
    DEFB    010H                        ;5b2e  10           15080  15099 
    DEFB    000H                        ;5b2f  00           15081  15100 
    DEFB    000H                        ;5b30  00           15082  15101 
    DEFB    000H                        ;5b31  00           15083  15102 
                                        ;                   15084  15103 ;
                                        ;                   15085  15104 ;CHR$(&HFE)
    DEFB    000H                        ;5b32  00           15086  15105 
    DEFB    000H                        ;5b33  00           15087  15106 
    DEFB    000H                        ;5b34  00           15088  15107 
    DEFB    000H                        ;5b35  00           15089  15108 
    DEFB    000H                        ;5b36  00           15090  15109 
    DEFB    032H                        ;5b37  32           15091  15110 
    DEFB    04CH                        ;5b38  4c           15092  15111 
    DEFB    000H                        ;5b39  00           15093  15112 
    DEFB    000H                        ;5b3a  00           15094  15113 
    DEFB    000H                        ;5b3b  00           15095  15114 
    DEFB    000H                        ;5b3c  00           15096  15115 
    DEFB    000H                        ;5b3d  00           15097  15116 
                                        ;                   15098  15117 ;
                                        ;                   15099  15118 ;CHR$(&HFF)
    DEFB    000H                        ;5b3e  00           15100  15119 
    DEFB    000H                        ;5b3f  00           15101  15120 
    DEFB    000H                        ;5b40  00           15102  15121 
    DEFB    000H                        ;5b41  00           15103  15122 
    DEFB    001H                        ;5b42  01           15104  15123 
    DEFB    03EH                        ;5b43  3e           15105  15124 
    DEFB    054H                        ;5b44  54           15106  15125 
    DEFB    014H                        ;5b45  14           15107  15126 
    DEFB    014H                        ;5b46  14           15108  15127 
    DEFB    000H                        ;5b47  00           15109  15128 
    DEFB    000H                        ;5b48  00           15110  15129 
    DEFB    000H                        ;5b49  00           15111  15130 
                                        ;                   15112  15131 
                                        ;                   15113  15132 ;	ORG	05B4Ah
ADDDEG: PUSH    HL                      ;5b4a  e5           15114  15133 
    LD  HL,8                            ;5b4b  21 08 00     15115  15134 
    ADD HL,DE                           ;5b4e  19           15116  15135 
    EX  DE,HL                           ;5b4f  eb           15117  15136 
    POP HL                              ;5b50  e1           15118  15137 
    RET                                 ;5b51  c9           15119  15138 
                                        ;                   15120  15139 ;
OCTLER: PUSH    HL                      ;5b52  e5           15121  15140 
    LD  HL,CHCKOC                       ;5b53  21 a1 5b     15122  15141 
    LD  (CHKVEC),HL                     ;5b56  22 7b 5b     15123  15142 
    LD  HL,00000h                       ;5b59  21 00 00     15124  15143 
    XOR A                               ;5b5c  af           15125  15144 
    JR  MID&OP                          ;5b5d  18 0c        15126  15145 
                                        ;                   15127  15146 ;
HEXPZM: PUSH    HL                      ;5b5f  e5           15128  15147 
    LD  HL,CHCKHX                       ;5b60  21 a8 5b     15129  15148 
    LD  (CHKVEC),HL                     ;5b63  22 7b 5b     15130  15149 
    LD  HL,ADHLCK                       ;5b66  21 38 5d     15131  15150 
    LD  A,0CDh                          ;5b69  3e cd        15132  15151 
MID&OP: LD  (MULVEC),HL                 ;5b6b  22 89 5b     15133  15152 
    LD  (VECSWT),A                      ;5b6e  32 88 5b     15134  15153 
    LD  HL,00000h                       ;5b71  21 00 00     15135  15154 
LOP&OP: CALL    DEFTCH                  ;5b74  cd 51 5d     15136  15155 
    CALL    SMALL'                      ;5b77  cd 1c 63     15137  15156 
    DEFB    0CDH                        ;5b7a  cd           15138  15157 ;CALL
CHKVEC: DEFW    CHCKHX                  ;5b7b  a8 5b        15139  15158 
    JR  C,RET&OP                        ;5b7d  38 17        15140  15159 
    CALL    ADHLCK                      ;5b7f  cd 38 5d     15141  15160 
    CALL    ADHLCK                      ;5b82  cd 38 5d     15142  15161 
    CALL    ADHLCK                      ;5b85  cd 38 5d     15143  15162 
VECSWT: DEFB    0CDH                    ;5b88  cd           15144  15163 
MULVEC: DEFW    ADHLCK                  ;5b89  38 5d        15145  15164 
    ADD A,L                             ;5b8b  85           15146  15165 
    LD  L,A                             ;5b8c  6f           15147  15166 
    LD  A,0                             ;5b8d  3e 00        15148  15167 
    ADC A,H                             ;5b8f  8c           15149  15168 
    JP  C,OVERFL1                       ;5b90  da e4 6e     15150  15169 
    LD  H,A                             ;5b93  67           15151  15170 
    JR  LOP&OP                          ;5b94  18 de        15152  15171 
                                        ;                   15153  15172 ;
RET&OP: DEC DE                          ;5b96  1b           15154  15173 
    LD  C,E                             ;5b97  4b           15155  15174 
    LD  B,D                             ;5b98  42           15156  15175 
    EX  DE,HL                           ;5b99  eb           15157  15176 
    POP HL                              ;5b9a  e1           15158  15177 
    CALL    FLTHEX                      ;5b9b  cd 02 29     15159  15178 
    LD  E,C                             ;5b9e  59           15160  15179 
    LD  D,B                             ;5b9f  50           15161  15180 
    RET                                 ;5ba0  c9           15162  15181 
                                        ;                   15163  15182 ;
CHCKOC: SUB 030h                        ;5ba1  d6 30        15164  15183 
    RET C                               ;5ba3  d8           15165  15184 
    CP  008h                            ;5ba4  fe 08        15166  15185 
    CCF                                 ;5ba6  3f           15167  15186 
    RET                                 ;5ba7  c9           15168  15187 
                                        ;                   15169  15188 ;
CHCKHX: SUB 030h                        ;5ba8  d6 30        15170  15189 
    RET C                               ;5baa  d8           15171  15190 
    CP  00Ah                            ;5bab  fe 0a        15172  15191 
    CCF                                 ;5bad  3f           15173  15192 
    RET NC                              ;5bae  d0           15174  15193 
    CP  011h                            ;5baf  fe 11        15175  15194 
    RET C                               ;5bb1  d8           15176  15195 
    SUB 007h                            ;5bb2  d6 07        15177  15196 
    CP  010h                            ;5bb4  fe 10        15178  15197 
    CCF                                 ;5bb6  3f           15179  15198 
    RET                                 ;5bb7  c9           15180  15199 
                                        ;                   15181  15200 ;
OVFLAG: LD  (IY+0),8                    ;5bb8  fd 36 00 08  15182  15201 
    XOR A                               ;5bbc  af           15183  15202 
    LD  (IY-1),A                        ;5bbd  fd 77 ff     15184  15203 
    LD  C,A                             ;5bc0  4f           15185  15204 
    INC C                               ;5bc1  0c           15186  15205 
    EX  DE,HL                           ;5bc2  eb           15187  15206 
    LD  B,8                             ;5bc3  06 08        15188  15207 
    CALL    ZFILL                       ;5bc5  cd 10 62     15189  15208 
    EX  DE,HL                           ;5bc8  eb           15190  15209 
    CALL    DEFTCH                      ;5bc9  cd 51 5d     15191  15210 
    CP  02Bh                            ;5bcc  fe 2b        15192  15211 
    JR  Z,OVFLAG                        ;5bce  28 e8        15193  15212 
    CP  02Dh                            ;5bd0  fe 2d        15194  15213 
    JR  Z,SKIP2D                        ;5bd2  28 0b        15195  15214 
    JR  L008F                           ;5bd4  18 03        15196  15215 
ZRSKIP: CALL    DEFTCH                  ;5bd6  cd 51 5d     15197  15216 
L008F:  CP  030h                        ;5bd9  fe 30        15198  15217 
    JR  Z,ZRSKIP                        ;5bdb  28 f9        15199  15218 
    JR  CHCK26                          ;5bdd  18 06        15200  15219 
SKIP2D: CALL    OVFLAG                  ;5bdf  cd b8 5b     15201  15220 
    JP  TOGLE                           ;5be2  c3 eb 6b     15202  15221 
                                        ;                   15203  15222 ;
CHCK26: CP  026h                        ;5be5  fe 26        15204  15223 
    JR  NZ,MDLAG                        ;5be7  20 17        15205  15224 
    CALL    DEFTCH                      ;5be9  cd 51 5d     15206  15225 
    CALL    SMALL'                      ;5bec  cd 1c 63     15207  15226 
    CP  048h                            ;5bef  fe 48        15208  15227 
    JP  Z,HEXPZM                        ;5bf1  ca 5f 5b     15209  15228 
    CP  04Fh                            ;5bf4  fe 4f        15210  15229 
    CALL    Z,DEFTCH                    ;5bf6  cc 51 5d     15211  15230 
    DEC DE                              ;5bf9  1b           15212  15231 
    JP  OCTLER                          ;5bfa  c3 52 5b     15213  15232 
                                        ;                   15214  15233 ;
FTCHL:  CALL    DEFTCH                  ;5bfd  cd 51 5d     15215  15234 
MDLAG:  CP  02Eh                        ;5c00  fe 2e        15216  15235 
    JR  Z,POINTS                        ;5c02  28 23        15217  15236 
    CP  045h                            ;5c04  fe 45        15218  15237 
    JP  Z,EXPON?                        ;5c06  ca a8 5c     15219  15238 
    CP  044h                            ;5c09  fe 44        15220  15239 
    JP  Z,DEXPON                        ;5c0b  ca b6 5c     15221  15240 
    CP  030h                            ;5c0e  fe 30        15222  15241 
    JR  C,TST23H                        ;5c10  38 47        15223  15242 
    CP  03Ah                            ;5c12  fe 3a        15224  15243 
    JR  NC,TST23H                       ;5c14  30 43        15225  15244 
    SUB 030h                            ;5c16  d6 30        15226  15245 
    CALL    MULTEN                      ;5c18  cd 42 61     15227  15246 
    INC (IY-1)                          ;5c1b  fd 34 ff     15228  15247 
    SET 6,(IY-1)                        ;5c1e  fd cb ff f6  15229  15248 
    CALL    MULDEC                      ;5c22  cd 3d 5d     15230  15249 
    JR  FTCHL                           ;5c25  18 d6        15231  15250 
                                        ;                   15232  15251 ;
POINTS: SET 7,(IY-1)                    ;5c27  fd cb ff fe  15233  15252 
POINT:  CALL    DEFTCH                  ;5c2b  cd 51 5d     15234  15253 
    CP  030h                            ;5c2e  fe 30        15235  15254 
    JR  C,PESC                          ;5c30  38 1f        15236  15255 
    CP  03Ah                            ;5c32  fe 3a        15237  15256 
    JR  NC,PESC                         ;5c34  30 1b        15238  15257 
    SUB 030h                            ;5c36  d6 30        15239  15258 
    INC C                               ;5c38  0c           15240  15259 
    CALL    MULTEN                      ;5c39  cd 42 61     15241  15260 
    BIT 6,(IY-1)                        ;5c3c  fd cb ff 76  15242  15261 
    JR  NZ,KMYSET                       ;5c40  20 07        15243  15262 
    OR  A                               ;5c42  b7           15244  15263 
    JR  Z,POINT                         ;5c43  28 e6        15245  15264 
    SET 6,(IY-1)                        ;5c45  fd cb ff f6  15246  15265 
KMYSET: CALL    MULDEC                  ;5c49  cd 3d 5d     15247  15266 
    INC (IY-1)                          ;5c4c  fd 34 ff     15248  15267 
    JR  POINT                           ;5c4f  18 da        15249  15268 
                                        ;                   15250  15269 ;
PESC:   DEC C                           ;5c51  0d           15251  15270 
    JR  Z,TST23H                        ;5c52  28 05        15252  15271 
    CALL    DIVTEN                      ;5c54  cd 27 5d     15253  15272 
    JR  PESC                            ;5c57  18 f8        15254  15273 
                                        ;                   15255  15274 ;
TST23H: CP  045h                        ;5c59  fe 45        15256  15275 
    JP  Z,EXPON!                        ;5c5b  ca af 5c     15257  15276 
    CP  044h                            ;5c5e  fe 44        15258  15277 
    JP  Z,DEXPON                        ;5c60  ca b6 5c     15259  15278 
    CP  023h                            ;5c63  fe 23        15260  15279 
    JR  NZ,TST21H                       ;5c65  20 09        15261  15280 
    LD  (IY+0),8                        ;5c67  fd 36 00 08  15262  15281 
    SET 7,(IY-1)                        ;5c6b  fd cb ff fe  15263  15282 
    RET                                 ;5c6f  c9           15264  15283 
                                        ;                   15265  15284 ;
TST21H: CP  021h                        ;5c70  fe 21        15266  15285 
    JR  NZ,TST25H                       ;5c72  20 1d        15267  15286 
    SET 7,(IY-1)                        ;5c74  fd cb ff fe  15268  15287 
DGTUPQ: PUSH    DE                      ;5c78  d5           15269  15288 
    PUSH    BC                          ;5c79  c5           15270  15289 
    CALL    CSNG                        ;5c7a  cd 26 2b     15271  15290 
    PUSH    HL                          ;5c7d  e5           15272  15291 
    INC HL                              ;5c7e  23           15273  15292 
    INC HL                              ;5c7f  23           15274  15293 
    INC HL                              ;5c80  23           15275  15294 
    INC HL                              ;5c81  23           15276  15295 
    LD  B,4                             ;5c82  06 04        15277  15296 
SNGCL1: LD  (HL),0                      ;5c84  36 00        15278  15297 
    INC HL                              ;5c86  23           15279  15298 
    DJNZ    SNGCL1                      ;5c87  10 fb        15280  15299 
    POP HL                              ;5c89  e1           15281  15300 
    POP BC                              ;5c8a  c1           15282  15301 
    POP DE                              ;5c8b  d1           15283  15302 
    LD  (IY+0),4                        ;5c8c  fd 36 00 04  15284  15303 
    RET                                 ;5c90  c9           15285  15304 
                                        ;                   15286  15305 ;
TST25H: CP  025h                        ;5c91  fe 25        15287  15306 
    JR  NZ,TSTPRC                       ;5c93  20 08        15288  15307 
    CALL    INT                         ;5c95  cd 10 60     15289  15308 
    RES 7,(IY-1)                        ;5c98  fd cb ff be  15290  15309 
    RET                                 ;5c9c  c9           15291  15310 
                                        ;                   15292  15311 ;
TSTPRC: DEC DE                          ;5c9d  1b           15293  15312 
    LD  A,(IY-1)                        ;5c9e  fd 7e ff     15294  15313 
    AND 03Fh                            ;5ca1  e6 3f        15295  15314 
    CP  008h                            ;5ca3  fe 08        15296  15315 
    RET NC                              ;5ca5  d0           15297  15316 
    JR  DGTUPQ                          ;5ca6  18 d0        15298  15317 
                                        ;                   15299  15318 ;
EXPON?: LD  A,(DE)                      ;5ca8  1a           15300  15319 
    CP  04Ch                            ;5ca9  fe 4c        15301  15320 
    JR  NZ,EXPON                        ;5cab  20 0f        15302  15321 
    JR  TSTPRC                          ;5cad  18 ee        15303  15322 
                                        ;                   15304  15323 ;
EXPON!: LD  A,(DE)                      ;5caf  1a           15305  15324 
    CP  04Ch                            ;5cb0  fe 4c        15306  15325 
    JR  NZ,EXPON                        ;5cb2  20 08        15307  15326 
    JR  TSTPRC                          ;5cb4  18 e7        15308  15327 
                                        ;                   15309  15328 ;
DEXPON: LD  (IY+0),8                    ;5cb6  fd 36 00 08  15310  15329 
    JR  EXPCLM                          ;5cba  18 04        15311  15330 
EXPON:  LD  (IY+0),4                    ;5cbc  fd 36 00 04  15312  15331 
EXPCLM: SET 7,(IY-1)                    ;5cc0  fd cb ff fe  15313  15332 
    PUSH    HL                          ;5cc4  e5           15314  15333 
    LD  HL,MUL                          ;5cc5  21 e0 6f     15315  15334 
    LD  (EXJPVC),HL                     ;5cc8  22 22 5d     15316  15335 
    LD  HL,00000h                       ;5ccb  21 00 00     15317  15336 
FTREPT: CALL    DEFTCH                  ;5cce  cd 51 5d     15318  15337 
    CP  02Bh                            ;5cd1  fe 2b        15319  15338 
    JR  Z,CBEGIN                        ;5cd3  28 0c        15320  15339 
    CP  02Dh                            ;5cd5  fe 2d        15321  15340 
    JR  NZ,CLMIDL                       ;5cd7  20 0b        15322  15341 
    PUSH    HL                          ;5cd9  e5           15323  15342 
    LD  HL,DIV                          ;5cda  21 bd 70     15324  15343 
    LD  (EXJPVC),HL                     ;5cdd  22 22 5d     15325  15344 
    POP HL                              ;5ce0  e1           15326  15345 
CBEGIN: CALL    DEFTCH                  ;5ce1  cd 51 5d     15327  15346 
CLMIDL: SUB 030h                        ;5ce4  d6 30        15328  15347 
    JR  C,ESCPER                        ;5ce6  38 1c        15329  15348 
    CP  00Ah                            ;5ce8  fe 0a        15330  15349 
    JR  NC,ESCPER                       ;5cea  30 18        15331  15350 
    PUSH    DE                          ;5cec  d5           15332  15351 
    CALL    ADHLCK                      ;5ced  cd 38 5d     15333  15352 
    LD  E,L                             ;5cf0  5d           15334  15353 
    LD  D,H                             ;5cf1  54           15335  15354 
    CALL    ADHLCK                      ;5cf2  cd 38 5d     15336  15355 
    CALL    ADHLCK                      ;5cf5  cd 38 5d     15337  15356 
    CALL    ADDECK                      ;5cf8  cd 34 5d     15338  15357 
    LD  E,A                             ;5cfb  5f           15339  15358 
    LD  D,000h                          ;5cfc  16 00        15340  15359 
    CALL    ADDECK                      ;5cfe  cd 34 5d     15341  15360 
    POP DE                              ;5d01  d1           15342  15361 
    JR  CBEGIN                          ;5d02  18 dd        15343  15362 
ESCPER: DEC DE                          ;5d04  1b           15344  15363 
    LD  A,H                             ;5d05  7c           15345  15364 
    OR  A                               ;5d06  b7           15346  15365 
    JR  NZ,OVERF'                       ;5d07  20 31        15347  15366 
    LD  A,L                             ;5d09  7d           15348  15367 
    POP HL                              ;5d0a  e1           15349  15368 
    PUSH    DE                          ;5d0b  d5           15350  15369 
    PUSH    BC                          ;5d0c  c5           15351  15370 
    PUSH    HL                          ;5d0d  e5           15352  15371 
    LD  DE,ZFAC1                        ;5d0e  11 fa 62     15353  15372 
    PUSH    DE                          ;5d11  d5           15354  15373 
    CALL    LDIR1                       ;5d12  cd a3 73     15355  15374 
    POP HL                              ;5d15  e1           15356  15375 
    LD  B,A                             ;5d16  47           15357  15376 
    INC B                               ;5d17  04           15358  15377 
    JR  MULLKM                          ;5d18  18 03        15359  15378 
EMLLPO: CALL    MULTEN                  ;5d1a  cd 42 61     15360  15379 
MULLKM: DJNZ    EMLLPO                  ;5d1d  10 fb        15361  15380 
    EX  DE,HL                           ;5d1f  eb           15362  15381 
    POP HL                              ;5d20  e1           15363  15382 
    DEFB    0CDH                        ;5d21  cd           15364  15383 ;CALL
EXJPVC: DEFS    2                       ;5d22               15365  15384 
    POP BC                              ;5d24  c1           15366  15385 
    POP DE                              ;5d25  d1           15367  15386 
    RET                                 ;5d26  c9           15368  15387 
                                        ;                   15369  15388 ;
DIVTEN: PUSH    AF                      ;5d27  f5           15370  15389 
    PUSH    BC                          ;5d28  c5           15371  15390 
    PUSH    DE                          ;5d29  d5           15372  15391 
    LD  DE,FLTEN                        ;5d2a  11 90 62     15373  15392 
    CALL    DIV                         ;5d2d  cd bd 70     15374  15393 
    POP DE                              ;5d30  d1           15375  15394 
    POP BC                              ;5d31  c1           15376  15395 
    POP AF                              ;5d32  f1           15377  15396 
    RET                                 ;5d33  c9           15378  15397 
                                        ;                   15379  15398 ;
ADDECK: ADD HL,DE                       ;5d34  19           15380  15399 
    RET NC                              ;5d35  d0           15381  15400 
    JR  OVERF'                          ;5d36  18 02        15382  15401 
                                        ;                   15383  15402 ;
ADHLCK: ADD HL,HL                       ;5d38  29           15384  15403 
    RET NC                              ;5d39  d0           15385  15404 
OVERF': JP  OVERFL1                     ;5d3a  c3 e4 6e     15386  15405 
                                        ;                   15387  15406 ;
MULDEC: PUSH    DE                      ;5d3d  d5           15388  15407 
    PUSH    HL                          ;5d3e  e5           15389  15408 
    LD  HL,ZFAC1                        ;5d3f  21 fa 62     15390  15409 
    LD  E,A                             ;5d42  5f           15391  15410 
    LD  D,0                             ;5d43  16 00        15392  15411 
    CALL    FLTHEX                      ;5d45  cd 02 29     15393  15412 
    EX  DE,HL                           ;5d48  eb           15394  15413 
    POP HL                              ;5d49  e1           15395  15414 
    PUSH    BC                          ;5d4a  c5           15396  15415 
    CALL    ADD                         ;5d4b  cd a6 6c     15397  15416 
    POP BC                              ;5d4e  c1           15398  15417 
    POP DE                              ;5d4f  d1           15399  15418 
    RET                                 ;5d50  c9           15400  15419 
                                        ;                   15401  15420 ;
DEFTCH: LD  A,(DE)                      ;5d51  1a           15402  15421 
    CP  020h                            ;5d52  fe 20        15403  15422 
    INC DE                              ;5d54  13           15404  15423 
    JR  Z,DEFTCH                        ;5d55  28 fa        15405  15424 
    RET                                 ;5d57  c9           15406  15425 
                                        ;                   15407  15426 ;
CVNMFL: LD  A,(HL)                      ;5d58  7e           15408  15427 
    OR  A                               ;5d59  b7           15409  15428 
    JR  Z,ONLYZ#                        ;5d5a  28 06        15410  15429 
    INC HL                              ;5d5c  23           15411  15430 
    LD  A,(HL)                          ;5d5d  7e           15412  15431 
    RES 7,(HL)                          ;5d5e  cb be        15413  15432 
    DEC HL                              ;5d60  2b           15414  15433 
    RLCA                                ;5d61  07           15415  15434 
ONLYZ#: LD  A,020h                      ;5d62  3e 20        15416  15435 
    JR  NC,PLUS                         ;5d64  30 02        15417  15436 
    LD  A,02Dh                          ;5d66  3e 2d        15418  15437 
PLUS:   PUSH    AF                      ;5d68  f5           15419  15438 
    CALL    CVASFL                      ;5d69  cd 1a 5e     15420  15439 
    POP AF                              ;5d6c  f1           15421  15440 
    INC B                               ;5d6d  04           15422  15441 
    DEC DE                              ;5d6e  1b           15423  15442 
    LD  (DE),A                          ;5d6f  12           15424  15443 
    RET                                 ;5d70  c9           15425  15444 
                                        ;                   15426  15445 ;
ENORLP: LD  BC,0                        ;5d71  01 00 00     15427  15446 
ENORL': CALL    CMP                     ;5d74  cd d6 61     15428  15447 
    JR  NC,NORRES                       ;5d77  30 06        15429  15448 
    CALL    MULTEN                      ;5d79  cd 42 61     15430  15449 
    DEC BC                              ;5d7c  0b           15431  15450 
    JR  ENORL'                          ;5d7d  18 f5        15432  15451 
NORRES: PUSH    HL                      ;5d7f  e5           15433  15452 
    LD  HL,0FFF8h                       ;5d80  21 f8 ff     15434  15453 
    ADD HL,DE                           ;5d83  19           15435  15454 
    EX  DE,HL                           ;5d84  eb           15436  15455 
    POP HL                              ;5d85  e1           15437  15456 
NORRE': CALL    CMP                     ;5d86  cd d6 61     15438  15457 
    RET C                               ;5d89  d8           15439  15458 
    CALL    DIVTEN                      ;5d8a  cd 27 5d     15440  15459 
    INC BC                              ;5d8d  03           15441  15460 
    JR  NORRE'                          ;5d8e  18 f6        15442  15461 
                                        ;                   15443  15462 ;
OKOMTR: LD  A,044h                      ;5d90  3e 44        15444  15463 
    BIT 3,(IY+0)                        ;5d92  fd cb 00 5e  15445  15464 
    JR  NZ,PUTEMK                       ;5d96  20 01        15446  15465 
    INC A                               ;5d98  3c           15447  15466 
PUTEMK: LD  (DE),A                      ;5d99  12           15448  15467 
    INC DE                              ;5d9a  13           15449  15468 
    LD  A,H                             ;5d9b  7c           15450  15469 
    OR  A                               ;5d9c  b7           15451  15470 
    LD  A,02Bh                          ;5d9d  3e 2b        15452  15471 
    JR  Z,EXPPLS                        ;5d9f  28 09        15453  15472 
    LD  A,L                             ;5da1  7d           15454  15473 
    CPL                                 ;5da2  2f           15455  15474 
    LD  L,A                             ;5da3  6f           15456  15475 
    LD  A,H                             ;5da4  7c           15457  15476 
    CPL                                 ;5da5  2f           15458  15477 
    LD  H,A                             ;5da6  67           15459  15478 
    INC HL                              ;5da7  23           15460  15479 
    LD  A,02Dh                          ;5da8  3e 2d        15461  15480 
EXPPLS: LD  (DE),A                      ;5daa  12           15462  15481 
    INC DE                              ;5dab  13           15463  15482 
    PUSH    DE                          ;5dac  d5           15464  15483 
    LD  DE,ZFAC                         ;5dad  11 f2 62     15465  15484 
    CALL    ASCHL                       ;5db0  cd a8 62     15466  15485 
    POP DE                              ;5db3  d1           15467  15486 
    LD  A,(ZFAC+3)                      ;5db4  3a f5 62     15468  15487 
    LD  (DE),A                          ;5db7  12           15469  15488 
    INC DE                              ;5db8  13           15470  15489 
    LD  A,(ZFAC+4)                      ;5db9  3a f6 62     15471  15490 
    LD  (DE),A                          ;5dbc  12           15472  15491 
    RET                                 ;5dbd  c9           15473  15492 
                                        ;                   15474  15493 ;
EXPASC: PUSH    HL                      ;5dbe  e5           15475  15494 
    LD  DE,ZFAC                         ;5dbf  11 f2 62     15476  15495 
    PUSH    DE                          ;5dc2  d5           15477  15496 
    CALL    LDIR8                       ;5dc3  cd a6 73     15478  15497 
    POP HL                              ;5dc6  e1           15479  15498 
    LD  DE,FLONE                        ;5dc7  11 98 62     15480  15499 
    CALL    ENORLP                      ;5dca  cd 71 5d     15481  15500 
    PUSH    BC                          ;5dcd  c5           15482  15501 
    CALL    CVASFL                      ;5dce  cd 1a 5e     15483  15502 
    POP HL                              ;5dd1  e1           15484  15503 
    PUSH    DE                          ;5dd2  d5           15485  15504 
    PUSH    BC                          ;5dd3  c5           15486  15505 
    LD  A,E                             ;5dd4  7b           15487  15506 
    ADD A,B                             ;5dd5  80           15488  15507 
    LD  E,A                             ;5dd6  5f           15489  15508 
    LD  A,000h                          ;5dd7  3e 00        15490  15509 
    ADC A,D                             ;5dd9  8a           15491  15510 
    LD  D,A                             ;5dda  57           15492  15511 
    DEC DE                              ;5ddb  1b           15493  15512 
    LD  A,(DE)                          ;5ddc  1a           15494  15513 
    CP  030h                            ;5ddd  fe 30        15495  15514 
    INC DE                              ;5ddf  13           15496  15515 
    JR  NZ,PUTEXP                       ;5de0  20 05        15497  15516 
    DEC DE                              ;5de2  1b           15498  15517 
    POP BC                              ;5de3  c1           15499  15518 
    DEC B                               ;5de4  05           15500  15519 
    PUSH    BC                          ;5de5  c5           15501  15520 
    INC HL                              ;5de6  23           15502  15521 
PUTEXP: CALL    OKOMTR                  ;5de7  cd 90 5d     15503  15522 
    POP BC                              ;5dea  c1           15504  15523 
    POP DE                              ;5deb  d1           15505  15524 
    INC B                               ;5dec  04           15506  15525 
    INC B                               ;5ded  04           15507  15526 
    INC B                               ;5dee  04           15508  15527 
    INC B                               ;5def  04           15509  15528 
    POP HL                              ;5df0  e1           15510  15529 
    RET                                 ;5df1  c9           15511  15530 
                                        ;                   15512  15531 ;
INTPAR: PUSH    HL                      ;5df2  e5           15513  15532 
    CALL    DLTEN                       ;5df3  cd 67 61     15514  15533 
    LD  DE,DGBUF+3                      ;5df6  11 07 63     15515  15534 
    CALL    ASCHL                       ;5df9  cd a8 62     15516  15535 
    EX  DE,HL                           ;5dfc  eb           15517  15536 
    LD  B,5                             ;5dfd  06 05        15518  15537 
FRSTCH: LD  A,(HL)                      ;5dff  7e           15519  15538 
    CP  030h                            ;5e00  fe 30        15520  15539 
    JR  NZ,BEGTRS                       ;5e02  20 03        15521  15540 
    INC HL                              ;5e04  23           15522  15541 
    DJNZ    FRSTCH                      ;5e05  10 f8        15523  15542 
BEGTRS: LD  C,B                         ;5e07  48           15524  15543 
MIDTRS: LD  A,(HL)                      ;5e08  7e           15525  15544 
    INC IX                              ;5e09  dd 23        15526  15545 
    LD  (IX+0),A                        ;5e0b  dd 77 00     15527  15546 
    INC HL                              ;5e0e  23           15528  15547 
    DJNZ    MIDTRS                      ;5e0f  10 f7        15529  15548 
    POP HL                              ;5e11  e1           15530  15549 
    CALL    FRAC                        ;5e12  cd 95 60     15531  15550 
    LD  DE,FLLAST                       ;5e15  11 a0 62     15532  15551 
    JR  ESTST'                          ;5e18  18 57        15533  15552 
                                        ;                   15534  15553 ;
CVASFL: XOR A                           ;5e1a  af           15535  15554 
    CP  (HL)                            ;5e1b  be           15536  15555 
    JP  Z,ASZERO                        ;5e1c  ca b4 5e     15537  15556 
    LD  A,(IY+0)                        ;5e1f  fd 7e 00     15538  15557 
    CP  008h                            ;5e22  fe 08        15539  15558 
    JR  Z,DBLLCH                        ;5e24  28 0b        15540  15559 
    LD  DE,SHLMT                        ;5e26  11 ee 62     15541  15560 
    CALL    CMP                         ;5e29  cd d6 61     15542  15561 
    JP  NC,EXPASC                       ;5e2c  d2 be 5d     15543  15562 
    JR  NOEXP                           ;5e2f  18 09        15544  15563 
DBLLCH: LD  DE,DHLMT                    ;5e31  11 e6 62     15545  15564 
    CALL    CMP                         ;5e34  cd d6 61     15546  15565 
    JP  NC,EXPASC                       ;5e37  d2 be 5d     15547  15566 
NOEXP:  LD  DE,FLLAST                   ;5e3a  11 a0 62     15548  15567 
    CALL    CMP                         ;5e3d  cd d6 61     15549  15568 
    JP  C,EXPASC                        ;5e40  da be 5d     15550  15569 
    PUSH    HL                          ;5e43  e5           15551  15570 
    LD  DE,ZFAC1                        ;5e44  11 fa 62     15552  15571 
    PUSH    DE                          ;5e47  d5           15553  15572 
    CALL    LDIR8                       ;5e48  cd a6 73     15554  15573 
    POP HL                              ;5e4b  e1           15555  15574 
    CALL    CONDDG                      ;5e4c  cd fa 5f     15556  15575 
    LD  IX,DGBUF                        ;5e4f  dd 21 04 63  15557  15576 
    LD  (IX+0),030h                     ;5e53  dd 36 00 30  15558  15577 
    LD  A,(HL)                          ;5e57  7e           15559  15578 
    CP  081h                            ;5e58  fe 81        15560  15579 
    JR  C,FRACDG                        ;5e5a  38 1e        15561  15580 
    CP  091h                            ;5e5c  fe 91        15562  15581 
    JP  C,INTPAR                        ;5e5e  da f2 5d     15563  15582 
    LD  DE,CONTBL                       ;5e61  11 20 62     15564  15583 
    CALL    CONDSF                      ;5e64  cd ec 5f     15565  15584 
CVCONT: CALL    CMP                     ;5e67  cd d6 61     15566  15585 
    JR  NC,DWNERC                       ;5e6a  30 0b        15567  15586 
    CALL    ADDDEG                      ;5e6c  cd 4a 5b     15568  15587 
    JR  CVCONT                          ;5e6f  18 f6        15569  15588 
                                        ;                   15570  15589 ;
ESTST': CALL    CONDDG                  ;5e71  cd fa 5f     15571  15590 
    LD  A,B                             ;5e74  78           15572  15591 
    SUB C                               ;5e75  91           15573  15592 
    LD  B,A                             ;5e76  47           15574  15593 
DWNERC: CALL    MIDSGN                  ;5e77  cd c0 5f     15575  15594 
FRACDG: INC IX                          ;5e7a  dd 23        15576  15595 
    LD  (IX+0),02Eh                     ;5e7c  dd 36 00 2e  15577  15596 
FRCAGN: LD  DE,FLMAX                    ;5e80  11 18 62     15578  15597 
    CALL    CONDSF                      ;5e83  cd ec 5f     15579  15598 
    PUSH    BC                          ;5e86  c5           15580  15599 
    PUSH    IX                          ;5e87  dd e5        15581  15600 
    CALL    MUL                         ;5e89  cd e0 6f     15582  15601 
    POP IX                              ;5e8c  dd e1        15583  15602 
    POP BC                              ;5e8e  c1           15584  15603 
    CALL    GNXDGT                      ;5e8f  cd bd 5f     15585  15604 
    LD  A,B                             ;5e92  78           15586  15605 
    OR  A                               ;5e93  b7           15587  15606 
    JR  NZ,FRCAGN                       ;5e94  20 ea        15588  15607 
    CALL    FRCADM                      ;5e96  cd bd 5e     15589  15608 
BCKSER: DEC HL                          ;5e99  2b           15590  15609 
    LD  A,(HL)                          ;5e9a  7e           15591  15610 
    CP  02Eh                            ;5e9b  fe 2e        15592  15611 
    DEC HL                              ;5e9d  2b           15593  15612 
    JR  Z,INTDIS                        ;5e9e  28 05        15594  15613 
    INC HL                              ;5ea0  23           15595  15614 
    CP  030h                            ;5ea1  fe 30        15596  15615 
    JR  Z,BCKSER                        ;5ea3  28 f4        15597  15616 
INTDIS: LD  DE,DGBUF                    ;5ea5  11 04 63     15598  15617 
    LD  A,(DE)                          ;5ea8  1a           15599  15618 
    CP  030h                            ;5ea9  fe 30        15600  15619 
    JR  NZ,LSTASA                       ;5eab  20 01        15601  15620 
    INC DE                              ;5ead  13           15602  15621 
LSTASA: SBC HL,DE                       ;5eae  ed 52        15603  15622 
    LD  B,L                             ;5eb0  45           15604  15623 
    INC B                               ;5eb1  04           15605  15624 
    POP HL                              ;5eb2  e1           15606  15625 
    RET                                 ;5eb3  c9           15607  15626 
                                        ;                   15608  15627 ;
ASZERO: LD  DE,DGBUF                    ;5eb4  11 04 63     15609  15628 
    LD  A,030h                          ;5eb7  3e 30        15610  15629 
    LD  (DE),A                          ;5eb9  12           15611  15630 
ASCONE: LD  B,1                         ;5eba  06 01        15612  15631 
    RET                                 ;5ebc  c9           15613  15632 
                                        ;                   15614  15633 ;
FRCADM: PUSH    IX                      ;5ebd  dd e5        15615  15634 
    POP HL                              ;5ebf  e1           15616  15635 
    LD  A,(HL)                          ;5ec0  7e           15617  15636 
    PUSH    HL                          ;5ec1  e5           15618  15637 
FRCASL: LD  (HL),030h                   ;5ec2  36 30        15619  15638 
    CP  035h                            ;5ec4  fe 35        15620  15639 
    JR  C,ESCADD                        ;5ec6  38 0c        15621  15640 
ADDLOP: DEC HL                          ;5ec8  2b           15622  15641 
    LD  A,(HL)                          ;5ec9  7e           15623  15642 
    CP  02Eh                            ;5eca  fe 2e        15624  15643 
    JR  Z,ADDLOP                        ;5ecc  28 fa        15625  15644 
    INC A                               ;5ece  3c           15626  15645 
    LD  (HL),A                          ;5ecf  77           15627  15646 
    CP  03Ah                            ;5ed0  fe 3a        15628  15647 
    JR  Z,FRCASL                        ;5ed2  28 ee        15629  15648 
ESCADD: POP HL                          ;5ed4  e1           15630  15649 
    RET                                 ;5ed5  c9           15631  15650 
                                        ;                   15632  15651 ;
USGNCV:                                 ;                   15633  15652 
                                        ;                   15634  15653 ;
                                        ;                   15635  15654 ; ACC <- 1 EXP ON
                                        ;                   15636  15655 ; ACC <- 0 EXP OFF
                                        ;                   15637  15656 ; B <- INT PAR
                                        ;                   15638  15657 ; C <- FRAC PAR
                                        ;                   15639  15658 ;
                                        ;                   15640  15659 ; OUT:HL <- LASTPO
                                        ;                   15641  15660 ; KEYBUF+1 <- RESULT
                                        ;                   15642  15661 ;
    PUSH    BC                          ;5ed6  c5           15643  15662 
    CALL    USGCV'                      ;5ed7  cd 4a 5f     15644  15663 
    POP BC                              ;5eda  c1           15645  15664 
    LD  A,B                             ;5edb  78           15646  15665 
    CP  2                               ;5edc  fe 02        15647  15666 
    RET C                               ;5ede  d8           15648  15667 
    DEC B                               ;5edf  05           15649  15668 
    LD  DE,KEYBUF                       ;5ee0  11 4f 7a     15650  15669 
RPSPAC: INC DE                          ;5ee3  13           15651  15670 
    LD  A,(DE)                          ;5ee4  1a           15652  15671 
    CP  030h                            ;5ee5  fe 30        15653  15672 
    RET NZ                              ;5ee7  c0           15654  15673 
    LD  A,020h                          ;5ee8  3e 20        15655  15674 
    LD  (DE),A                          ;5eea  12           15656  15675 
    DJNZ    RPSPAC                      ;5eeb  10 f6        15657  15676 
    RET                                 ;5eed  c9           15658  15677 
                                        ;                   15659  15678 ;
EXPUSG: PUSH    BC                      ;5eee  c5           15660  15679 
    LD  A,B                             ;5eef  78           15661  15680 
    CP  011h                            ;5ef0  fe 11        15662  15681 
    JP  NC,FOVER                        ;5ef2  d2 a6 5f     15663  15682 
    OR  A                               ;5ef5  b7           15664  15683 
    JR  Z,USNRIW                        ;5ef6  28 01        15665  15684 
    DEC A                               ;5ef8  3d           15666  15685 
USNRIW: CALL    CPSHIF                  ;5ef9  cd dd 5f     15667  15686 
    LD  A,(HL)                          ;5efc  7e           15668  15687 
    OR  A                               ;5efd  b7           15669  15688 
    LD  BC,0                            ;5efe  01 00 00     15670  15689 
    CALL    NZ,ENORLP                   ;5f01  c4 71 5d     15671  15690 
    LD  E,C                             ;5f04  59           15672  15691 
    LD  D,B                             ;5f05  50           15673  15692 
    POP BC                              ;5f06  c1           15674  15693 
    LD  (EXPUBC),BC                     ;5f07  ed 43 2d 5f  15675  15694 
    LD  (EXPUHL),HL                     ;5f0b  22 30 5f     15676  15695 
AGNEXP: PUSH    DE                      ;5f0e  d5           15677  15696 
    PUSH    BC                          ;5f0f  c5           15678  15697 
    LD  DE,ZFAC                         ;5f10  11 f2 62     15679  15698 
    PUSH    DE                          ;5f13  d5           15680  15699 
    CALL    LDIR8                       ;5f14  cd a6 73     15681  15700 
    POP HL                              ;5f17  e1           15682  15701 
    POP BC                              ;5f18  c1           15683  15702 
    CALL    USGC''                      ;5f19  cd 46 5f     15684  15703 
    LD  DE,KEYBUF                       ;5f1c  11 4f 7a     15685  15704 
    LD  A,(DE)                          ;5f1f  1a           15686  15705 
    CP  02Fh                            ;5f20  fe 2f        15687  15706 
    JR  NZ,NGPUDS                       ;5f22  20 06        15688  15707 
    INC DE                              ;5f24  13           15689  15708 
    LD  A,(DE)                          ;5f25  1a           15690  15709 
    CP  031h                            ;5f26  fe 31        15691  15710 
    JR  NZ,WRITEL1                      ;5f28  20 0d        15692  15711 
NGPUDS: POP DE                          ;5f2a  d1           15693  15712 
    INC DE                              ;5f2b  13           15694  15713 
    DEFB    001H                        ;5f2c  01           15695  15714 ; LD BC,?
EXPUBC: DEFS    2                       ;5f2d               15696  15715 
    DEFB    021H                        ;5f2f  21           15697  15716 ; LD HL,?
EXPUHL: DEFS    2                       ;5f30               15698  15717 
    CALL    DIVTEN                      ;5f32  cd 27 5d     15699  15718 
    JR  AGNEXP                          ;5f35  18 d7        15700  15719 
                                        ;                   15701  15720 ;
WRITEL1: CP 02Eh                        ;5f37  fe 2e        15702  15721 
    JR  Z,NTPT2E                        ;5f39  28 03        15703  15722 
    LD  A,020h                          ;5f3b  3e 20        15704  15723 
    LD  (DE),A                          ;5f3d  12           15705  15724 
NTPT2E: POP DE                          ;5f3e  d1           15706  15725 
    EX  DE,HL                           ;5f3f  eb           15707  15726 
    CALL    OKOMTR                      ;5f40  cd 90 5d     15708  15727 
    INC DE                              ;5f43  13           15709  15728 
    EX  DE,HL                           ;5f44  eb           15710  15729 
    RET                                 ;5f45  c9           15711  15730 
                                        ;                   15712  15731 ;
USGC'': LD  A,02Fh                      ;5f46  3e 2f        15713  15732 
    JR  USG'''                          ;5f48  18 05        15714  15733 
                                        ;                   15715  15734 ;
USGCV': OR  A                           ;5f4a  b7           15716  15735 
    JR  NZ,EXPUSG                       ;5f4b  20 a1        15717  15736 
    LD  A,030h                          ;5f4d  3e 30        15718  15737 
USG''': LD  IX,KEYBUF                   ;5f4f  dd 21 4f 7a  15719  15738 
    LD  (IX+0),A                        ;5f53  dd 77 00     15720  15739 
    LD  A,B                             ;5f56  78           15721  15740 
    OR  A                               ;5f57  b7           15722  15741 
    JR  Z,FRACUS                        ;5f58  28 1d        15723  15742 
    CP  17                              ;5f5a  fe 11        15724  15743 
    JR  C,STDGUS                        ;5f5c  38 0b        15725  15744 
STFLBL: INC IX                          ;5f5e  dd 23        15726  15745 
    LD  (IX+0),030h                     ;5f60  dd 36 00 30  15727  15746 
    DEC A                               ;5f64  3d           15728  15747 
    CP  16                              ;5f65  fe 10        15729  15748 
    JR  NZ,STFLBL                       ;5f67  20 f5        15730  15749 
STDGUS: INC A                           ;5f69  3c           15731  15750 
    CALL    CPSHIF                      ;5f6a  cd dd 5f     15732  15751 
    CALL    CMP                         ;5f6d  cd d6 61     15733  15752 
    JR  NC,FOVER                        ;5f70  30 34        15734  15753 
    LD  B,0                             ;5f72  06 00        15735  15754 
    CALL    GTESTB                      ;5f74  cd bb 5f     15736  15755 
FRACUS: CALL    ONECMP                  ;5f77  cd d3 61     15737  15756 
    JR  NC,FOVER                        ;5f7a  30 2a        15738  15757 
    LD  A,C                             ;5f7c  79           15739  15758 
    OR  A                               ;5f7d  b7           15740  15759 
    JR  Z,NOFRAC                        ;5f7e  28 2b        15741  15760 
    INC IX                              ;5f80  dd 23        15742  15761 
    LD  (IX+0),02Eh                     ;5f82  dd 36 00 2e  15743  15762 
    LD  B,C                             ;5f86  41           15744  15763 
AGINFR: PUSH    BC                      ;5f87  c5           15745  15764 
    PUSH    IX                          ;5f88  dd e5        15746  15765 
    LD  DE,FLMAX                        ;5f8a  11 18 62     15747  15766 
    CALL    CONDSF                      ;5f8d  cd ec 5f     15748  15767 
    CALL    MUL                         ;5f90  cd e0 6f     15749  15768 
    POP IX                              ;5f93  dd e1        15750  15769 
    POP BC                              ;5f95  c1           15751  15770 
    CALL    GNXDGT                      ;5f96  cd bd 5f     15752  15771 
    LD  A,B                             ;5f99  78           15753  15772 
    OR  A                               ;5f9a  b7           15754  15773 
    JR  NZ,AGINFR                       ;5f9b  20 ea        15755  15774 
OVERRD: CALL    FRCADM                  ;5f9d  cd bd 5e     15756  15775 
    LD  A,(KEYBUF)                      ;5fa0  3a 4f 7a     15757  15776 
    CP  031h                            ;5fa3  fe 31        15758  15777 
    RET C                               ;5fa5  d8           15759  15778 
FOVER:  LD  A,21                        ;5fa6  3e 15        15760  15779 
    JP  ERROR                           ;5fa8  c3 96 21     15761  15780 
                                        ;                   15762  15781 ;
NOFRAC: INC (HL)                        ;5fab  34           15763  15782 
    CALL    ONECMP                      ;5fac  cd d3 61     15764  15783 
    INC IX                              ;5faf  dd 23        15765  15784 
    PUSH    IX                          ;5fb1  dd e5        15766  15785 
    POP HL                              ;5fb3  e1           15767  15786 
    RET C                               ;5fb4  d8           15768  15787 
    LD  (IX+0),039h                     ;5fb5  dd 36 00 39  15769  15788 
    JR  OVERRD                          ;5fb9  18 e2        15770  15789 
                                        ;                   15771  15790 ;
GTESTB: DEC B                           ;5fbb  05           15772  15791 
    RET Z                               ;5fbc  c8           15773  15792 
GNXDGT: CALL    ADDDEG                  ;5fbd  cd 4a 5b     15774  15793 
MIDSGN: LD  A,(DE)                      ;5fc0  1a           15775  15794 
    CP  07Dh                            ;5fc1  fe 7d        15776  15795 
    RET Z                               ;5fc3  c8           15777  15796 
    INC IX                              ;5fc4  dd 23        15778  15797 
    LD  (IX+0),030h                     ;5fc6  dd 36 00 30  15779  15798 
INTGDL: CALL    CMP                     ;5fca  cd d6 61     15780  15799 
    JR  C,GTESTB                        ;5fcd  38 ec        15781  15800 
    INC (IX+0)                          ;5fcf  dd 34 00     15782  15801 
    PUSH    IX                          ;5fd2  dd e5        15783  15802 
    PUSH    BC                          ;5fd4  c5           15784  15803 
    CALL    SUB                         ;5fd5  cd d1 6b     15785  15804 
    POP BC                              ;5fd8  c1           15786  15805 
    POP IX                              ;5fd9  dd e1        15787  15806 
    JR  INTGDL                          ;5fdb  18 ed        15788  15807 
                                        ;                   15789  15808 ;
CPSHIF: ADD A,A                         ;5fdd  87           15790  15809 
    ADD A,A                             ;5fde  87           15791  15810 
    ADD A,A                             ;5fdf  87           15792  15811 
    LD  B,A                             ;5fe0  47           15793  15812 
    LD  DE,FLLAST                       ;5fe1  11 a0 62     15794  15813 
    LD  A,E                             ;5fe4  7b           15795  15814 
    SUB B                               ;5fe5  90           15796  15815 
    LD  E,A                             ;5fe6  5f           15797  15816 
    LD  A,D                             ;5fe7  7a           15798  15817 
    SBC A,0                             ;5fe8  de 00        15799  15818 
    LD  D,A                             ;5fea  57           15800  15819 
    RET                                 ;5feb  c9           15801  15820 
                                        ;                   15802  15821 ;
CONDSF: LD  A,(IY+0)                    ;5fec  fd 7e 00     15803  15822 
    CP  008h                            ;5fef  fe 08        15804  15823 
    RET Z                               ;5ff1  c8           15805  15824 
    PUSH    HL                          ;5ff2  e5           15806  15825 
    LD  HL,72                           ;5ff3  21 48 00     15807  15826 
    ADD HL,DE                           ;5ff6  19           15808  15827 
    EX  DE,HL                           ;5ff7  eb           15809  15828 
    POP HL                              ;5ff8  e1           15810  15829 
    RET                                 ;5ff9  c9           15811  15830 
                                        ;                   15812  15831 ;
CONDDG: LD  A,(IY+0)                    ;5ffa  fd 7e 00     15813  15832 
    LD  B,17                            ;5ffd  06 11        15814  15833 
    CP  008h                            ;5fff  fe 08        15815  15834 
    RET Z                               ;6001  c8           15816  15835 
    LD  B,7                             ;6002  06 07        15817  15836 
    RET                                 ;6004  c9           15818  15837 
                                        ;                   15819  15838 ;
INTZRR: LD  B,(IY+0)                    ;6005  fd 46 00     15820  15839 
    EX  DE,HL                           ;6008  eb           15821  15840 
    CALL    ZFILL                       ;6009  cd 10 62     15822  15841 
INTBCK: POP DE                          ;600c  d1           15823  15842 
    POP HL                              ;600d  e1           15824  15843 
    POP BC                              ;600e  c1           15825  15844 
    RET                                 ;600f  c9           15826  15845 
                                        ;                   15827  15846 ;
B_FIX:                                  ;                   15828  15847 
INT:    PUSH    BC                      ;6010  c5           15829  15848 
    PUSH    HL                          ;6011  e5           15830  15849 
    PUSH    DE                          ;6012  d5           15831  15850 
    LD  A,(HL)                          ;6013  7e           15832  15851 
    CP  081h                            ;6014  fe 81        15833  15852 
    JR  C,INTZRR                        ;6016  38 ed        15834  15853 
    BIT 3,(IY+0)                        ;6018  fd cb 00 5e  15835  15854 
    JR  NZ,INTDBL                       ;601c  20 24        15836  15855 
    CP  098h                            ;601e  fe 98        15837  15856 
    JR  NC,INTBCK                       ;6020  30 ea        15838  15857 
    INC HL                              ;6022  23           15839  15858 
    CALL    RCHLBC                      ;6023  cd 8e 60     15840  15859 
    DEC HL                              ;6026  2b           15841  15860 
    LD  B,0                             ;6027  06 00        15842  15861 
INTSFL: SRL E                           ;6029  cb 3b        15843  15862 
    RR  D                               ;602b  cb 1a        15844  15863 
    RR  C                               ;602d  cb 19        15845  15864 
    INC A                               ;602f  3c           15846  15865 
    INC B                               ;6030  04           15847  15866 
    CP  098h                            ;6031  fe 98        15848  15867 
    JR  NZ,INTSFL                       ;6033  20 f4        15849  15868 
INTSBL: SLA C                           ;6035  cb 21        15850  15869 
    RL  D                               ;6037  cb 12        15851  15870 
    RL  E                               ;6039  cb 13        15852  15871 
    DJNZ    INTSBL                      ;603b  10 f8        15853  15872 
INTBC': CALL    STHLBC                  ;603d  cd 88 60     15854  15873 
    JR  INTBCK                          ;6040  18 ca        15855  15874 
                                        ;                   15856  15875 ;
INTDBL: CP  0B8h                        ;6042  fe b8        15857  15876 
    JR  NC,INTBCK                       ;6044  30 c6        15858  15877 
    INC HL                              ;6046  23           15859  15878 
    CALL    RCHLBC                      ;6047  cd 8e 60     15860  15879 
    PUSH    HL                          ;604a  e5           15861  15880 
    EXX                                 ;604b  d9           15862  15881 
    POP HL                              ;604c  e1           15863  15882 
    CALL    RCHLBC                      ;604d  cd 8e 60     15864  15883 
    LD  B,(HL)                          ;6050  46           15865  15884 
    EXX                                 ;6051  d9           15866  15885 
    LD  B,000h                          ;6052  06 00        15867  15886 
INDSFL: SRL E                           ;6054  cb 3b        15868  15887 
    RR  D                               ;6056  cb 1a        15869  15888 
    RR  C                               ;6058  cb 19        15870  15889 
    EXX                                 ;605a  d9           15871  15890 
    RR  E                               ;605b  cb 1b        15872  15891 
    RR  D                               ;605d  cb 1a        15873  15892 
    RR  C                               ;605f  cb 19        15874  15893 
    RR  B                               ;6061  cb 18        15875  15894 
    EXX                                 ;6063  d9           15876  15895 
    INC B                               ;6064  04           15877  15896 
    INC A                               ;6065  3c           15878  15897 
    CP  0B8h                            ;6066  fe b8        15879  15898 
    JR  NZ,INDSFL                       ;6068  20 ea        15880  15899 
IDSFBL: EXX                             ;606a  d9           15881  15900 
    SLA B                               ;606b  cb 20        15882  15901 
    RL  C                               ;606d  cb 11        15883  15902 
    RL  D                               ;606f  cb 12        15884  15903 
    RL  E                               ;6071  cb 13        15885  15904 
    EXX                                 ;6073  d9           15886  15905 
    RL  C                               ;6074  cb 11        15887  15906 
    RL  D                               ;6076  cb 12        15888  15907 
    RL  E                               ;6078  cb 13        15889  15908 
    DJNZ    IDSFBL                      ;607a  10 ee        15890  15909 
    EXX                                 ;607c  d9           15891  15910 
    LD  (HL),B                          ;607d  70           15892  15911 
    DEC HL                              ;607e  2b           15893  15912 
MIDERF: CALL    STHLBC                  ;607f  cd 88 60     15894  15913 
    DEC HL                              ;6082  2b           15895  15914 
    PUSH    HL                          ;6083  e5           15896  15915 
    EXX                                 ;6084  d9           15897  15916 
    POP HL                              ;6085  e1           15898  15917 
    JR  INTBC'                          ;6086  18 b5        15899  15918 
                                        ;                   15900  15919 ;
STHLBC: LD  (HL),C                      ;6088  71           15901  15920 
    DEC HL                              ;6089  2b           15902  15921 
    LD  (HL),D                          ;608a  72           15903  15922 
    DEC HL                              ;608b  2b           15904  15923 
    LD  (HL),E                          ;608c  73           15905  15924 
    RET                                 ;608d  c9           15906  15925 
                                        ;                   15907  15926 ;
RCHLBC: LD  E,(HL)                      ;608e  5e           15908  15927 
    INC HL                              ;608f  23           15909  15928 
    LD  D,(HL)                          ;6090  56           15910  15929 
    INC HL                              ;6091  23           15911  15930 
    LD  C,(HL)                          ;6092  4e           15912  15931 
    INC HL                              ;6093  23           15913  15932 
    RET                                 ;6094  c9           15914  15933 
                                        ;                   15915  15934 ;
FRAC:   LD  A,(HL)                      ;6095  7e           15916  15935 
    OR  A                               ;6096  b7           15917  15936 
    RET Z                               ;6097  c8           15918  15937 
    INC HL                              ;6098  23           15919  15938 
    LD  A,(HL)                          ;6099  7e           15920  15939 
    SET 7,(HL)                          ;609a  cb fe        15921  15940 
    DEC HL                              ;609c  2b           15922  15941 
    PUSH    AF                          ;609d  f5           15923  15942 
    CALL    FRAC'                       ;609e  cd a7 60     15924  15943 
    POP AF                              ;60a1  f1           15925  15944 
    RLCA                                ;60a2  07           15926  15945 
    RET C                               ;60a3  d8           15927  15946 
    JP  RESNHL                          ;60a4  c3 c0 6b     15928  15947 
                                        ;                   15929  15948 ;
FRAC':  PUSH    BC                      ;60a7  c5           15930  15949 
    PUSH    HL                          ;60a8  e5           15931  15950 
    PUSH    DE                          ;60a9  d5           15932  15951 
    LD  A,(HL)                          ;60aa  7e           15933  15952 
    CP  081h                            ;60ab  fe 81        15934  15953 
    JP  C,INTBCK                        ;60ad  da 0c 60     15935  15954 
    BIT 3,(IY+0)                        ;60b0  fd cb 00 5e  15936  15955 
    JR  NZ,FRCDBL                       ;60b4  20 31        15937  15956 
    CP  098h                            ;60b6  fe 98        15938  15957 
    JP  NC,INTZRR                       ;60b8  d2 05 60     15939  15958 
    INC HL                              ;60bb  23           15940  15959 
    CALL    RCHLBC                      ;60bc  cd 8e 60     15941  15960 
    DEC HL                              ;60bf  2b           15942  15961 
FRCSBL: SLA C                           ;60c0  cb 21        15943  15962 
    RL  D                               ;60c2  cb 12        15944  15963 
    RL  E                               ;60c4  cb 13        15945  15964 
    DEC A                               ;60c6  3d           15946  15965 
    CP  080h                            ;60c7  fe 80        15947  15966 
    JR  NZ,FRCSBL                       ;60c9  20 f5        15948  15967 
    EX  AF,AF'                          ;60cb  08           15949  15968 
    LD  A,E                             ;60cc  7b           15950  15969 
    OR  D                               ;60cd  b2           15951  15970 
    OR  C                               ;60ce  b1           15952  15971 
    JR  Z,ENDSFR                        ;60cf  28 0e        15953  15972 
    EX  AF,AF'                          ;60d1  08           15954  15973 
FRCSB': BIT 7,E                         ;60d2  cb 7b        15955  15974 
    JR  NZ,ENDSFR                       ;60d4  20 09        15956  15975 
    SLA C                               ;60d6  cb 21        15957  15976 
    RL  D                               ;60d8  cb 12        15958  15977 
    RL  E                               ;60da  cb 13        15959  15978 
    DEC A                               ;60dc  3d           15960  15979 
    JR  FRCSB'                          ;60dd  18 f3        15961  15980 
                                        ;                   15962  15981 ;
ENDSFR: CALL    STHLBC                  ;60df  cd 88 60     15963  15982 
    DEC HL                              ;60e2  2b           15964  15983 
    LD  (HL),A                          ;60e3  77           15965  15984 
    JP  INTBCK                          ;60e4  c3 0c 60     15966  15985 
                                        ;                   15967  15986 ;
FRCDBL: CP  0B8h                        ;60e7  fe b8        15968  15987 
    JP  NC,INTZRR                       ;60e9  d2 05 60     15969  15988 
    INC HL                              ;60ec  23           15970  15989 
    CALL    RCHLBC                      ;60ed  cd 8e 60     15971  15990 
    PUSH    HL                          ;60f0  e5           15972  15991 
    EXX                                 ;60f1  d9           15973  15992 
    POP HL                              ;60f2  e1           15974  15993 
    CALL    RCHLBC                      ;60f3  cd 8e 60     15975  15994 
    LD  B,(HL)                          ;60f6  46           15976  15995 
IDFRBL: SLA B                           ;60f7  cb 20        15977  15996 
    RL  C                               ;60f9  cb 11        15978  15997 
    RL  D                               ;60fb  cb 12        15979  15998 
    RL  E                               ;60fd  cb 13        15980  15999 
    EXX                                 ;60ff  d9           15981  16000 
    RL  C                               ;6100  cb 11        15982  16001 
    RL  D                               ;6102  cb 12        15983  16002 
    RL  E                               ;6104  cb 13        15984  16003 
    EXX                                 ;6106  d9           15985  16004 
    DEC A                               ;6107  3d           15986  16005 
    CP  080h                            ;6108  fe 80        15987  16006 
    JR  NZ,IDFRBL                       ;610a  20 eb        15988  16007 
    EX  AF,AF'                          ;610c  08           15989  16008 
    LD  A,B                             ;610d  78           15990  16009 
    OR  C                               ;610e  b1           15991  16010 
    OR  D                               ;610f  b2           15992  16011 
    OR  E                               ;6110  b3           15993  16012 
    EXX                                 ;6111  d9           15994  16013 
    OR  C                               ;6112  b1           15995  16014 
    OR  D                               ;6113  b2           15996  16015 
    OR  E                               ;6114  b3           15997  16016 
    EXX                                 ;6115  d9           15998  16017 
    JR  Z,ESCDFS                        ;6116  28 19        15999  16018 
    EX  AF,AF'                          ;6118  08           16000  16019 
    EXX                                 ;6119  d9           16001  16020 
DSFL1': BIT 7,E                         ;611a  cb 7b        16002  16021 
    EXX                                 ;611c  d9           16003  16022 
    JR  NZ,ESCDFS                       ;611d  20 12        16004  16023 
    SLA B                               ;611f  cb 20        16005  16024 
    RL  C                               ;6121  cb 11        16006  16025 
    RL  D                               ;6123  cb 12        16007  16026 
    RL  E                               ;6125  cb 13        16008  16027 
    EXX                                 ;6127  d9           16009  16028 
    RL  C                               ;6128  cb 11        16010  16029 
    RL  D                               ;612a  cb 12        16011  16030 
    RL  E                               ;612c  cb 13        16012  16031 
    DEC A                               ;612e  3d           16013  16032 
    JR  DSFL1'                          ;612f  18 e9        16014  16033 
ESCDFS: LD  (HL),B                      ;6131  70           16015  16034 
    DEC HL                              ;6132  2b           16016  16035 
    CALL    STHLBC                      ;6133  cd 88 60     16017  16036 
    DEC HL                              ;6136  2b           16018  16037 
    PUSH    HL                          ;6137  e5           16019  16038 
    EXX                                 ;6138  d9           16020  16039 
    POP HL                              ;6139  e1           16021  16040 
    CALL    STHLBC                      ;613a  cd 88 60     16022  16041 
    DEC HL                              ;613d  2b           16023  16042 
    LD  (HL),A                          ;613e  77           16024  16043 
    JP  INTBCK                          ;613f  c3 0c 60     16025  16044 
                                        ;                   16026  16045 ;
MULTEN: PUSH    AF                      ;6142  f5           16027  16046 
    PUSH    BC                          ;6143  c5           16028  16047 
    PUSH    DE                          ;6144  d5           16029  16048 
    LD  DE,FLTEN                        ;6145  11 90 62     16030  16049 
    CALL    MUL                         ;6148  cd e0 6f     16031  16050 
    POP DE                              ;614b  d1           16032  16051 
    POP BC                              ;614c  c1           16033  16052 
    POP AF                              ;614d  f1           16034  16053 
    RET                                 ;614e  c9           16035  16054 
                                        ;                   16036  16055 ;
MOD:    PUSH    HL                      ;614f  e5           16037  16056 
    PUSH    DE                          ;6150  d5           16038  16057 
    CALL    DIV                         ;6151  cd bd 70     16039  16058 
    CALL    FRAC                        ;6154  cd 95 60     16040  16059 
    CALL    MUL                         ;6157  cd e0 6f     16041  16060 
    POP DE                              ;615a  d1           16042  16061 
    POP HL                              ;615b  e1           16043  16062 
    RET                                 ;615c  c9           16044  16063 
                                        ;                   16045  16064 
HEXFLT: LD  A,(HL)                      ;615d  7e           16046  16065 
    CP  091h                            ;615e  fe 91        16047  16066 
    JR  C,HLFLT                         ;6160  38 05        16048  16067 
HXZRRT: CCF                             ;6162  3f           16049  16068 
    LD  HL,00000h                       ;6163  21 00 00     16050  16069 
    RET                                 ;6166  c9           16051  16070 
                                        ;                   16052  16071 ;
DLTEN:                                  ;                   16053  16072 
HLFLT:  INC HL                          ;6167  23           16054  16073 
    BIT 7,(HL)                          ;6168  cb 7e        16055  16074 
    JR  Z,NORHLC                        ;616a  28 0b        16056  16075 
    CALL    NORHLC                      ;616c  cd 77 61     16057  16076 
    LD  A,H                             ;616f  7c           16058  16077 
    CPL                                 ;6170  2f           16059  16078 
    LD  H,A                             ;6171  67           16060  16079 
    LD  A,L                             ;6172  7d           16061  16080 
    CPL                                 ;6173  2f           16062  16081 
    LD  L,A                             ;6174  6f           16063  16082 
    INC HL                              ;6175  23           16064  16083 
    RET                                 ;6176  c9           16065  16084 
                                        ;                   16066  16085 ;
NORHLC: DEC HL                          ;6177  2b           16067  16086 
    LD  A,(HL)                          ;6178  7e           16068  16087 
    CP  091h                            ;6179  fe 91        16069  16088 
    JP  NC,OVERFL1                      ;617b  d2 e4 6e     16070  16089 
TSTRNG: CP  081h                        ;617e  fe 81        16071  16090 
    JR  C,HXZRRT                        ;6180  38 e0        16072  16091 
    PUSH    AF                          ;6182  f5           16073  16092 
    INC HL                              ;6183  23           16074  16093 
    LD  A,(HL)                          ;6184  7e           16075  16094 
    INC HL                              ;6185  23           16076  16095 
    LD  L,(HL)                          ;6186  6e           16077  16096 
    LD  H,A                             ;6187  67           16078  16097 
    POP AF                              ;6188  f1           16079  16098 
    SET 7,H                             ;6189  cb fc        16080  16099 
HXFLSL: CP  090h                        ;618b  fe 90        16081  16100 
    RET Z                               ;618d  c8           16082  16101 
    INC A                               ;618e  3c           16083  16102 
    SRL H                               ;618f  cb 3c        16084  16103 
    RR  L                               ;6191  cb 1d        16085  16104 
    JR  HXFLSL                          ;6193  18 f6        16086  16105 
                                        ;                   16087  16106 ;
STRCMP: LD  (IY+0),4                    ;6195  fd 36 00 04  16088  16107 
    CALL    CONDMZ                      ;6199  cd f6 6b     16089  16108 
    EX  DE,HL                           ;619c  eb           16090  16109 
    CALL    CONDMZ                      ;619d  cd f6 6b     16091  16110 
    EX  DE,HL                           ;61a0  eb           16092  16111 
    LD  E,(HL)                          ;61a1  5e           16093  16112 
    INC HL                              ;61a2  23           16094  16113 
    LD  D,(HL)                          ;61a3  56           16095  16114 
    POP HL                              ;61a4  e1           16096  16115 
    PUSH    HL                          ;61a5  e5           16097  16116 
    LD  A,(HL)                          ;61a6  7e           16098  16117 
    INC HL                              ;61a7  23           16099  16118 
    LD  H,(HL)                          ;61a8  66           16100  16119 
    LD  L,A                             ;61a9  6f           16101  16120 
    EX  DE,HL                           ;61aa  eb           16102  16121 
    PUSH    HL                          ;61ab  e5           16103  16122 
    PUSH    DE                          ;61ac  d5           16104  16123 
    LD  A,(DE)                          ;61ad  1a           16105  16124 
    CP  (HL)                            ;61ae  be           16106  16125 
    JR  C,NOIV0                         ;61af  38 01        16107  16126 
    LD  A,(HL)                          ;61b1  7e           16108  16127 
NOIV0:  LD  B,A                         ;61b2  47           16109  16128 
    OR  A                               ;61b3  b7           16110  16129 
    JR  Z,SCMPLN                        ;61b4  28 13        16111  16130 
    INC HL                              ;61b6  23           16112  16131 
    INC DE                              ;61b7  13           16113  16132 
    PUSH    DE                          ;61b8  d5           16114  16133 
    LD  E,(HL)                          ;61b9  5e           16115  16134 
    INC HL                              ;61ba  23           16116  16135 
    LD  D,(HL)                          ;61bb  56           16117  16136 
    POP HL                              ;61bc  e1           16118  16137 
    LD  A,(HL)                          ;61bd  7e           16119  16138 
    INC HL                              ;61be  23           16120  16139 
    LD  H,(HL)                          ;61bf  66           16121  16140 
    LD  L,A                             ;61c0  6f           16122  16141 
SCMPLP: LD  A,(DE)                      ;61c1  1a           16123  16142 
    CP  (HL)                            ;61c2  be           16124  16143 
    INC HL                              ;61c3  23           16125  16144 
    INC DE                              ;61c4  13           16126  16145 
    JR  NZ,PCMPRT                       ;61c5  20 08        16127  16146 
    DJNZ    SCMPLP                      ;61c7  10 f8        16128  16147 
SCMPLN: POP HL                          ;61c9  e1           16129  16148 
    POP DE                              ;61ca  d1           16130  16149 
    LD  A,(DE)                          ;61cb  1a           16131  16150 
    CP  (HL)                            ;61cc  be           16132  16151 
    JR  CMPRET                          ;61cd  18 2b        16133  16152 
                                        ;                   16134  16153 ;
PCMPRT: POP HL                          ;61cf  e1           16135  16154 
    POP DE                              ;61d0  d1           16136  16155 
    JR  CMPRET                          ;61d1  18 27        16137  16156 
                                        ;                   16138  16157 ;
ONECMP: LD  DE,FLONE                    ;61d3  11 98 62     16139  16158 
CMP:    PUSH    BC                      ;61d6  c5           16140  16159 
    PUSH    HL                          ;61d7  e5           16141  16160 
    PUSH    DE                          ;61d8  d5           16142  16161 
    LD  A,(IY+0)                        ;61d9  fd 7e 00     16143  16162 
    CP  003h                            ;61dc  fe 03        16144  16163 
    JR  Z,STRCMP                        ;61de  28 b5        16145  16164 
    INC HL                              ;61e0  23           16146  16165 
    INC DE                              ;61e1  13           16147  16166 
    BIT 7,(HL)                          ;61e2  cb 7e        16148  16167 
    JR  NZ,HMISN                        ;61e4  20 18        16149  16168 
TSTCMP2:                                ;                   16150  16169 
    LD  A,(DE)                          ;61e6  1a           16151  16170 
    RLCA                                ;61e7  07           16152  16171 
    JR  C,CMPR''                        ;61e8  38 22        16153  16172 
    DEC HL                              ;61ea  2b           16154  16173 
    DEC DE                              ;61eb  1b           16155  16174 
TSTCMP: LD  C,0                         ;61ec  0e 00        16156  16175 
    LD  B,(IY+0)                        ;61ee  fd 46 00     16157  16176 
    EX  DE,HL                           ;61f1  eb           16158  16177 
DCMPLO: LD  A,(DE)                      ;61f2  1a           16159  16178 
    CP  (HL)                            ;61f3  be           16160  16179 
    JR  NZ,CMPRET                       ;61f4  20 04        16161  16180 
    INC HL                              ;61f6  23           16162  16181 
    INC DE                              ;61f7  13           16163  16182 
    DJNZ    DCMPLO                      ;61f8  10 f8        16164  16183 
CMPRET: POP DE                          ;61fa  d1           16165  16184 
    POP HL                              ;61fb  e1           16166  16185 
    POP BC                              ;61fc  c1           16167  16186 
    RET                                 ;61fd  c9           16168  16187 
                                        ;                   16169  16188 ;
HMISN:  LD  A,(DE)                      ;61fe  1a           16170  16189 
    RLCA                                ;61ff  07           16171  16190 
    JR  NC,CMPRE'                       ;6200  30 05        16172  16191 
    DEC HL                              ;6202  2b           16173  16192 
    DEC DE                              ;6203  1b           16174  16193 
    EX  DE,HL                           ;6204  eb           16175  16194 
    JR  TSTCMP                          ;6205  18 e5        16176  16195 
                                        ;                   16177  16196 ;
CMPRE': XOR A                           ;6207  af           16178  16197 
    INC A                               ;6208  3c           16179  16198 
    SCF                                 ;6209  37           16180  16199 
    JR  CMPRET                          ;620a  18 ee        16181  16200 
                                        ;                   16182  16201 ;
CMPR'': XOR A                           ;620c  af           16183  16202 
    INC A                               ;620d  3c           16184  16203 
    JR  CMPRET                          ;620e  18 ea        16185  16204 
                                        ;                   16186  16205 ;
ZFILL:  XOR A                           ;6210  af           16187  16206 
FILL:   PUSH    DE                      ;6211  d5           16188  16207 
FILLOP: LD  (DE),A                      ;6212  12           16189  16208 
    INC DE                              ;6213  13           16190  16209 
    DJNZ    FILLOP                      ;6214  10 fc        16191  16210 
    POP DE                              ;6216  d1           16192  16211 
    RET                                 ;6217  c9           16193  16212 
                                        ;                   16194  16213 ;
FLMAX:  DEFB    0B6H                    ;6218  b6           16195  16214 
    DEFB    00EH                        ;6219  0e           16196  16215 
    DEFB    01BH                        ;621a  1b           16197  16216 
    DEFB    0C9H                        ;621b  c9           16198  16217 
    DEFB    0BFH                        ;621c  bf           16199  16218 
    DEFB    004H                        ;621d  04           16200  16219 
    DEFB    000H                        ;621e  00           16201  16220 
    DEFB    000H                        ;621f  00           16202  16221 
                                        ;                   16203  16222 ;
CONTBL: DEFB    0B2H                    ;6220  b2           16204  16223 
    DEFB    063H                        ;6221  63           16205  16224 
    DEFB    05FH                        ;6222  5f           16206  16225 
    DEFB    0A9H                        ;6223  a9           16207  16226 
    DEFB    031H                        ;6224  31           16208  16227 
    DEFB    0A0H                        ;6225  a0           16209  16228 
    DEFB    000H                        ;6226  00           16210  16229 
    DEFB    000H                        ;6227  00           16211  16230 
                                        ;                   16212  16231 ;
    DEFB    0AFH                        ;6228  af           16213  16232 
    DEFB    035H                        ;6229  35           16214  16233 
    DEFB    0E6H                        ;622a  e6           16215  16234 
    DEFB    020H                        ;622b  20           16216  16235 
    DEFB    0F4H                        ;622c  f4           16217  16236 
    DEFB    080H                        ;622d  80           16218  16237 
    DEFB    000H                        ;622e  00           16219  16238 
    DEFB    000H                        ;622f  00           16220  16239 
                                        ;                   16221  16240 ;
    DEFB    0ACH                        ;6230  ac           16222  16241 
    DEFB    011H                        ;6231  11           16223  16242 
    DEFB    084H                        ;6232  84           16224  16243 
    DEFB    0E7H                        ;6233  e7           16225  16244 
    DEFB    02AH                        ;6234  2a           16226  16245 
    DEFB    000H                        ;6235  00           16227  16246 
    DEFB    000H                        ;6236  00           16228  16247 
    DEFB    000H                        ;6237  00           16229  16248 
                                        ;                   16230  16249 ;
    DEFB    0A8H                        ;6238  a8           16231  16250 
    DEFB    068H                        ;6239  68           16232  16251 
    DEFB    0D4H                        ;623a  d4           16233  16252 
    DEFB    0A5H                        ;623b  a5           16234  16253 
    DEFB    010H                        ;623c  10           16235  16254 
    DEFB    000H                        ;623d  00           16236  16255 
    DEFB    000H                        ;623e  00           16237  16256 
    DEFB    000H                        ;623f  00           16238  16257 
                                        ;                   16239  16258 ;
    DEFB    0A5H                        ;6240  a5           16240  16259 
    DEFB    03AH                        ;6241  3a           16241  16260 
    DEFB    043H                        ;6242  43           16242  16261 
    DEFB    0B7H                        ;6243  b7           16243  16262 
    DEFB    040H                        ;6244  40           16244  16263 
    DEFB    000H                        ;6245  00           16245  16264 
    DEFB    000H                        ;6246  00           16246  16265 
    DEFB    000H                        ;6247  00           16247  16266 
                                        ;                   16248  16267 ;
    DEFB    0A2H                        ;6248  a2           16249  16268 
    DEFB    015H                        ;6249  15           16250  16269 
    DEFB    002H                        ;624a  02           16251  16270 
    DEFB    0F9H                        ;624b  f9           16252  16271 
    DEFB    000H                        ;624c  00           16253  16272 
    DEFB    000H                        ;624d  00           16254  16273 
    DEFB    000H                        ;624e  00           16255  16274 
    DEFB    000H                        ;624f  00           16256  16275 
                                        ;                   16257  16276 ;
    DEFB    09EH                        ;6250  9e           16258  16277 
    DEFB    06EH                        ;6251  6e           16259  16278 
    DEFB    06BH                        ;6252  6b           16260  16279 
    DEFB    028H                        ;6253  28           16261  16280 
    DEFB    000H                        ;6254  00           16262  16281 
    DEFB    000H                        ;6255  00           16263  16282 
    DEFB    000H                        ;6256  00           16264  16283 
    DEFB    000H                        ;6257  00           16265  16284 
                                        ;                   16266  16285 ;
    DEFB    09BH                        ;6258  9b           16267  16286 
    DEFB    03EH                        ;6259  3e           16268  16287 
    DEFB    0BCH                        ;625a  bc           16269  16288 
    DEFB    020H                        ;625b  20           16270  16289 
    DEFB    000H                        ;625c  00           16271  16290 
    DEFB    000H                        ;625d  00           16272  16291 
    DEFB    000H                        ;625e  00           16273  16292 
    DEFB    000H                        ;625f  00           16274  16293 
                                        ;                   16275  16294 ;
    DEFB    098H                        ;6260  98           16276  16295 
    DEFB    018H                        ;6261  18           16277  16296 
    DEFB    096H                        ;6262  96           16278  16297 
    DEFB    080H                        ;6263  80           16279  16298 
    DEFB    000H                        ;6264  00           16280  16299 
    DEFB    000H                        ;6265  00           16281  16300 
    DEFB    000H                        ;6266  00           16282  16301 
    DEFB    000H                        ;6267  00           16283  16302 
                                        ;                   16284  16303 ;
SNGMXO: DEFB    094H                    ;6268  94           16285  16304 
    DEFB    074H                        ;6269  74           16286  16305 
    DEFB    024H                        ;626a  24           16287  16306 
    DEFB    000H                        ;626b  00           16288  16307 
    DEFB    000H                        ;626c  00           16289  16308 
    DEFB    000H                        ;626d  00           16290  16309 
    DEFB    000H                        ;626e  00           16291  16310 
    DEFB    000H                        ;626f  00           16292  16311 
                                        ;                   16293  16312 ;
    DEFB    091H                        ;6270  91           16294  16313 
    DEFB    043H                        ;6271  43           16295  16314 
    DEFB    050H                        ;6272  50           16296  16315 
    DEFB    000H                        ;6273  00           16297  16316 
    DEFB    000H                        ;6274  00           16298  16317 
    DEFB    000H                        ;6275  00           16299  16318 
    DEFB    000H                        ;6276  00           16300  16319 
    DEFB    000H                        ;6277  00           16301  16320 
                                        ;                   16302  16321 ;
    DEFB    08EH                        ;6278  8e           16303  16322 
    DEFB    01CH                        ;6279  1c           16304  16323 
    DEFB    040H                        ;627a  40           16305  16324 
    DEFB    000H                        ;627b  00           16306  16325 
    DEFB    000H                        ;627c  00           16307  16326 
    DEFB    000H                        ;627d  00           16308  16327 
    DEFB    000H                        ;627e  00           16309  16328 
    DEFB    000H                        ;627f  00           16310  16329 
                                        ;                   16311  16330 ;
    DEFB    08AH                        ;6280  8a           16312  16331 
    DEFB    07AH                        ;6281  7a           16313  16332 
    DEFB    000H                        ;6282  00           16314  16333 
    DEFB    000H                        ;6283  00           16315  16334 
    DEFB    000H                        ;6284  00           16316  16335 
    DEFB    000H                        ;6285  00           16317  16336 
    DEFB    000H                        ;6286  00           16318  16337 
    DEFB    000H                        ;6287  00           16319  16338 
                                        ;                   16320  16339 ;
    DEFB    087H                        ;6288  87           16321  16340 
    DEFB    048H                        ;6289  48           16322  16341 
    DEFB    000H                        ;628a  00           16323  16342 
    DEFB    000H                        ;628b  00           16324  16343 
    DEFB    000H                        ;628c  00           16325  16344 
    DEFB    000H                        ;628d  00           16326  16345 
    DEFB    000H                        ;628e  00           16327  16346 
    DEFB    000H                        ;628f  00           16328  16347 
                                        ;                   16329  16348 ;
FLTEN:                                  ;                   16330  16349 
    DEFB    084H                        ;6290  84           16331  16350 
    DEFB    020H                        ;6291  20           16332  16351 
    DEFB    000H                        ;6292  00           16333  16352 
    DEFB    000H                        ;6293  00           16334  16353 
    DEFB    000H                        ;6294  00           16335  16354 
    DEFB    000H                        ;6295  00           16336  16355 
    DEFB    000H                        ;6296  00           16337  16356 
    DEFB    000H                        ;6297  00           16338  16357 
FLONE:                                  ;                   16339  16358 
    DEFB    081H                        ;6298  81           16340  16359 
    DEFB    000H                        ;6299  00           16341  16360 
    DEFB    000H                        ;629a  00           16342  16361 
    DEFB    000H                        ;629b  00           16343  16362 
    DEFB    000H                        ;629c  00           16344  16363 
    DEFB    000H                        ;629d  00           16345  16364 
    DEFB    000H                        ;629e  00           16346  16365 
    DEFB    000H                        ;629f  00           16347  16366 
FLLAST:                                 ;                   16348  16367 
    DEFB    07DH                        ;62a0  7d           16349  16368 
    DEFB    04CH                        ;62a1  4c           16350  16369 
    DEFB    0CCH                        ;62a2  cc           16351  16370 
    DEFB    0CCH                        ;62a3  cc           16352  16371 
    DEFB    0CCH                        ;62a4  cc           16353  16372 
    DEFB    0CCH                        ;62a5  cc           16354  16373 
    DEFB    0CCH                        ;62a6  cc           16355  16374 
    DEFB    0CDH                        ;62a7  cd           16356  16375 
ASCHL:                                  ;                   16357  16376 
    PUSH    HL                          ;62a8  e5           16358  16377 
    PUSH    DE                          ;62a9  d5           16359  16378 
    PUSH    BC                          ;62aa  c5           16360  16379 
    LD  C,0H                            ;62ab  0e 00        16361  16380 
    PUSH    DE                          ;62ad  d5           16362  16381 
    LD  B,0                             ;62ae  06 00        16363  16382 
    LD  DE,02710H                       ;62b0  11 10 27     16364  16383 
    CALL    CONV1                       ;62b3  cd d1 62     16365  16384 
    LD  DE,003E8H                       ;62b6  11 e8 03     16366  16385 
    CALL    CONV1                       ;62b9  cd d1 62     16367  16386 
    LD  DE,00064H                       ;62bc  11 64 00     16368  16387 
    CALL    CONV1                       ;62bf  cd d1 62     16369  16388 
    LD  DE,0000AH                       ;62c2  11 0a 00     16370  16389 
    CALL    CONV1                       ;62c5  cd d1 62     16371  16390 
    LD  A,L                             ;62c8  7d           16372  16391 
    POP DE                              ;62c9  d1           16373  16392 
    OR  030H                            ;62ca  f6 30        16374  16393 
    LD  (DE),A                          ;62cc  12           16375  16394 
    POP BC                              ;62cd  c1           16376  16395 
    POP DE                              ;62ce  d1           16377  16396 
    POP HL                              ;62cf  e1           16378  16397 
    RET                                 ;62d0  c9           16379  16398 
                                        ;                   16380  16399 ;
CONV1:  LD  A,0FFH                      ;62d1  3e ff        16381  16400 
CONV2:  INC A                           ;62d3  3c           16382  16401 
    OR  A                               ;62d4  b7           16383  16402 
    SBC HL,DE                           ;62d5  ed 52        16384  16403 
    JR  NC,CONV2                        ;62d7  30 fa        16385  16404 
    ADD HL,DE                           ;62d9  19           16386  16405 
    OR  A                               ;62da  b7           16387  16406 
    INC B                               ;62db  04           16388  16407 
    DEFB    0F6H                        ;62dc  f6           16389  16408 ;OR ?
    DEFB    030H                        ;62dd  30           16390  16409 
    POP DE                              ;62de  d1           16391  16410 
    EX  (SP),HL                         ;62df  e3           16392  16411 
    LD  (HL),A                          ;62e0  77           16393  16412 
    INC HL                              ;62e1  23           16394  16413 
    EX  (SP),HL                         ;62e2  e3           16395  16414 
    PUSH    DE                          ;62e3  d5           16396  16415 
    INC C                               ;62e4  0c           16397  16416 
    RET                                 ;62e5  c9           16398  16417 
                                        ;                   16399  16418 ;
DHLMT:                                  ;                   16400  16419 
    DEFB    0B6H                        ;62e6  b6           16401  16420 
    DEFB    00EH                        ;62e7  0e           16402  16421 
    DEFB    01BH                        ;62e8  1b           16403  16422 
    DEFB    0C9H                        ;62e9  c9           16404  16423 
    DEFB    0BFH                        ;62ea  bf           16405  16424 
    DEFB    003H                        ;62eb  03           16406  16425 
    DEFB    0FFH                        ;62ec  ff           16407  16426 
    DEFB    0FEH                        ;62ed  fe           16408  16427 
                                        ;                   16409  16428 ;
SHLMT:                                  ;                   16410  16429 
    DEFB    094H                        ;62ee  94           16411  16430 
    DEFB    074H                        ;62ef  74           16412  16431 
    DEFB    023H                        ;62f0  23           16413  16432 
    DEFB    0F8H                        ;62f1  f8           16414  16433 
ZFAC:                                   ;                   16415  16434 
    DEFS    8                           ;62f2               16416  16435 
ZFAC1:  DEFS    8                       ;62fa               16417  16436 
    DEFS    2                           ;6302               16418  16437 
DGBUF:  DEFS    18                      ;6304               16419  16438 
    DEFS    5                           ;6316               16420  16439 
                                        ;                   16421  16440 
                                        ;                   16422  16441 ;	ORG	0631Bh
                                        ;                   16423  16442 
$EDIT:                                  ;                   16424  16443 
SMALL:  LD  A,(DE)                      ;631b  1a           16425  16444 
SMALL': CP  061h                        ;631c  fe 61        16426  16445 
    RET C                               ;631e  d8           16427  16446 
    CP  07Bh                            ;631f  fe 7b        16428  16447 
    RET NC                              ;6321  d0           16429  16448 
    SUB 020h                            ;6322  d6 20        16430  16449 
    RET                                 ;6324  c9           16431  16450 
                                        ;                   16432  16451 ;
CVIMTX:                                 ;                   16433  16452 
    PUSH    BC                          ;6325  c5           16434  16453 
    PUSH    DE                          ;6326  d5           16435  16454 
CPILLP: CALL    SPSTRE                  ;6327  cd ad 64     16436  16455 
    OR  A                               ;632a  b7           16437  16456 
    JR  Z,TREND                         ;632b  28 2f        16438  16457 
    INC DE                              ;632d  13           16439  16458 
    CP  080h                            ;632e  fe 80        16440  16459 ;80H 이상은 BASIC에 무시
    JR  NC,CPILLP                       ;6330  30 f5        16441  16460 
    CP  020h                            ;6332  fe 20        16442  16461 ;20H 이하도 무시
    JR  C,CPILLP                        ;6334  38 f1        16443  16462 
    DEC DE                              ;6336  1b           16444  16463 
    CP  03Fh                            ;6337  fe 3f        16445  16464 
    JR  Z,PRTCDE                        ;6339  28 1a        16446  16465 
    CP  022h                            ;633b  fe 22        16447  16466 
    JR  Z,STRING1                       ;633d  28 21        16448  16467 
    CP  027h                            ;633f  fe 27        16449  16468 
    JR  Z,REMOPR                        ;6341  28 24        16450  16469 
    CP  02Eh                            ;6343  fe 2e        16451  16470 
    JR  Z,NUMJMP                        ;6345  28 09        16452  16471 
    CP  026h                            ;6347  fe 26        16453  16472 
    JR  Z,NUMJMP                        ;6349  28 05        16454  16473 
    CALL    TSTNAC                      ;634b  cd 2e 65     16455  16474 
    JR  C,STATE                         ;634e  38 45        16456  16475 
NUMJMP: CALL    NUMBER                  ;6350  cd b6 64     16457  16476 
    JR  CPILLP                          ;6353  18 d2        16458  16477 
PRTCDE: LD  (HL),08Ch                   ;6355  36 8c        16459  16478 
BACKLP: INC HL                          ;6357  23           16460  16479 
    INC DE                              ;6358  13           16461  16480 
    JR  CPILLP                          ;6359  18 cc        16462  16481 
TREND': EX  DE,HL                       ;635b  eb           16463  16482 
TREND:  LD  (HL),A                      ;635c  77           16464  16483 
    POP DE                              ;635d  d1           16465  16484 
    POP BC                              ;635e  c1           16466  16485 
    RET                                 ;635f  c9           16467  16486 
                                        ;                   16468  16487 ;
STRING1: CALL   DQTSTR                  ;6360  cd 9d 64     16469  16488 
    JR  Z,TREND                         ;6363  28 f7        16470  16489 
    JR  CPILLP                          ;6365  18 c0        16471  16490 
                                        ;                   16472  16491 ;
REMOPR: LD  (HL),03Ah                   ;6367  36 3a        16473  16492 
    INC HL                              ;6369  23           16474  16493 
RMTRLP: LD  (HL),A                      ;636a  77           16475  16494 
    INC DE                              ;636b  13           16476  16495 
    INC HL                              ;636c  23           16477  16496 
RMTRMD: LD  A,(DE)                      ;636d  1a           16478  16497 
    OR  A                               ;636e  b7           16479  16498 
    JR  NZ,RMTRLP                       ;636f  20 f9        16480  16499 
BACK:   JP  CPILLP                      ;6371  c3 27 63     16481  16500 
STORE': INC HL                          ;6374  23           16482  16501 
STORE:  CALL    SMALL                   ;6375  cd 1b 63     16483  16502 
    LD  (HL),A                          ;6378  77           16484  16503 
    INC DE                              ;6379  13           16485  16504 
    CP  041h                            ;637a  fe 41        16486  16505 ;대문자 체크
    JR  C,BACK1                         ;637c  38 14        16487  16506 
    CP  05Bh                            ;637e  fe 5b        16488  16507 
    JR  NC,BACK1                        ;6380  30 10        16489  16508 
NOSLOP: CALL    SMALL                   ;6382  cd 1b 63     16490  16509 
    CP  030h                            ;6385  fe 30        16491  16510 ;숫자 체크
    JR  C,BACK1                         ;6387  38 09        16492  16511 
    CP  03Ah                            ;6389  fe 3a        16493  16512 
    JR  NC,BACK1                        ;638b  30 05        16494  16513 
    INC HL                              ;638d  23           16495  16514 
    LD  (HL),A                          ;638e  77           16496  16515 
    INC DE                              ;638f  13           16497  16516 
    JR  NOSLOP                          ;6390  18 f0        16498  16517 
BACK1:  INC HL                          ;6392  23           16499  16518 
    JR  BACK                            ;6393  18 dc        16500  16519 
                                        ;                   16501  16520 ;
STATE:  LD  BC,CTBL1                    ;6395  01 37 67     16502  16521 ;예약어가 저장된 곳
    CALL    MATCH                       ;6398  cd 61 64     16503  16522 
    JR  NC,GETHX                        ;639b  30 21        16504  16523 
    LD  BC,CTBL2                        ;639d  01 d3 68     16505  16524 
    CALL    MATCH                       ;63a0  cd 61 64     16506  16525 
    JR  C,STORE                         ;63a3  38 d0        16507  16526 
    DEC HL                              ;63a5  2b           16508  16527 
    LD  A,(HL)                          ;63a6  7e           16509  16528 
    LD  (HL),0FFh                       ;63a7  36 ff        16510  16529 
    INC HL                              ;63a9  23           16511  16530 
    LD  (HL),A                          ;63aa  77           16512  16531 
    CP  0C0h                            ;63ab  fe c0        16513  16532 
    JR  NZ,BACK1                        ;63ad  20 e3        16514  16533 
    INC HL                              ;63af  23           16515  16534 
    CALL    SPSTRE                      ;63b0  cd ad 64     16516  16535 
    CP  03Dh                            ;63b3  fe 3d        16517  16536 
    JP  NZ,BACK                         ;63b5  c2 71 63     16518  16537 
    LD  (HL),0F5h                       ;63b8  36 f5        16519  16538 
    INC HL                              ;63ba  23           16520  16539 
    INC DE                              ;63bb  13           16521  16540 
    JR  LNOSLP1                         ;63bc  18 25        16522  16541 
                                        ;                   16523  16542 ;
GETHX:  LD  A,B                         ;63be  78           16524  16543 
    CP  092h                            ;63bf  fe 92        16525  16544 
    JR  Z,RMTRMD                        ;63c1  28 aa        16526  16545 
    CP  08Fh                            ;63c3  fe 8f        16527  16546 
    JP  Z,DATAST1                       ;63c5  ca 3c 64     16528  16547 
    CP  0B8h                            ;63c8  fe b8        16529  16548 
    JR  Z,ELSEST                        ;63ca  28 68        16530  16549 
    CP  0E1h                            ;63cc  fe e1        16531  16550 
    JR  Z,LNOSLP1                       ;63ce  28 13        16532  16551 
    CP  0B6h                            ;63d0  fe b6        16533  16552 
    JR  Z,LNOSLP1                       ;63d2  28 0f        16534  16553 
    CP  093h                            ;63d4  fe 93        16535  16554 
    JR  Z,LISTER                        ;63d6  28 3a        16536  16555 
    CP  08Ah                            ;63d8  fe 8a        16537  16556 
    JP  NC,BACK                         ;63da  d2 71 63     16538  16557 
    CP  086h                            ;63dd  fe 86        16539  16558 
    JR  Z,LSIT#?                        ;63df  28 74        16540  16559 
    JR  NC,LISTER                       ;63e1  30 2f        16541  16560 
LNOSLP1: CALL   SPSTRE                  ;63e3  cd ad 64     16542  16561 
    CP  02Ch                            ;63e6  fe 2c        16543  16562 
    JR  Z,COMSTR                        ;63e8  28 0d        16544  16563 
    CALL    TSTNAC                      ;63ea  cd 2e 65     16545  16564 
    JR  C,LBLGOT1                       ;63ed  38 0d        16546  16565 
    CALL    CVBCAS                      ;63ef  cd bd 30     16547  16566 
    CALL    HEX2                        ;63f2  cd 0c 65     16548  16567 
    JR  LNOSLP1                         ;63f5  18 ec        16549  16568 
COMSTR: LD  (HL),A                      ;63f7  77           16550  16569 
    INC HL                              ;63f8  23           16551  16570 
    INC DE                              ;63f9  13           16552  16571 
    JR  LNOSLP1                         ;63fa  18 e7        16553  16572 
                                        ;                   16554  16573 ;
LBLGOT1: CP 03Ah                        ;63fc  fe 3a        16555  16574 
    JP  Z,BACK                          ;63fe  ca 71 63     16556  16575 
    OR  A                               ;6401  b7           16557  16576 
    JP  Z,BACK                          ;6402  ca 71 63     16558  16577 
    CP  022h                            ;6405  fe 22        16559  16578 
    JP  NZ,BACK                         ;6407  c2 71 63     16560  16579 
    CALL    DQTSTR                      ;640a  cd 9d 64     16561  16580 
    JP  Z,TREND                         ;640d  ca 5c 63     16562  16581 
    JR  LNOSLP1                         ;6410  18 d1        16563  16582 
                                        ;                   16564  16583 ;
LISTER: CALL    SPSTRE                  ;6412  cd ad 64     16565  16584 
LISTRM: CP  02Eh                        ;6415  fe 2e        16566  16585 
    JR  Z,AFNUM                         ;6417  28 16        16567  16586 
    CP  02Dh                            ;6419  fe 2d        16568  16587 
    JR  Z,AFNUM                         ;641b  28 12        16569  16588 
    CP  02Ch                            ;641d  fe 2c        16570  16589 
    JR  Z,AFNUM                         ;641f  28 0e        16571  16590 
    CALL    TSTNAC                      ;6421  cd 2e 65     16572  16591 
    JP  C,BACK                          ;6424  da 71 63     16573  16592 
    CALL    CVBCAS                      ;6427  cd bd 30     16574  16593 
    CALL    HEX2                        ;642a  cd 0c 65     16575  16594 
    JR  LISTER                          ;642d  18 e3        16576  16595 
                                        ;                   16577  16596 ;
AFNUM:  LD  (HL),A                      ;642f  77           16578  16597 
    INC HL                              ;6430  23           16579  16598 
    INC DE                              ;6431  13           16580  16599 
    JR  LISTER                          ;6432  18 de        16581  16600 
                                        ;                   16582  16601 ;
ELSEST: DEC HL                          ;6434  2b           16583  16602 
    LD  (HL),03Ah                       ;6435  36 3a        16584  16603 
    INC HL                              ;6437  23           16585  16604 
    LD  (HL),A                          ;6438  77           16586  16605 
    INC HL                              ;6439  23           16587  16606 
    JR  LNOSLP1                         ;643a  18 a7        16588  16607 
                                        ;                   16589  16608 ;
DATAST1: LD A,(DE)                      ;643c  1a           16590  16609 
    OR  A                               ;643d  b7           16591  16610 
    JP  Z,TREND                         ;643e  ca 5c 63     16592  16611 
    LD  (HL),A                          ;6441  77           16593  16612 
    INC HL                              ;6442  23           16594  16613 
    INC DE                              ;6443  13           16595  16614 
DATAS: CP   03Ah                        ;6444  fe 3a        16596  16615 
    JP  Z,CPILLP                        ;6446  ca 27 63     16597  16616 
    CP  022h                            ;6449  fe 22        16598  16617 
    JR  NZ,DATAST1                      ;644b  20 ef        16599  16618 
DQSTL:  CALL    DQTST'                  ;644d  cd a0 64     16600  16619 
    JP  Z,TREND                         ;6450  ca 5c 63     16601  16620 
    JR  DATAST1                         ;6453  18 e7        16602  16621 ;DATAS'?
                                        ;                   16603  16622 ;
LSIT#?: LD  A,(DE)                      ;6455  1a           16604  16623 
    CP  023h                            ;6456  fe 23        16605  16624 
    JR  NZ,LISTER                       ;6458  20 b8        16606  16625 
    DEC HL                              ;645a  2b           16607  16626 
    INC (HL)                            ;645b  34           16608  16627 
    INC HL                              ;645c  23           16609  16628 
    INC DE                              ;645d  13           16610  16629 
    INC DE                              ;645e  13           16611  16630 
    JR  LISTER                          ;645f  18 b1        16612  16631 
                                        ;                   16613  16632 ;
MATCH:  PUSH    HL                      ;6461  e5           16614  16633 
    PUSH    DE                          ;6462  d5           16615  16634 
    LD  L,C                             ;6463  69           16616  16635 
    LD  H,B                             ;6464  60           16617  16636 
    LD  B,080h                          ;6465  06 80        16618  16637 
MSTART: POP DE                          ;6467  d1           16619  16638 
    PUSH    DE                          ;6468  d5           16620  16639 
    INC B                               ;6469  04           16621  16640 
    LD  A,(HL)                          ;646a  7e           16622  16641 
    INC A                               ;646b  3c           16623  16642 
    JR  Z,NOMTCH1                       ;646c  28 1e        16624  16643 
                                        ;                   16625  16644 ;
TESTMT: CALL    SMALL                   ;646e  cd 1b 63     16626  16645 
    LD  C,(HL)                          ;6471  4e           16627  16646 
    INC HL                              ;6472  23           16628  16647 
    INC DE                              ;6473  13           16629  16648 
    CP  02Eh                            ;6474  fe 2e        16630  16649 ;생략형 명령 처리
    JR  Z,SHORTN1                       ;6476  28 18        16631  16650 
    SUB C                               ;6478  91           16632  16651 
    JR  Z,TESTMT                        ;6479  28 f3        16633  16652 
    CP  080h                            ;647b  fe 80        16634  16653 
    JR  Z,MTCHOK                        ;647d  28 08        16635  16654 
    DEC HL                              ;647f  2b           16636  16655 
SKIPTB: LD  A,(HL)                      ;6480  7e           16637  16656 
    RLCA                                ;6481  07           16638  16657 
    INC HL                              ;6482  23           16639  16658 
    JR  NC,SKIPTB                       ;6483  30 fb        16640  16659 
    JR  MSTART                          ;6485  18 e0        16641  16660 
MTCHOK: POP HL                          ;6487  e1           16642  16661 
    POP HL                              ;6488  e1           16643  16662 
    LD  (HL),B                          ;6489  70           16644  16663 
    INC HL                              ;648a  23           16645  16664 
    RET                                 ;648b  c9           16646  16665 
                                        ;                   16647  16666 ;
NOMTCH1: POP    DE                      ;648c  d1           16648  16667 
    POP HL                              ;648d  e1           16649  16668 
    SCF                                 ;648e  37           16650  16669 
    RET                                 ;648f  c9           16651  16670 
                                        ;                   16652  16671 ;
SHORTN1: EX AF,AF'                      ;6490  08           16653  16672 
    LD  A,B                             ;6491  78           16654  16673 
    CP  0EEh                            ;6492  fe ee        16655  16674 
    JR  NC,NO2EH                        ;6494  30 03        16656  16675 
    EX  AF,AF'                          ;6496  08           16657  16676 
    JR  MTCHOK                          ;6497  18 ee        16658  16677 
                                        ;                   16659  16678 ;
NO2EH:  EX  AF,AF'                      ;6499  08           16660  16679 
    DEC HL                              ;649a  2b           16661  16680 
    JR  SKIPTB                          ;649b  18 e3        16662  16681 
                                        ;                   16663  16682 ;
DQTSTR: LD  (HL),A                      ;649d  77           16664  16683 
    INC DE                              ;649e  13           16665  16684 
    INC HL                              ;649f  23           16666  16685 
DQTST': LD  A,(DE)                      ;64a0  1a           16667  16686 
    OR  A                               ;64a1  b7           16668  16687 
    RET Z                               ;64a2  c8           16669  16688 
    CP  022h                            ;64a3  fe 22        16670  16689 
    JR  NZ,DQTSTR                       ;64a5  20 f6        16671  16690 
    LD  (HL),A                          ;64a7  77           16672  16691 
    INC DE                              ;64a8  13           16673  16692 
    INC HL                              ;64a9  23           16674  16693 
    INC A                               ;64aa  3c           16675  16694 
    DEC A                               ;64ab  3d           16676  16695 
    RET                                 ;64ac  c9           16677  16696 
                                        ;                   16678  16697 ;
SPSTRE: LD  A,(DE)                      ;64ad  1a           16679  16698 
    CP  020h                            ;64ae  fe 20        16680  16699 
    RET NZ                              ;64b0  c0           16681  16700 
    LD  (HL),A                          ;64b1  77           16682  16701 
    INC DE                              ;64b2  13           16683  16702 
    INC HL                              ;64b3  23           16684  16703 
    JR  SPSTRE                          ;64b4  18 f7        16685  16704 
                                        ;                   16686  16705 ;
NUMBER: LD  A,(DE)                      ;64b6  1a           16687  16706 
    CP  026h                            ;64b7  fe 26        16688  16707 
    PUSH    HL                          ;64b9  e5           16689  16708 
    INC HL                              ;64ba  23           16690  16709 
    JR  NZ,NOT26H                       ;64bb  20 23        16691  16710 
    PUSH    DE                          ;64bd  d5           16692  16711 
    INC DE                              ;64be  13           16693  16712 
    CALL    DEFTCH                      ;64bf  cd 51 5d     16694  16713 
    CALL    SMALL'                      ;64c2  cd 1c 63     16695  16714 
    POP DE                              ;64c5  d1           16696  16715 ;이 줄은 책에서 빠져있네요.
    PUSH    AF                          ;64c6  f5           16697  16716 
    CALL    OVFLAG                      ;64c7  cd b8 5b     16698  16717 
    CALL    HEXFLT                      ;64ca  cd 5d 61     16699  16718 
    POP AF                              ;64cd  f1           16700  16719 
    CP  048h                            ;64ce  fe 48        16701  16720 
    LD  A,011h                          ;64d0  3e 11        16702  16721 
    JR  Z,SKIPHX                        ;64d2  28 01        16703  16722 
    DEC A                               ;64d4  3d           16704  16723 
SKIPHX: LD  C,L                         ;64d5  4d           16705  16724 
    LD  B,H                             ;64d6  44           16706  16725 
    POP HL                              ;64d7  e1           16707  16726 
    LD  (HL),A                          ;64d8  77           16708  16727 
    INC HL                              ;64d9  23           16709  16728 
    LD  (HL),C                          ;64da  71           16710  16729 
    INC HL                              ;64db  23           16711  16730 
    LD  (HL),B                          ;64dc  70           16712  16731 
    INC HL                              ;64dd  23           16713  16732 
    JR  BCKSPS                          ;64de  18 24        16714  16733 
                                        ;                   16715  16734 ;
NOT26H: CALL    OVFLAG                  ;64e0  cd b8 5b     16716  16735 
    BIT 7,(IY-1)                        ;64e3  fd cb ff 7e  16717  16736 
    JR  NZ,FLOAT                        ;64e7  20 32        16718  16737 
    LD  A,(HL)                          ;64e9  7e           16719  16738 
    CP  090h                            ;64ea  fe 90        16720  16739 
    JR  NC,FLOAT                        ;64ec  30 2d        16721  16740 
    CALL    HEXFLT                      ;64ee  cd 5d 61     16722  16741 
    PUSH    DE                          ;64f1  d5           16723  16742 
    EX  DE,HL                           ;64f2  eb           16724  16743 
    LD  HL,00009H                       ;64f3  21 09 00     16725  16744 
    OR  A                               ;64f6  b7           16726  16745 
    SBC HL,DE                           ;64f7  ed 52        16727  16746 
    EX  DE,HL                           ;64f9  eb           16728  16747 
    POP DE                              ;64fa  d1           16729  16748 
    LD  A,012h                          ;64fb  3e 12        16730  16749 
    JR  C,HEX1                          ;64fd  38 11        16731  16750 
    LD  A,L                             ;64ff  7d           16732  16751 
    INC A                               ;6500  3c           16733  16752 
    POP HL                              ;6501  e1           16734  16753 
    LD  (HL),A                          ;6502  77           16735  16754 
    INC HL                              ;6503  23           16736  16755 
BCKSPS: DEC DE                          ;6504  1b           16737  16756 
    LD  A,(DE)                          ;6505  1a           16738  16757 
    CP  020h                            ;6506  fe 20        16739  16758 
    JR  Z,BCKSPS                        ;6508  28 fa        16740  16759 
    INC DE                              ;650a  13           16741  16760 
    RET                                 ;650b  c9           16742  16761 
                                        ;                   16743  16762 ;
HEX2:   LD  A,00Bh                      ;650c  3e 0b        16744  16763 
    JR  PPOLNO                          ;650e  18 03        16745  16764 
                                        ;                   16746  16765 ;
HEX1:   LD  C,L                         ;6510  4d           16747  16766 
    LD  B,H                             ;6511  44           16748  16767 
    POP HL                              ;6512  e1           16749  16768 
PPOLNO: LD  (HL),A                      ;6513  77           16750  16769 
    INC HL                              ;6514  23           16751  16770 
    LD  (HL),C                          ;6515  71           16752  16771 
    INC HL                              ;6516  23           16753  16772 
    LD  (HL),B                          ;6517  70           16754  16773 
    INC HL                              ;6518  23           16755  16774 
    JR  BCKSPS                          ;6519  18 e9        16756  16775 
                                        ;                   16757  16776 ;
FLOAT:  LD  A,(IY+0)                    ;651b  fd 7e 00     16758  16777 
    AND 00Fh                            ;651e  e6 0f        16759  16778 
    OR  010h                            ;6520  f6 10        16760  16779 
    POP HL                              ;6522  e1           16761  16780 
    LD  (HL),A                          ;6523  77           16762  16781 
    INC HL                              ;6524  23           16763  16782 
    LD  C,(IY+0)                        ;6525  fd 4e 00     16764  16783 
    LD  B,0                             ;6528  06 00        16765  16784 
    ADD HL,BC                           ;652a  09           16766  16785 
    JR  BCKSPS                          ;652b  18 d7        16767  16786 
                                        ;                   16768  16787 ;
TSTNDE: LD  A,(DE)                      ;652d  1a           16769  16788 
TSTNAC: CP  030h                        ;652e  fe 30        16770  16789 
    RET C                               ;6530  d8           16771  16790 
    CP  03Ah                            ;6531  fe 3a        16772  16791 
    CCF                                 ;6533  3f           16773  16792 
    RET                                 ;6534  c9           16774  16793 
                                        ;                   16775  16794 ;
TREN':  LD  (DE),A                      ;6535  12           16776  16795 
    POP BC                              ;6536  c1           16777  16796 
    POP DE                              ;6537  d1           16778  16797 
    POP HL                              ;6538  e1           16779  16798 
    RET                                 ;6539  c9           16780  16799 
                                        ;                   16781  16800 ;
CVTXIM: PUSH    HL                      ;653a  e5           16782  16801 
    PUSH    DE                          ;653b  d5           16783  16802 
    PUSH    BC                          ;653c  c5           16784  16803 
    LD  (CVCPPT),DE                     ;653d  ed 53 4a 65  16785  16804 
CVTMLP: PUSH    HL                      ;6541  e5           16786  16805 
    PUSH    DE                          ;6542  d5           16787  16806 
    EX  DE,HL                           ;6543  eb           16788  16807 
    DEC H                               ;6544  25           16789  16808 
    LD  DE,26                           ;6545  11 1a 00     16790  16809 
    ADD HL,DE                           ;6548  19           16791  16810 
    DEFB    011H                        ;6549  11           16792  16811 ; LD DE,?
CVCPPT: DEFS    2                       ;654a               16793  16812 
    XOR A                               ;654c  af           16794  16813 
    SBC HL,DE                           ;654d  ed 52        16795  16814 
    POP DE                              ;654f  d1           16796  16815 
    POP HL                              ;6550  e1           16797  16816 
    JP  NC,TREN'                        ;6551  d2 35 65     16798  16817 
    LD  A,(HL)                          ;6554  7e           16799  16818 
    OR  A                               ;6555  b7           16800  16819 
    JP  Z,TREN'                         ;6556  ca 35 65     16801  16820 
    CP  081h                            ;6559  fe 81        16802  16821 ;FUNCTION의 TOKEN
    JR  NC,TRASIM                       ;655b  30 13        16803  16822 
    CP  020h                            ;655d  fe 20        16804  16823 
    JR  C,TRNUMB                        ;655f  38 32        16805  16824 
    CP  022h                            ;6561  fe 22        16806  16825 
    JP  Z,DQUAT                         ;6563  ca 5d 66     16807  16826 
    CP  03Ah                            ;6566  fe 3a        16808  16827 
    JP  Z,CORON                         ;6568  ca 74 66     16809  16828 
BCEG:   LD  (DE),A                      ;656b  12           16810  16829 
    INC DE                              ;656c  13           16811  16830 
MDLBK:  INC HL                          ;656d  23           16812  16831 
    JR  CVTMLP                          ;656e  18 d1        16813  16832 
TRASIM: CP  0FFh                        ;6570  fe ff        16814  16833 ;함수 앞에 FF가 붙으므로
    JR  Z,FUNCTR                        ;6572  28 15        16815  16834 
    LD  BC,CTBL1                        ;6574  01 37 67     16816  16835 
    PUSH    AF                          ;6577  f5           16817  16836 
    CALL    INVS                        ;6578  cd 84 66     16818  16837 
    POP AF                              ;657b  f1           16819  16838 
    INC HL                              ;657c  23           16820  16839 
    CP  092h                            ;657d  fe 92        16821  16840 
    JP  Z,REM1                          ;657f  ca 70 66     16822  16841 
    CP  08Fh                            ;6582  fe 8f        16823  16842 
    JP  Z,DTARCL                        ;6584  ca 3d 66     16824  16843 
    JR  CVTMLP                          ;6587  18 b8        16825  16844 
                                        ;                   16826  16845 ;
FUNCTR: INC HL                          ;6589  23           16827  16846 
    LD  A,(HL)                          ;658a  7e           16828  16847 
    LD  BC,CTBL2                        ;658b  01 d3 68     16829  16848 
    CALL    INVS                        ;658e  cd 84 66     16830  16849 
    JR  MDLBK                           ;6591  18 da        16831  16850 
                                        ;                   16832  16851 ;
TRNUMB: CP  010h                        ;6593  fe 10        16833  16852 
    JR  NC,RFLOAT                       ;6595  30 41        16834  16853 
    CP  00Bh                            ;6597  fe 0b        16835  16854 
    JR  NC,IMHORN                       ;6599  30 05        16836  16855 
    DEC A                               ;659b  3d           16837  16856 
    OR  030h                            ;659c  f6 30        16838  16857 
    JR  BCEG                            ;659e  18 cb        16839  16858 
                                        ;                   16840  16859 ;
IMHORN: CP  00Ch                        ;65a0  fe 0c        16841  16860 
    JP  Z,IMLNO                         ;65a2  ca 2d 66     16842  16861 
IMHEX:  PUSH    DE                      ;65a5  d5           16843  16862 
    INC HL                              ;65a6  23           16844  16863 
    LD  E,(HL)                          ;65a7  5e           16845  16864 
    INC HL                              ;65a8  23           16846  16865 
    LD  D,(HL)                          ;65a9  56           16847  16866 
    INC HL                              ;65aa  23           16848  16867 
    PUSH    HL                          ;65ab  e5           16849  16868 
    CP  010h                            ;65ac  fe 10        16850  16869 
    JR  C,IMMID                         ;65ae  38 05        16851  16870 
    CP  012h                            ;65b0  fe 12        16852  16871 
    JP  C,HEXOCT                        ;65b2  da ae 66     16853  16872 
IMMID:  EX  DE,HL                       ;65b5  eb           16854  16873 
    LD  DE,FIVEBF                       ;65b6  11 ab 69     16855  16874 
    CALL    ASCHL                       ;65b9  cd a8 62     16856  16875 
    XOR A                               ;65bc  af           16857  16876 
    LD  (FIVEBF+5),A                    ;65bd  32 b0 69     16858  16877 
    LD  B,4                             ;65c0  06 04        16859  16878 
SKZRLP: LD  A,(DE)                      ;65c2  1a           16860  16879 
    CP  030h                            ;65c3  fe 30        16861  16880 
    JR  NZ,ESSKZR                       ;65c5  20 03        16862  16881 
    INC DE                              ;65c7  13           16863  16882 
    DJNZ    SKZRLP                      ;65c8  10 f8        16864  16883 
ESSKZR: LD  C,E                         ;65ca  4b           16865  16884 
    LD  B,D                             ;65cb  42           16866  16885 
    POP HL                              ;65cc  e1           16867  16886 
    POP DE                              ;65cd  d1           16868  16887 
ZTRLW:  LD  A,(BC)                      ;65ce  0a           16869  16888 
    OR  A                               ;65cf  b7           16870  16889 
    JP  Z,CVTMLP                        ;65d0  ca 41 65     16871  16890 
    LD  (DE),A                          ;65d3  12           16872  16891 
    INC DE                              ;65d4  13           16873  16892 
    INC BC                              ;65d5  03           16874  16893 
    JR  ZTRLW                           ;65d6  18 f6        16875  16894 
RFLOAT: CP  013h                        ;65d8  fe 13        16876  16895 
    JR  C,IMHEX                         ;65da  38 c9        16877  16896 
    AND 00Fh                            ;65dc  e6 0f        16878  16897 
    LD  (IY+0),A                        ;65de  fd 77 00     16879  16898 
    INC HL                              ;65e1  23           16880  16899 
    PUSH    HL                          ;65e2  e5           16881  16900 
    PUSH    DE                          ;65e3  d5           16882  16901 
    CALL    CVASFL                      ;65e4  cd 1a 5e     16883  16902 
    EX  DE,HL                           ;65e7  eb           16884  16903 
    POP DE                              ;65e8  d1           16885  16904 
FLTRDL: LD  A,(HL)                      ;65e9  7e           16886  16905 
    LD  (DE),A                          ;65ea  12           16887  16906 
    CP  02Eh                            ;65eb  fe 2e        16888  16907 
    JR  Z,NTPT21                        ;65ed  28 29        16889  16908 
    CP  045h                            ;65ef  fe 45        16890  16909 
    JR  Z,NTPT21                        ;65f1  28 25        16891  16910 
    CP  044h                            ;65f3  fe 44        16892  16911 
    JR  Z,NTPT23                        ;65f5  28 30        16893  16912 
    INC HL                              ;65f7  23           16894  16913 
    INC DE                              ;65f8  13           16895  16914 
    DJNZ    FLTRDL                      ;65f9  10 ee        16896  16915 
    LD  A,(IY+0)                        ;65fb  fd 7e 00     16897  16916 
    CP  008h                            ;65fe  fe 08        16898  16917 
    LD  A,021h                          ;6600  3e 21        16899  16918 
    JR  NZ,PUT21H                       ;6602  20 02        16900  16919 
PUT23H: LD  A,023h                      ;6604  3e 23        16901  16920 
PUT21H: LD  (DE),A                      ;6606  12           16902  16921 
    INC DE                              ;6607  13           16903  16922 
TSTED:  LD  C,(IY+0)                    ;6608  fd 4e 00     16904  16923 
    LD  B,0                             ;660b  06 00        16905  16924 
    POP HL                              ;660d  e1           16906  16925 
    ADD HL,BC                           ;660e  09           16907  16926 
    JP  CVTMLP                          ;660f  c3 41 65     16908  16927 
                                        ;                   16909  16928 ;
FLTRP': LD  A,(HL)                      ;6612  7e           16910  16929 
    LD  (DE),A                          ;6613  12           16911  16930 
    CP  044h                            ;6614  fe 44        16912  16931 
    JR  Z,NTPT23                        ;6616  28 0f        16913  16932 
NTPT21: INC HL                          ;6618  23           16914  16933 
    INC DE                              ;6619  13           16915  16934 
    DJNZ    FLTRP'                      ;661a  10 f6        16916  16935 
    LD  A,(IY+0)                        ;661c  fd 7e 00     16917  16936 
    CP  008h                            ;661f  fe 08        16918  16937 
    JR  Z,PUT23H                        ;6621  28 e1        16919  16938 
    JR  TSTED                           ;6623  18 e3        16920  16939 
                                        ;                   16921  16940 ;
FLTR'': LD  A,(HL)                      ;6625  7e           16922  16941 
    LD  (DE),A                          ;6626  12           16923  16942 
NTPT23: INC HL                          ;6627  23           16924  16943 
    INC DE                              ;6628  13           16925  16944 
    DJNZ    FLTR''                      ;6629  10 fa        16926  16945 
    JR  TSTED                           ;662b  18 db        16927  16946 
                                        ;                   16928  16947 ;
IMLNO:  PUSH    DE                      ;662d  d5           16929  16948 
    INC HL                              ;662e  23           16930  16949 
    LD  E,(HL)                          ;662f  5e           16931  16950 
    INC HL                              ;6630  23           16932  16951 
    LD  D,(HL)                          ;6631  56           16933  16952 
    INC HL                              ;6632  23           16934  16953 
    PUSH    HL                          ;6633  e5           16935  16954 
    EX  DE,HL                           ;6634  eb           16936  16955 
    INC HL                              ;6635  23           16937  16956 
    INC HL                              ;6636  23           16938  16957 
    LD  E,(HL)                          ;6637  5e           16939  16958 
    INC HL                              ;6638  23           16940  16959 
    LD  D,(HL)                          ;6639  56           16941  16960 
    JP  IMMID                           ;663a  c3 b5 65     16942  16961 
                                        ;                   16943  16962 ;
DTARCL: LD  A,(HL)                      ;663d  7e           16944  16963 
    CP  022h                            ;663e  fe 22        16945  16964 
    JR  Z,DTA22S                        ;6640  28 0e        16946  16965 
MIDDST: LD  (DE),A                      ;6642  12           16947  16966 
    CP  03Ah                            ;6643  fe 3a        16948  16967 
    INC HL                              ;6645  23           16949  16968 
    INC DE                              ;6646  13           16950  16969 
    JP  Z,CVTMLP                        ;6647  ca 41 65     16951  16970 
    OR  A                               ;664a  b7           16952  16971 
    JP  Z,TREN'                         ;664b  ca 35 65     16953  16972 
    JR  DTARCL                          ;664e  18 ed        16954  16973 
                                        ;                   16955  16974 ;
DTA22S: LD  (DE),A                      ;6650  12           16956  16975 
    INC HL                              ;6651  23           16957  16976 
    INC DE                              ;6652  13           16958  16977 
    LD  A,(HL)                          ;6653  7e           16959  16978 
    CP  022h                            ;6654  fe 22        16960  16979 
    JR  Z,MIDDST                        ;6656  28 ea        16961  16980 
    OR  A                               ;6658  b7           16962  16981 
    JR  Z,MIDDST                        ;6659  28 e7        16963  16982 
    JR  DTA22S                          ;665b  18 f3        16964  16983 
                                        ;                   16965  16984 ;
DQUAT:  LD  B,022h                      ;665d  06 22        16966  16985 
    LD  (DE),A                          ;665f  12           16967  16986 
    INC HL                              ;6660  23           16968  16987 
    INC DE                              ;6661  13           16969  16988 
DQUATL: LD  A,(HL)                      ;6662  7e           16970  16989 
    LD  (DE),A                          ;6663  12           16971  16990 
    OR  A                               ;6664  b7           16972  16991 
    JP  Z,TREN'                         ;6665  ca 35 65     16973  16992 
    CP  B                               ;6668  b8           16974  16993 
    INC HL                              ;6669  23           16975  16994 
    INC DE                              ;666a  13           16976  16995 
    JP  Z,CVTMLP                        ;666b  ca 41 65     16977  16996 
    JR  DQUATL                          ;666e  18 f2        16978  16997 
                                        ;                   16979  16998 ;
REM1:   LD  B,0                         ;6670  06 00        16980  16999 
    JR  DQUATL                          ;6672  18 ee        16981  17000 
                                        ;                   16982  17001 ;
CORON:  LD  (DE),A                      ;6674  12           16983  17002 
    INC HL                              ;6675  23           16984  17003 
    LD  A,(HL)                          ;6676  7e           16985  17004 
    CP  027h                            ;6677  fe 27        16986  17005 
    JR  Z,REM1                          ;6679  28 f5        16987  17006 
    CP  0B8h                            ;667b  fe b8        16988  17007 
    JP  Z,CVTMLP                        ;667d  ca 41 65     16989  17008 
    INC DE                              ;6680  13           16990  17009 
    JP  CVTMLP                          ;6681  c3 41 65     16991  17010 
                                        ;                   16992  17011 ;
INVS:   DEC A                           ;6684  3d           16993  17012 
    CP  080h                            ;6685  fe 80        16994  17013 
    JR  Z,ASSTR#                        ;6687  28 0b        16995  17014 
    EX  AF,AF'                          ;6689  08           16996  17015 
SKIPTR: LD  A,(BC)                      ;668a  0a           16997  17016 
    RLCA                                ;668b  07           16998  17017 
    INC BC                              ;668c  03           16999  17018 
    JP  NC,SKIPTR                       ;668d  d2 8a 66     17000  17019 
    EX  AF,AF'                          ;6690  08           17001  17020 
    JP  INVS                            ;6691  c3 84 66     17002  17021 
ASSTR#: LD  A,(BC)                      ;6694  0a           17003  17022 
    PUSH    AF                          ;6695  f5           17004  17023 
    AND 07Fh                            ;6696  e6 7f        17005  17024 
    LD  (DE),A                          ;6698  12           17006  17025 
    POP AF                              ;6699  f1           17007  17026 
    INC DE                              ;669a  13           17008  17027 
    INC BC                              ;669b  03           17009  17028 
    RLCA                                ;669c  07           17010  17029 
    JR  NC,ASSTR#                       ;669d  30 f5        17011  17030 
    RET                                 ;669f  c9           17012  17031 
                                        ;                   17013  17032 ;
OCTALD: LD  A,04Fh                      ;66a0  3e 4f        17014  17033 
    EX  AF,AF'                          ;66a2  08           17015  17034 
    EX  DE,HL                           ;66a3  eb           17016  17035 
    LD  DE,FIVEBF                       ;66a4  11 ab 69     17017  17036 
    CALL    OCTHL                       ;66a7  cd db 66     17018  17037 
    LD  B,005h                          ;66aa  06 05        17019  17038 
    JR  SKHEXP                          ;66ac  18 10        17020  17039 
                                        ;                   17021  17040 ;
HEXOCT: CP  011h                        ;66ae  fe 11        17022  17041 
    JR  NZ,OCTALD                       ;66b0  20 ee        17023  17042 
    LD  A,048h                          ;66b2  3e 48        17024  17043 
    EX  AF,AF'                          ;66b4  08           17025  17044 
    EX  DE,HL                           ;66b5  eb           17026  17045 
    LD  DE,FIVEBF                       ;66b6  11 ab 69     17027  17046 
    CALL    HEXHL                       ;66b9  cd 12 67     17028  17047 
    LD  B,3                             ;66bc  06 03        17029  17048 
SKHEXP: LD  A,(DE)                      ;66be  1a           17030  17049 
    CP  030h                            ;66bf  fe 30        17031  17050 
    JR  NZ,ESHEXR                       ;66c1  20 03        17032  17051 
    INC DE                              ;66c3  13           17033  17052 
    DJNZ    SKHEXP                      ;66c4  10 f8        17034  17053 
ESHEXR: LD  C,E                         ;66c6  4b           17035  17054 
    LD  B,D                             ;66c7  42           17036  17055 
    POP HL                              ;66c8  e1           17037  17056 
    POP DE                              ;66c9  d1           17038  17057 
    LD  A,026h                          ;66ca  3e 26        17039  17058 
    LD  (DE),A                          ;66cc  12           17040  17059 
    INC DE                              ;66cd  13           17041  17060 
    EX  AF,AF'                          ;66ce  08           17042  17061 
    LD  (DE),A                          ;66cf  12           17043  17062 
    INC DE                              ;66d0  13           17044  17063 
ZTRLWH: LD  A,(BC)                      ;66d1  0a           17045  17064 
    OR  A                               ;66d2  b7           17046  17065 
    JP  Z,CVTMLP                        ;66d3  ca 41 65     17047  17066 
    LD  (DE),A                          ;66d6  12           17048  17067 
    INC DE                              ;66d7  13           17049  17068 
    INC BC                              ;66d8  03           17050  17069 
    JR  ZTRLWH                          ;66d9  18 f6        17051  17070 
                                        ;                   17052  17071 ;
OCTHL:  PUSH    DE                      ;66db  d5           17053  17072 
    CALL    OCTCOV                      ;66dc  cd e1 66     17054  17073 
    POP DE                              ;66df  d1           17055  17074 
    RET                                 ;66e0  c9           17056  17075 
                                        ;                   17057  17076 ;
OCTCOV: LD  A,H                         ;66e1  7c           17058  17077 
    RLA                                 ;66e2  17           17059  17078 
    LD  A,0                             ;66e3  3e 00        17060  17079 
    ADC A,030h                          ;66e5  ce 30        17061  17080 
    LD  (DE),A                          ;66e7  12           17062  17081 
    INC DE                              ;66e8  13           17063  17082 
    LD  A,H                             ;66e9  7c           17064  17083 
    RRCA                                ;66ea  0f           17065  17084 
    RRCA                                ;66eb  0f           17066  17085 
    RRCA                                ;66ec  0f           17067  17086 
    RRCA                                ;66ed  0f           17068  17087 
    CALL    OCTSTO                      ;66ee  cd 0b 67     17069  17088 
    LD  A,H                             ;66f1  7c           17070  17089 
    RRCA                                ;66f2  0f           17071  17090 
    CALL    OCTSTO                      ;66f3  cd 0b 67     17072  17091 
    LD  A,H                             ;66f6  7c           17073  17092 
    AND 001h                            ;66f7  e6 01        17074  17093 
    LD  H,L                             ;66f9  65           17075  17094 
    RL  H                               ;66fa  cb 14        17076  17095 
    RLA                                 ;66fc  17           17077  17096 
    RL  H                               ;66fd  cb 14        17078  17097 
    RLA                                 ;66ff  17           17079  17098 
    CALL    OCTSTO                      ;6700  cd 0b 67     17080  17099 
    LD  A,L                             ;6703  7d           17081  17100 
    RRCA                                ;6704  0f           17082  17101 
    RRCA                                ;6705  0f           17083  17102 
    RRCA                                ;6706  0f           17084  17103 
    CALL    OCTSTO                      ;6707  cd 0b 67     17085  17104 
    LD  A,L                             ;670a  7d           17086  17105 
OCTSTO: AND 007h                        ;670b  e6 07        17087  17106 
    ADD A,030h                          ;670d  c6 30        17088  17107 
    LD  (DE),A                          ;670f  12           17089  17108 
    INC DE                              ;6710  13           17090  17109 
    RET                                 ;6711  c9           17091  17110 
                                        ;                   17092  17111 ;
HEXHL:  PUSH    DE                      ;6712  d5           17093  17112 
    CALL    HEXCOV                      ;6713  cd 1a 67     17094  17113 
    XOR A                               ;6716  af           17095  17114 
    LD  (DE),A                          ;6717  12           17096  17115 
    POP DE                              ;6718  d1           17097  17116 
    RET                                 ;6719  c9           17098  17117 
                                        ;                   17099  17118 ;
HEXCOV: LD  A,H                         ;671a  7c           17100  17119 
    CALL    HEXACC                      ;671b  cd 1f 67     17101  17120 
    LD  A,L                             ;671e  7d           17102  17121 
HEXACC: PUSH    AF                      ;671f  f5           17103  17122 
    RRCA                                ;6720  0f           17104  17123 
    RRCA                                ;6721  0f           17105  17124 
    RRCA                                ;6722  0f           17106  17125 
    RRCA                                ;6723  0f           17107  17126 
    AND 00Fh                            ;6724  e6 0f        17108  17127 
    CALL    HEXHLF                      ;6726  cd 2c 67     17109  17128 
    POP AF                              ;6729  f1           17110  17129 
    AND 00Fh                            ;672a  e6 0f        17111  17130 
HEXHLF: ADD A,030h                      ;672c  c6 30        17112  17131 
    CP  03Ah                            ;672e  fe 3a        17113  17132 
    JR  C,SKIUTO                        ;6730  38 02        17114  17133 
    ADD A,007h                          ;6732  c6 07        17115  17134 
SKIUTO: LD  (DE),A                      ;6734  12           17116  17135 
    INC DE                              ;6735  13           17117  17136 
    RET                                 ;6736  c9           17118  17137 
                                        ;                   17119  17138 ;
CTBL1:  DEFM    'GOT'                   ;6737  47 4f 54     17120  17139 ;GOTO		81H
    DEFB    'O'+080H                    ;673a  cf           17121  17140 
    DEFM    'GOSU'                      ;673b  47 4f 53 55  17122  17141 ;GOSUB
    DEFB    'B'+080H                    ;673f  c2           17123  17142 
    DEFM    'RU'                        ;6740  52 55        17124  17143 ;RUN
    DEFB    'N'+080H                    ;6742  ce           17125  17144 
    DEFM    'RETUR'                     ;6743  52 45 54 55  17126  17145 ;RETURN
                                        ;6747  52           17126  17146
    DEFB    'N'+080H                    ;6748  ce           17127  17147 
    DEFM    'RESTOR'                    ;6749  52 45 53 54  17128  17148 ;RESTORE
                                        ;674d  4f 52        17128  17149
    DEFB    'E'+080H                    ;674f  c5           17129  17150 
    DEFM    'LIS'                       ;6750  4c 49 53     17130  17151 ;LIST
    DEFB    'T'+080H                    ;6753  d4           17131  17152 
    DEFM    'LIST#'                     ;6754  4c 49 53 54  17132  17153 ;LIST#1
                                        ;6758  23           17132  17154
    DEFB    '1'+080H                    ;6759  b1           17133  17155 
    DEFM    'AUT'                       ;675a  41 55 54     17134  17156 ;AUTO
    DEFB    'O'+080H                    ;675d  cf           17135  17157 
    DEFM    'DELET'                     ;675e  44 45 4c 45  17136  17158 ;DELETE
                                        ;6762  54           17136  17159
    DEFB    'E'+080H                    ;6763  c5           17137  17160 
    DEFM    'FO'                        ;6764  46 4f        17138  17161 ;FOR
    DEFB    'R'+080H                    ;6766  d2           17139  17162 
    DEFM    'NEX'                       ;6767  4e 45 58     17140  17163 ;NEXT
    DEFB    'T'+080H                    ;676a  d4           17141  17164 
    DEFM    'PRIN'                      ;676b  50 52 49 4e  17142  17165 ;PRINT
    DEFB    'T'+080H                    ;676f  d4           17143  17166 
    DEFM    'INPU'                      ;6770  49 4e 50 55  17144  17167 ;INPUT
    DEFB    'T'+080H                    ;6774  d4           17145  17168 
    DEFM    'I'                         ;6775  49           17146  17169 ;IF
    DEFB    'F'+080H                    ;6776  c6           17147  17170 
    DEFM    'DAT'                       ;6777  44 41 54     17148  17171 ;DATA
    DEFB    'A'+080H                    ;677a  c1           17149  17172 
    DEFM    'REA'                       ;677b  52 45 41     17150  17173 ;READ		90H
    DEFB    'D'+080H                    ;677e  c4           17151  17174 
    DEFM    'DI'                        ;677f  44 49        17152  17175 ;DIM
    DEFB    'M'+080H                    ;6781  cd           17153  17176 
    DEFM    'RE'                        ;6782  52 45        17154  17177 ;REM
    DEFB    'M'+080H                    ;6784  cd           17155  17178 
    DEFM    'EDI'                       ;6785  45 44 49     17156  17179 ;EDIT
    DEFB    'T'+080H                    ;6788  d4           17157  17180 
    DEFM    'STO'                       ;6789  53 54 4f     17158  17181 ;STOP
    DEFB    'P'+080H                    ;678c  d0           17159  17182 
    DEFM    'CON'                       ;678d  43 4f 4e     17160  17183 ;CONT
    DEFB    'T'+080H                    ;6790  d4           17161  17184 
    DEFM    'CL'                        ;6791  43 4c        17162  17185 ;CLS
    DEFB    'S'+080H                    ;6793  d3           17163  17186 
    DEFM    'CLEA'                      ;6794  43 4c 45 41  17164  17187 ;CLEAR
    DEFB    'R'+080H                    ;6798  d2           17165  17188 
    DEFM    'O'                         ;6799  4f           17166  17189 ;ON
    DEFB    'N'+080H                    ;679a  ce           17167  17190 
    DEFM    'LE'                        ;679b  4c 45        17168  17191 ;LET
    DEFB    'T'+080H                    ;679d  d4           17169  17192 
    DEFM    'NE'                        ;679e  4e 45        17170  17193 ;NEW
    DEFB    'W'+080H                    ;67a0  d7           17171  17194 
    DEFM    'POK'                       ;67a1  50 4f 4b     17172  17195 ;POKE
    DEFB    'E'+080H                    ;67a4  c5           17173  17196 
    DEFM    'OF'                        ;67a5  4f 46        17174  17197 ;OFF
    DEFB    'F'+080H                    ;67a7  c6           17175  17198 
    DEFM    'WHIL'                      ;67a8  57 48 49 4c  17176  17199 ;WHILE
    DEFB    'E'+080H                    ;67ac  c5           17177  17200 
    DEFM    'WEN'                       ;67ad  57 45 4e     17178  17201 ;WEND
    DEFB    'D'+080H                    ;67b0  c4           17179  17202 
    DEFM    'REPEA'                     ;67b1  52 45 50 45  17180  17203 ;REPEAT
                                        ;67b5  41           17180  17204
    DEFB    'T'+080H                    ;67b6  d4           17181  17205 
    DEFM    'UNTI'                      ;67b7  55 4e 54 49  17182  17206 ;UNTIL		A0
    DEFB    'L'+080H                    ;67bb  cc           17183  17207 
    DEFM    'TRAC'                      ;67bc  54 52 41 43  17184  17208 ;TRACE
    DEFB    'E'+080H                    ;67c0  c5           17185  17209 
    DEFM    'EN'                        ;67c1  45 4e        17186  17210 ;END
    DEFB    'D'+080H                    ;67c3  c4           17187  17211 
    DEFM    'PLA'                       ;67c4  50 4c 41     17188  17212 ;PLAY
    DEFB    'Y'+080H                    ;67c7  d9           17189  17213 
    DEFM    'BEE'                       ;67c8  42 45 45     17190  17214 ;BEEP
    DEFB    'P'+080H                    ;67cb  d0           17191  17215 
    DEFM    'DEFIN'                     ;67cc  44 45 46 49  17192  17216 ;DEFINT
                                        ;67d0  4e           17192  17217
    DEFB    'T'+080H                    ;67d1  d4           17193  17218 
    DEFM    'DEFSN'                     ;67d2  44 45 46 53  17194  17219 ;DEFSNG
                                        ;67d6  4e           17194  17220
    DEFB    'G'+080H                    ;67d7  c7           17195  17221 
    DEFM    'DEFDB'                     ;67d8  44 45 46 44  17196  17222 ;DEFDBL
                                        ;67dc  42           17196  17223
    DEFB    'L'+080H                    ;67dd  cc           17197  17224 
    DEFM    'DEFST'                     ;67de  44 45 46 53  17198  17225 ;DEFST
                                        ;67e2  54           17198  17226
    DEFB    'R'+080H                    ;67e3  d2           17199  17227 
    DEFM    'DE'                        ;67e4  44 45        17200  17228 ;DEF
    DEFB    'F'+080H                    ;67e6  c6           17201  17229 
    DEFM    'DUM'                       ;67e7  44 55 4d     17202  17230 ;DUMP
    DEFB    'P'+080H                    ;67ea  d0           17203  17231 
    DEFM    'LOA'                       ;67eb  4c 4f 41     17204  17232 ;LOAD
    DEFB    'D'+080H                    ;67ee  c4           17205  17233 
    DEFM    'SAV'                       ;67ef  53 41 56     17206  17234 ;SAVE
    DEFB    'E'+080H                    ;67f2  c5           17207  17235 
    DEFM    'MERG'                      ;67f3  4d 45 52 47  17208  17236 ;MERGE
    DEFB    'E'+080H                    ;67f7  c5           17209  17237 
    DEFB    080H                        ;67f8  80           17210  17238 ;DEFM 'CONSO'
                                        ;                   17211  17239 ;DEFB	'L'+080H
    DEFM    'OU'                        ;67f9  4f 55        17212  17240 ;OUT
    DEFB    'T'+080H                    ;67fb  d4           17213  17241 
    DEFM    'SEARC'                     ;67fc  53 45 41 52  17214  17242 ;SEARCH 	B0
                                        ;6800  43           17214  17243
    DEFB    'H'+080H                    ;6801  c8           17215  17244 
    DEFM    'SOUN'                      ;6802  53 4f 55 4e  17216  17245 ;SOUND
    DEFB    'D'+080H                    ;6806  c4           17217  17246 
    DEFB    080H                        ;6807  80           17218  17247 
    DEFM    'SWA'                       ;6808  53 57 41     17219  17248 ;SWAP
    DEFB    'P'+080H                    ;680b  d0           17220  17249 
    DEFB    080H                        ;680c  80           17221  17250 ;DEFM 'ERAS'
    DEFM    'ERRO'                      ;680d  45 52 52 4f  17222  17251 ;ERROR
    DEFB    'R'+080H                    ;6811  d2           17223  17252 
    DEFM    'RESUM'                     ;6812  52 45 53 55  17224  17253 ;RESUME
                                        ;6816  4d           17224  17254
    DEFB    'E'+080H                    ;6817  c5           17225  17255 
    DEFM    'RENU'                      ;6818  52 45 4e 55  17226  17256 ;RENUM
    DEFB    'M'+080H                    ;681c  cd           17227  17257 
    DEFM    'ELS'                       ;681d  45 4c 53     17228  17258 ;ELSE
    DEFB    'E'+080H                    ;6820  c5           17229  17259 
    DEFM    'CAL'                       ;6821  43 41 4c     17230  17260 ;CALL
    DEFB    'L'+080H                    ;6824  cc           17231  17261 
    DEFM    'LOCAT'                     ;6825  4c 4f 43 41  17232  17262 ;LOCATE
                                        ;6829  54           17232  17263
    DEFB    'E'+080H                    ;682a  c5           17233  17264 
    DEFB    080H                        ;682b  80           17234  17265 ;DEFM 'MA'	;MAT
                                        ;                   17235  17266 ;DEFB	'T'+080H
    DEFM    'MO'                        ;682c  4d 4f        17236  17267 ;MON
    DEFB    'N'+080H                    ;682e  ce           17237  17268 
    DEFM    'HCOP'                      ;682f  48 43 4f 50  17238  17269 ;HCOPY
    DEFB    'Y'+080H                    ;6833  d9           17239  17270 
    DEFM    'KE'                        ;6834  4b 45        17240  17271 ;KEY
    DEFB    'Y'+080H                    ;6836  d9           17241  17272 
    DEFM    'PUS'                       ;6837  50 55 53     17242  17273 ;PUSH
    DEFB    'H'+080H                    ;683a  c8           17243  17274 
    DEFM    'PO'                        ;683b  50 4f        17244  17275 ;POP		C0
    DEFB    'P'+080H                    ;683d  d0           17245  17276 
    DEFB    080H                        ;683e  80           17246  17277 ;DEFM	'BAS'
    DEFM    'LABE'                      ;683f  4c 41 42 45  17247  17278 ;LABEL
    DEFB    'L'+080H                    ;6843  cc           17248  17279 
    DEFB    080H                        ;6844  80           17249  17280 ;DEFM	'RANDOMIZ'
    DEFM    'SCREE'                     ;6845  53 43 52 45  17250  17281 ;SCREEN
                                        ;6849  45           17250  17282
    DEFB    'N'+080H                    ;684a  ce           17251  17283 
    DEFM    'LIN'                       ;684b  4c 49 4e     17252  17284 ;LINE
    DEFB    'E'+080H                    ;684e  c5           17253  17285 
    DEFM    'COLO'                      ;684f  43 4f 4c 4f  17254  17286 ;COLOR
    DEFB    'R'+080H                    ;6853  d2           17255  17287 
    DEFM    'PSE'                       ;6854  50 53 45     17256  17288 ;PSET
    DEFB    'T'+080H                    ;6857  d4           17257  17289 
    DEFM    'PRESE'                     ;6858  50 52 45 53  17258  17290 ;PRESET
                                        ;685c  45           17258  17291
    DEFB    'T'+080H                    ;685d  d4           17259  17292 
    DEFM    'CGINI'                     ;685e  43 47 49 4e  17260  17293 ;CGINIT
                                        ;6862  49           17260  17294
    DEFB    'T'+080H                    ;6863  d4           17261  17295 
    DEFM    'PATTER'                    ;6864  50 41 54 54  17262  17296 ;PATTERN
                                        ;6868  45 52        17262  17297
    DEFB    'N'+080H                    ;686a  ce           17263  17298 
    DEFM    'CIRCL'                     ;686b  43 49 52 43  17264  17299 ;CIRCLE
                                        ;686f  4c           17264  17300
    DEFB    'E'+080H                    ;6870  c5           17265  17301 
    DEFM    'PAIN'                      ;6871  50 41 49 4e  17266  17302 ;PAINT
    DEFB    'T'+080H                    ;6875  d4           17267  17303 
    DEFM    'ROPE'                      ;6876  52 4f 50 45  17268  17304 ;ROPEN
    DEFB    'N'+080H                    ;687a  ce           17269  17305 
    DEFM    'WOPE'                      ;687b  57 4f 50 45  17270  17306 ;WOPEN
    DEFB    'N'+080H                    ;687f  ce           17271  17307 
    DEFM    'CLOS'                      ;6880  43 4c 4f 53  17272  17308 ;CLOSE
    DEFB    'E'+080H                    ;6884  c5           17273  17309 
    DEFB    080H                        ;6885  80           17274  17310 ;DEFM	'FILED'
    DEFB    080H                        ;6886  80           17275  17311 ;DEFM	'GET'
    DEFB    080H                        ;6887  80           17276  17312 ;DEFM	'PUT'
    DEFB    080H                        ;6888  80           17277  17313 ;DEFM	'SET'
    DEFB    080H                        ;6889  80           17278  17314 ;DEFM	'FILES'
    DEFB    080H                        ;688a  80           17279  17315 ;DEFM	'RENAME'
    DEFB    080H                        ;688b  80           17280  17316 ;DEFM	'KILL'
    DEFB    080H                        ;688c  80           17281  17317 ;DEFM	'LSET'
    DEFB    080H                        ;688d  80           17282  17318 ;DEFM	'RSET'
    DEFB    080H                        ;688e  80           17283  17319 ;DEFM	'FORMAT
    DEFB    080H                        ;688f  80           17284  17320 ;DEFM	'INIT'
    DEFB    080H                        ;6890  80           17285  17321 ;EDFM	'CHAIN
    DEFB    080H                        ;6891  80           17286  17322 ;DEFM	'PEN'
    DEFB    080H                        ;6892  80           17287  17323 ;DEFM	'COM'
    DEFB    080H                        ;6893  80           17288  17324 ;DEFM	'PAUSE'
    DEFM    'T'                         ;6894  54           17289  17325 ;TO
    DEFB    'O'+080H                    ;6895  cf           17290  17326 
    DEFM    'STE'                       ;6896  53 54 45     17291  17327 ;STEP
    DEFB    'P'+080H                    ;6899  d0           17292  17328 
    DEFM    'THE'                       ;689a  54 48 45     17293  17329 ;THEN
    DEFB    'N'+080H                    ;689d  ce           17294  17330 
    DEFM    'USIN'                      ;689e  55 53 49 4e  17295  17331 ;USING
    DEFB    'G'+080H                    ;68a2  c7           17296  17332 
    DEFB    080H                        ;68a3  80           17297  17333 
    DEFB    080H                        ;68a4  80           17298  17334 
    DEFB    080H                        ;68a5  80           17299  17335 
    DEFB    080H                        ;68a6  80           17300  17336 
    DEFM    'TA'                        ;68a7  54 41        17301  17337 ;TAB
    DEFB    'B'+080H                    ;68a9  c2           17302  17338 
    DEFM    'SP'                        ;68aa  53 50        17303  17339 ;SPC
    DEFB    'C'+080H                    ;68ac  c3           17304  17340 
    DEFB    080H                        ;68ad  80           17305  17341 
    DEFB    080H                        ;68ae  80           17306  17342 
    DEFM    'XO'                        ;68af  58 4f        17307  17343 ;XOR
    DEFB    'R'+080H                    ;68b1  d2           17308  17344 
    DEFM    'O'                         ;68b2  4f           17309  17345 ;OR
    DEFB    'R'+080H                    ;68b3  d2           17310  17346 
    DEFM    'AN'                        ;68b4  41 4e        17311  17347 ;AND
    DEFB    'D'+080H                    ;68b6  c4           17312  17348 
    DEFM    'NO'                        ;68b7  4e 4f        17313  17349 ;NOT
    DEFB    'T'+080H                    ;68b9  d4           17314  17350 
    DEFB    '>'                         ;68ba  3e           17315  17351 ;><
    DEFB    '<'+080H                    ;68bb  bc           17316  17352 
    DEFB    '<'                         ;68bc  3c           17317  17353 ;<>
    DEFB    '>'+080H                    ;68bd  be           17318  17354 
    DEFM    '='                         ;68be  3d           17319  17355 ;=<
    DEFB    '<'+080H                    ;68bf  bc           17320  17356 
    DEFM    '='                         ;68c0  3d           17321  17357 ;=>
    DEFB    '>'+080H                    ;68c1  be           17322  17358 
    DEFB    '<'                         ;68c2  3c           17323  17359 ;<=
    DEFB    '='+080H                    ;68c3  bd           17324  17360 
    DEFB    '>'                         ;68c4  3e           17325  17361 ;><
    DEFB    '='+080H                    ;68c5  bd           17326  17362 ;=    
    DEFB    '='+080H                    ;68c6  bd           17327  17363 ;=
    DEFB    '>'+080H                    ;68c7  be           17328  17364 ;>
    DEFB    '<'+080H                    ;68c8  bc           17329  17365 ;<
    DEFB    '+'+080H                    ;68c9  ab           17330  17366 ;+
    DEFB    '-'+080H                    ;68ca  ad           17331  17367 ;-
    DEFM    'MO'                        ;68cb  4d 4f        17332  17368 ;MOD
    DEFB    'D'+080H                    ;68cd  c4           17333  17369 
    DEFB    0FCH                        ;68ce  fc           17334  17370 ;\
    DEFB    '/'+080H                    ;68cf  af           17335  17371 ;/
    DEFB    '*'+080H                    ;68d0  aa           17336  17372 ;*
    DEFB    '^'+080H                    ;68d1  de           17337  17373 ;^
    DEFB    0FFH                        ;68d2  ff           17338  17374 ;예약어 끝을 의미하는 DELIMETER
                                        ;                   17339  17375 
CTBL2:                                  ;                   17340  17376 
    DEFM    'IN'                        ;68d3  49 4e        17341  17377 ;81H INT
    DEFB    'T'+080H                    ;68d5  d4           17342  17378 
    DEFM    'AB'                        ;68d6  41 42        17343  17379 ;ABS
    DEFB    'S'+080H                    ;68d8  d3           17344  17380 
    DEFM    'SI'                        ;68d9  53 49        17345  17381 ;SIN
    DEFB    'N'+080H                    ;68db  ce           17346  17382 
    DEFM    'CO'                        ;68dc  43 4f        17347  17383 ;COS
    DEFB    'S'+080H                    ;68de  d3           17348  17384 
    DEFM    'TA'                        ;68df  54 41        17349  17385 ;TAN
    DEFB    'N'+080H                    ;68e1  ce           17350  17386 
    DEFM    'LO'                        ;68e2  4c 4f        17351  17387 ;LOG
    DEFB    'G'+080H                    ;68e4  c7           17352  17388 
    DEFM    'EX'                        ;68e5  45 58        17353  17389 ;EXP
    DEFB    'P'+080H                    ;68e7  d0           17354  17390 
    DEFM    'SQ'                        ;68e8  53 51        17355  17391 ;SQR
    DEFB    'R'+080H                    ;68ea  d2           17356  17392 
    DEFM    'RN'                        ;68eb  52 4e        17357  17393 ;RND
    DEFB    'D'+080H                    ;68ed  c4           17358  17394 
    DEFM    'PEE'                       ;68ee  50 45 45     17359  17395 ;PEEK
    DEFB    'K'+080H                    ;68f1  cb           17360  17396 
    DEFM    'AT'                        ;68f2  41 54        17361  17397 ;ATN
    DEFB    'N'+080H                    ;68f4  ce           17362  17398 
    DEFM    'SG'                        ;68f5  53 47        17363  17399 ;SGN
    DEFB    'N'+080H                    ;68f7  ce           17364  17400 
    DEFM    'FRA'                       ;68f8  46 52 41     17365  17401 ;FRAC
    DEFB    'C'+080H                    ;68fb  c3           17366  17402 
    DEFM    'FI'                        ;68fc  46 49        17367  17403 ;FIX
    DEFB    'X'+080H                    ;68fe  d8           17368  17404 
    DEFM    'PA'                        ;68ff  50 41        17369  17405 ;PAI
    DEFB    'I'+080H                    ;6901  c9           17370  17406 
    DEFM    'RA'                        ;6902  52 41        17371  17407 ;RAD	90H
    DEFB    'D'+080H                    ;6904  c4           17372  17408 
    DEFM    'IN'                        ;6905  49 4e        17373  17409 ;INP
    DEFB    'P'+080H                    ;6907  d0           17374  17410 
    DEFM    'CDB'                       ;6908  43 44 42     17375  17411 ;CDBL
    DEFB    'L'+080H                    ;690b  cc           17376  17412 
    DEFM    'CSN'                       ;690c  43 53 4e     17377  17413 ;CSNG
    DEFB    'G'+080H                    ;690f  c7           17378  17414 
    DEFM    'CIN'                       ;6910  43 49 4e     17379  17415 ;CINT
    DEFB    'T'+080H                    ;6913  d4           17380  17416 
    DEFB    080H                        ;6914  80           17381  17417 ;DEFM	'DSK'	;DSKF
    DEFB    080H                        ;6915  80           17382  17418 ;DEFM	'EO'	;EOF
    DEFB    080H                        ;6916  80           17383  17419 ;DEFM	'FPO'	;FPOS
    DEFB    080H                        ;6917  80           17384  17420 ;DEFM	'LO'	;LOC
    DEFB    080H                        ;6918  80           17385  17421 ;DEFM	'LO'	;LOF
    DEFM    'PO'                        ;6919  50 4f        17386  17422 ;POS
    DEFB    'S'+080H                    ;691b  d3           17387  17423 
    DEFM    'LPO'                       ;691c  4c 50 4f     17388  17424 ;LPOS
    DEFB    'S'+080H                    ;691f  d3           17389  17425 
    DEFM    'FA'                        ;6920  46 41        17390  17426 ;FAC
    DEFB    'C'+080H                    ;6922  c3           17391  17427 
    DEFM    'SU'                        ;6923  53 55        17392  17428 ;SUM
    DEFB    'M'+080H                    ;6925  cd           17393  17429 
    DEFB    080H                        ;6926  80           17394  17430 ;DEFM	'RE'	;REV
    DEFB    080H                        ;6927  80           17395  17431 ;DUMMY
    DEFM    'CHR'                       ;6928  43 48 52     17396  17432 ;CHR$	A0
    DEFB    '$'+080H                    ;692b  a4           17397  17433 
    DEFM    'STR'                       ;692c  53 54 52     17398  17434 ;STR$
    DEFB    '$'+080H                    ;692f  a4           17399  17435 
    DEFM    'HEX'                       ;6930  48 45 58     17400  17436 ;HEX$
    DEFB    '$'+080H                    ;6933  a4           17401  17437 
    DEFM    'OCT'                       ;6934  4f 43 54     17402  17438 ;OCT$
    DEFB    '$'+080H                    ;6937  a4           17403  17439 
    DEFM    'MKI'                       ;6938  4d 4b 49     17404  17440 ;MKI$
    DEFB    '$'+080H                    ;693b  a4           17405  17441 
    DEFM    'MKS'                       ;693c  4d 4b 53     17406  17442 ;MKS$
    DEFB    '$'+080H                    ;693f  a4           17407  17443 
    DEFM    'MKD'                       ;6940  4d 4b 44     17408  17444 ;MKD$
    DEFB    '$'+080H                    ;6943  a4           17409  17445 
    DEFM    'SPACE'                     ;6944  53 50 41 43  17410  17446 ;SPACE$
                                        ;6948  45           17410  17447
    DEFB    '$'+080H                    ;6949  a4           17411  17448 
    DEFB    080H                        ;694a  80           17412  17449 ;DUMMY
    DEFM    'AS'                        ;694b  41 53        17413  17450 ;ASC	A9
    DEFB    'C'+080H                    ;694d  c3           17414  17451 
    DEFM    'LE'                        ;694e  4c 45        17415  17452 ;LEN
    DEFB    'N'+080H                    ;6950  ce           17416  17453 
    DEFM    'VA'                        ;6951  56 41        17417  17454 ;VAL
    DEFB    'L'+080H                    ;6953  cc           17418  17455 
    DEFM    'CV'                        ;6954  43 56        17419  17456 ;CVS
    DEFB    'S'+080H                    ;6956  d3           17420  17457 
    DEFM    'CV'                        ;6957  43 56        17421  17458 ;CVD
    DEFB    'D'+080H                    ;6959  c4           17422  17459 
    DEFM    'CV'                        ;695a  43 56        17423  17460 ;CVI
    DEFB    'I'+080H                    ;695c  c9           17424  17461 
    DEFM    'STA'                       ;695d  53 54 41     17425  17462 ;STAT
    DEFB    'T'+080H                    ;6960  d4           17426  17463 
    DEFM    'PA'                        ;6961  50 41        17427  17464 ;PAR(ITY)	B0H
    DEFB    'R'+080H                    ;6963  d2           17428  17465 
    DEFB    080H                        ;6964  80           17429  17466 ;DUMMY B1H
    DEFM    'LEFT'                      ;6965  4c 45 46 54  17430  17467 ;LEFT$
    DEFB    '$'+080H                    ;6969  a4           17431  17468 
    DEFM    'RIGHT'                     ;696a  52 49 47 48  17432  17469 ;RIGHT$
                                        ;696e  54           17432  17470
    DEFB    '$'+080H                    ;696f  a4           17433  17471 
    DEFM    'MID'                       ;6970  4d 49 44     17434  17472 ;MID$
    DEFB    '$'+080H                    ;6973  a4           17435  17473 
    DEFM    'INKEY'                     ;6974  49 4e 4b 45  17436  17474 ;INKEY$
                                        ;6978  59           17436  17475
    DEFB    '$'+080H                    ;6979  a4           17437  17476 
    DEFM    'INST'                      ;697a  49 4e 53 54  17438  17477 ;INSTR
    DEFB    'R'+080H                    ;697e  d2           17439  17478 
    DEFM    'FR'                        ;697f  46 52        17440  17479 ;FRE
    DEFB    'E'+080H                    ;6981  c5           17441  17480 
    DEFM    'MEM'                       ;6982  4d 45 4d     17442  17481 ;MEM$
    DEFB    '$'+080H                    ;6985  a4           17443  17482 
    DEFM    'SCRN'                      ;6986  53 43 52 4e  17444  17483 ;SCRN$
    DEFB    '$'+080H                    ;698a  a4           17445  17484 
    DEFM    'VARPT'                     ;698b  56 41 52 50  17446  17485 ;VARPTR
                                        ;698f  54           17446  17486
    DEFB    'R'+080H                    ;6990  d2           17447  17487 
    DEFM    'STRING'                    ;6991  53 54 52 49  17448  17488 ;STRING$
                                        ;6995  4e 47        17448  17489
    DEFB    '$'+080H                    ;6997  a4           17449  17490 
    DEFB    080H                        ;6998  80           17450  17491 ;DEFM	'TIME'
    DEFM    'F'                         ;6999  46           17451  17492 ;FN
    DEFB    'N'+080H                    ;699a  ce           17452  17493 
    DEFM    'US'                        ;699b  55 53        17453  17494 ;USR
    DEFB    'R'+080H                    ;699d  d2           17454  17495 
    DEFM    'ER'                        ;699e  45 52        17455  17496 ;ERR
    DEFB    'R'+080H                    ;69a0  d2           17456  17497 
    DEFM    'ER'                        ;69a1  45 52        17457  17498 ;ERL
    DEFB    'L'+080H                    ;69a3  cc           17458  17499 
    DEFM    'CSRLI'                     ;69a4  43 53 52 4c  17459  17500 ;CSRLIN
                                        ;69a8  49           17459  17501
    DEFB    'N'+080H                    ;69a9  ce           17460  17502 
    DEFB    0FFH                        ;69aa  ff           17461  17503 
                                        ;                   17462  17504 ;
FIVEBF: DEFS    6                       ;69ab               17463  17505 
    DEFB    000H                        ;69b1  00           17464  17506 
                                        ;                   17465  17507 ;
                                        ;                   17466  17508 ;	ORG	069B2H
$ERTXT:                                 ;                   17467  17509 
ERRTXT:                                 ;                   17468  17510 
    DEFB    000H                        ;69b2  00           17469  17511 
    DEFM    'NEXT WITHOUT FOR'          ;69b3  4e 45 58 54  17470  17512 
                                        ;69b7  20 57 49 54  17470  17513
                                        ;69bb  48 4f 55 54  17470  17514
                                        ;69bf  20 46 4f 52  17470  17515
                                        ;                   17471  17516 
    DEFB    000H                        ;69c3  00           17472  17517 
    DEFM    'SYNTAX ERROR'              ;69c4  53 59 4e 54  17473  17518 
                                        ;69c8  41 58 20 45  17473  17519
                                        ;69cc  52 52 4f 52  17473  17520
                                        ;                   17474  17521 
    DEFB    000H                        ;69d0  00           17475  17522 
    DEFM    'RETURN WITHOUT GOSUB'      ;69d1  52 45 54 55  17476  17523 
                                        ;69d5  52 4e 20 57  17476  17524
                                        ;69d9  49 54 48 4f  17476  17525
                                        ;69dd  55 54 20 47  17476  17526
                                        ;69e1  4f 53 55 42  17476  17527
                                        ;                   17477  17528 
    DEFB    000H                        ;69e5  00           17478  17529 
    DEFM    'OUT OF DATA'               ;69e6  4f 55 54 20  17479  17530 
                                        ;69ea  4f 46 20 44  17479  17531
                                        ;69ee  41 54 41     17479  17532
                                        ;                   17480  17533 
    DEFB    000H                        ;69f1  00           17481  17534 
    DEFM    'ILLEGAL FUNCTION CALL'     ;69f2  49 4c 4c 45  17482  17535 
                                        ;69f6  47 41 4c 20  17482  17536
                                        ;69fa  46 55 4e 43  17482  17537
                                        ;69fe  54 49 4f 4e  17482  17538
                                        ;6a02  20 43 41 4c  17482  17539
                                        ;6a06  4c           17482  17540
                                        ;                   17483  17541 
    DEFB    000H                        ;6a07  00           17484  17542 
    DEFM    'OVERFLOW'                  ;6a08  4f 56 45 52  17485  17543 
                                        ;6a0c  46 4c 4f 57  17485  17544
                                        ;                   17486  17545 
    DEFB    000H                        ;6a10  00           17487  17546 
    DEFM    'OUT OF MEMORY'             ;6a11  4f 55 54 20  17488  17547 
                                        ;6a15  4f 46 20 4d  17488  17548
                                        ;6a19  45 4d 4f 52  17488  17549
                                        ;6a1d  59           17488  17550
                                        ;                   17489  17551 
    DEFB    000H                        ;6a1e  00           17490  17552 
UDLMES:                                 ;                   17491  17553 
    DEFM    'UNDEFINED LINE NUMBER'     ;6a1f  55 4e 44 45  17492  17554 
                                        ;6a23  46 49 4e 45  17492  17555
                                        ;6a27  44 20 4c 49  17492  17556
                                        ;6a2b  4e 45 20 4e  17492  17557
                                        ;6a2f  55 4d 42 45  17492  17558
                                        ;6a33  52           17492  17559
                                        ;                   17493  17560 
    DEFB    000H                        ;6a34  00           17494  17561 
    DEFM    'SUBSCRIPT OUT OF RANGE'    ;6a35  53 55 42 53  17495  17562 
                                        ;6a39  43 52 49 50  17495  17563
                                        ;6a3d  54 20 4f 55  17495  17564
                                        ;6a41  54 20 4f 46  17495  17565
                                        ;6a45  20 52 41 4e  17495  17566
                                        ;6a49  47 45        17495  17567
                                        ;                   17496  17568 
    DEFB    000H                        ;6a4b  00           17497  17569 
    DEFM    'DUPLICATE DEFINITION'      ;6a4c  44 55 50 4c  17498  17570 
                                        ;6a50  49 43 41 54  17498  17571
                                        ;6a54  45 20 44 45  17498  17572
                                        ;6a58  46 49 4e 49  17498  17573
                                        ;6a5c  54 49 4f 4e  17498  17574
                                        ;                   17499  17575 
    DEFB    000H                        ;6a60  00           17500  17576 
    DEFM    'DIVISION BY ZERO'          ;6a61  44 49 56 49  17501  17577 
                                        ;6a65  53 49 4f 4e  17501  17578
                                        ;6a69  20 42 59 20  17501  17579
                                        ;6a6d  5a 45 52 4f  17501  17580
                                        ;                   17502  17581 
    DEFB    000H                        ;6a71  00           17503  17582 
    DEFM    'ILLEGAL DIRECT'            ;6a72  49 4c 4c 45  17504  17583 
                                        ;6a76  47 41 4c 20  17504  17584
                                        ;6a7a  44 49 52 45  17504  17585
                                        ;6a7e  43 54        17504  17586
                                        ;                   17505  17587 
    DEFB    000H                        ;6a80  00           17506  17588 
    DEFM    'TYPE MISMATCH'             ;6a81  54 59 50 45  17507  17589 
                                        ;6a85  20 4d 49 53  17507  17590
                                        ;6a89  4d 41 54 43  17507  17591
                                        ;6a8d  48           17507  17592
                                        ;                   17508  17593 
    DEFB    000H                        ;6a8e  00           17509  17594 
    DEFM    'HUBASIC'                   ;6a8f  48 55 42 41  17510  17595 
                                        ;6a93  53 49 43     17510  17596
                                        ;                   17511  17597 
    DEFB    000H                        ;6a96  00           17512  17598 
    DEFM    'STRING TOO LONG'           ;6a97  53 54 52 49  17513  17599 
                                        ;6a9b  4e 47 20 54  17513  17600
                                        ;6a9f  4f 4f 20 4c  17513  17601
                                        ;6aa3  4f 4e 47     17513  17602
                                        ;                   17514  17603 
    DEFB    000H                        ;6aa6  00           17515  17604 
    DEFM    'EXPRESSION TOO COMPLEX'    ;6aa7  45 58 50 52  17516  17605 
                                        ;6aab  45 53 53 49  17516  17606
                                        ;6aaf  4f 4e 20 54  17516  17607
                                        ;6ab3  4f 4f 20 43  17516  17608
                                        ;6ab7  4f 4d 50 4c  17516  17609
                                        ;6abb  45 58        17516  17610
                                        ;                   17517  17611 
    DEFB    000H                        ;6abd  00           17518  17612 
    DEFM    'CAN\'T CONTINUE'           ;6abe  43 41 4e 27  17519  17613 
                                        ;6ac2  54 20 43 4f  17519  17614
                                        ;6ac6  4e 54 49 4e  17519  17615
                                        ;6aca  55 45        17519  17616
                                        ;                   17520  17617 
    DEFB    000H                        ;6acc  00           17521  17618 
    DEFM    'UNDEFINED USER FUNCTION'   ;6acd  55 4e 44 45  17522  17619 
                                        ;6ad1  46 49 4e 45  17522  17620
                                        ;6ad5  44 20 55 53  17522  17621
                                        ;6ad9  45 52 20 46  17522  17622
                                        ;6add  55 4e 43 54  17522  17623
                                        ;6ae1  49 4f 4e     17522  17624
                                        ;                   17523  17625 
    DEFB    000H                        ;6ae4  00           17524  17626 
    DEFM    'NO RESUME'                 ;6ae5  4e 4f 20 52  17525  17627 
                                        ;6ae9  45 53 55 4d  17525  17628
                                        ;6aed  45           17525  17629
                                        ;                   17526  17630 
    DEFB    000H                        ;6aee  00           17527  17631 
    DEFM    'RESUME WITHOUT ERROR'      ;6aef  52 45 53 55  17528  17632 
                                        ;6af3  4d 45 20 57  17528  17633
                                        ;6af7  49 54 48 4f  17528  17634
                                        ;6afb  55 54 20 45  17528  17635
                                        ;6aff  52 52 4f 52  17528  17636
                                        ;                   17529  17637 
    DEFB    000H                        ;6b03  00           17530  17638 
    DEFM    'FORMAT OVER'               ;6b04  46 4f 52 4d  17531  17639 
                                        ;6b08  41 54 20 4f  17531  17640
                                        ;6b0c  56 45 52     17531  17641
                                        ;                   17532  17642 
    DEFB    000H                        ;6b0f  00           17533  17643 
    DEFM    'MISSING OPERAND'           ;6b10  4d 49 53 53  17534  17644 
                                        ;6b14  49 4e 47 20  17534  17645
                                        ;6b18  4f 50 45 52  17534  17646
                                        ;6b1c  41 4e 44     17534  17647
                                        ;                   17535  17648 
    DEFB    000H                        ;6b1f  00           17536  17649 
    DEFM    'REPEAT WITHOUT UNTIL'      ;6b20  52 45 50 45  17537  17650 
                                        ;6b24  41 54 20 57  17537  17651
                                        ;6b28  49 54 48 4f  17537  17652
                                        ;6b2c  55 54 20 55  17537  17653
                                        ;6b30  4e 54 49 4c  17537  17654
                                        ;                   17538  17655 
    DEFB    000H                        ;6b34  00           17539  17656 
    DEFM    'UNTIL WITHOUT REPEAT'      ;6b35  55 4e 54 49  17540  17657 
                                        ;6b39  4c 20 57 49  17540  17658
                                        ;6b3d  54 48 4f 55  17540  17659
                                        ;6b41  54 20 52 45  17540  17660
                                        ;6b45  50 45 41 54  17540  17661
                                        ;                   17541  17662 
    DEFB    000H                        ;6b49  00           17542  17663 
    DEFM    'WHILE WITHOUT WEND'        ;6b4a  57 48 49 4c  17543  17664 
                                        ;6b4e  45 20 57 49  17543  17665
                                        ;6b52  54 48 4f 55  17543  17666
                                        ;6b56  54 20 57 45  17543  17667
                                        ;6b5a  4e 44        17543  17668
                                        ;                   17544  17669 
    DEFB    000H                        ;6b5c  00           17545  17670 
    DEFM    'WEND WITHOUT WHILE'        ;6b5d  57 45 4e 44  17546  17671 
                                        ;6b61  20 57 49 54  17546  17672
                                        ;6b65  48 4f 55 54  17546  17673
                                        ;6b69  20 57 48 49  17546  17674
                                        ;6b6d  4c 45        17546  17675
                                        ;                   17547  17676 
    DEFB    000H                        ;6b6f  00           17548  17677 
    DEFM    'TAPE READ ERROR'           ;6b70  54 41 50 45  17549  17678 
                                        ;6b74  20 52 45 41  17549  17679
                                        ;6b78  44 20 45 52  17549  17680
                                        ;6b7c  52 4f 52     17549  17681
                                        ;                   17550  17682 
    DEFB    000H                        ;6b7f  00           17551  17683 
    DEFM    'DEVICE UNAVAILABLE'        ;6b80  44 45 56 49  17552  17684 
                                        ;6b84  43 45 20 55  17552  17685
                                        ;6b88  4e 41 56 41  17552  17686
                                        ;6b8c  49 4c 41 42  17552  17687
                                        ;6b90  4c 45        17552  17688
                                        ;                   17553  17689 
    DEFB    000H                        ;6b92  00           17554  17690 
    DEFM    'STATEMENT NOT INSTALL'     ;6b93  53 54 41 54  17555  17691 
                                        ;6b97  45 4d 45 4e  17555  17692
                                        ;6b9b  54 20 4e 4f  17555  17693
                                        ;6b9f  54 20 49 4e  17555  17694
                                        ;6ba3  53 54 41 4c  17555  17695
                                        ;6ba7  4c           17555  17696
                                        ;                   17556  17697 
    DEFB    000H                        ;6ba8  00           17557  17698 
    DEFM    'STACK EMPTY'               ;6ba9  53 54 41 43  17558  17699 
                                        ;6bad  4b 20 45 4d  17558  17700
                                        ;6bb1  50 54 59     17558  17701
                                        ;                   17559  17702 
    DEFB    000H                        ;6bb4  00           17560  17703 
    DEFM    'FILE ERROR'                ;6bb5  46 49 4c 45  17561  17704 
                                        ;6bb9  20 45 52 52  17561  17705
                                        ;6bbd  4f 52        17561  17706
                                        ;                   17562  17707 
    DEFB    000H                        ;6bbf  00           17563  17708 
                                        ;                   17564  17709 
                                        ;                   17565  17710 ;	ORG	06BC0h
$FLOAT:                                 ;                   17566  17711 
B_ABS:                                  ;                   17567  17712 
RESNHL: INC HL                          ;6bc0  23           17568  17713 
    RES 7,(HL)                          ;6bc1  cb be        17569  17714 
    DEC HL                              ;6bc3  2b           17570  17715 
    RET                                 ;6bc4  c9           17571  17716 
                                        ;                   17572  17717 ;
STROMT: LD  A,(IY+0)                    ;6bc5  fd 7e 00     17573  17718 
    CP  003h                            ;6bc8  fe 03        17574  17719 
    JP  Z,TYPEMS                        ;6bca  ca 32 17     17575  17720 
    RET                                 ;6bcd  c9           17576  17721 
                                        ;                   17577  17722 ;
ONESUB: LD  DE,FLONE                    ;6bce  11 98 62     17578  17723 
SUB:    CALL    STROMT                  ;6bd1  cd c5 6b     17579  17724 
    CALL    TOGLE                       ;6bd4  cd eb 6b     17580  17725 
    CALL    ADD                         ;6bd7  cd a6 6c     17581  17726 
    PUSH    AF                          ;6bda  f5           17582  17727 
    CALL    TOGLE                       ;6bdb  cd eb 6b     17583  17728 
    XOR A                               ;6bde  af           17584  17729 
    CP  (HL)                            ;6bdf  be           17585  17730 
    JR  Z,ZERO3                         ;6be0  28 03        17586  17731 
    POP AF                              ;6be2  f1           17587  17732 
    CCF                                 ;6be3  3f           17588  17733 
    RET                                 ;6be4  c9           17589  17734 
                                        ;                   17590  17735 ;
ZERO3:  POP AF                          ;6be5  f1           17591  17736 
    XOR A                               ;6be6  af           17592  17737 
    INC HL                              ;6be7  23           17593  17738 
    LD  (HL),A                          ;6be8  77           17594  17739 
    DEC HL                              ;6be9  2b           17595  17740 
    RET                                 ;6bea  c9           17596  17741 
                                        ;                   17597  17742 
TOGLE:  INC HL                          ;6beb  23           17598  17743 
    LD  A,(HL)                          ;6bec  7e           17599  17744 
    XOR 080h                            ;6bed  ee 80        17600  17745 
    LD  (HL),A                          ;6bef  77           17601  17746 
    DEC HL                              ;6bf0  2b           17602  17747 
    RET                                 ;6bf1  c9           17603  17748 
                                        ;                   17604  17749 ;
CONDM': PUSH    HL                      ;6bf2  e5           17605  17750 
    PUSH    DE                          ;6bf3  d5           17606  17751 
    JR  MIDCMZ                          ;6bf4  18 0f        17607  17752 
                                        ;                   17608  17753 ;
CONDMZ: PUSH    HL                      ;6bf6  e5           17609  17754 
    PUSH    DE                          ;6bf7  d5           17610  17755 
    LD  E,(HL)                          ;6bf8  5e           17611  17756 
    INC HL                              ;6bf9  23           17612  17757 
    LD  D,(HL)                          ;6bfa  56           17613  17758 
    INC HL                              ;6bfb  23           17614  17759 
    OR  A                               ;6bfc  b7           17615  17760 
    SBC HL,DE                           ;6bfd  ed 52        17616  17761 
    JR  Z,MTCHPO                        ;6bff  28 03        17617  17762 
RTCDMZ: POP DE                          ;6c01  d1           17618  17763 
    POP HL                              ;6c02  e1           17619  17764 
    RET                                 ;6c03  c9           17620  17765 
                                        ;                   17621  17766 ;
MTCHPO: EX  DE,HL                       ;6c04  eb           17622  17767 
MIDCMZ: LD  A,(HL)                      ;6c05  7e           17623  17768 
    OR  A                               ;6c06  b7           17624  17769 
    JR  Z,RTCDMZ                        ;6c07  28 f8        17625  17770 
    INC HL                              ;6c09  23           17626  17771 
    LD  E,(HL)                          ;6c0a  5e           17627  17772 
    INC HL                              ;6c0b  23           17628  17773 
    LD  D,(HL)                          ;6c0c  56           17629  17774 
    LD  HL,(STRTOP)                     ;6c0d  2a 41 7a     17630  17775 
    SBC HL,DE                           ;6c10  ed 52        17631  17776 
    JR  NC,RTCDMZ                       ;6c12  30 ed        17632  17777 
    EX  DE,HL                           ;6c14  eb           17633  17778 
    DEC HL                              ;6c15  2b           17634  17779 
    LD  (HL),0                          ;6c16  36 00        17635  17780 
    DEC HL                              ;6c18  2b           17636  17781 
    LD  (HL),A                          ;6c19  77           17637  17782 
    POP DE                              ;6c1a  d1           17638  17783 
    POP HL                              ;6c1b  e1           17639  17784 
    RET                                 ;6c1c  c9           17640  17785 
                                        ;                   17641  17786 ;
STROVF: LD  A,15                        ;6c1d  3e 0f        17642  17787 
    JP  ERROR                           ;6c1f  c3 96 21     17643  17788 
                                        ;                   17644  17789 ;
STRADE: POP DE                          ;6c22  d1           17645  17790 
    POP HL                              ;6c23  e1           17646  17791 
    CALL    CONDMZ                      ;6c24  cd f6 6b     17647  17792 
    PUSH    HL                          ;6c27  e5           17648  17793 
    PUSH    DE                          ;6c28  d5           17649  17794 
    LD  HL,ZFAC                         ;6c29  21 f2 62     17650  17795 
    CALL    LDIR8                       ;6c2c  cd a6 73     17651  17796 
    POP HL                              ;6c2f  e1           17652  17797 
    PUSH    HL                          ;6c30  e5           17653  17798 
    LD  E,L                             ;6c31  5d           17654  17799 
    LD  D,H                             ;6c32  54           17655  17800 
    INC DE                              ;6c33  13           17656  17801 
    INC DE                              ;6c34  13           17657  17802 
    LD  (HL),E                          ;6c35  73           17658  17803 
    INC HL                              ;6c36  23           17659  17804 
    LD  (HL),D                          ;6c37  72           17660  17805 
    EX  DE,HL                           ;6c38  eb           17661  17806 
    INC HL                              ;6c39  23           17662  17807 
    LD  E,(HL)                          ;6c3a  5e           17663  17808 
    INC HL                              ;6c3b  23           17664  17809 
    LD  D,(HL)                          ;6c3c  56           17665  17810 
    DEC HL                              ;6c3d  2b           17666  17811 
    DEC HL                              ;6c3e  2b           17667  17812 
    EX  DE,HL                           ;6c3f  eb           17668  17813 
    DEC HL                              ;6c40  2b           17669  17814 
    LD  (HL),D                          ;6c41  72           17670  17815 
    DEC HL                              ;6c42  2b           17671  17816 
    LD  (HL),E                          ;6c43  73           17672  17817 
SRADE': POP HL                          ;6c44  e1           17673  17818 
    POP DE                              ;6c45  d1           17674  17819 
    RET                                 ;6c46  c9           17675  17820 
                                        ;                   17676  17821 ;
STRADD: PUSH    DE                      ;6c47  d5           17677  17822 
    PUSH    HL                          ;6c48  e5           17678  17823 
    LD  C,(HL)                          ;6c49  4e           17679  17824 
    INC HL                              ;6c4a  23           17680  17825 
    LD  B,(HL)                          ;6c4b  46           17681  17826 
    EX  DE,HL                           ;6c4c  eb           17682  17827 
    LD  E,(HL)                          ;6c4d  5e           17683  17828 
    INC HL                              ;6c4e  23           17684  17829 
    LD  D,(HL)                          ;6c4f  56           17685  17830 
    LD  L,C                             ;6c50  69           17686  17831 
    LD  H,B                             ;6c51  60           17687  17832 
    LD  A,(HL)                          ;6c52  7e           17688  17833 
    EX  AF,AF'                          ;6c53  08           17689  17834 
    LD  A,(DE)                          ;6c54  1a           17690  17835 
    ADD A,(HL)                          ;6c55  86           17691  17836 
    JR  C,STROVF                        ;6c56  38 c5        17692  17837 
    JR  Z,SRADE'                        ;6c58  28 ea        17693  17838 
    LD  HL,ZFAC                         ;6c5a  21 f2 62     17694  17839 
    CALL    CLRFAC                      ;6c5d  cd a9 28     17695  17840 
    PUSH    HL                          ;6c60  e5           17696  17841 
    PUSH    DE                          ;6c61  d5           17697  17842 
    LD  E,L                             ;6c62  5d           17698  17843 
    LD  D,H                             ;6c63  54           17699  17844 
    INC HL                              ;6c64  23           17700  17845 
    INC HL                              ;6c65  23           17701  17846 
    EX  DE,HL                           ;6c66  eb           17702  17847 
    LD  (HL),E                          ;6c67  73           17703  17848 
    INC HL                              ;6c68  23           17704  17849 
    LD  (HL),D                          ;6c69  72           17705  17850 
    EX  DE,HL                           ;6c6a  eb           17706  17851 
    LD  (HL),A                          ;6c6b  77           17707  17852 
    LD  E,L                             ;6c6c  5d           17708  17853 
    LD  D,H                             ;6c6d  54           17709  17854 
    EX  AF,AF'                          ;6c6e  08           17710  17855 
    PUSH    AF                          ;6c6f  f5           17711  17856 
    CALL    GETSTR                      ;6c70  cd 9e 2d     17712  17857 
    INC HL                              ;6c73  23           17713  17858 
    LD  A,(HL)                          ;6c74  7e           17714  17859 
    INC HL                              ;6c75  23           17715  17860 
    LD  H,(HL)                          ;6c76  66           17716  17861 
    LD  L,A                             ;6c77  6f           17717  17862 
    INC BC                              ;6c78  03           17718  17863 
    LD  A,(BC)                          ;6c79  0a           17719  17864 
    LD  E,A                             ;6c7a  5f           17720  17865 
    INC BC                              ;6c7b  03           17721  17866 
    LD  A,(BC)                          ;6c7c  0a           17722  17867 
    LD  D,A                             ;6c7d  57           17723  17868 
    POP AF                              ;6c7e  f1           17724  17869 
    OR  A                               ;6c7f  b7           17725  17870 
    JR  Z,NXTADS                        ;6c80  28 07        17726  17871 
    LD  B,A                             ;6c82  47           17727  17872 
FSTTRL: LD  A,(DE)                      ;6c83  1a           17728  17873 
    LD  (HL),A                          ;6c84  77           17729  17874 
    INC HL                              ;6c85  23           17730  17875 
    INC DE                              ;6c86  13           17731  17876 
    DJNZ    FSTTRL                      ;6c87  10 fa        17732  17877 
NXTADS: POP BC                          ;6c89  c1           17733  17878 
    LD  A,(BC)                          ;6c8a  0a           17734  17879 
    EX  AF,AF'                          ;6c8b  08           17735  17880 
    INC BC                              ;6c8c  03           17736  17881 
    LD  A,(BC)                          ;6c8d  0a           17737  17882 
    LD  E,A                             ;6c8e  5f           17738  17883 
    INC BC                              ;6c8f  03           17739  17884 
    LD  A,(BC)                          ;6c90  0a           17740  17885 
    LD  D,A                             ;6c91  57           17741  17886 
    EX  AF,AF'                          ;6c92  08           17742  17887 
    OR  A                               ;6c93  b7           17743  17888 
    JR  Z,STRADS                        ;6c94  28 07        17744  17889 
    LD  B,A                             ;6c96  47           17745  17890 
SNDTRL: LD  A,(DE)                      ;6c97  1a           17746  17891 
    LD  (HL),A                          ;6c98  77           17747  17892 
    INC HL                              ;6c99  23           17748  17893 
    INC DE                              ;6c9a  13           17749  17894 
    DJNZ    SNDTRL                      ;6c9b  10 fa        17750  17895 
STRADS: POP DE                          ;6c9d  d1           17751  17896 
    POP HL                              ;6c9e  e1           17752  17897 
    PUSH    HL                          ;6c9f  e5           17753  17898 
    CALL    CONDMZ                      ;6ca0  cd f6 6b     17754  17899 
    JP  STRADE                          ;6ca3  c3 22 6c     17755  17900 
                                        ;                   17756  17901 ;
ADD:    LD  A,(IY+0)                    ;6ca6  fd 7e 00     17757  17902 
    CP  003h                            ;6ca9  fe 03        17758  17903 
    JR  Z,STRADD                        ;6cab  28 9a        17759  17904 
    PUSH    DE                          ;6cad  d5           17760  17905 
    PUSH    HL                          ;6cae  e5           17761  17906 
    INC HL                              ;6caf  23           17762  17907 
    LD  A,(HL)                          ;6cb0  7e           17763  17908 
    RLCA                                ;6cb1  07           17764  17909 
    JR  C,HMINS                         ;6cb2  38 0f        17765  17910 
    INC DE                              ;6cb4  13           17766  17911 
    LD  A,(DE)                          ;6cb5  1a           17767  17912 
    RLCA                                ;6cb6  07           17768  17913 
    JR  C,DMINS                         ;6cb7  38 2e        17769  17914 
    DEC DE                              ;6cb9  1b           17770  17915 
    DEC HL                              ;6cba  2b           17771  17916 
    CALL    FADD                        ;6cbb  cd fc 6c     17772  17917 
    POP HL                              ;6cbe  e1           17773  17918 
    POP DE                              ;6cbf  d1           17774  17919 
    JP  RESNHL                          ;6cc0  c3 c0 6b     17775  17920 
                                        ;                   17776  17921 ;
HMINS:  LD  A,(DE)                      ;6cc3  1a           17777  17922 
    OR  A                               ;6cc4  b7           17778  17923 
    JR  Z,MINCR                         ;6cc5  28 0a        17779  17924 
    INC DE                              ;6cc7  13           17780  17925 
    LD  A,(DE)                          ;6cc8  1a           17781  17926 
    RLCA                                ;6cc9  07           17782  17927 
    JR  NC,HMDP                         ;6cca  30 0f        17783  17928 
    DEC DE                              ;6ccc  1b           17784  17929 
    DEC HL                              ;6ccd  2b           17785  17930 
    CALL    FADD                        ;6cce  cd fc 6c     17786  17931 
MINCR:  POP HL                          ;6cd1  e1           17787  17932 
    INC HL                              ;6cd2  23           17788  17933 
    LD  A,(HL)                          ;6cd3  7e           17789  17934 
    DEC HL                              ;6cd4  2b           17790  17935 
    OR  A                               ;6cd5  b7           17791  17936 
    JR  Z,MZRT                          ;6cd6  28 01        17792  17937 
    SCF                                 ;6cd8  37           17793  17938 
MZRT:   POP DE                          ;6cd9  d1           17794  17939 
    RET                                 ;6cda  c9           17795  17940 
                                        ;                   17796  17941 ;
HMDP:   DEC DE                          ;6cdb  1b           17797  17942 
    DEC HL                              ;6cdc  2b           17798  17943 
    CALL    FSUB                        ;6cdd  cd 04 6e     17799  17944 
    POP HL                              ;6ce0  e1           17800  17945 
    JR  C,MZRT                          ;6ce1  38 f6        17801  17946 
    POP DE                              ;6ce3  d1           17802  17947 
    JP  RESNHL                          ;6ce4  c3 c0 6b     17803  17948 
                                        ;                   17804  17949 ;
DMINS:  DEC DE                          ;6ce7  1b           17805  17950 
    DEC HL                              ;6ce8  2b           17806  17951 
    CALL    FSUB                        ;6ce9  cd 04 6e     17807  17952 
    POP HL                              ;6cec  e1           17808  17953 
    JR  NC,OKM                          ;6ced  30 06        17809  17954 
    CALL    RESNHL                      ;6cef  cd c0 6b     17810  17955 
ZRO:    POP DE                          ;6cf2  d1           17811  17956 
    OR  A                               ;6cf3  b7           17812  17957 
    RET                                 ;6cf4  c9           17813  17958 
                                        ;                   17814  17959 
OKM:    XOR A                           ;6cf5  af           17815  17960 
    CP  (HL)                            ;6cf6  be           17816  17961 
    JR  Z,ZRO                           ;6cf7  28 f9        17817  17962 
    POP DE                              ;6cf9  d1           17818  17963 
    SCF                                 ;6cfa  37           17819  17964 
    RET                                 ;6cfb  c9           17820  17965 
                                        ;                   17821  17966 ;
FADD:   LD  A,0B7h                      ;6cfc  3e b7        17822  17967 
    LD  (INST1),A                       ;6cfe  32 7c 6d     17823  17968 
    BIT 2,(IY+0)                        ;6d01  fd cb 00 56  17824  17969 
    JP  NZ,SFADD                        ;6d05  c2 ea 6e     17825  17970 
    XOR A                               ;6d08  af           17826  17971 
    CP  (HL)                            ;6d09  be           17827  17972 
    JP  Z,TRANS                         ;6d0a  ca cf 6e     17828  17973 
    LD  A,(DE)                          ;6d0d  1a           17829  17974 
    OR  A                               ;6d0e  b7           17830  17975 
    RET Z                               ;6d0f  c8           17831  17976 
    SUB (HL)                            ;6d10  96           17832  17977 
    JR  NC,ANSHIF                       ;6d11  30 0b        17833  17978 
    NEG                                 ;6d13  ed 44        17834  17979 
    CP  56                              ;6d15  fe 38        17835  17980 
    RET NC                              ;6d17  d0           17836  17981 
    LD  (HLBUF),HL                      ;6d18  22 6a 6d     17837  17982 
    EX  DE,HL                           ;6d1b  eb           17838  17983 
    JR  FADDS                           ;6d1c  18 08        17839  17984 
ANSHIF: CP  56                          ;6d1e  fe 38        17840  17985 
    JP  NC,TRANS                        ;6d20  d2 cf 6e     17841  17986 
    LD  (HLBUF),HL                      ;6d23  22 6a 6d     17842  17987 
FADDS:  CALL    FADD1                   ;6d26  cd 7f 6d     17843  17988 
    PUSH    IX                          ;6d29  dd e5        17844  17989 
    EX  (SP),HL                         ;6d2b  e3           17845  17990 
    LD  A,D                             ;6d2c  7a           17846  17991 
    ADD A,H                             ;6d2d  84           17847  17992 
    LD  D,A                             ;6d2e  57           17848  17993 
    LD  A,L                             ;6d2f  7d           17849  17994 
    ADC A,E                             ;6d30  8b           17850  17995 
    LD  E,A                             ;6d31  5f           17851  17996 
    POP HL                              ;6d32  e1           17852  17997 
    LD  A,B                             ;6d33  78           17853  17998 
    EXX                                 ;6d34  d9           17854  17999 
    ADC A,B                             ;6d35  88           17855  18000 
    EXX                                 ;6d36  d9           17856  18001 
    LD  B,A                             ;6d37  47           17857  18002 
    LD  A,C                             ;6d38  79           17858  18003 
    EXX                                 ;6d39  d9           17859  18004 
    ADC A,C                             ;6d3a  89           17860  18005 
    EXX                                 ;6d3b  d9           17861  18006 
    LD  C,A                             ;6d3c  4f           17862  18007 
    LD  A,H                             ;6d3d  7c           17863  18008 
    EXX                                 ;6d3e  d9           17864  18009 
    ADC A,H                             ;6d3f  8c           17865  18010 
    EXX                                 ;6d40  d9           17866  18011 
    LD  H,A                             ;6d41  67           17867  18012 
    LD  A,L                             ;6d42  7d           17868  18013 
    EXX                                 ;6d43  d9           17869  18014 
    ADC A,L                             ;6d44  8d           17870  18015 
    EXX                                 ;6d45  d9           17871  18016 
    LD  L,A                             ;6d46  6f           17872  18017 
    EXX                                 ;6d47  d9           17873  18018 
    EX  AF,AF'                          ;6d48  08           17874  18019 
    LD  B,A                             ;6d49  47           17875  18020 
    EX  AF,AF'                          ;6d4a  08           17876  18021 
    LD  A,B                             ;6d4b  78           17877  18022 
    ADC A,D                             ;6d4c  8a           17878  18023 
    LD  D,A                             ;6d4d  57           17879  18024 
    JP  NC,STORE1                       ;6d4e  d2 66 6d     17880  18025 
    INC E                               ;6d51  1c           17881  18026 
    JP  Z,OVERFL1                       ;6d52  ca e4 6e     17882  18027 
    EXX                                 ;6d55  d9           17883  18028 
    SCF                                 ;6d56  37           17884  18029 
    RRA                                 ;6d57  1f           17885  18030 
    RR  L                               ;6d58  cb 1d        17886  18031 
    RR  H                               ;6d5a  cb 1c        17887  18032 
    RR  C                               ;6d5c  cb 19        17888  18033 
    RR  B                               ;6d5e  cb 18        17889  18034 
    RR  E                               ;6d60  cb 1b        17890  18035 
    RR  D                               ;6d62  cb 1a        17891  18036 
    EXX                                 ;6d64  d9           17892  18037 
    LD  D,A                             ;6d65  57           17893  18038 
STORE1: LD  BC,00008h                   ;6d66  01 08 00     17894  18039 
    DEFB    021H                        ;6d69  21           17895  18040 ;LD HL,?
HLBUF:  DEFS    2                       ;6d6a               17896  18041 
    ADD HL,BC                           ;6d6c  09           17897  18042 
    LD  (SPBF),SP                       ;6d6d  ed 73 5b 70  17898  18043 
    LD  SP,HL                           ;6d71  f9           17899  18044 
    EXX                                 ;6d72  d9           17900  18045 
    PUSH    DE                          ;6d73  d5           17901  18046 
    PUSH    BC                          ;6d74  c5           17902  18047 
    PUSH    HL                          ;6d75  e5           17903  18048 
    EXX                                 ;6d76  d9           17904  18049 
    PUSH    DE                          ;6d77  d5           17905  18050 
FLEXIT: LD  SP,(SPBF)                   ;6d78  ed 7b 5b 70  17906  18051 
INST1:  DEFS    1                       ;6d7c               17907  18052 
    EI                                  ;6d7d  fb           17908  18053 
    RET                                 ;6d7e  c9           17909  18054 
                                        ;                   17910  18055 ;
FADD1:  DI                              ;6d7f  f3           17911  18056 
    LD  (SPBF),SP                       ;6d80  ed 73 5b 70  17912  18057 
    LD  C,A                             ;6d84  4f           17913  18058 
    AND 007h                            ;6d85  e6 07        17914  18059 
    INC A                               ;6d87  3c           17915  18060 
    LD  B,A                             ;6d88  47           17916  18061 
    LD  A,C                             ;6d89  79           17917  18062 
    AND 038h                            ;6d8a  e6 38        17918  18063 
    LD  (JPVEC),A                       ;6d8c  32 99 6d     17919  18064 
    LD  SP,HL                           ;6d8f  f9           17920  18065 
    EX  AF,AF'                          ;6d90  08           17921  18066 
    EXX                                 ;6d91  d9           17922  18067 
    POP AF                              ;6d92  f1           17923  18068 
    SET 7,A                             ;6d93  cb ff        17924  18069 
    POP HL                              ;6d95  e1           17925  18070 
    POP BC                              ;6d96  c1           17926  18071 
    POP DE                              ;6d97  d1           17927  18072 
    DEFB    018H                        ;6d98  18           17928  18073 ;JR ?
JPVEC:  DEFS    1                       ;6d99               17929  18074 
    JP  CLR1                            ;6d9a  c3 d1 6d     17930  18075 
FADDL1: XOR A                           ;6d9d  af           17931  18076 
    JP  CLR1                            ;6d9e  c3 d1 6d     17932  18077 
    DEFB    000H                        ;6da1  00           17933  18078 
    LD  D,E                             ;6da2  53           17934  18079 
    LD  E,B                             ;6da3  58           17935  18080 
    LD  B,C                             ;6da4  41           17936  18081 
    LD  C,H                             ;6da5  4c           17937  18082 
    LD  H,L                             ;6da6  65           17938  18083 
    LD  L,A                             ;6da7  6f           17939  18084 
    JR  FADDL1                          ;6da8  18 f3        17940  18085 
    LD  D,B                             ;6daa  50           17941  18086 
    LD  E,C                             ;6dab  59           17942  18087 
    LD  B,H                             ;6dac  44           17943  18088 
    LD  C,L                             ;6dad  4d           17944  18089 
    LD  H,A                             ;6dae  67           17945  18090 
    XOR A                               ;6daf  af           17946  18091 
    JR  CLR2$                           ;6db0  18 1e        17947  18092 
    LD  D,C                             ;6db2  51           17948  18093 
    LD  E,H                             ;6db3  5c           17949  18094 
    LD  B,L                             ;6db4  45           17950  18095 
    LD  C,A                             ;6db5  4f           17951  18096 
    XOR A                               ;6db6  af           17952  18097 
    JP  CLR3                            ;6db7  c3 cf 6d     17953  18098 
    LD  D,H                             ;6dba  54           17954  18099 
    LD  E,L                             ;6dbb  5d           17955  18100 
    LD  B,A                             ;6dbc  47           17956  18101 
    XOR A                               ;6dbd  af           17957  18102 
    JP  CLR4                            ;6dbe  c3 ce 6d     17958  18103 
    DEFB    000H                        ;6dc1  00           17959  18104 
    LD  D,L                             ;6dc2  55           17960  18105 
    LD  E,A                             ;6dc3  5f           17961  18106 
    XOR A                               ;6dc4  af           17962  18107 
    JP  CLR5                            ;6dc5  c3 cd 6d     17963  18108 
    DEFW    0                           ;6dc8  00 00        17964  18109 
    LD  D,A                             ;6dca  57           17965  18110 
    XOR A                               ;6dcb  af           17966  18111 
    LD  E,A                             ;6dcc  5f           17967  18112 
CLR5:   LD  B,A                         ;6dcd  47           17968  18113 
CLR4:   LD  C,A                         ;6dce  4f           17969  18114 
CLR3:   LD  H,A                         ;6dcf  67           17970  18115 
CLR2$:  LD  L,A                         ;6dd0  6f           17971  18116 
CLR1:   EX  AF,AF'                      ;6dd1  08           17972  18117 
    RRCA                                ;6dd2  0f           17973  18118 
    RRCA                                ;6dd3  0f           17974  18119 
    ADD A,0EBh                          ;6dd4  c6 eb        17975  18120 
    LD  (JPVEC2),A                      ;6dd6  32 f1 6d     17976  18121 
    EX  AF,AF'                          ;6dd9  08           17977  18122 
    JP  SHIFST                          ;6dda  c3 eb 6d     17978  18123 
    OR  A                               ;6ddd  b7           17979  18124 
    RRA                                 ;6dde  1f           17980  18125 
    RR  L                               ;6ddf  cb 1d        17981  18126 
    RR  H                               ;6de1  cb 1c        17982  18127 
    RR  C                               ;6de3  cb 19        17983  18128 
    RR  B                               ;6de5  cb 18        17984  18129 
    RR  E                               ;6de7  cb 1b        17985  18130 
    RR  D                               ;6de9  cb 1a        17986  18131 
SHIFST: EXX                             ;6deb  d9           17987  18132 
    SCF                                 ;6dec  37           17988  18133 
    CCF                                 ;6ded  3f           17989  18134 
    DEC B                               ;6dee  05           17990  18135 
    EXX                                 ;6def  d9           17991  18136 
    DEFB    020H                        ;6df0  20           17992  18137 ;JR NZ,?
JPVEC2: DEFS    1                       ;6df1               17993  18138 
    EXX                                 ;6df2  d9           17994  18139 
    EX  DE,HL                           ;6df3  eb           17995  18140 
    LD  SP,HL                           ;6df4  f9           17996  18141 
    POP DE                              ;6df5  d1           17997  18142 
    SET 7,D                             ;6df6  cb fa        17998  18143 
    POP HL                              ;6df8  e1           17999  18144 
    POP BC                              ;6df9  c1           18000  18145 
    POP IX                              ;6dfa  dd e1        18001  18146 
    LD  SP,(SPBF)                       ;6dfc  ed 7b 5b 70  18002  18147 
    EXX                                 ;6e00  d9           18003  18148 
    SCF                                 ;6e01  37           18004  18149 
    EX  AF,AF'                          ;6e02  08           18005  18150 
    RET                                 ;6e03  c9           18006  18151 
                                        ;                   18007  18152 ;
FSUB:   BIT 3,(IY+0)                    ;6e04  fd cb 00 5e  18008  18153 
    JP  Z,SSUB                          ;6e08  ca 83 6f     18009  18154 
FSUB1:  XOR A                           ;6e0b  af           18010  18155 
    CP  (HL)                            ;6e0c  be           18011  18156 
    JP  Z,NEGTIV                        ;6e0d  ca ce 6e     18012  18157 
    LD  A,(DE)                          ;6e10  1a           18013  18158 
    OR  A                               ;6e11  b7           18014  18159 
    RET Z                               ;6e12  c8           18015  18160 
    SUB (HL)                            ;6e13  96           18016  18161 
    JR  NC,SNSHIF                       ;6e14  30 0f        18017  18162 
    NEG                                 ;6e16  ed 44        18018  18163 
    CP  56                              ;6e18  fe 38        18019  18164 
    CCF                                 ;6e1a  3f           18020  18165 
    RET C                               ;6e1b  d8           18021  18166 
    LD  (HLBUF),HL                      ;6e1c  22 6a 6d     18022  18167 
    EX  DE,HL                           ;6e1f  eb           18023  18168 
    CALL    DSUB1                       ;6e20  cd 2d 6e     18024  18169 
    CCF                                 ;6e23  3f           18025  18170 
    RET                                 ;6e24  c9           18026  18171 
                                        ;                   18027  18172 ;
SNSHIF: CP  56                          ;6e25  fe 38        18028  18173 
    JP  NC,NEGTIV                       ;6e27  d2 ce 6e     18029  18174 
    LD  (HLBUF),HL                      ;6e2a  22 6a 6d     18030  18175 
DSUB1:  PUSH    AF                      ;6e2d  f5           18031  18176 
    PUSH    HL                          ;6e2e  e5           18032  18177 
    PUSH    DE                          ;6e2f  d5           18033  18178 
    LD  A,(DE)                          ;6e30  1a           18034  18179 
    CP  (HL)                            ;6e31  be           18035  18180 
    JR  NZ,NE                           ;6e32  20 1d        18036  18181 
    INC DE                              ;6e34  13           18037  18182 
    INC HL                              ;6e35  23           18038  18183 
    LD  A,(DE)                          ;6e36  1a           18039  18184 
    SET 7,A                             ;6e37  cb ff        18040  18185 
    CP  (HL)                            ;6e39  be           18041  18186 
    JR  Z,CMPCON                        ;6e3a  28 05        18042  18187 
    RES 7,A                             ;6e3c  cb bf        18043  18188 
    CP  (HL)                            ;6e3e  be           18044  18189 
    JR  NZ,NE                           ;6e3f  20 10        18045  18190 
CMPCON: INC HL                          ;6e41  23           18046  18191 
    INC DE                              ;6e42  13           18047  18192 
    LD  B,6                             ;6e43  06 06        18048  18193 
CMPL:   LD  A,(DE)                      ;6e45  1a           18049  18194 
    CP  (HL)                            ;6e46  be           18050  18195 
    JP  NZ,NE                           ;6e47  c2 51 6e     18051  18196 
    INC HL                              ;6e4a  23           18052  18197 
    INC DE                              ;6e4b  13           18053  18198 
    DJNZ    CMPL                        ;6e4c  10 f7        18054  18199 
    JP  ZERO                            ;6e4e  c3 d8 6e     18055  18200 
NE: POP DE                              ;6e51  d1           18056  18201 
    POP HL                              ;6e52  e1           18057  18202 
    POP AF                              ;6e53  f1           18058  18203 
    CALL    FADD1                       ;6e54  cd 7f 6d     18059  18204 
    PUSH    IX                          ;6e57  dd e5        18060  18205 
    EX  (SP),HL                         ;6e59  e3           18061  18206 
    LD  A,H                             ;6e5a  7c           18062  18207 
    SUB D                               ;6e5b  92           18063  18208 
    LD  D,A                             ;6e5c  57           18064  18209 
    LD  A,L                             ;6e5d  7d           18065  18210 
    SBC A,E                             ;6e5e  9b           18066  18211 
    LD  E,A                             ;6e5f  5f           18067  18212 
    POP HL                              ;6e60  e1           18068  18213 
    EXX                                 ;6e61  d9           18069  18214 
    LD  A,B                             ;6e62  78           18070  18215 
    EXX                                 ;6e63  d9           18071  18216 
    SBC A,B                             ;6e64  98           18072  18217 
    LD  B,A                             ;6e65  47           18073  18218 
    EXX                                 ;6e66  d9           18074  18219 
    LD  A,C                             ;6e67  79           18075  18220 
    EXX                                 ;6e68  d9           18076  18221 
    SBC A,C                             ;6e69  99           18077  18222 
    LD  C,A                             ;6e6a  4f           18078  18223 
    EXX                                 ;6e6b  d9           18079  18224 
    LD  A,H                             ;6e6c  7c           18080  18225 
    EXX                                 ;6e6d  d9           18081  18226 
    SBC A,H                             ;6e6e  9c           18082  18227 
    LD  H,A                             ;6e6f  67           18083  18228 
    EXX                                 ;6e70  d9           18084  18229 
    LD  A,L                             ;6e71  7d           18085  18230 
    EXX                                 ;6e72  d9           18086  18231 
    SBC A,L                             ;6e73  9d           18087  18232 
    LD  L,A                             ;6e74  6f           18088  18233 
    EXX                                 ;6e75  d9           18089  18234 
    EX  AF,AF'                          ;6e76  08           18090  18235 
    LD  B,A                             ;6e77  47           18091  18236 
    EX  AF,AF'                          ;6e78  08           18092  18237 
    LD  A,D                             ;6e79  7a           18093  18238 
    SBC A,B                             ;6e7a  98           18094  18239 
    LD  D,A                             ;6e7b  57           18095  18240 
    LD  A,0B7h                          ;6e7c  3e b7        18096  18241 
    LD  (INST1),A                       ;6e7e  32 7c 6d     18097  18242 
    EXX                                 ;6e81  d9           18098  18243 
    CALL    C,MINUS                     ;6e82  dc a2 6e     18099  18244 
    EXX                                 ;6e85  d9           18100  18245 
DSSFL2: BIT 7,D                         ;6e86  cb 7a        18101  18246 
    JP  NZ,STORE1                       ;6e88  c2 66 6d     18102  18247 
    EXX                                 ;6e8b  d9           18103  18248 
    OR  A                               ;6e8c  b7           18104  18249 
    RL  D                               ;6e8d  cb 12        18105  18250 
    RL  E                               ;6e8f  cb 13        18106  18251 
    RL  B                               ;6e91  cb 10        18107  18252 
    RL  C                               ;6e93  cb 11        18108  18253 
    RL  H                               ;6e95  cb 14        18109  18254 
    RL  L                               ;6e97  cb 15        18110  18255 
    EXX                                 ;6e99  d9           18111  18256 
    RL  D                               ;6e9a  cb 12        18112  18257 
    DEC E                               ;6e9c  1d           18113  18258 
    JR  NZ,DSSFL2                       ;6e9d  20 e7        18114  18259 
    JP  STORE1                          ;6e9f  c3 66 6d     18115  18260 
                                        ;                   18116  18261 ;
MINUS:  EXX                             ;6ea2  d9           18117  18262 
    LD  A,03Fh                          ;6ea3  3e 3f        18118  18263 
    LD  (INST1),A                       ;6ea5  32 7c 6d     18119  18264 
    LD  A,D                             ;6ea8  7a           18120  18265 
    CPL                                 ;6ea9  2f           18121  18266 
    LD  D,A                             ;6eaa  57           18122  18267 
    EXX                                 ;6eab  d9           18123  18268 
    LD  A,D                             ;6eac  7a           18124  18269 
    CPL                                 ;6ead  2f           18125  18270 
    LD  D,A                             ;6eae  57           18126  18271 
    LD  A,E                             ;6eaf  7b           18127  18272 
    CPL                                 ;6eb0  2f           18128  18273 
    LD  E,A                             ;6eb1  5f           18129  18274 
    LD  A,B                             ;6eb2  78           18130  18275 
    CPL                                 ;6eb3  2f           18131  18276 
    LD  B,A                             ;6eb4  47           18132  18277 
    LD  A,C                             ;6eb5  79           18133  18278 
    CPL                                 ;6eb6  2f           18134  18279 
    LD  C,A                             ;6eb7  4f           18135  18280 
    LD  A,H                             ;6eb8  7c           18136  18281 
    CPL                                 ;6eb9  2f           18137  18282 
    LD  H,A                             ;6eba  67           18138  18283 
    LD  A,L                             ;6ebb  7d           18139  18284 
    CPL                                 ;6ebc  2f           18140  18285 
    LD  L,A                             ;6ebd  6f           18141  18286 
    INC D                               ;6ebe  14           18142  18287 
    RET NZ                              ;6ebf  c0           18143  18288 
    INC E                               ;6ec0  1c           18144  18289 
    RET NZ                              ;6ec1  c0           18145  18290 
    INC B                               ;6ec2  04           18146  18291 
    RET NZ                              ;6ec3  c0           18147  18292 
    INC C                               ;6ec4  0c           18148  18293 
    RET NZ                              ;6ec5  c0           18149  18294 
    INC H                               ;6ec6  24           18150  18295 
    RET NZ                              ;6ec7  c0           18151  18296 
    INC L                               ;6ec8  2c           18152  18297 
    RET NZ                              ;6ec9  c0           18153  18298 
    EXX                                 ;6eca  d9           18154  18299 
    INC D                               ;6ecb  14           18155  18300 
    EXX                                 ;6ecc  d9           18156  18301 
    RET                                 ;6ecd  c9           18157  18302 
                                        ;                   18158  18303 ;
NEGTIV: OR  A                           ;6ece  b7           18159  18304 
TRANS:  LD  C,(IY+0)                    ;6ecf  fd 4e 00     18160  18305 
    LD  B,0                             ;6ed2  06 00        18161  18306 
    EX  DE,HL                           ;6ed4  eb           18162  18307 
    LDIR                                ;6ed5  ed b0        18163  18308 
    RET                                 ;6ed7  c9           18164  18309 
                                        ;                   18165  18310 ;
ZERO:   POP DE                          ;6ed8  d1           18166  18311 
    POP HL                              ;6ed9  e1           18167  18312 
    POP AF                              ;6eda  f1           18168  18313 
ZERO':  LD  B,(IY+0)                    ;6edb  fd 46 00     18169  18314 
    XOR A                               ;6ede  af           18170  18315 
ZFILL0: LD  (HL),A                      ;6edf  77           18171  18316 
    INC HL                              ;6ee0  23           18172  18317 
    DJNZ    ZFILL0                      ;6ee1  10 fc        18173  18318 
    RET                                 ;6ee3  c9           18174  18319 
                                        ;                   18175  18320 ;
OVERFL1: LD A,6                         ;6ee4  3e 06        18176  18321 
    EI                                  ;6ee6  fb           18177  18322 
    JP  ERROR                           ;6ee7  c3 96 21     18178  18323 
                                        ;                   18179  18324 ;
SFADD:  XOR A                           ;6eea  af           18180  18325 
    CP  (HL)                            ;6eeb  be           18181  18326 
    JP  Z,TRANS                         ;6eec  ca cf 6e     18182  18327 
    LD  A,(DE)                          ;6eef  1a           18183  18328 
    OR  A                               ;6ef0  b7           18184  18329 
    RET Z                               ;6ef1  c8           18185  18330 
    SUB (HL)                            ;6ef2  96           18186  18331 
    JR  NC,SNSH                         ;6ef3  30 0c        18187  18332 
    NEG                                 ;6ef5  ed 44        18188  18333 
    CP  24                              ;6ef7  fe 18        18189  18334 
    RET NC                              ;6ef9  d0           18190  18335 
    LD  (SHLBUF),HL                     ;6efa  22 79 6f     18191  18336 
    EX  DE,HL                           ;6efd  eb           18192  18337 
    JP  SADD1                           ;6efe  c3 09 6f     18193  18338 
SNSH:   CP  24                          ;6f01  fe 18        18194  18339 
    JP  NC,TRANS                        ;6f03  d2 cf 6e     18195  18340 
    LD  (SHLBUF),HL                     ;6f06  22 79 6f     18196  18341 
SADD1:  LD  (SPBF),SP                   ;6f09  ed 73 5b 70  18197  18342 
    DI                                  ;6f0d  f3           18198  18343 
    LD  C,A                             ;6f0e  4f           18199  18344 
    AND 007h                            ;6f0f  e6 07        18200  18345 
    INC A                               ;6f11  3c           18201  18346 
    LD  B,A                             ;6f12  47           18202  18347 
    LD  A,C                             ;6f13  79           18203  18348 
    AND 038h                            ;6f14  e6 38        18204  18349 
    LD  C,A                             ;6f16  4f           18205  18350 
    LD  (SJVEC),A                       ;6f17  32 21 6f     18206  18351 
    LD  SP,HL                           ;6f1a  f9           18207  18352 
    EXX                                 ;6f1b  d9           18208  18353 
    POP DE                              ;6f1c  d1           18209  18354 
    SET 7,D                             ;6f1d  cb fa        18210  18355 
    POP HL                              ;6f1f  e1           18211  18356 
    DEFB    018H                        ;6f20  18           18212  18357 ;JR ?
SJVEC:  DEFS    1                       ;6f21               18213  18358 
    LD  C,0                             ;6f22  0e 00        18214  18359 
    JP  SCL0                            ;6f24  c3 37 6f     18215  18360 
    DEFS    3                           ;6f27               18216  18361 
    LD  C,H                             ;6f2a  4c           18217  18362 
    LD  H,L                             ;6f2b  65           18218  18363 
    LD  L,D                             ;6f2c  6a           18219  18364 
    XOR A                               ;6f2d  af           18220  18365 
    JP  SCL1                            ;6f2e  c3 36 6f     18221  18366 
    DEFS    1                           ;6f31               18222  18367 
    LD  C,L                             ;6f32  4d           18223  18368 
    LD  H,D                             ;6f33  62           18224  18369 
    XOR A                               ;6f34  af           18225  18370 
    LD  L,A                             ;6f35  6f           18226  18371 
SCL1:   LD  D,A                         ;6f36  57           18227  18372 
SCL0:   EXX                             ;6f37  d9           18228  18373 
    LD  A,C                             ;6f38  79           18229  18374 
    RRCA                                ;6f39  0f           18230  18375 
    RRCA                                ;6f3a  0f           18231  18376 
    ADD A,0F5h                          ;6f3b  c6 f5        18232  18377 
    LD  (SJVEC2),A                      ;6f3d  32 50 6f     18233  18378 
    LD  A,B                             ;6f40  78           18234  18379 
    EXX                                 ;6f41  d9           18235  18380 
    LD  B,A                             ;6f42  47           18236  18381 
    JP  SSIFST                          ;6f43  c3 4e 6f     18237  18382 
    RR  D                               ;6f46  cb 1a        18238  18383 
    RR  L                               ;6f48  cb 1d        18239  18384 
    RR  H                               ;6f4a  cb 1c        18240  18385 
    RR  C                               ;6f4c  cb 19        18241  18386 
SSIFST: OR  A                           ;6f4e  b7           18242  18387 
    DEFB    010H                        ;6f4f  10           18243  18388 ;DJNZ ?
SJVEC2: DEFS    1                       ;6f50               18244  18389 
    RL  C                               ;6f51  cb 11        18245  18390 
    EXX                                 ;6f53  d9           18246  18391 
    EX  DE,HL                           ;6f54  eb           18247  18392 
    LD  SP,HL                           ;6f55  f9           18248  18393 
    POP DE                              ;6f56  d1           18249  18394 
    SET 7,D                             ;6f57  cb fa        18250  18395 
    EXX                                 ;6f59  d9           18251  18396 
    POP BC                              ;6f5a  c1           18252  18397 
    LD  A,H                             ;6f5b  7c           18253  18398 
    ADC A,B                             ;6f5c  88           18254  18399 
    LD  H,A                             ;6f5d  67           18255  18400 
    LD  A,C                             ;6f5e  79           18256  18401 
    ADC A,L                             ;6f5f  8d           18257  18402 
    LD  L,A                             ;6f60  6f           18258  18403 
    EXX                                 ;6f61  d9           18259  18404 
    LD  A,D                             ;6f62  7a           18260  18405 
    EXX                                 ;6f63  d9           18261  18406 
    ADC A,D                             ;6f64  8a           18262  18407 
    LD  D,A                             ;6f65  57           18263  18408 
    EXX                                 ;6f66  d9           18264  18409 
    LD  A,E                             ;6f67  7b           18265  18410 
    EXX                                 ;6f68  d9           18266  18411 
    LD  E,A                             ;6f69  5f           18267  18412 
    JP  NC,SSTRE                        ;6f6a  d2 74 6f     18268  18413 
    RR  D                               ;6f6d  cb 1a        18269  18414 
    RR  L                               ;6f6f  cb 1d        18270  18415 
    RR  H                               ;6f71  cb 1c        18271  18416 
    INC E                               ;6f73  1c           18272  18417 
SSTRE:  EXX                             ;6f74  d9           18273  18418 
    LD  BC,00004h                       ;6f75  01 04 00     18274  18419 
    DEFB    021H                        ;6f78  21           18275  18420 ;LD HL,?
SHLBUF: DEFS    2                       ;6f79               18276  18421 
    ADD HL,BC                           ;6f7b  09           18277  18422 
    LD  SP,HL                           ;6f7c  f9           18278  18423 
    EXX                                 ;6f7d  d9           18279  18424 
    PUSH    HL                          ;6f7e  e5           18280  18425 
    PUSH    DE                          ;6f7f  d5           18281  18426 
    JP  FLEXIT                          ;6f80  c3 78 6d     18282  18427 
                                        ;                   18283  18428 ;
SSUB:   PUSH    HL                      ;6f83  e5           18284  18429 
    PUSH    DE                          ;6f84  d5           18285  18430 
    LD  A,(DE)                          ;6f85  1a           18286  18431 
    CP  (HL)                            ;6f86  be           18287  18432 
    JR  C,NSSUB0                        ;6f87  38 01        18288  18433 
    LD  A,(HL)                          ;6f89  7e           18289  18434 
NSSUB0: CP  080h                        ;6f8a  fe 80        18290  18435 
    LD  A,000h                          ;6f8c  3e 00        18291  18436 
    JR  NC,OSETER                       ;6f8e  30 10        18292  18437 
    PUSH    HL                          ;6f90  e5           18293  18438 
    INC HL                              ;6f91  23           18294  18439 
    INC HL                              ;6f92  23           18295  18440 
    INC HL                              ;6f93  23           18296  18441 
    LD  C,(HL)                          ;6f94  4e           18297  18442 
    POP HL                              ;6f95  e1           18298  18443 
    EX  DE,HL                           ;6f96  eb           18299  18444 
    INC HL                              ;6f97  23           18300  18445 
    INC HL                              ;6f98  23           18301  18446 
    INC HL                              ;6f99  23           18302  18447 
    LD  A,(HL)                          ;6f9a  7e           18303  18448 
    EX  DE,HL                           ;6f9b  eb           18304  18449 
    CP  C                               ;6f9c  b9           18305  18450 
    JR  C,OSETER                        ;6f9d  38 01        18306  18451 
    LD  A,C                             ;6f9f  79           18307  18452 
OSETER: LD  DE,WRKFC                    ;6fa0  11 93 73     18308  18453 
    LD  BC,00004h                       ;6fa3  01 04 00     18309  18454 
    LDIR                                ;6fa6  ed b0        18310  18455 
    LD  B,4                             ;6fa8  06 04        18311  18456 
ZFSSUB: LD  (DE),A                      ;6faa  12           18312  18457 
    INC DE                              ;6fab  13           18313  18458 
    DJNZ    ZFSSUB                      ;6fac  10 fc        18314  18459 
    POP DE                              ;6fae  d1           18315  18460 
    PUSH    DE                          ;6faf  d5           18316  18461 
    EX  DE,HL                           ;6fb0  eb           18317  18462 
    LD  DE,WRKFC1                       ;6fb1  11 9b 73     18318  18463 
    LD  BC,00004h                       ;6fb4  01 04 00     18319  18464 
    LDIR                                ;6fb7  ed b0        18320  18465 
    LD  B,4                             ;6fb9  06 04        18321  18466 
ZFSSU1: LD  (DE),A                      ;6fbb  12           18322  18467 
    INC DE                              ;6fbc  13           18323  18468 
    DJNZ    ZFSSU1                      ;6fbd  10 fc        18324  18469 
    LD  HL,WRKFC                        ;6fbf  21 93 73     18325  18470 
    LD  DE,WRKFC1                       ;6fc2  11 9b 73     18326  18471 
    DEC IY                              ;6fc5  fd 2b        18327  18472 
    LD  (IY+0),008h                     ;6fc7  fd 36 00 08  18328  18473 
    CALL    FSUB1                       ;6fcb  cd 0b 6e     18329  18474 
    INC IY                              ;6fce  fd 23        18330  18475 
    POP DE                              ;6fd0  d1           18331  18476 
    POP HL                              ;6fd1  e1           18332  18477 
    PUSH    HL                          ;6fd2  e5           18333  18478 
    PUSH    DE                          ;6fd3  d5           18334  18479 
    EX  DE,HL                           ;6fd4  eb           18335  18480 
    LD  HL,WRKFC                        ;6fd5  21 93 73     18336  18481 
    LD  BC,00004h                       ;6fd8  01 04 00     18337  18482 
    LDIR                                ;6fdb  ed b0        18338  18483 
    POP DE                              ;6fdd  d1           18339  18484 
    POP HL                              ;6fde  e1           18340  18485 
    RET                                 ;6fdf  c9           18341  18486 
                                        ;                   18342  18487 ;
MUL:    CALL    STROMT                  ;6fe0  cd c5 6b     18343  18488 
    DI                                  ;6fe3  f3           18344  18489 
    PUSH    DE                          ;6fe4  d5           18345  18490 
    PUSH    HL                          ;6fe5  e5           18346  18491 
    LD  (SPBF),SP                       ;6fe6  ed 73 5b 70  18347  18492 
    BIT 3,(IY+0)                        ;6fea  fd cb 00 5e  18348  18493 
    JP  NZ,DMUL                         ;6fee  c2 8e 71     18349  18494 
    LD  SP,HL                           ;6ff1  f9           18350  18495 
    LD  A,(DE)                          ;6ff2  1a           18351  18496 
    OR  A                               ;6ff3  b7           18352  18497 
    JP  Z,UNDRFL                        ;6ff4  ca ab 70     18353  18498 
    XOR A                               ;6ff7  af           18354  18499 
    EXX                                 ;6ff8  d9           18355  18500 
    POP DE                              ;6ff9  d1           18356  18501 
    SET 7,D                             ;6ffa  cb fa        18357  18502 
    CP  E                               ;6ffc  bb           18358  18503 
    JP  Z,UNDRFL                        ;6ffd  ca ab 70     18359  18504 
    POP HL                              ;7000  e1           18360  18505 
    EXX                                 ;7001  d9           18361  18506 
    EX  DE,HL                           ;7002  eb           18362  18507 
    LD  SP,HL                           ;7003  f9           18363  18508 
    POP DE                              ;7004  d1           18364  18509 
    SET 7,D                             ;7005  cb fa        18365  18510 
    CP  E                               ;7007  bb           18366  18511 
    JP  Z,UNDRFL                        ;7008  ca ab 70     18367  18512 
    POP HL                              ;700b  e1           18368  18513 
    LD  BC,05F00h                       ;700c  01 00 5f     18369  18514 
    LD  SP,WRKFC+6                      ;700f  31 99 73     18370  18515 
    PUSH    BC                          ;7012  c5           18371  18516 
    PUSH    BC                          ;7013  c5           18372  18517 
    LD  C,A                             ;7014  4f           18373  18518 
    LD  B,A                             ;7015  47           18374  18519 
    PUSH    BC                          ;7016  c5           18375  18520 
    EXX                                 ;7017  d9           18376  18521 
    PUSH    DE                          ;7018  d5           18377  18522 
    LD  E,A                             ;7019  5f           18378  18523 
    EXX                                 ;701a  d9           18379  18524 
    CP  H                               ;701b  bc           18380  18525 
    LD  IX,WRKFC+4                      ;701c  dd 21 97 73  18381  18526 
    JR  Z,SML1                          ;7020  28 04        18382  18527 
    LD  C,H                             ;7022  4c           18383  18528 
    CALL    SMULTS                      ;7023  cd 77 70     18384  18529 
SML1:   DEC IX                          ;7026  dd 2b        18385  18530 
    CP  L                               ;7028  bd           18386  18531 
    JR  Z,SML2                          ;7029  28 04        18387  18532 
    LD  C,L                             ;702b  4d           18388  18533 
    CALL    SMULTS                      ;702c  cd 77 70     18389  18534 
SML2:   DEC IX                          ;702f  dd 2b        18390  18535 
    LD  C,D                             ;7031  4a           18391  18536 
    CALL    SMULTS                      ;7032  cd 77 70     18392  18537 
    POP HL                              ;7035  e1           18393  18538 
    LD  A,E                             ;7036  7b           18394  18539 
    ADD A,L                             ;7037  85           18395  18540 
    LD  L,A                             ;7038  6f           18396  18541 
    LD  A,000h                          ;7039  3e 00        18397  18542 
    ADC A,A                             ;703b  8f           18398  18543 
    LD  H,A                             ;703c  67           18399  18544 
    POP BC                              ;703d  c1           18400  18545 
    POP DE                              ;703e  d1           18401  18546 
SMSF:   BIT 7,C                         ;703f  cb 79        18402  18547 
    JR  NZ,EXPCUL                       ;7041  20 09        18403  18548 
    RL  D                               ;7043  cb 12        18404  18549 
    RL  E                               ;7045  cb 13        18405  18550 
    RL  B                               ;7047  cb 10        18406  18551 
    RL  C                               ;7049  cb 11        18407  18552 
    DEC HL                              ;704b  2b           18408  18553 
EXPCUL: LD  A,L                         ;704c  7d           18409  18554 
    SUB 080h                            ;704d  d6 80        18410  18555 
    LD  L,A                             ;704f  6f           18411  18556 
    LD  A,H                             ;7050  7c           18412  18557 
    SBC A,000h                          ;7051  de 00        18413  18558 
    JP  C,UNDRFL                        ;7053  da ab 70     18414  18559 
    JP  NZ,OVERFL1                      ;7056  c2 e4 6e     18415  18560 
    LD  A,L                             ;7059  7d           18416  18561 
    DEFB    031H                        ;705a  31           18417  18562 ;LD SP,?
SPBF:   DEFS    2                       ;705b               18418  18563 
    POP HL                              ;705d  e1           18419  18564 
    LD  (HL),A                          ;705e  77           18420  18565 
    INC HL                              ;705f  23           18421  18566 
    LD  A,(HL)                          ;7060  7e           18422  18567 
    EX  (SP),HL                         ;7061  e3           18423  18568 
    INC HL                              ;7062  23           18424  18569 
    XOR (HL)                            ;7063  ae           18425  18570 
    DEC HL                              ;7064  2b           18426  18571 
    EX  (SP),HL                         ;7065  e3           18427  18572 
    DEC HL                              ;7066  2b           18428  18573 
    PUSH    HL                          ;7067  e5           18429  18574 
    INC HL                              ;7068  23           18430  18575 
    RLCA                                ;7069  07           18431  18576 
    JR  C,SMSTS                         ;706a  38 02        18432  18577 
    RES 7,C                             ;706c  cb b9        18433  18578 
SMSTS:  LD  (HL),C                      ;706e  71           18434  18579 
    INC HL                              ;706f  23           18435  18580 
    LD  (HL),B                          ;7070  70           18436  18581 
    INC HL                              ;7071  23           18437  18582 
    LD  (HL),E                          ;7072  73           18438  18583 
    POP HL                              ;7073  e1           18439  18584 
    POP DE                              ;7074  d1           18440  18585 
    EI                                  ;7075  fb           18441  18586 
    RET                                 ;7076  c9           18442  18587 
                                        ;                   18443  18588 ;
SMULTS: LD  B,8                         ;7077  06 08        18444  18589 
SMULTP: RR  C                           ;7079  cb 19        18445  18590 
    EXX                                 ;707b  d9           18446  18591 
    JP  NC,SMLP1                        ;707c  d2 94 70     18447  18592 
    LD  SP,IX                           ;707f  dd f9        18448  18593 
    POP BC                              ;7081  c1           18449  18594 
    PUSH    HL                          ;7082  e5           18450  18595 
    LD  A,H                             ;7083  7c           18451  18596 
    ADD A,B                             ;7084  80           18452  18597 
    LD  H,A                             ;7085  67           18453  18598 
    LD  A,L                             ;7086  7d           18454  18599 
    ADC A,C                             ;7087  89           18455  18600 
    LD  L,A                             ;7088  6f           18456  18601 
    EX  (SP),HL                         ;7089  e3           18457  18602 
    DEC SP                              ;708a  3b           18458  18603 
    DEC SP                              ;708b  3b           18459  18604 
    EX  (SP),HL                         ;708c  e3           18460  18605 
    LD  A,H                             ;708d  7c           18461  18606 
    ADC A,D                             ;708e  8a           18462  18607 
    LD  H,A                             ;708f  67           18463  18608 
    LD  A,L                             ;7090  7d           18464  18609 
    ADC A,E                             ;7091  8b           18465  18610 
    LD  L,A                             ;7092  6f           18466  18611 
    EX  (SP),HL                         ;7093  e3           18467  18612 
SMLP1:  OR  A                           ;7094  b7           18468  18613 
    RL  H                               ;7095  cb 14        18469  18614 
    RL  L                               ;7097  cb 15        18470  18615 
    RL  D                               ;7099  cb 12        18471  18616 
    RL  E                               ;709b  cb 13        18472  18617 
    EXX                                 ;709d  d9           18473  18618 
    DJNZ    SMULTP                      ;709e  10 d9        18474  18619 
    EXX                                 ;70a0  d9           18475  18620 
    LD  H,L                             ;70a1  65           18476  18621 
    LD  L,D                             ;70a2  6a           18477  18622 
    LD  D,E                             ;70a3  53           18478  18623 
    XOR A                               ;70a4  af           18479  18624 
    LD  E,A                             ;70a5  5f           18480  18625 
    EXX                                 ;70a6  d9           18481  18626 
    LD  SP,WRKFC-4                      ;70a7  31 8f 73     18482  18627 
    RET                                 ;70aa  c9           18483  18628 
                                        ;                   18484  18629 ;
UNDRFL: LD  SP,(SPBF)                   ;70ab  ed 7b 5b 70  18485  18630 
    POP HL                              ;70af  e1           18486  18631 
    PUSH    HL                          ;70b0  e5           18487  18632 
    CALL    ZERO'                       ;70b1  cd db 6e     18488  18633 
    POP HL                              ;70b4  e1           18489  18634 
    POP DE                              ;70b5  d1           18490  18635 
    EI                                  ;70b6  fb           18491  18636 
    RET                                 ;70b7  c9           18492  18637 
                                        ;                   18493  18638 ;
DVBYZR: LD  A,11                        ;70b8  3e 0b        18494  18639 
    JP  ERROR                           ;70ba  c3 96 21     18495  18640 
                                        ;                   18496  18641 ;
DIV:    CALL    STROMT                  ;70bd  cd c5 6b     18497  18642 
    DI                                  ;70c0  f3           18498  18643 
    XOR A                               ;70c1  af           18499  18644 
    PUSH    DE                          ;70c2  d5           18500  18645 
    PUSH    HL                          ;70c3  e5           18501  18646 
    LD  (SPBF),SP                       ;70c4  ed 73 5b 70  18502  18647 
    BIT 3,(IY+0)                        ;70c8  fd cb 00 5e  18503  18648 
    JP  NZ,DDIV                         ;70cc  c2 89 72     18504  18649 
    LD  SP,HL                           ;70cf  f9           18505  18650 
    EXX                                 ;70d0  d9           18506  18651 
    POP DE                              ;70d1  d1           18507  18652 
    SET 7,D                             ;70d2  cb fa        18508  18653 
    CP  E                               ;70d4  bb           18509  18654 
    JR  Z,UNDRFL                        ;70d5  28 d4        18510  18655 
    LD  E,A                             ;70d7  5f           18511  18656 
    POP HL                              ;70d8  e1           18512  18657 
    EXX                                 ;70d9  d9           18513  18658 
    EX  DE,HL                           ;70da  eb           18514  18659 
    LD  SP,HL                           ;70db  f9           18515  18660 
    POP DE                              ;70dc  d1           18516  18661 
    SET 7,D                             ;70dd  cb fa        18517  18662 
    CP  E                               ;70df  bb           18518  18663 
    JR  Z,DVBYZR                        ;70e0  28 d6        18519  18664 
    LD  E,A                             ;70e2  5f           18520  18665 
    POP HL                              ;70e3  e1           18521  18666 
    LD  SP,(SPBF)                       ;70e4  ed 7b 5b 70  18522  18667 
    LD  IX,WRKFC-1                      ;70e8  dd 21 92 73  18523  18668 
    LD  C,4                             ;70ec  0e 04        18524  18669 
SDLOP2: INC IX                          ;70ee  dd 23        18525  18670 
    LD  B,8                             ;70f0  06 08        18526  18671 
SDLOP1: EXX                             ;70f2  d9           18527  18672 
    RL  (IX+0)                          ;70f3  dd cb 00 16  18528  18673 
    LD  A,H                             ;70f7  7c           18529  18674 
    EXX                                 ;70f8  d9           18530  18675 
    SUB H                               ;70f9  94           18531  18676 
    EXX                                 ;70fa  d9           18532  18677 
    LD  H,A                             ;70fb  67           18533  18678 
    LD  A,L                             ;70fc  7d           18534  18679 
    EXX                                 ;70fd  d9           18535  18680 
    SBC A,L                             ;70fe  9d           18536  18681 
    EXX                                 ;70ff  d9           18537  18682 
    LD  L,A                             ;7100  6f           18538  18683 
    LD  A,D                             ;7101  7a           18539  18684 
    EXX                                 ;7102  d9           18540  18685 
    SBC A,D                             ;7103  9a           18541  18686 
    EXX                                 ;7104  d9           18542  18687 
    LD  D,A                             ;7105  57           18543  18688 
    LD  A,E                             ;7106  7b           18544  18689 
    EXX                                 ;7107  d9           18545  18690 
    SBC A,E                             ;7108  9b           18546  18691 
    EXX                                 ;7109  d9           18547  18692 
    LD  E,A                             ;710a  5f           18548  18693 
    SET 0,(IX+0)                        ;710b  dd cb 00 c6  18549  18694 
    JR  NC,SDCNT                        ;710f  30 18        18550  18695 
    RES 0,(IX+0)                        ;7111  dd cb 00 86  18551  18696 
    EXX                                 ;7115  d9           18552  18697 
    LD  A,H                             ;7116  7c           18553  18698 
    EXX                                 ;7117  d9           18554  18699 
    ADD A,H                             ;7118  84           18555  18700 
    LD  H,A                             ;7119  67           18556  18701 
    EXX                                 ;711a  d9           18557  18702 
    LD  A,L                             ;711b  7d           18558  18703 
    EXX                                 ;711c  d9           18559  18704 
    ADC A,L                             ;711d  8d           18560  18705 
    LD  L,A                             ;711e  6f           18561  18706 
    EXX                                 ;711f  d9           18562  18707 
    LD  A,D                             ;7120  7a           18563  18708 
    EXX                                 ;7121  d9           18564  18709 
    ADC A,D                             ;7122  8a           18565  18710 
    LD  D,A                             ;7123  57           18566  18711 
    EXX                                 ;7124  d9           18567  18712 
    LD  A,E                             ;7125  7b           18568  18713 
    EXX                                 ;7126  d9           18569  18714 
    ADC A,E                             ;7127  8b           18570  18715 
    LD  E,A                             ;7128  5f           18571  18716 
SDCNT:  SLA H                           ;7129  cb 24        18572  18717 
    RL  L                               ;712b  cb 15        18573  18718 
    RL  D                               ;712d  cb 12        18574  18719 
    RL  E                               ;712f  cb 13        18575  18720 
    EXX                                 ;7131  d9           18576  18721 
    DJNZ    SDLOP1                      ;7132  10 be        18577  18722 
    DEC C                               ;7134  0d           18578  18723 
    JR  NZ,SDLOP2                       ;7135  20 b7        18579  18724 
    LD  HL,WRKFC+3                      ;7137  21 96 73     18580  18725 
    LD  A,067h                          ;713a  3e 67        18581  18726 
    ADD A,(HL)                          ;713c  86           18582  18727 
    LD  (HL),A                          ;713d  77           18583  18728 
    LD  B,3                             ;713e  06 03        18584  18729 
ADLP:   DEC HL                          ;7140  2b           18585  18730 
    LD  A,0                             ;7141  3e 00        18586  18731 
    ADC A,(HL)                          ;7143  8e           18587  18732 
    LD  (HL),A                          ;7144  77           18588  18733 
    DJNZ    ADLP                        ;7145  10 f9        18589  18734 
    XOR A                               ;7147  af           18590  18735 
    BIT 7,(HL)                          ;7148  cb 7e        18591  18736 
    JR  NZ,SDEXPC                       ;714a  20 0d        18592  18737 
    LD  HL,WRKFC+3                      ;714c  21 96 73     18593  18738 
    RL  (HL)                            ;714f  cb 16        18594  18739 
    LD  B,003h                          ;7151  06 03        18595  18740 
NOSDLP: DEC HL                          ;7153  2b           18596  18741 
    RL  (HL)                            ;7154  cb 16        18597  18742 
    DJNZ    NOSDLP                      ;7156  10 fb        18598  18743 
    SCF                                 ;7158  37           18599  18744 
SDEXPC: POP HL                          ;7159  e1           18600  18745 
    POP DE                              ;715a  d1           18601  18746 
    PUSH    DE                          ;715b  d5           18602  18747 
    PUSH    HL                          ;715c  e5           18603  18748 
    LD  A,(HL)                          ;715d  7e           18604  18749 
    CCF                                 ;715e  3f           18605  18750 
    ADC A,080h                          ;715f  ce 80        18606  18751 
    LD  C,A                             ;7161  4f           18607  18752 
    LD  A,0                             ;7162  3e 00        18608  18753 
    ADC A,A                             ;7164  8f           18609  18754 
    LD  B,A                             ;7165  47           18610  18755 
    EX  DE,HL                           ;7166  eb           18611  18756 
    LD  A,C                             ;7167  79           18612  18757 
    SUB (HL)                            ;7168  96           18613  18758 
    EX  DE,HL                           ;7169  eb           18614  18759 
    LD  C,A                             ;716a  4f           18615  18760 
    LD  A,B                             ;716b  78           18616  18761 
    SBC A,0                             ;716c  de 00        18617  18762 
    JP  C,UNDRFL                        ;716e  da ab 70     18618  18763 
    JP  NZ,OVERFL1                      ;7171  c2 e4 6e     18619  18764 
    LD  (HL),C                          ;7174  71           18620  18765 
    INC HL                              ;7175  23           18621  18766 
    INC DE                              ;7176  13           18622  18767 
    LD  A,(DE)                          ;7177  1a           18623  18768 
    XOR (HL)                            ;7178  ae           18624  18769 
    RLCA                                ;7179  07           18625  18770 
    LD  B,3                             ;717a  06 03        18626  18771 
DDTRL:  LD  DE,WRKFC                    ;717c  11 93 73     18627  18772 
SDTRL:  LD  A,(DE)                      ;717f  1a           18628  18773 
    LD  (HL),A                          ;7180  77           18629  18774 
    INC HL                              ;7181  23           18630  18775 
    INC DE                              ;7182  13           18631  18776 
    DJNZ    SDTRL                       ;7183  10 fa        18632  18777 
    POP HL                              ;7185  e1           18633  18778 
    JR  C,SDMIN                         ;7186  38 03        18634  18779 
    CALL    RESNHL                      ;7188  cd c0 6b     18635  18780 
SDMIN:  POP DE                          ;718b  d1           18636  18781 
    EI                                  ;718c  fb           18637  18782 
    RET                                 ;718d  c9           18638  18783 
                                        ;                   18639  18784 ;
DMUL:   LD  SP,HL                       ;718e  f9           18640  18785 
    LD  A,(DE)                          ;718f  1a           18641  18786 
    OR  A                               ;7190  b7           18642  18787 
    JP  Z,UNDRFL                        ;7191  ca ab 70     18643  18788 
    XOR A                               ;7194  af           18644  18789 
    EXX                                 ;7195  d9           18645  18790 
    POP DE                              ;7196  d1           18646  18791 
    SET 7,D                             ;7197  cb fa        18647  18792 
    CP  E                               ;7199  bb           18648  18793 
    JP  Z,UNDRFL                        ;719a  ca ab 70     18649  18794 
    LD  E,A                             ;719d  5f           18650  18795 
    POP BC                              ;719e  c1           18651  18796 
    POP HL                              ;719f  e1           18652  18797 
    POP IX                              ;71a0  dd e1        18653  18798 
    EXX                                 ;71a2  d9           18654  18799 
    LD  SP,WRKFC+14                     ;71a3  31 a1 73     18655  18800 
    LD  BC,05F00h                       ;71a6  01 00 5f     18656  18801 
    PUSH    BC                          ;71a9  c5           18657  18802 
    PUSH    BC                          ;71aa  c5           18658  18803 
    PUSH    BC                          ;71ab  c5           18659  18804 
    PUSH    BC                          ;71ac  c5           18660  18805 
    LD  B,A                             ;71ad  47           18661  18806 
    PUSH    BC                          ;71ae  c5           18662  18807 
    PUSH    BC                          ;71af  c5           18663  18808 
    PUSH    BC                          ;71b0  c5           18664  18809 
    LD  SP,(SPBF)                       ;71b1  ed 7b 5b 70  18665  18810 
    EX  DE,HL                           ;71b5  eb           18666  18811 
    LD  B,6                             ;71b6  06 06        18667  18812 
    LD  DE,00007h                       ;71b8  11 07 00     18668  18813 
    ADD HL,DE                           ;71bb  19           18669  18814 
    LD  DE,WRKFC+13                     ;71bc  11 a0 73     18670  18815 
DMULLP: CALL    BLCKAD                  ;71bf  cd 13 72     18671  18816 
    DEC DE                              ;71c2  1b           18672  18817 
    DEC HL                              ;71c3  2b           18673  18818 
    DJNZ    DMULLP                      ;71c4  10 f9        18674  18819 
    LD  A,(HL)                          ;71c6  7e           18675  18820 
    SET 7,A                             ;71c7  cb ff        18676  18821 
    CALL    BLCKA1                      ;71c9  cd 16 72     18677  18822 
    LD  HL,WRKFC                        ;71cc  21 93 73     18678  18823 
    BIT 7,(HL)                          ;71cf  cb 7e        18679  18824 
    SCF                                 ;71d1  37           18680  18825 
    JR  NZ,DMNOSH                       ;71d2  20 0b        18681  18826 
    LD  HL,WRKFC+7                      ;71d4  21 9a 73     18682  18827 
    LD  B,008h                          ;71d7  06 08        18683  18828 
DMSFL:  RL  (HL)                        ;71d9  cb 16        18684  18829 
    DEC HL                              ;71db  2b           18685  18830 
    DJNZ    DMSFL                       ;71dc  10 fb        18686  18831 
    OR  A                               ;71de  b7           18687  18832 
DMNOSH: POP HL                          ;71df  e1           18688  18833 
    POP DE                              ;71e0  d1           18689  18834 
    PUSH    DE                          ;71e1  d5           18690  18835 
    PUSH    HL                          ;71e2  e5           18691  18836 
    LD  A,(DE)                          ;71e3  1a           18692  18837 
    LD  C,A                             ;71e4  4f           18693  18838 
    ADC A,(HL)                          ;71e5  8e           18694  18839 
    LD  C,A                             ;71e6  4f           18695  18840 
    LD  A,0                             ;71e7  3e 00        18696  18841 
    ADC A,A                             ;71e9  8f           18697  18842 
    LD  B,A                             ;71ea  47           18698  18843 
    LD  A,C                             ;71eb  79           18699  18844 
    SUB 081h                            ;71ec  d6 81        18700  18845 
    LD  C,A                             ;71ee  4f           18701  18846 
    LD  A,B                             ;71ef  78           18702  18847 
    SBC A,0                             ;71f0  de 00        18703  18848 
    JP  M,UNDRFL                        ;71f2  fa ab 70     18704  18849 
    JP  NZ,OVERFL1                      ;71f5  c2 e4 6e     18705  18850 
    LD  (HL),C                          ;71f8  71           18706  18851 
    INC DE                              ;71f9  13           18707  18852 
    INC HL                              ;71fa  23           18708  18853 
    LD  A,(DE)                          ;71fb  1a           18709  18854 
    XOR (HL)                            ;71fc  ae           18710  18855 
    RLCA                                ;71fd  07           18711  18856 
    LD  DE,WRKFC                        ;71fe  11 93 73     18712  18857 
    JR  C,SMSKP1                        ;7201  38 04        18713  18858 
    EX  DE,HL                           ;7203  eb           18714  18859 
    RES 7,(HL)                          ;7204  cb be        18715  18860 
    EX  DE,HL                           ;7206  eb           18716  18861 
SMSKP1: LD  B,007h                      ;7207  06 07        18717  18862 
DMTRL:  LD  A,(DE)                      ;7209  1a           18718  18863 
    LD  (HL),A                          ;720a  77           18719  18864 
    INC DE                              ;720b  13           18720  18865 
    INC HL                              ;720c  23           18721  18866 
    DJNZ    DMTRL                       ;720d  10 fa        18722  18867 
    POP HL                              ;720f  e1           18723  18868 
    POP DE                              ;7210  d1           18724  18869 
    EI                                  ;7211  fb           18725  18870 
    RET                                 ;7212  c9           18726  18871 
                                        ;                   18727  18872 ;
BLCKAD: LD  A,(HL)                      ;7213  7e           18728  18873 
    OR  A                               ;7214  b7           18729  18874 
    RET Z                               ;7215  c8           18730  18875 
BLCKA1: PUSH    HL                      ;7216  e5           18731  18876 
    PUSH    BC                          ;7217  c5           18732  18877 
    PUSH    DE                          ;7218  d5           18733  18878 
    LD  B,8                             ;7219  06 08        18734  18879 
BLADLP: RRCA                            ;721b  0f           18735  18880 
    PUSH    AF                          ;721c  f5           18736  18881 
    JP  NC,DMSKIP                       ;721d  d2 54 72     18737  18882 
    LD  A,(DE)                          ;7220  1a           18738  18883 
    PUSH    IX                          ;7221  dd e5        18739  18884 
    EX  (SP),HL                         ;7223  e3           18740  18885 
    ADD A,H                             ;7224  84           18741  18886 
    LD  (DE),A                          ;7225  12           18742  18887 
    DEC DE                              ;7226  1b           18743  18888 
    LD  A,(DE)                          ;7227  1a           18744  18889 
    ADC A,L                             ;7228  8d           18745  18890 
    LD  (DE),A                          ;7229  12           18746  18891 
    POP HL                              ;722a  e1           18747  18892 
    DEC DE                              ;722b  1b           18748  18893 
    LD  A,(DE)                          ;722c  1a           18749  18894 
    EXX                                 ;722d  d9           18750  18895 
    ADC A,H                             ;722e  8c           18751  18896 
    EXX                                 ;722f  d9           18752  18897 
    LD  (DE),A                          ;7230  12           18753  18898 
    DEC DE                              ;7231  1b           18754  18899 
    LD  A,(DE)                          ;7232  1a           18755  18900 
    EXX                                 ;7233  d9           18756  18901 
    ADC A,L                             ;7234  8d           18757  18902 
    EXX                                 ;7235  d9           18758  18903 
    LD  (DE),A                          ;7236  12           18759  18904 
    DEC DE                              ;7237  1b           18760  18905 
    LD  A,(DE)                          ;7238  1a           18761  18906 
    EXX                                 ;7239  d9           18762  18907 
    ADC A,B                             ;723a  88           18763  18908 
    EXX                                 ;723b  d9           18764  18909 
    LD  (DE),A                          ;723c  12           18765  18910 
    DEC DE                              ;723d  1b           18766  18911 
    LD  A,(DE)                          ;723e  1a           18767  18912 
    EXX                                 ;723f  d9           18768  18913 
    ADC A,C                             ;7240  89           18769  18914 
    EXX                                 ;7241  d9           18770  18915 
    LD  (DE),A                          ;7242  12           18771  18916 
    DEC DE                              ;7243  1b           18772  18917 
    LD  A,(DE)                          ;7244  1a           18773  18918 
    EXX                                 ;7245  d9           18774  18919 
    ADC A,D                             ;7246  8a           18775  18920 
    EXX                                 ;7247  d9           18776  18921 
    LD  (DE),A                          ;7248  12           18777  18922 
    DEC DE                              ;7249  1b           18778  18923 
    LD  A,(DE)                          ;724a  1a           18779  18924 
    EXX                                 ;724b  d9           18780  18925 
    ADC A,E                             ;724c  8b           18781  18926 
    EXX                                 ;724d  d9           18782  18927 
    LD  (DE),A                          ;724e  12           18783  18928 
    DEC DE                              ;724f  1b           18784  18929 
    LD  A,(DE)                          ;7250  1a           18785  18930 
    ADC A,0                             ;7251  ce 00        18786  18931 
    LD  (DE),A                          ;7253  12           18787  18932 
                                        ;                   18788  18933 ;
DMSKIP: EXX                             ;7254  d9           18789  18934 
    PUSH    IX                          ;7255  dd e5        18790  18935 
    EX  (SP),HL                         ;7257  e3           18791  18936 
    LD  A,H                             ;7258  7c           18792  18937 
    ADD A,A                             ;7259  87           18793  18938 
    LD  H,A                             ;725a  67           18794  18939 
    LD  A,L                             ;725b  7d           18795  18940 
    RLA                                 ;725c  17           18796  18941 
    LD  L,A                             ;725d  6f           18797  18942 
    EX  (SP),HL                         ;725e  e3           18798  18943 
    POP IX                              ;725f  dd e1        18799  18944 
    RL  H                               ;7261  cb 14        18800  18945 
    RL  L                               ;7263  cb 15        18801  18946 
    RL  B                               ;7265  cb 10        18802  18947 
    RL  C                               ;7267  cb 11        18803  18948 
    RL  D                               ;7269  cb 12        18804  18949 
    RL  E                               ;726b  cb 13        18805  18950 
    EXX                                 ;726d  d9           18806  18951 
    POP AF                              ;726e  f1           18807  18952 
    POP DE                              ;726f  d1           18808  18953 
    PUSH    DE                          ;7270  d5           18809  18954 
    DJNZ    BLADLP                      ;7271  10 a8        18810  18955 
    EXX                                 ;7273  d9           18811  18956 
    LD  A,H                             ;7274  7c           18812  18957 
    PUSH    IX                          ;7275  dd e5        18813  18958 
    EX  (SP),HL                         ;7277  e3           18814  18959 
    LD  H,L                             ;7278  65           18815  18960 
    LD  L,A                             ;7279  6f           18816  18961 
    EX  (SP),HL                         ;727a  e3           18817  18962 
    POP IX                              ;727b  dd e1        18818  18963 
    LD  H,L                             ;727d  65           18819  18964 
    LD  L,B                             ;727e  68           18820  18965 
    LD  B,C                             ;727f  41           18821  18966 
    LD  C,D                             ;7280  4a           18822  18967 
    LD  D,E                             ;7281  53           18823  18968 
    LD  E,0                             ;7282  1e 00        18824  18969 
    EXX                                 ;7284  d9           18825  18970 
    POP DE                              ;7285  d1           18826  18971 
    POP BC                              ;7286  c1           18827  18972 
    POP HL                              ;7287  e1           18828  18973 
    RET                                 ;7288  c9           18829  18974 
                                        ;                   18830  18975 ;
DDIV:   LD  SP,HL                       ;7289  f9           18831  18976 
    EXX                                 ;728a  d9           18832  18977 
    POP DE                              ;728b  d1           18833  18978 
    SET 7,D                             ;728c  cb fa        18834  18979 
    CP  E                               ;728e  bb           18835  18980 
    JP  Z,UNDRFL                        ;728f  ca ab 70     18836  18981 
    LD  E,A                             ;7292  5f           18837  18982 
    POP BC                              ;7293  c1           18838  18983 
    POP HL                              ;7294  e1           18839  18984 
    POP IX                              ;7295  dd e1        18840  18985 
    EXX                                 ;7297  d9           18841  18986 
    EX  DE,HL                           ;7298  eb           18842  18987 
    LD  SP,(SPBF)                       ;7299  ed 7b 5b 70  18843  18988 
    CP  (HL)                            ;729d  be           18844  18989 
    JP  Z,DVBYZR                        ;729e  ca b8 70     18845  18990 
    LD  DE,00007h                       ;72a1  11 07 00     18846  18991 
    ADD HL,DE                           ;72a4  19           18847  18992 
    EX  DE,HL                           ;72a5  eb           18848  18993 
    LD  HL,WRKFC-1                      ;72a6  21 92 73     18849  18994 
    LD  C,8                             ;72a9  0e 08        18850  18995 
DDLOP2: INC HL                          ;72ab  23           18851  18996 
    LD  B,8                             ;72ac  06 08        18852  18997 
DDLOP1: RL  (HL)                        ;72ae  cb 16        18853  18998 
    PUSH    DE                          ;72b0  d5           18854  18999 
    EX  DE,HL                           ;72b1  eb           18855  19000 
    PUSH    BC                          ;72b2  c5           18856  19001 
    PUSH    IX                          ;72b3  dd e5        18857  19002 
    POP BC                              ;72b5  c1           18858  19003 
    LD  A,B                             ;72b6  78           18859  19004 
    SUB (HL)                            ;72b7  96           18860  19005 
    LD  B,A                             ;72b8  47           18861  19006 
    DEC HL                              ;72b9  2b           18862  19007 
    LD  A,C                             ;72ba  79           18863  19008 
    SBC A,(HL)                          ;72bb  9e           18864  19009 
    LD  C,A                             ;72bc  4f           18865  19010 
    PUSH    BC                          ;72bd  c5           18866  19011 
    POP IX                              ;72be  dd e1        18867  19012 
    POP BC                              ;72c0  c1           18868  19013 
    DEC HL                              ;72c1  2b           18869  19014 
    EXX                                 ;72c2  d9           18870  19015 
    LD  A,H                             ;72c3  7c           18871  19016 
    EXX                                 ;72c4  d9           18872  19017 
    SBC A,(HL)                          ;72c5  9e           18873  19018 
    EXX                                 ;72c6  d9           18874  19019 
    LD  H,A                             ;72c7  67           18875  19020 
    LD  A,L                             ;72c8  7d           18876  19021 
    EXX                                 ;72c9  d9           18877  19022 
    DEC HL                              ;72ca  2b           18878  19023 
    SBC A,(HL)                          ;72cb  9e           18879  19024 
    EXX                                 ;72cc  d9           18880  19025 
    LD  L,A                             ;72cd  6f           18881  19026 
    LD  A,B                             ;72ce  78           18882  19027 
    EXX                                 ;72cf  d9           18883  19028 
    DEC HL                              ;72d0  2b           18884  19029 
    SBC A,(HL)                          ;72d1  9e           18885  19030 
    EXX                                 ;72d2  d9           18886  19031 
    LD  B,A                             ;72d3  47           18887  19032 
    LD  A,C                             ;72d4  79           18888  19033 
    EXX                                 ;72d5  d9           18889  19034 
    DEC HL                              ;72d6  2b           18890  19035 
    SBC A,(HL)                          ;72d7  9e           18891  19036 
    EXX                                 ;72d8  d9           18892  19037 
    LD  C,A                             ;72d9  4f           18893  19038 
    LD  A,D                             ;72da  7a           18894  19039 
    EXX                                 ;72db  d9           18895  19040 
    DEC HL                              ;72dc  2b           18896  19041 
    PUSH    BC                          ;72dd  c5           18897  19042 
    LD  C,(HL)                          ;72de  4e           18898  19043 
    SET 7,C                             ;72df  cb f9        18899  19044 
    SBC A,C                             ;72e1  99           18900  19045 
    POP BC                              ;72e2  c1           18901  19046 
    EXX                                 ;72e3  d9           18902  19047 
    LD  D,A                             ;72e4  57           18903  19048 
    LD  A,E                             ;72e5  7b           18904  19049 
    SBC A,0                             ;72e6  de 00        18905  19050 
    LD  E,A                             ;72e8  5f           18906  19051 
    EXX                                 ;72e9  d9           18907  19052 
    EX  DE,HL                           ;72ea  eb           18908  19053 
    POP DE                              ;72eb  d1           18909  19054 
    PUSH    DE                          ;72ec  d5           18910  19055 
    SET 0,(HL)                          ;72ed  cb c6        18911  19056 
    JR  NC,DDCNT                        ;72ef  30 37        18912  19057 
    RES 0,(HL)                          ;72f1  cb 86        18913  19058 
    EX  DE,HL                           ;72f3  eb           18914  19059 
    PUSH    BC                          ;72f4  c5           18915  19060 
    PUSH    IX                          ;72f5  dd e5        18916  19061 
    POP BC                              ;72f7  c1           18917  19062 
    LD  A,B                             ;72f8  78           18918  19063 
    ADD A,(HL)                          ;72f9  86           18919  19064 
    LD  B,A                             ;72fa  47           18920  19065 
    DEC HL                              ;72fb  2b           18921  19066 
    LD  A,C                             ;72fc  79           18922  19067 
    ADC A,(HL)                          ;72fd  8e           18923  19068 
    LD  C,A                             ;72fe  4f           18924  19069 
    PUSH    BC                          ;72ff  c5           18925  19070 
    POP IX                              ;7300  dd e1        18926  19071 
    POP BC                              ;7302  c1           18927  19072 
    DEC HL                              ;7303  2b           18928  19073 
    LD  A,(HL)                          ;7304  7e           18929  19074 
    EXX                                 ;7305  d9           18930  19075 
    ADC A,H                             ;7306  8c           18931  19076 
    LD  H,A                             ;7307  67           18932  19077 
    EXX                                 ;7308  d9           18933  19078 
    DEC HL                              ;7309  2b           18934  19079 
    LD  A,(HL)                          ;730a  7e           18935  19080 
    EXX                                 ;730b  d9           18936  19081 
    ADC A,L                             ;730c  8d           18937  19082 
    LD  L,A                             ;730d  6f           18938  19083 
    EXX                                 ;730e  d9           18939  19084 
    DEC HL                              ;730f  2b           18940  19085 
    LD  A,(HL)                          ;7310  7e           18941  19086 
    EXX                                 ;7311  d9           18942  19087 
    ADC A,B                             ;7312  88           18943  19088 
    LD  B,A                             ;7313  47           18944  19089 
    EXX                                 ;7314  d9           18945  19090 
    DEC HL                              ;7315  2b           18946  19091 
    LD  A,(HL)                          ;7316  7e           18947  19092 
    EXX                                 ;7317  d9           18948  19093 
    ADC A,C                             ;7318  89           18949  19094 
    LD  C,A                             ;7319  4f           18950  19095 
    EXX                                 ;731a  d9           18951  19096 
    DEC HL                              ;731b  2b           18952  19097 
    LD  A,(HL)                          ;731c  7e           18953  19098 
    EXX                                 ;731d  d9           18954  19099 
    SET 7,A                             ;731e  cb ff        18955  19100 
    ADC A,D                             ;7320  8a           18956  19101 
    LD  D,A                             ;7321  57           18957  19102 
    LD  A,E                             ;7322  7b           18958  19103 
    ADC A,0                             ;7323  ce 00        18959  19104 
    LD  E,A                             ;7325  5f           18960  19105 
    EXX                                 ;7326  d9           18961  19106 
    EX  DE,HL                           ;7327  eb           18962  19107 
DDCNT:  POP DE                          ;7328  d1           18963  19108 
    PUSH    IX                          ;7329  dd e5        18964  19109 
    EX  (SP),HL                         ;732b  e3           18965  19110 
    SLA H                               ;732c  cb 24        18966  19111 
    RL  L                               ;732e  cb 15        18967  19112 
    EX  (SP),HL                         ;7330  e3           18968  19113 
    POP IX                              ;7331  dd e1        18969  19114 
    EXX                                 ;7333  d9           18970  19115 
    RL  H                               ;7334  cb 14        18971  19116 
    RL  L                               ;7336  cb 15        18972  19117 
    RL  B                               ;7338  cb 10        18973  19118 
    RL  C                               ;733a  cb 11        18974  19119 
    RL  D                               ;733c  cb 12        18975  19120 
    RL  E                               ;733e  cb 13        18976  19121 
    EXX                                 ;7340  d9           18977  19122 
    DEC B                               ;7341  05           18978  19123 
    JP  NZ,DDLOP1                       ;7342  c2 ae 72     18979  19124 
    DEC C                               ;7345  0d           18980  19125 
    JP  NZ,DDLOP2                       ;7346  c2 ab 72     18981  19126 
    LD  HL,WRKFC+7                      ;7349  21 9a 73     18982  19127 
    LD  A,067h                          ;734c  3e 67        18983  19128 
    ADD A,(HL)                          ;734e  86           18984  19129 
    LD  (HL),A                          ;734f  77           18985  19130 
    LD  B,007h                          ;7350  06 07        18986  19131 
DDADLP: DEC HL                          ;7352  2b           18987  19132 
    LD  A,000h                          ;7353  3e 00        18988  19133 
    ADC A,(HL)                          ;7355  8e           18989  19134 
    LD  (HL),A                          ;7356  77           18990  19135 
    DJNZ    DDADLP                      ;7357  10 f9        18991  19136 
    XOR A                               ;7359  af           18992  19137 
    BIT 7,(HL)                          ;735a  cb 7e        18993  19138 
    JR  NZ,DDEXPC                       ;735c  20 0b        18994  19139 
    LD  HL,WRKFC+8                      ;735e  21 9b 73     18995  19140 
    LD  B,8                             ;7361  06 08        18996  19141 
DDNSLP: DEC HL                          ;7363  2b           18997  19142 
    RL  (HL)                            ;7364  cb 16        18998  19143 
    DJNZ    DDNSLP                      ;7366  10 fb        18999  19144 
    SCF                                 ;7368  37           19000  19145 
DDEXPC: POP HL                          ;7369  e1           19001  19146 
    POP DE                              ;736a  d1           19002  19147 
    PUSH    DE                          ;736b  d5           19003  19148 
    PUSH    HL                          ;736c  e5           19004  19149 
    LD  A,(HL)                          ;736d  7e           19005  19150 
    CCF                                 ;736e  3f           19006  19151 
    ADC A,080h                          ;736f  ce 80        19007  19152 
    LD  C,A                             ;7371  4f           19008  19153 
    LD  A,0                             ;7372  3e 00        19009  19154 
    ADC A,A                             ;7374  8f           19010  19155 
    LD  B,A                             ;7375  47           19011  19156 
    EX  DE,HL                           ;7376  eb           19012  19157 
    LD  A,C                             ;7377  79           19013  19158 
    SUB (HL)                            ;7378  96           19014  19159 
    EX  DE,HL                           ;7379  eb           19015  19160 
    LD  C,A                             ;737a  4f           19016  19161 
    LD  A,B                             ;737b  78           19017  19162 
    SBC A,0                             ;737c  de 00        19018  19163 
    JP  C,UNDRFL                        ;737e  da ab 70     19019  19164 
    JP  NZ,OVERFL1                      ;7381  c2 e4 6e     19020  19165 
    LD  (HL),C                          ;7384  71           19021  19166 
    INC HL                              ;7385  23           19022  19167 
    INC DE                              ;7386  13           19023  19168 
    LD  A,(DE)                          ;7387  1a           19024  19169 
    XOR (HL)                            ;7388  ae           19025  19170 
    RLCA                                ;7389  07           19026  19171 
    LD  B,7                             ;738a  06 07        19027  19172 
    JP  DDTRL                           ;738c  c3 7c 71     19028  19173 
                                        ;                   19029  19174 ;
    DEFS    4                           ;738f               19030  19175 
WRKFC:  DEFS    8                       ;7393               19031  19176 
WRKFC1: DEFS    8                       ;739b               19032  19177 
                                        ;                   19033  19178 ;    ORG 073A3H
LDIR1:      LD  HL,FLONE                ;73a3  21 98 62     19034  19179 ;!b
LDIR8:      LD  BC,00008h               ;73a6  01 08 00     19035  19180 ;
            LDIR                        ;73a9  ed b0        19036  19181 ;
            RET                         ;73ab  c9           19037  19182 ;
                                        ;                   19038  19183 
ONEADD:     LD  DE,FLONE                ;73ac  11 98 62     19039  19184 ;b
            JP  ADD                     ;73af  c3 a6 6c     19040  19185 ;l
L073B2h:    EX  DE,HL                   ;73b2  eb           19041  19186 ;
            LD  HL,00008h               ;73b3  21 08 00     19042  19187 ;!
            ADD HL,DE                   ;73b6  19           19043  19188 ;
            EX  DE,HL                   ;73b7  eb           19044  19189 ;
            RET                         ;73b8  c9           19045  19190 ;
                                        ;                   19046  19191 
B_SQR:      XOR A                       ;73b9  af           19047  19192 ;
            CP  (HL)                    ;73ba  be           19048  19193 ;
            RET Z                       ;73bb  c8           19049  19194 ;
            INC HL                      ;73bc  23           19050  19195 ;#
            BIT 7,(HL)                  ;73bd  cb 7e        19051  19196 ;~
            DEC HL                      ;73bf  2b           19052  19197 ;+
            JP  NZ,IFCALL               ;73c0  c2 36 17     19053  19198 ;6
            PUSH    BC                  ;73c3  c5           19054  19199 ;
            LD  DE,00008h               ;73c4  11 08 00     19055  19200 ;
            PUSH    HL                  ;73c7  e5           19056  19201 ;
            ADD HL,DE                   ;73c8  19           19057  19202 ;
            LD  (L073D1h+1),HL          ;73c9  22 d2 73     19058  19203 ;"s
            ADD HL,DE                   ;73cc  19           19059  19204 ;
            LD  (L073E4h+1),HL          ;73cd  22 e5 73     19060  19205 ;"s
            POP HL                      ;73d0  e1           19061  19206 ;
L073D1h:    LD  DE,00000h               ;73d1  11 00 00     19062  19207 ;
            PUSH    HL                  ;73d4  e5           19063  19208 ;
            PUSH    DE                  ;73d5  d5           19064  19209 ;
            CALL    LDIR8               ;73d6  cd a6 73     19065  19210 ;s
            POP HL                      ;73d9  e1           19066  19211 ;
            LD  A,(HL)                  ;73da  7e           19067  19212 ;~
            CP  082h                    ;73db  fe 82        19068  19213 ;
            ADC A,081h                  ;73dd  ce 81        19069  19214 ;
            DEC A                       ;73df  3d           19070  19215 ;=
            RRA                         ;73e0  1f           19071  19216 ;
            LD  (HL),A                  ;73e1  77           19072  19217 ;w
L073E2h:    POP HL                      ;73e2  e1           19073  19218 ;
            PUSH    HL                  ;73e3  e5           19074  19219 ;
L073E4h:    LD  DE,00000h               ;73e4  11 00 00     19075  19220 ;
            PUSH    DE                  ;73e7  d5           19076  19221 ;
            CALL    LDIR8               ;73e8  cd a6 73     19077  19222 ;s
            POP HL                      ;73eb  e1           19078  19223 ;
            LD  DE,(L073D1h+1)          ;73ec  ed 5b d2 73  19079  19224 ;[s
            CALL    DIV                 ;73f0  cd bd 70     19080  19225 ;p
            CALL    ADD                 ;73f3  cd a6 6c     19081  19226 ;l
            DEC (HL)                    ;73f6  35           19082  19227 ;5
            CALL    CMP                 ;73f7  cd d6 61     19083  19228 ;a
            JR  Z,L07401h               ;73fa  28 05        19084  19229 ;(
            CALL    LDIR8               ;73fc  cd a6 73     19085  19230 ;s
            JR  L073E2h                 ;73ff  18 e1        19086  19231 ;
L07401h:    POP DE                      ;7401  d1           19087  19232 ;
            PUSH    DE                  ;7402  d5           19088  19233 ;
            CALL    LDIR8               ;7403  cd a6 73     19089  19234 ;s
            POP HL                      ;7406  e1           19090  19235 ;
            POP BC                      ;7407  c1           19091  19236 ;
            RET                         ;7408  c9           19092  19237 ;
                                        ;                   19093  19238 
B_SUM:      CALL    B_FIX               ;7409  cd 10 60     19094  19239 ;` 7409
            LD  A,(HL)                  ;740c  7e           19095  19240 ;~
            OR  A                       ;740d  b7           19096  19241 ;
            RET Z                       ;740e  c8           19097  19242 ;
            INC HL                      ;740f  23           19098  19243 ;#
            BIT 7,(HL)                  ;7410  cb 7e        19099  19244 ;~
            DEC HL                      ;7412  2b           19100  19245 ;+
            JP  NZ,IFCALL               ;7413  c2 36 17     19101  19246 ;6
            PUSH    BC                  ;7416  c5           19102  19247 ;
            CALL    L073B2h             ;7417  cd b2 73     19103  19248 ;s
            PUSH    HL                  ;741a  e5           19104  19249 ;
            PUSH    DE                  ;741b  d5           19105  19250 ;
            CALL    LDIR8               ;741c  cd a6 73     19106  19251 ;s
            POP HL                      ;741f  e1           19107  19252 ;
            CALL    ONEADD              ;7420  cd ac 73     19108  19253 ;s
            EX  DE,HL                   ;7423  eb           19109  19254 ;
            POP HL                      ;7424  e1           19110  19255 ;
            CALL    MUL                 ;7425  cd e0 6f     19111  19256 ;o
            DEC (HL)                    ;7428  35           19112  19257 ;5
            POP BC                      ;7429  c1           19113  19258 ;
            RET                         ;742a  c9           19114  19259 ;
                                        ;                   19115  19260 
B_FACG:     PUSH    BC                  ;742b  c5           19116  19261 ;
            CALL    B_FIX               ;742c  cd 10 60     19117  19262 ;`
            LD  A,(HL)                  ;742f  7e           19118  19263 ;~
            OR  A                       ;7430  b7           19119  19264 ;
            JR  Z,L07437h               ;7431  28 04        19120  19265 ;(
            CP  082h                    ;7433  fe 82        19121  19266 ;
            JR  NC,L0743Fh              ;7435  30 08        19122  19267 ;0
L07437h:    PUSH    HL                  ;7437  e5           19123  19268 ;
            EX  DE,HL                   ;7438  eb           19124  19269 ;
            CALL    LDIR1               ;7439  cd a3 73     19125  19270 ;s
            POP HL                      ;743c  e1           19126  19271 ;
            POP BC                      ;743d  c1           19127  19272 ;
            RET                         ;743e  c9           19128  19273 ;
                                        ;                   19129  19274 
L0743Fh:    PUSH    HL                  ;743f  e5           19130  19275 ;
            CALL    HEXFLT              ;7440  cd 5d 61     19131  19276 ;]a
            XOR A                       ;7443  af           19132  19277 ;
            CP  H                       ;7444  bc           19133  19278 ;
            JP  NZ,OVERFL1              ;7445  c2 e4 6e     19134  19279 ;n
            LD  A,L                     ;7448  7d           19135  19280 ;}
            CP  022h                    ;7449  fe 22        19136  19281 ;"
            JP  NC,OVERFL1              ;744b  d2 e4 6e     19137  19282 ;n
            LD  B,L                     ;744e  45           19138  19283 ;E
            POP DE                      ;744f  d1           19139  19284 ;
            LD  HL,00008h               ;7450  21 08 00     19140  19285 ;!
            ADD HL,DE                   ;7453  19           19141  19286 ;
            PUSH    HL                  ;7454  e5           19142  19287 ;
            PUSH    DE                  ;7455  d5           19143  19288 ;
            PUSH    BC                  ;7456  c5           19144  19289 ;
            EX  DE,HL                   ;7457  eb           19145  19290 ;
            CALL    LDIR1               ;7458  cd a3 73     19146  19291 ;s
            POP BC                      ;745b  c1           19147  19292 ;
            POP DE                      ;745c  d1           19148  19293 ;
            POP HL                      ;745d  e1           19149  19294 ;
L0745Eh:    PUSH    BC                  ;745e  c5           19150  19295 ;
            CALL    MUL                 ;745f  cd e0 6f     19151  19296 ;o
            PUSH    HL                  ;7462  e5           19152  19297 ;
            EX  DE,HL                   ;7463  eb           19153  19298 ;
            CALL    ONESUB              ;7464  cd ce 6b     19154  19299 ;k
            EX  DE,HL                   ;7467  eb           19155  19300 ;
            POP HL                      ;7468  e1           19156  19301 ;
            POP BC                      ;7469  c1           19157  19302 ;
            DJNZ    L0745Eh             ;746a  10 f2        19158  19303 ;
            PUSH    DE                  ;746c  d5           19159  19304 ;
            CALL    LDIR8               ;746d  cd a6 73     19160  19305 ;s
            POP HL                      ;7470  e1           19161  19306 ;
            POP BC                      ;7471  c1           19162  19307 ;
            RET                         ;7472  c9           19163  19308 ;
                                        ;                   19164  19309 
L07473h:    LD  A,(HL)                  ;7473  7e           19165  19310 ;~
            LD  C,H                     ;7474  4c           19166  19311 ;L
L07475h:    ADD A,B                     ;7475  80           19167  19312 ;
            DEC HL                      ;7476  2b           19168  19313 ;+
B_ATN:      PUSH    BC                  ;7477  c5           19169  19314 ;
            INC HL                      ;7478  23           19170  19315 ;#
            LD  A,(HL)                  ;7479  7e           19171  19316 ;~
            RES 7,(HL)                  ;747a  cb be        19172  19317 ;
            DEC HL                      ;747c  2b           19173  19318 ;+
            PUSH    AF                  ;747d  f5           19174  19319 ;
            CALL    L07488h             ;747e  cd 88 74     19175  19320 ;t
            POP AF                      ;7481  f1           19176  19321 ;
            POP BC                      ;7482  c1           19177  19322 ;
            RLCA                        ;7483  07           19178  19323 ;
            RET NC                      ;7484  d0           19179  19324 ;
            JP  TOGLE                   ;7485  c3 eb 6b     19180  19325 ;k
L07488h:    CALL    ONECMP              ;7488  cd d3 61     19181  19326 ;a
            JR  C,L074ADh               ;748b  38 20        19182  19327 ;8 
            CALL    L073B2h             ;748d  cd b2 73     19183  19328 ;s
            PUSH    DE                  ;7490  d5           19184  19329 ;
            PUSH    HL                  ;7491  e5           19185  19330 ;
            CALL    LDIR8               ;7492  cd a6 73     19186  19331 ;s
            POP DE                      ;7495  d1           19187  19332 ;
            PUSH    DE                  ;7496  d5           19188  19333 ;
            CALL    LDIR1               ;7497  cd a3 73     19189  19334 ;s
            POP HL                      ;749a  e1           19190  19335 ;
            POP DE                      ;749b  d1           19191  19336 ;
            CALL    DIV                 ;749c  cd bd 70     19192  19337 ;p
            CALL    L074ADh             ;749f  cd ad 74     19193  19338 ;t
            LD  DE,PAITBL               ;74a2  11 78 77     19194  19339 ;xw
            INC (HL)                    ;74a5  34           19195  19340 ;4
            CALL    SUB                 ;74a6  cd d1 6b     19196  19341 ;k
            DEC (HL)                    ;74a9  35           19197  19342 ;5
            JP  B_ABS                   ;74aa  c3 c0 6b     19198  19343 ;k
L074ADh:    LD  A,0FFh                  ;74ad  3e ff        19199  19344 ;>
            LD  (L07602h+1),A           ;74af  32 03 76     19200  19345 ;2v
            LD  DE,L07473h              ;74b2  11 73 74     19201  19346 ;st
            CALL    CMP                 ;74b5  cd d6 61     19202  19347 ;a
            JR  C,L07509h               ;74b8  38 4f        19203  19348 ;8O
            LD  DE,L07475h              ;74ba  11 75 74     19204  19349 ;ut
            CALL    CMP                 ;74bd  cd d6 61     19205  19350 ;a
            PUSH    AF                  ;74c0  f5           19206  19351 ;
            CALL    L073B2h             ;74c1  cd b2 73     19207  19352 ;s
            POP AF                      ;74c4  f1           19208  19353 ;
            PUSH    HL                  ;74c5  e5           19209  19354 ;
            PUSH    DE                  ;74c6  d5           19210  19355 ;
            CALL    LDIR8               ;74c7  cd a6 73     19211  19356 ;s
            POP HL                      ;74ca  e1           19212  19357 ;
            JR  C,L074E1h               ;74cb  38 14        19213  19358 ;8
            CALL    ONEADD              ;74cd  cd ac 73     19214  19359 ;s
            EX  (SP),HL                 ;74d0  e3           19215  19360 ;
            CALL    SUB                 ;74d1  cd d1 6b     19216  19361 ;k
            POP DE                      ;74d4  d1           19217  19362 ;
            CALL    DIV                 ;74d5  cd bd 70     19218  19363 ;p
            CALL    L07509h             ;74d8  cd 09 75     19219  19364 ;u
            LD  DE,SINTBL3              ;74db  11 4a 77     19220  19365 ;Jw
            JP  ADD                     ;74de  c3 a6 6c     19221  19366 ;l
L074E1h:    LD  DE,L07501h              ;74e1  11 01 75     19222  19367 ;u
            CALL    MUL                 ;74e4  cd e0 6f     19223  19368 ;o
            CALL    ONEADD              ;74e7  cd ac 73     19224  19369 ;s
            EX  (SP),HL                 ;74ea  e3           19225  19370 ;
            LD  DE,L07501h              ;74eb  11 01 75     19226  19371 ;u
            CALL    SUB                 ;74ee  cd d1 6b     19227  19372 ;k
            POP DE                      ;74f1  d1           19228  19373 ;
            CALL    DIV                 ;74f2  cd bd 70     19229  19374 ;p
            CALL    L07509h             ;74f5  cd 09 75     19230  19375 ;u
            INC (HL)                    ;74f8  34           19231  19376 ;4
            LD  DE,SINTBL3              ;74f9  11 4a 77     19232  19377 ;Jw
            CALL    ADD                 ;74fc  cd a6 6c     19233  19378 ;l
            DEC (HL)                    ;74ff  35           19234  19379 ;5
            RET                         ;7500  c9           19235  19380 ;
                                        ;                   19236  19381 
L07501h:    LD  A,A                     ;7501  7f           19237  19382 ;
            LD  D,H                     ;7502  54           19238  19383 ;T
            INC DE                      ;7503  13           19239  19384 ;
L0E7CFh     EQU    0E7CFh               ;e7cf               19240  19385 
            CALL    Z,L0E7CFh           ;7504  cc cf e7     19241  19386 ;
            LD  A,C                     ;7507  79           19242  19387 ;y
            SUB B                       ;7508  90           19243  19388 ;
L07509h:    PUSH    BC                  ;7509  c5           19244  19389 ;
            PUSH    HL                  ;750a  e5           19245  19390 ;
            LD  (L075F2h+1),HL          ;750b  22 f3 75     19246  19391 ;"u
            LD  DE,00008h               ;750e  11 08 00     19247  19392 ;
            ADD HL,DE                   ;7511  19           19248  19393 ;
            LD  (L075E2h+1),HL          ;7512  22 e3 75     19249  19394 ;"u
            ADD HL,DE                   ;7515  19           19250  19395 ;
            LD  (L075C8h),HL            ;7516  22 c8 75     19251  19396 ;"u
            ADD HL,DE                   ;7519  19           19252  19397 ;
            LD  (L075DAh+1),HL          ;751a  22 db 75     19253  19398 ;"u
            EX  DE,HL                   ;751d  eb           19254  19399 ;
            POP HL                      ;751e  e1           19255  19400 ;
            PUSH    HL                  ;751f  e5           19256  19401 ;
            PUSH    DE                  ;7520  d5           19257  19402 ;
            CALL    LDIR8               ;7521  cd a6 73     19258  19403 ;s
            POP HL                      ;7524  e1           19259  19404 ;
            LD  E,L                     ;7525  5d           19260  19405 ;]
            LD  D,H                     ;7526  54           19261  19406 ;T
            CALL    MUL                 ;7527  cd e0 6f     19262  19407 ;o
            LD  DE,(L075C8h)            ;752a  ed 5b c8 75  19263  19408 ;[u
            POP HL                      ;752e  e1           19264  19409 ;
            PUSH    HL                  ;752f  e5           19265  19410 ;
            CALL    LDIR8               ;7530  cd a6 73     19266  19411 ;s
            LD  A,(IY+0)                ;7533  fd 7e 00     19267  19412 ;~
            DEC A                       ;7536  3d           19268  19413 ;=
            CP  003h                    ;7537  fe 03        19269  19414 ;
            LD  B,A                     ;7539  47           19270  19415 ;G
            LD  HL,L076FAh              ;753a  21 fa 76     19271  19416 ;!v
            JP  Z,L075D5h               ;753d  ca d5 75     19272  19417 ;u
            LD  B,00Ah                  ;7540  06 0a        19273  19418 ;
            JP  L075D5h                 ;7542  c3 d5 75     19274  19419 ;u
B_COS:      PUSH    BC                  ;7545  c5           19275  19420 ;
            LD  A,(HL)                  ;7546  7e           19276  19421 ;~
            OR  A                       ;7547  b7           19277  19422 ;
            JP  Z,L07437h               ;7548  ca 37 74     19278  19423 ;7t
            LD  DE,SINTBL3              ;754b  11 4a 77     19279  19424 ;Jw
            DEC (HL)                    ;754e  35           19280  19425 ;5
            CALL    SUB                 ;754f  cd d1 6b     19281  19426 ;k
            INC (HL)                    ;7552  34           19282  19427 ;4
            CALL    TOGLE               ;7553  cd eb 6b     19283  19428 ;k
            POP BC                      ;7556  c1           19284  19429 ;
B_SIN:      PUSH    BC                  ;7557  c5           19285  19430 ;
            PUSH    HL                  ;7558  e5           19286  19431 ;
            INC HL                      ;7559  23           19287  19432 ;#
            LD  A,(HL)                  ;755a  7e           19288  19433 ;~
            RES 7,(HL)                  ;755b  cb be        19289  19434 ;
            AND 080h                    ;755d  e6 80        19290  19435 ;
            CPL                         ;755f  2f           19291  19436 ;/
            LD  (L07602h+1),A           ;7560  32 03 76     19292  19437 ;2v
            DEC HL                      ;7563  2b           19293  19438 ;+
            CALL    L073B2h             ;7564  cd b2 73     19294  19439 ;s
            LD  HL,SINTBL3              ;7567  21 4a 77     19295  19440 ;!Jw
            PUSH    DE                  ;756a  d5           19296  19441 ;
            CALL    LDIR8               ;756b  cd a6 73     19297  19442 ;s
            POP HL                      ;756e  e1           19298  19443 ;
            INC (HL)                    ;756f  34           19299  19444 ;4
            INC (HL)                    ;7570  34           19300  19445 ;4
            INC (HL)                    ;7571  34           19301  19446 ;4
            EX  DE,HL                   ;7572  eb           19302  19447 ;
            POP HL                      ;7573  e1           19303  19448 ;
            PUSH    HL                  ;7574  e5           19304  19449 ;
            CALL    CMP                 ;7575  cd d6 61     19305  19450 ;a
            CALL    NC,MOD              ;7578  d4 4f 61     19306  19451 ;Oa
            EX  DE,HL                   ;757b  eb           19307  19452 ;
            DEC (HL)                    ;757c  35           19308  19453 ;5
            EX  DE,HL                   ;757d  eb           19309  19454 ;
            CALL    CMP                 ;757e  cd d6 61     19310  19455 ;a
            JR  C,L0758Eh               ;7581  38 0b        19311  19456 ;8
            CALL    SUB                 ;7583  cd d1 6b     19312  19457 ;k
            LD  A,(L07602h+1)           ;7586  3a 03 76     19313  19458 ;:v
            XOR 080h                    ;7589  ee 80        19314  19459 ;
            LD  (L07602h+1),A           ;758b  32 03 76     19315  19460 ;2v
L0758Eh:    EX  DE,HL                   ;758e  eb           19316  19461 ;
            DEC (HL)                    ;758f  35           19317  19462 ;5
            EX  DE,HL                   ;7590  eb           19318  19463 ;
            CALL    CMP                 ;7591  cd d6 61     19319  19464 ;a
            JR  C,L0759Eh               ;7594  38 08        19320  19465 ;8
            DEC (HL)                    ;7596  35           19321  19466 ;5
            CALL    SUB                 ;7597  cd d1 6b     19322  19467 ;k
            INC (HL)                    ;759a  34           19323  19468 ;4
            CALL    B_ABS               ;759b  cd c0 6b     19324  19469 ;k
L0759Eh:    LD  (L075F2h+1),HL          ;759e  22 f3 75     19325  19470 ;"u
            LD  DE,00008h               ;75a1  11 08 00     19326  19471 ;
            ADD HL,DE                   ;75a4  19           19327  19472 ;
            LD  (L075E2h+1),HL          ;75a5  22 e3 75     19328  19473 ;"u
            ADD HL,DE                   ;75a8  19           19329  19474 ;
            LD  (L075C8h),HL            ;75a9  22 c8 75     19330  19475 ;"u
            ADD HL,DE                   ;75ac  19           19331  19476 ;
            LD  (L075DAh+1),HL          ;75ad  22 db 75     19332  19477 ;"u
            EX  DE,HL                   ;75b0  eb           19333  19478 ;
            POP HL                      ;75b1  e1           19334  19479 ;
            PUSH    DE                  ;75b2  d5           19335  19480 ;
            LD  DE,SINTBL3              ;75b3  11 4a 77     19336  19481 ;Jw
            CALL    CMP                 ;75b6  cd d6 61     19337  19482 ;a
            JR  NC,L0761Bh              ;75b9  30 60        19338  19483 ;0`
            POP DE                      ;75bb  d1           19339  19484 ;
            PUSH    HL                  ;75bc  e5           19340  19485 ;
            PUSH    DE                  ;75bd  d5           19341  19486 ;
            CALL    LDIR8               ;75be  cd a6 73     19342  19487 ;s
            POP HL                      ;75c1  e1           19343  19488 ;
            LD  E,L                     ;75c2  5d           19344  19489 ;]
            LD  D,H                     ;75c3  54           19345  19490 ;T
            CALL    MUL                 ;75c4  cd e0 6f     19346  19491 ;o
            DEFB 011h                   ;75c7  11           19347  19492 ; LD DE, xxxx
L075C8h:                                ;                   19348  19493 
            DEFW 0                      ;75c8  00 00        19349  19494 ;
            POP HL                      ;75ca  e1           19350  19495 ;
            PUSH    HL                  ;75cb  e5           19351  19496 ;
            CALL    LDIR8               ;75cc  cd a6 73     19352  19497 ;s
            LD  B,(IY+0)                ;75cf  fd 46 00     19353  19498 ;F
            LD  HL,SINTBL1              ;75d2  21 7a 76     19354  19499 ;!zv
L075D5h:    PUSH    BC                  ;75d5  c5           19355  19500 ;
            PUSH    HL                  ;75d6  e5           19356  19501 ;
            LD  HL,(L075C8h)            ;75d7  2a c8 75     19357  19502 ;*u
L075DAh:    LD  DE,00000h               ;75da  11 00 00     19358  19503 ;
            CALL    MUL                 ;75dd  cd e0 6f     19359  19504 ;o
            POP HL                      ;75e0  e1           19360  19505 ;
            PUSH    HL                  ;75e1  e5           19361  19506 ;
L075E2h:    LD  DE,00000h               ;75e2  11 00 00     19362  19507 ;
            PUSH    DE                  ;75e5  d5           19363  19508 ;
            CALL    LDIR8               ;75e6  cd a6 73     19364  19509 ;s
            POP HL                      ;75e9  e1           19365  19510 ;
            LD  DE,(L075C8h)            ;75ea  ed 5b c8 75  19366  19511 ;[u
            CALL    MUL                 ;75ee  cd e0 6f     19367  19512 ;o
            EX  DE,HL                   ;75f1  eb           19368  19513 ;
L075F2h:    LD  HL,00000h               ;75f2  21 00 00     19369  19514 ;!
            CALL    ADD                 ;75f5  cd a6 6c     19370  19515 ;l
            POP HL                      ;75f8  e1           19371  19516 ;
            LD  DE,00008h               ;75f9  11 08 00     19372  19517 ;
            ADD HL,DE                   ;75fc  19           19373  19518 ;
            POP BC                      ;75fd  c1           19374  19519 ;
            DJNZ    L075D5h             ;75fe  10 d5        19375  19520 ;
            POP HL                      ;7600  e1           19376  19521 ;
            POP BC                      ;7601  c1           19377  19522 ;
L07602h:    LD  A,000h                  ;7602  3e 00        19378  19523 ;>
            INC HL                      ;7604  23           19379  19524 ;#
            XOR (HL)                    ;7605  ae           19380  19525 ;
            CPL                         ;7606  2f           19381  19526 ;/
            LD  (HL),A                  ;7607  77           19382  19527 ;w
            DEC HL                      ;7608  2b           19383  19528 ;+
            LD  A,(IY+0)                ;7609  fd 7e 00     19384  19529 ;~
            CP  008h                    ;760c  fe 08        19385  19530 ;
            LD  A,(HL)                  ;760e  7e           19386  19531 ;~
            JR  Z,L07617h               ;760f  28 06        19387  19532 ;(
            CP  06Ch                    ;7611  fe 6c        19388  19533 ;l
L07613h:    RET NC                      ;7613  d0           19389  19534 ;
            JP  CLRFAC                  ;7614  c3 a9 28     19390  19535 ;(
L07617h:    CP  04Dh                    ;7617  fe 4d        19391  19536 ;M
            JR  L07613h                 ;7619  18 f8        19392  19537 ;
L0761Bh:    DEC (HL)                    ;761b  35           19393  19538 ;5
            LD  DE,SINTBL3              ;761c  11 4a 77     19394  19539 ;Jw
            CALL    SUB                 ;761f  cd d1 6b     19395  19540 ;k
            INC (HL)                    ;7622  34           19396  19541 ;4
            CALL    B_ABS               ;7623  cd c0 6b     19397  19542 ;k
            POP DE                      ;7626  d1           19398  19543 ;
            PUSH    HL                  ;7627  e5           19399  19544 ;
            PUSH    DE                  ;7628  d5           19400  19545 ;
            CALL    LDIR8               ;7629  cd a6 73     19401  19546 ;s
            POP HL                      ;762c  e1           19402  19547 ;
            LD  E,L                     ;762d  5d           19403  19548 ;]
            LD  D,H                     ;762e  54           19404  19549 ;T
            CALL    MUL                 ;762f  cd e0 6f     19405  19550 ;o
            LD  DE,(L075C8h)            ;7632  ed 5b c8 75  19406  19551 ;[u
            CALL    LDIR1               ;7636  cd a3 73     19407  19552 ;s
            POP DE                      ;7639  d1           19408  19553 ;
            PUSH    DE                  ;763a  d5           19409  19554 ;
            CALL    LDIR1               ;763b  cd a3 73     19410  19555 ;s
            LD  B,(IY+0)                ;763e  fd 46 00     19411  19556 ;F
            LD  HL,SINTBL2              ;7641  21 ba 76     19412  19557 ;!v
L07644h:    JR  L075D5h                 ;7644  18 8f        19413  19558 ;
B_TAN:                                  ;                   19414  19559 
            PUSH    BC                  ;7646  c5           19415  19560 ;
            PUSH    HL                  ;7647  e5           19416  19561 ;
            LD  DE,00008h               ;7648  11 08 00     19417  19562 ;
            ADD HL,DE                   ;764b  19           19418  19563 ;
            LD  (L0766Dh+1),HL          ;764c  22 6e 76     19419  19564 ;"nv
            ADD HL,DE                   ;764f  19           19420  19565 ;
            LD  (L07662h+1),HL          ;7650  22 63 76     19421  19566 ;"cv
            EX  DE,HL                   ;7653  eb           19422  19567 ;
            POP HL                      ;7654  e1           19423  19568 ;
            PUSH    HL                  ;7655  e5           19424  19569 ;
            CALL    LDIR8               ;7656  cd a6 73     19425  19570 ;s
            LD  HL,(L0766Dh+1)          ;7659  2a 6e 76     19426  19571 ;*nv
            EX  DE,HL                   ;765c  eb           19427  19572 ;
            POP HL                      ;765d  e1           19428  19573 ;
            PUSH    HL                  ;765e  e5           19429  19574 ;
            CALL    LDIR8               ;765f  cd a6 73     19430  19575 ;s
L07662h:    LD  HL,00000h               ;7662  21 00 00     19431  19576 ;!
            CALL    B_SIN               ;7665  cd 57 75     19432  19577 ;Wu
            POP DE                      ;7668  d1           19433  19578 ;
            PUSH    DE                  ;7669  d5           19434  19579 ;
            CALL    LDIR8               ;766a  cd a6 73     19435  19580 ;s
L0766Dh:    LD  HL,00000h               ;766d  21 00 00     19436  19581 ;!
            CALL    B_COS               ;7670  cd 45 75     19437  19582 ;Eu
            EX  DE,HL                   ;7673  eb           19438  19583 ;
            POP HL                      ;7674  e1           19439  19584 ;
            CALL    DIV                 ;7675  cd bd 70     19440  19585 ;p
            POP BC                      ;7678  c1           19441  19586 ;
            RET                         ;7679  c9           19442  19587 ;
SINTBL1:                                ;                   19443  19588 
            DEFB 07Eh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;767a  7e aa aa aa  19444  19589 
                                        ;767e  aa aa aa ab  19444  19590
            DEFB 07Ah, 008h, 088h, 088h, 088h, 088h, 088h, 089h;7682  7a 08 88 88  19445  19591 
                                        ;7686  88 88 88 89  19445  19592
            DEFB 074h, 0D0h, 00Dh, 000h, 0D0h, 00Dh, 000h, 0D0h;768a  74 d0 0d 00  19446  19593 
                                        ;768e  d0 0d 00 d0  19446  19594
            DEFB 06Eh, 038h, 0EFh, 01Dh, 02Ah, 0B6h, 039h, 09Ch;7692  6e 38 ef 1d  19447  19595 
                                        ;7696  2a b6 39 9c  19447  19596
            DEFB 067h, 0D7h, 032h, 02Bh, 03Fh, 0AAh, 027h, 01Ch;769a  67 d7 32 2b  19448  19597 
                                        ;769e  3f aa 27 1c  19448  19598
            DEFB 060h, 030h, 092h, 030h, 09Dh, 043h, 068h, 04Ch;76a2  60 30 92 30  19449  19599 
                                        ;76a6  9d 43 68 4c  19449  19600
            DEFB 058h, 0D7h, 03Fh, 09Fh, 039h, 09Dh, 0C0h, 0F9h;76aa  58 d7 3f 9f  19450  19601 
                                        ;76ae  39 9d c0 f9  19450  19602
            DEFB 050h, 04Ah, 096h, 03Bh, 081h, 085h, 06Ah, 053h;76b2  50 4a 96 3b  19451  19603 
                                        ;76b6  81 85 6a 53  19451  19604
SINTBL2:                                ;                   19452  19605 
            DEFB 080h, 080h, 000h, 000h, 000h, 000h, 000h, 000h;76ba  80 80 00 00  19453  19606 
                                        ;76be  00 00 00 00  19453  19607
            DEFB 07Ch, 02Ah, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;76c2  7c 2a aa aa  19454  19608 
                                        ;76c6  aa aa aa ab  19454  19609
            DEFB 077h, 0B6h, 00Bh, 060h, 0B6h, 00Bh, 060h, 0B7h;76ca  77 b6 0b 60  19455  19610 
                                        ;76ce  b6 0b 60 b7  19455  19611
            DEFB 071h, 050h, 00Dh, 000h, 0D0h, 00Dh, 000h, 0D1h;76d2  71 50 0d 00  19456  19612 
                                        ;76d6  d0 0d 00 d1  19456  19613
            DEFB 06Bh, 093h, 0F2h, 07Dh, 0BBh, 0C4h, 0FAh, 0E4h;76da  6b 93 f2 7d  19457  19614 
                                        ;76de  bb c4 fa e4  19457  19615
            DEFB 064h, 00Fh, 076h, 0C7h, 07Fh, 0C6h, 0C4h, 0BEh;76e2  64 0f 76 c7  19458  19616 
                                        ;76e6  7f c6 c4 be  19458  19617
            DEFB 05Ch, 0C9h, 0CBh, 0A5h, 046h, 003h, 0E4h, 0EAh;76ea  5c c9 cb a5  19459  19618 
                                        ;76ee  46 03 e4 ea  19459  19619
            DEFB 054h, 057h, 03Fh, 09Fh, 039h, 09Dh, 0C0h, 0F9h;76f2  54 57 3f 9f  19460  19620 
                                        ;76f6  39 9d c0 f9  19460  19621
L076FAh:    DEFB 07Fh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;76fa  7f aa aa aa  19461  19622 
                                        ;76fe  aa aa aa ab  19461  19623
            DEFB 07Eh, 04Ch, 0CCh, 0CCh, 0CCh, 0CCh, 0CCh, 0CDh;7702  7e 4c cc cc  19462  19624 
                                        ;7706  cc cc cc cd  19462  19625
            DEFB 07Eh, 092h, 049h, 024h, 092h, 049h, 024h, 093h;770a  7e 92 49 24  19463  19626 
                                        ;770e  92 49 24 93  19463  19627
            DEFB 07Dh, 063h, 08Eh, 038h, 0E3h, 08Eh, 038h, 0E4h;7712  7d 63 8e 38  19464  19628 
                                        ;7716  e3 8e 38 e4  19464  19629
            DEFB 07Dh, 0BAh, 02Eh, 08Bh, 0A2h, 0E8h, 0BAh, 02Fh;771a  7d ba 2e 8b  19465  19630 
                                        ;771e  a2 e8 ba 2f  19465  19631
            DEFB 07Dh, 01Dh, 089h, 0D8h, 09Dh, 089h, 0D8h, 09Eh;7722  7d 1d 89 d8  19466  19632 
                                        ;7726  9d 89 d8 9e  19466  19633
            DEFB 07Dh, 088h, 088h, 088h, 088h, 088h, 088h, 089h;772a  7d 88 88 88  19467  19634 
                                        ;772e  88 88 88 89  19467  19635
            DEFB 07Ch, 070h, 0F0h, 0F0h, 0F0h, 0F0h, 0F0h, 0F1h;7732  7c 70 f0 f0  19468  19636 
                                        ;7736  f0 f0 f0 f1  19468  19637
            DEFB 07Ch, 0D7h, 094h, 035h, 0E5h, 00Dh, 079h, 044h;773a  7c d7 94 35  19469  19638 
                                        ;773e  e5 0d 79 44  19469  19639
            DEFB 07Ch, 043h, 00Ch, 030h, 0C3h, 00Ch, 030h, 0C4h;7742  7c 43 0c 30  19470  19640 
                                        ;7746  c3 0c 30 c4  19470  19641
SINTBL3:    DEFB 080h, 049h, 00Fh, 0DAh, 0A2h, 021h, 068h, 0C2h;774a  80 49 0f da  19471  19642 
                                        ;774e  a2 21 68 c2  19471  19643
                                        ;                   19472  19644 ;    ORG 07752h
B_SGN:      LD A,(HL)                   ;7752  7e           19473  19645 
            OR A                        ;7753  b7           19474  19646 
            RET Z                       ;7754  c8           19475  19647 
            INC HL                      ;7755  23           19476  19648 ;#
            BIT 7,(HL)                  ;7756  cb 7e        19477  19649 ;~
            DEC HL                      ;7758  2b           19478  19650 ;+
            JR  NZ,L07764h              ;7759  20 09        19479  19651 ;     
L0775Bh:    PUSH    HL                  ;775b  e5           19480  19652 ;
            EX  DE,HL                   ;775c  eb           19481  19653 ;
            PUSH    BC                  ;775d  c5           19482  19654 ;
            CALL    LDIR1               ;775e  cd a3 73     19483  19655 ;s
            POP BC                      ;7761  c1           19484  19656 ;
            POP HL                      ;7762  e1           19485  19657 ;
            RET                         ;7763  c9           19486  19658 ;
                                        ;                   19487  19659 
L07764h:    CALL    L0775Bh             ;7764  cd 5b 77     19488  19660 ;[w
            JP  TOGLE                   ;7767  c3 eb 6b     19489  19661 ;k
B_RAD:      LD  DE,07780h               ;776a  11 80 77     19490  19662 ;w
            JR  L07772h                 ;776d  18 03        19491  19663 ;h
B_PAI:      LD  DE,PAITBL               ;776f  11 78 77     19492  19664 ;xw
L07772h:    PUSH    BC                  ;7772  c5           19493  19665 ;
            CALL    MUL                 ;7773  cd e0 6f     19494  19666 ;o
            POP BC                      ;7776  c1           19495  19667 ;
            RET                         ;7777  c9           19496  19668 ;
PAITBL:                                 ;                   19497  19669 
            DEFB 082h, 049h, 00Fh, 0DAh ;7778  82 49 0f da  19498  19670 
            DEFB 0A2h, 021h, 068h, 0C2h ;777c  a2 21 68 c2  19499  19671 
            DEFB 07Bh, 00Eh, 0FAh, 035h ;7780  7b 0e fa 35  19500  19672 
            DEFB 012h, 094h, 0E9h, 0C9h ;7784  12 94 e9 c9  19501  19673 
                                        ;                   19502  19674 
B_INP:      PUSH    HL                  ;7788  e5           19503  19675 ;
            PUSH    BC                  ;7789  c5           19504  19676 ;
            CALL    HLFLT               ;778a  cd 67 61     19505  19677 ;ga
            LD  B,H                     ;778d  44           19506  19678 ;D
            LD  C,L                     ;778e  4d           19507  19679 ;M
            IN  A,(C)                   ;778f  ed 78        19508  19680 ;x
            LD  E,A                     ;7791  5f           19509  19681 ;_
            LD  D,000h                  ;7792  16 00        19510  19682 ;
            POP BC                      ;7794  c1           19511  19683 ;
            POP HL                      ;7795  e1           19512  19684 ;
            JP  FLTHEX                  ;7796  c3 02 29     19513  19685 ;)
B_RND:      PUSH    BC                  ;7799  c5           19514  19686 ;
            LD  DE,(L077C8h)            ;779a  ed 5b c8 77  19515  19687 ;[w
            LD  A,R                     ;779e  ed 5f        19516  19688 ;_
            XOR D                       ;77a0  aa           19517  19689 ;
            RRC A                       ;77a1  cb 0f        19518  19690 ;
            RRC A                       ;77a3  cb 0f        19519  19691 ;
            RRC A                       ;77a5  cb 0f        19520  19692 ;
            LD  D,A                     ;77a7  57           19521  19693 ;W
            LD  A,R                     ;77a8  ed 5f        19522  19694 ;_
            XOR E                       ;77aa  ab           19523  19695 ;
            RLC A                       ;77ab  cb 07        19524  19696 ;
            RLC A                       ;77ad  cb 07        19525  19697 ;
            LD  E,D                     ;77af  5a           19526  19698 ;Z
            LD  D,A                     ;77b0  57           19527  19699 ;W
            LD  (L077C8h),DE            ;77b1  ed 53 c8 77  19528  19700 ;Sw
            PUSH    HL                  ;77b5  e5           19529  19701 ;
            INC HL                      ;77b6  23           19530  19702 ;#
            RES 7,D                     ;77b7  cb ba        19531  19703 ;
            LD  (HL),D                  ;77b9  72           19532  19704 ;r
            INC HL                      ;77ba  23           19533  19705 ;#
            LD  (HL),E                  ;77bb  73           19534  19706 ;s
            INC HL                      ;77bc  23           19535  19707 ;#
            LD  A,R                     ;77bd  ed 5f        19536  19708 ;_
            LD  (HL),A                  ;77bf  77           19537  19709 ;w
            POP HL                      ;77c0  e1           19538  19710 ;
            LD  (HL),081h               ;77c1  36 81        19539  19711 ;6
            CALL    ONESUB              ;77c3  cd ce 6b     19540  19712 ;k
            POP BC                      ;77c6  c1           19541  19713 ;
            RET                         ;77c7  c9           19542  19714 ;
                                        ;                   19543  19715 
L077C8h:    DEFW 04193h                 ;77c8  93 41        19544  19716 ;      	SUB	E;LD	B,C         
B_EXP:      PUSH    BC                  ;77ca  c5           19545  19717 ;
            LD  A,(HL)                  ;77cb  7e           19546  19718 ;~
            OR  A                       ;77cc  b7           19547  19719 ;
            JP  Z,L07437h               ;77cd  ca 37 74     19548  19720 ;7t
            INC HL                      ;77d0  23           19549  19721 ;#
            LD  A,(HL)                  ;77d1  7e           19550  19722 ;~
            LD  (L07896h+1),A           ;77d2  32 97 78     19551  19723 ;2x
            RES 7,(HL)                  ;77d5  cb be        19552  19724 ;
            DEC HL                      ;77d7  2b           19553  19725 ;+
            LD  DE,07A2Fh               ;77d8  11 2f 7a     19554  19726 ;/z
            CALL    MUL                 ;77db  cd e0 6f     19555  19727 ;o
            PUSH    HL                  ;77de  e5           19556  19728 ;
            CALL    L073B2h             ;77df  cd b2 73     19557  19729 ;s
            PUSH    DE                  ;77e2  d5           19558  19730 ;
            CALL    LDIR8               ;77e3  cd a6 73     19559  19731 ;s
            POP HL                      ;77e6  e1           19560  19732 ;
            CALL    B_FIX               ;77e7  cd 10 60     19561  19733 ;`
            PUSH    HL                  ;77ea  e5           19562  19734 ;
            CALL    HLFLT               ;77eb  cd 67 61     19563  19735 ;ga
            XOR A                       ;77ee  af           19564  19736 ;
            CP  H                       ;77ef  bc           19565  19737 ;
            JP  NZ,OVERFL1              ;77f0  c2 e4 6e     19566  19738 ;n
            LD  A,L                     ;77f3  7d           19567  19739 ;}
            LD  (L0788Bh+1),A           ;77f4  32 8c 78     19568  19740 ;2x
            POP DE                      ;77f7  d1           19569  19741 ;
            POP HL                      ;77f8  e1           19570  19742 ;
            PUSH    HL                  ;77f9  e5           19571  19743 ;
            CALL    SUB                 ;77fa  cd d1 6b     19572  19744 ;k
            PUSH    DE                  ;77fd  d5           19573  19745 ;
            PUSH    HL                  ;77fe  e5           19574  19746 ;
            CALL    LDIR1               ;77ff  cd a3 73     19575  19747 ;s
            POP DE                      ;7802  d1           19576  19748 ;
            POP HL                      ;7803  e1           19577  19749 ;
            DEC (HL)                    ;7804  35           19578  19750 ;5
            EX  DE,HL                   ;7805  eb           19579  19751 ;
            XOR A                       ;7806  af           19580  19752 ;
            LD  B,008h                  ;7807  06 08        19581  19753 ;
L07809h:    PUSH    BC                  ;7809  c5           19582  19754 ;
            PUSH    AF                  ;780a  f5           19583  19755 ;
            CALL    CMP                 ;780b  cd d6 61     19584  19756 ;a
            JR  C,L07817h               ;780e  38 07        19585  19757 ;8
            CALL    SUB                 ;7810  cd d1 6b     19586  19758 ;k
            POP AF                      ;7813  f1           19587  19759 ;
            SET 7,A                     ;7814  cb ff        19588  19760 ;
            PUSH    AF                  ;7816  f5           19589  19761 ;
L07817h:    POP AF                      ;7817  f1           19590  19762 ;
            RLC A                       ;7818  cb 07        19591  19763 ;
            EX  DE,HL                   ;781a  eb           19592  19764 ;
            DEC (HL)                    ;781b  35           19593  19765 ;5
            EX  DE,HL                   ;781c  eb           19594  19766 ;
            POP BC                      ;781d  c1           19595  19767 ;
            DJNZ    L07809h             ;781e  10 e9        19596  19768 ;
            LD  (L07876h+1),A           ;7820  32 77 78     19597  19769 ;2wx
            PUSH    DE                  ;7823  d5           19598  19770 ;
            LD  DE,L07A27h              ;7824  11 27 7a     19599  19771 ;'z
            CALL    MUL                 ;7827  cd e0 6f     19600  19772 ;o
            POP DE                      ;782a  d1           19601  19773 ;
            PUSH    DE                  ;782b  d5           19602  19774 ;
            CALL    LDIR8               ;782c  cd a6 73     19603  19775 ;s
            POP HL                      ;782f  e1           19604  19776 ;
            BIT 3,(IY+0)                ;7830  fd cb 00 5e  19605  19777 ;^
            JP  Z,L078ADh               ;7834  ca ad 78     19606  19778 ;x
            INC (HL)                    ;7837  34           19607  19779 ;4
            LD  DE,FLTEN                ;7838  11 90 62     19608  19780 ;b
            CALL    ADD                 ;783b  cd a6 6c     19609  19781 ;l
            DEC (HL)                    ;783e  35           19610  19782 ;5
            POP DE                      ;783f  d1           19611  19783 ;
L07840h:    PUSH    DE                  ;7840  d5           19612  19784 ;
            CALL    MUL                 ;7841  cd e0 6f     19613  19785 ;o
            LD  DE,FLTEN                ;7844  11 90 62     19614  19786 ;b
            DEC (HL)                    ;7847  35           19615  19787 ;5
            CALL    ADD                 ;7848  cd a6 6c     19616  19788 ;l
            INC (HL)                    ;784b  34           19617  19789 ;4
            POP DE                      ;784c  d1           19618  19790 ;
            PUSH    DE                  ;784d  d5           19619  19791 ;
            CALL    MUL                 ;784e  cd e0 6f     19620  19792 ;o
            LD  DE,L07A1Fh              ;7851  11 1f 7a     19621  19793 ;z
            CALL    MUL                 ;7854  cd e0 6f     19622  19794 ;o
            INC (HL)                    ;7857  34           19623  19795 ;4
            CALL    ONEADD              ;7858  cd ac 73     19624  19796 ;s
            DEC (HL)                    ;785b  35           19625  19797 ;5
            POP DE                      ;785c  d1           19626  19798 ;
            PUSH    DE                  ;785d  d5           19627  19799 ;
            CALL    MUL                 ;785e  cd e0 6f     19628  19800 ;o
            CALL    ONEADD              ;7861  cd ac 73     19629  19801 ;s
            POP DE                      ;7864  d1           19630  19802 ;
            PUSH    DE                  ;7865  d5           19631  19803 ;
            CALL    MUL                 ;7866  cd e0 6f     19632  19804 ;o
L07869h:    CALL    ONEADD              ;7869  cd ac 73     19633  19805 ;s
            EX  (SP),HL                 ;786c  e3           19634  19806 ;
            EX  DE,HL                   ;786d  eb           19635  19807 ;
            PUSH    DE                  ;786e  d5           19636  19808 ;
            CALL    LDIR1               ;786f  cd a3 73     19637  19809 ;s
            POP HL                      ;7872  e1           19638  19810 ;
            LD  DE,LOGTBL1              ;7873  11 9f 79     19639  19811 ;y
L07876h:    LD  A,000h                  ;7876  3e 00        19640  19812 ;>
            LD  B,008h                  ;7878  06 08        19641  19813 ;
L0787Ah:    RLC A                       ;787a  cb 07        19642  19814 ;
            JR  NC,L07885h              ;787c  30 07        19643  19815 ;0
            PUSH    AF                  ;787e  f5           19644  19816 ;
            PUSH    BC                  ;787f  c5           19645  19817 ;
            CALL    MUL                 ;7880  cd e0 6f     19646  19818 ;o
            POP BC                      ;7883  c1           19647  19819 ;
            POP AF                      ;7884  f1           19648  19820 ;
L07885h:    CALL    ADDDEG              ;7885  cd 4a 5b     19649  19821 ;J[
            DJNZ    L0787Ah             ;7888  10 f0        19650  19822 ;
            LD  A,(HL)                  ;788a  7e           19651  19823 ;~
L0788Bh:    ADD A,000h                  ;788b  c6 00        19652  19824 ;
            JP  C,OVERFL1               ;788d  da e4 6e     19653  19825 ;n
            LD  (HL),A                  ;7890  77           19654  19826 ;w
            POP DE                      ;7891  d1           19655  19827 ;
            CALL    MUL                 ;7892  cd e0 6f     19656  19828 ;o
            POP BC                      ;7895  c1           19657  19829 ;
L07896h:    LD  A,000h                  ;7896  3e 00        19658  19830 ;>
            RLC A                       ;7898  cb 07        19659  19831 ;
            RET NC                      ;789a  d0           19660  19832 ;
            PUSH    BC                  ;789b  c5           19661  19833 ;
            PUSH    DE                  ;789c  d5           19662  19834 ;
            PUSH    HL                  ;789d  e5           19663  19835 ;
            CALL    LDIR8               ;789e  cd a6 73     19664  19836 ;s
            POP DE                      ;78a1  d1           19665  19837 ;
            PUSH    DE                  ;78a2  d5           19666  19838 ;
            CALL    LDIR1               ;78a3  cd a3 73     19667  19839 ;s
            POP HL                      ;78a6  e1           19668  19840 ;
            POP DE                      ;78a7  d1           19669  19841 ;
            CALL    DIV                 ;78a8  cd bd 70     19670  19842 ;p
            POP BC                      ;78ab  c1           19671  19843 ;
            RET                         ;78ac  c9           19672  19844 ;
                                        ;                   19673  19845 
L078ADh:    POP DE                      ;78ad  d1           19674  19846 ;
            PUSH    DE                  ;78ae  d5           19675  19847 ;
            CALL    MUL                 ;78af  cd e0 6f     19676  19848 ;o
            LD  A,(HL)                  ;78b2  7e           19677  19849 ;~
            OR  A                       ;78b3  b7           19678  19850 ;
            JR  Z,L078B7h               ;78b4  28 01        19679  19851 ;(
            DEC (HL)                    ;78b6  35           19680  19852 ;5
L078B7h:    CALL    ADD                 ;78b7  cd a6 6c     19681  19853 ;l
            JP  L07869h                 ;78ba  c3 69 78     19682  19854 ;ix
B_LOG:      PUSH    BC                  ;78bd  c5           19683  19855 ;
            INC HL                      ;78be  23           19684  19856 ;#
            LD  A,(HL)                  ;78bf  7e           19685  19857 ;~
            RLC A                       ;78c0  cb 07        19686  19858 ;
            JP  C,IFCALL                ;78c2  da 36 17     19687  19859 ;6
            DEC HL                      ;78c5  2b           19688  19860 ;+
            LD  A,(HL)                  ;78c6  7e           19689  19861 ;~
            OR  A                       ;78c7  b7           19690  19862 ;
            JP  Z,IFCALL                ;78c8  ca 36 17     19691  19863 ;6
            SUB 081h                    ;78cb  d6 81        19692  19864 ;
            LD  (L0790Bh+1),A           ;78cd  32 0c 79     19693  19865 ;2y
            LD  (HL),081h               ;78d0  36 81        19694  19866 ;6
            XOR A                       ;78d2  af           19695  19867 ;
            LD  B,008h                  ;78d3  06 08        19696  19868 ;
            LD  DE,LOGTBL1              ;78d5  11 9f 79     19697  19869 ;y
L078D8h:    PUSH    BC                  ;78d8  c5           19698  19870 ;
            PUSH    AF                  ;78d9  f5           19699  19871 ;
            CALL    CMP                 ;78da  cd d6 61     19700  19872 ;a
            JR  C,L078EEh               ;78dd  38 0f        19701  19873 ;8
            PUSH    HL                  ;78df  e5           19702  19874 ;
            LD  HL,00040h               ;78e0  21 40 00     19703  19875 ;!@
            ADD HL,DE                   ;78e3  19           19704  19876 ;
            EX  DE,HL                   ;78e4  eb           19705  19877 ;
            EX  (SP),HL                 ;78e5  e3           19706  19878 ;
            CALL    MUL                 ;78e6  cd e0 6f     19707  19879 ;o
            POP DE                      ;78e9  d1           19708  19880 ;
            POP AF                      ;78ea  f1           19709  19881 ;
            SET 7,A                     ;78eb  cb ff        19710  19882 ;
            PUSH    AF                  ;78ed  f5           19711  19883 ;
L078EEh:    POP AF                      ;78ee  f1           19712  19884 ;
            RLC A                       ;78ef  cb 07        19713  19885 ;
            CALL    ADDDEG              ;78f1  cd 4a 5b     19714  19886 ;J[
            POP BC                      ;78f4  c1           19715  19887 ;
            DJNZ    L078D8h             ;78f5  10 e1        19716  19888 ;
            LD  (L07943h+1),HL          ;78f7  22 44 79     19717  19889 ;"Dy
            LD  DE,00008h               ;78fa  11 08 00     19718  19890 ;
            ADD HL,DE                   ;78fd  19           19719  19891 ;
            LD  E,A                     ;78fe  5f           19720  19892 ;_
            LD  D,000h                  ;78ff  16 00        19721  19893 ;
            CALL    FLTHEX              ;7901  cd 02 29     19722  19894 ;)
            LD  A,(HL)                  ;7904  7e           19723  19895 ;~
            OR  A                       ;7905  b7           19724  19896 ;
            JR  Z,L0790Bh               ;7906  28 03        19725  19897 ;(
            SUB 008h                    ;7908  d6 08        19726  19898 ;
            LD  (HL),A                  ;790a  77           19727  19899 ;w
L0790Bh:    LD  A,000h                  ;790b  3e 00        19728  19900 ;>
            CP  080h                    ;790d  fe 80        19729  19901 ;
            JR  C,L07913h               ;790f  38 02        19730  19902 ;8
            NEG                         ;7911  ed 44        19731  19903 ;D
L07913h:    PUSH    HL                  ;7913  e5           19732  19904 ;
            LD  DE,00008h               ;7914  11 08 00     19733  19905 ;
            ADD HL,DE                   ;7917  19           19734  19906 ;
            LD  (L07940h+1),HL          ;7918  22 41 79     19735  19907 ;"Ay
            LD  E,A                     ;791b  5f           19736  19908 ;_
            LD  D,000h                  ;791c  16 00        19737  19909 ;
            CALL    FLTHEX              ;791e  cd 02 29     19738  19910 ;)
            LD  A,(L0790Bh+1)           ;7921  3a 0c 79     19739  19911 ;:y
            AND 080h                    ;7924  e6 80        19740  19912 ;
            INC HL                      ;7926  23           19741  19913 ;#
            OR  (HL)                    ;7927  b6           19742  19914 ;
            LD  (HL),A                  ;7928  77           19743  19915 ;w
            DEC HL                      ;7929  2b           19744  19916 ;+
            EX  DE,HL                   ;792a  eb           19745  19917 ;
            POP HL                      ;792b  e1           19746  19918 ;
            CALL    ADD                 ;792c  cd a6 6c     19747  19919 ;l
            LD  A,(IY+0)                ;792f  fd 7e 00     19748  19920 ;~
            LD  DE,L07A37h              ;7932  11 37 7a     19749  19921 ;7z
            CP  004h                    ;7935  fe 04        19750  19922 ;
            JR  Z,L0793Ch               ;7937  28 03        19751  19923 ;(
            LD  DE,L07A27h              ;7939  11 27 7a     19752  19924 ;'z
L0793Ch:    CALL    MUL                 ;793c  cd e0 6f     19753  19925 ;o
            PUSH    HL                  ;793f  e5           19754  19926 ;
L07940h:    LD  DE,00000h               ;7940  11 00 00     19755  19927 ;
L07943h:    LD  HL,00000h               ;7943  21 00 00     19756  19928 ;!
            PUSH    HL                  ;7946  e5           19757  19929 ;
            PUSH    DE                  ;7947  d5           19758  19930 ;
            CALL    LDIR8               ;7948  cd a6 73     19759  19931 ;s
            POP HL                      ;794b  e1           19760  19932 ;
            CALL    ONEADD              ;794c  cd ac 73     19761  19933 ;s
            EX  (SP),HL                 ;794f  e3           19762  19934 ;
            CALL    SUB                 ;7950  cd d1 6b     19763  19935 ;k
            POP DE                      ;7953  d1           19764  19936 ;
            CALL    DIV                 ;7954  cd bd 70     19765  19937 ;p
            PUSH    DE                  ;7957  d5           19766  19938 ;
            CALL    LDIR8               ;7958  cd a6 73     19767  19939 ;s
            POP HL                      ;795b  e1           19768  19940 ;
            PUSH    DE                  ;795c  d5           19769  19941 ;
            LD  E,L                     ;795d  5d           19770  19942 ;]
            LD  D,H                     ;795e  54           19771  19943 ;T
            CALL    MUL                 ;795f  cd e0 6f     19772  19944 ;o
            POP DE                      ;7962  d1           19773  19945 ;
            PUSH    HL                  ;7963  e5           19774  19946 ;
            PUSH    DE                  ;7964  d5           19775  19947 ;
            CALL    LDIR8               ;7965  cd a6 73     19776  19948 ;s
            POP HL                      ;7968  e1           19777  19949 ;
            LD  DE,LOGTBL0              ;7969  11 97 79     19778  19950 ;y
            CALL    ADD                 ;796c  cd a6 6c     19779  19951 ;l
            EX  DE,HL                   ;796f  eb           19780  19952 ;
            POP HL                      ;7970  e1           19781  19953 ;
            CALL    MUL                 ;7971  cd e0 6f     19782  19954 ;o
            LD  DE,FLTEN                ;7974  11 90 62     19783  19955 ;b
            INC (HL)                    ;7977  34           19784  19956 ;4
            CALL    ADD                 ;7978  cd a6 6c     19785  19957 ;l
            DEC (HL)                    ;797b  35           19786  19958 ;5
            EX  DE,HL                   ;797c  eb           19787  19959 ;
            LD  HL,(L07943h+1)          ;797d  2a 44 79     19788  19960 ;*Dy
            CALL    MUL                 ;7980  cd e0 6f     19789  19961 ;o
            LD  DE,LOGTBL               ;7983  11 8f 79     19790  19962 ;y
            CALL    MUL                 ;7986  cd e0 6f     19791  19963 ;o
            POP DE                      ;7989  d1           19792  19964 ;
            CALL    ADD                 ;798a  cd a6 6c     19793  19965 ;l
            POP BC                      ;798d  c1           19794  19966 ;
            RET                         ;798e  c9           19795  19967 ;
LOGTBL:                                 ;                   19796  19968 
            DEFB 07Fh, 04Ch, 0CCh, 0CCh, 0CCh, 0CCh, 0CCh, 0CDh;798f  7f 4c cc cc  19797  19969 
                                        ;7993  cc cc cc cd  19797  19970
LOGTBL0:    DEFB 081h, 055h, 055h, 055h, 055h, 055h, 055h, 055h;7997  81 55 55 55  19798  19971 
                                        ;799b  55 55 55 55  19798  19972
LOGTBL1:    DEFB 081h, 035h, 004h, 0F3h, 033h, 0F9h, 0DEh, 065h;799f  81 35 04 f3  19799  19973 
                                        ;79a3  33 f9 de 65  19799  19974
            DEFB 081h, 018h, 037h, 0F0h, 051h, 08Dh, 0B8h, 0AAh;79a7  81 18 37 f0  19800  19975 
                                        ;79ab  51 8d b8 aa  19800  19976
            DEFB 081h, 00Bh, 095h, 0C1h, 0E3h, 0EAh, 08Bh, 0D7h;79af  81 0b 95 c1  19801  19977 
                                        ;79b3  e3 ea 8b d7  19801  19978
            DEFB 081h, 005h, 0AAh, 0C3h, 067h, 0CCh, 048h, 07Bh;79b7  81 05 aa c3  19802  19979 
                                        ;79bb  67 cc 48 7b  19802  19980
            DEFB 081h, 002h, 0CDh, 086h, 098h, 0ACh, 02Bh, 0A2h;79bf  81 02 cd 86  19803  19981 
                                        ;79c3  98 ac 2b a2  19803  19982
            DEFB 081h, 001h, 064h, 0D1h, 0F3h, 0BCh, 003h, 008h;79c7  81 01 64 d1  19804  19983 
                                        ;79cb  f3 bc 03 08  19804  19984
            DEFB 081h, 000h, 0B1h, 0EDh, 04Fh, 0D9h, 099h, 0ACh;79cf  81 00 b1 ed  19805  19985 
                                        ;79d3  4f d9 99 ac  19805  19986
            DEFB 081h, 000h, 058h, 0D7h, 0D2h, 0D5h, 0E5h, 0F7h;79d7  81 00 58 d7  19806  19987 
                                        ;79db  d2 d5 e5 f7  19806  19988
            DEFB 080h, 035h, 004h, 0F3h, 033h, 0F9h, 0DEh, 065h;79df  80 35 04 f3  19807  19989 
                                        ;79e3  33 f9 de 65  19807  19990
            DEFB 080h, 057h, 044h, 0FCh, 0CAh, 0D6h, 09Dh, 06Bh;79e7  80 57 44 fc  19808  19991 
                                        ;79eb  ca d6 9d 6b  19808  19992
            DEFB 080h, 06Ah, 0C0h, 0C6h, 0E7h, 0DDh, 024h, 03Ah;79ef  80 6a c0 c6  19809  19993 
                                        ;79f3  e7 dd 24 3a  19809  19994
            DEFB 080h, 075h, 025h, 07Dh, 015h, 024h, 086h, 0CDh;79f7  80 75 25 7d  19810  19995 
                                        ;79fb  15 24 86 cd  19810  19996
            DEFB 080h, 07Ah, 083h, 0B2h, 0DBh, 072h, 02Ah, 003h;79ff  80 7a 83 b2  19811  19997 
                                        ;7a03  db 72 2a 03  19811  19998
            DEFB 080h, 07Dh, 03Eh, 00Ch, 00Ch, 0F4h, 086h, 0C1h;7a07  80 7d 3e 0c  19812  19999 
                                        ;7a0b  0c f4 86 c1  19812  20000
            DEFB 080h, 07Eh, 09Eh, 011h, 05Ch, 07Bh, 08Fh, 088h;7a0f  80 7e 9e 11  19813  20001 
                                        ;7a13  5c 7b 8f 88  19813  20002
            DEFB 080h, 07Fh, 04Eh, 0CBh, 059h, 051h, 01Eh, 0C9h;7a17  80 7f 4e cb  19814  20003 
                                        ;7a1b  59 51 1e c9  19814  20004
L07A1Fh:    DEFB 07Ah, 008h, 088h, 088h, 088h, 088h, 088h, 089h;7a1f  7a 08 88 88  19815  20005 
                                        ;7a23  88 88 88 89  19815  20006
L07A27h:    DEFB 080h, 031h, 072h, 017h, 0F7h, 0D1h, 0CFh, 07Ah;7a27  80 31 72 17  19816  20007 
                                        ;7a2b  f7 d1 cf 7a  19816  20008
            DEFB 081h, 038h, 0AAh, 03Bh, 029h, 05Ch, 017h, 0F1h;7a2f  81 38 aa 3b  19817  20009 
                                        ;7a33  29 5c 17 f1  19817  20010
L07A37h:    DEFB 080h, 031h, 072h, 018h ;7a37  80 31 72 18  19818  20011 
                                        ;                   19819  20012 
                                        ;                   19820  20013 ;    ORG 07A3BH
VSTART: DEFW 07C89h                     ;7a3b  89 7c        19821  20014 
STRPTR: DEFW 0                          ;7a3d  00 00        19822  20015 
STKLMT: DEFW 0                          ;7a3f  00 00        19823  20016 
STRTOP: DEFW 0                          ;7a41  00 00        19824  20017 ; EQU  07a41h
INTSSP: DEFW 0                          ;7a43  00 00        19825  20018 
STRBTM: DEFW 0                          ;7a45  00 00        19826  20019 
MEMEND: DEFW 0                          ;7a47  00 00        19827  20020 
MEMMAX: DEFW 0                          ;7a49  00 00        19828  20021 ;  EQU  07a49h
INTFAC: DEFW 0                          ;7a4b  00 00        19829  20022 ;  EQU  07a4bh
        DEFW 0                          ;7a4d  00 00        19830  20023 
IMDBUF  EQU  07b4eh                     ;7b4e               19831  20024 
TEXTST  EQU  07c4eh                     ;7c4e               19832  20025 
                                        ;                   19833  20026 ;	ORG 07A4FH
KEYBUF: DEFB 00Ch                       ;7a4f  0c           19834  20027 
        DEFM 'SAMSUNG HUBASIC V1.0'     ;7a50  53 41 4d 53  19835  20028 
                                        ;7a54  55 4e 47 20  19835  20029
                                        ;7a58  48 55 42 41  19835  20030
                                        ;7a5c  53 49 43 20  19835  20031
                                        ;7a60  56 31 2e 30  19835  20032
        DEFB 00Dh                       ;7a64  0d           19836  20033 
        DEFM 'COPYRIGHT (C) 1982'       ;7a65  43 4f 50 59  19837  20034 
                                        ;7a69  52 49 47 48  19837  20035
                                        ;7a6d  54 20 28 43  19837  20036
                                        ;7a71  29 20 31 39  19837  20037
                                        ;7a75  38 32        19837  20038
        DEFB 00Dh                       ;7a77  0d           19838  20039 
        DEFM '       BY HUDSON SOFT'    ;7a78  20 20 20 20  19839  20040 
                                        ;7a7c  20 20 20 42  19839  20041
                                        ;7a80  59 20 48 55  19839  20042
                                        ;7a84  44 53 4f 4e  19839  20043
                                        ;7a88  20 53 4f 46  19839  20044
                                        ;7a8c  54           19839  20045
        DEFB 00Dh                       ;7a8d  0d           19840  20046 
        DEFS 07B00h-$                   ;7a8e               19841  20047 
                                        ;                   19842  20048 
;Z80-Assembler		Release 1.6				Page 2
;Source file: spc-1000_all.asm
;Title:       Symboltable

BOOT     0000	JT1      0000	JT2      0003	JT3      0006	
JT4      0009	JT5      000c	JT6      000f	JT7      0012	
JT8      0015	JT9      0018	JT10     001b	JT11     001e	
JT12     0021	JT13     0024	JT14     0027	JT15     002a	
JT16     002d	JT17     0030	JT18     0033	TICONT   0036	
JT19     0038	JT20     003b	JT21     003e	JT22     0041	
JT23     0044	JT24     0047	MAIN     004a	INITSB   0056	
NOPRET   0061	IO20SB   0062	IO60SB   006b	COUNTR   0074	
FSAVE    0080	FSAVE0   008e	FSAVE1   00ad	MSAVE    00b6	
SAVE     00ce	SAVE1    00d3	SAVE0    00e3	SAVE2    0100	
SAVE3    0102	SAVE4    0110	FLOAD    0114	FLOAD1   0122	
MLOAD    0134	CLOAD    014c	CLOAD7   0151	CLOAD0   0158	
CLOAD1   0175	CLOAD8   019c	CLOAD4   019d	CLOAD2   01a5	
CLOAD3   01ad	CLOAD5   01b3	MVRFY    01b9	MVRFY1   01e3	
MVRFYN   01e8	MVRFY2   01ef	MVRFY3   0206	MVRFY4   0230	
EDGE     0230	MVRFY5   023b	MVRFY6   0244	MVRFY7   024f	
VBLOAD   0259	VBLOD1   0266	VBLOD2   0282	VBLOD3   028d	
MKRD     0291	MKRD1    02a0	MKRD4    02aa	MKRD5    02ad	
MKRD2    02c3	MKRD3    02dc	MOTON    02e0	MOTON1   02ef	
MOTON6   02f8	MOTON4   02f9	MOTON5   02fd	MOTON2   031f	
MOTON3   032b	MOTCH    0344	MOTCH1   0353	MOTCH2   035f	
WRITEM   0375	MBUF6    037e	MBUF6A   0383	MBUF7    038f	
CKSUM    039e	SUM1     03a4	SUM2     03b3	SUM3     03b7	
SUM4     03bb	WAITR    03c4	WAIT2    03c6	WRITES   03cb	
WRITEL   03ed	WRACC    040f	WRACC1   0415	WRMRK    0422	
WMRK1    0436	WMRK2    043e	WMRK3    0444	MONOP    0450	
MONCOM   0455	MONINP   045d	MONSTK   0483	MEMWRT   0487	
WRTLP    048a	CALLAD   049e	MEMDMP   04a3	HLSTOK   04b2	
MEMDPL   04b6	HLEND    04bb	MONDPS   04c5	DMPSUB   04c8	
LINCNT   04c9	DMPSB2   04ca	MEMLP2   04cd	SPCSTP   04d3	
MONEDT   04e1	DATAST   04ec	ACCSET   04f6	AHEXIN   0500	
HLSET    0509	HLHOLD   051d	HEX4IN   051f	HEX4ER   052a	
HEX2IN   052c	BHEXIN   0540	DESMAL   0553	HLINDS   055e	
HEX2PR   0562	ASCSET   0578	CRHLDS   0580	MONSAH   058e	
MNSHLP   05ae	HLDECK   05c2	HLDEC1   05c9	HLDEC2   05d2	
SCRNBC   05d6	SCRNS0   05f3	SCRNTB   0660	SCRN00   0668	
SCRN01   0674	SCRN02   0680	SCRN03   068c	SCRN04   0698	
INPUTF   06a4	INKYLP   06ad	BREAKI   06be	BELL     06ca	
BELL2    06d2	BELL3    06d8	L0715    0715	BELLBF   0740	
BELLTB   0744	BELLT2   0748	BRKJOB   074c	CRJOB2   0751	
INPEND   0757	ACCEND   075a	CRJOB    075f	L0770    0770	
CRJOBL   077e	L0786    0786	CRJOBP   078e	AINBC    0794	
ALPHA    07ab	AINOK    07b5	SEMI6    07b7	BCUYST   07ba	
LPBNST   07be	ECUYST   07c5	ECUYS2   07c8	CUTBHL   07d3	
ATBHL    07d6	CR1DEP   07de	PRTSDC   07e1	PRTSDL   07e8	
PRTSDE   07ef	DEPRT    07f3	DEPRTL   07f5	DEPRTR   07ff	
TABPRT   0802	TABPRL   0819	CR2      0823	CCR2     0833	
CR1      0843	CR1CTM   0858	SPPRT    0862	ACCPRT   0864	
ACCOUS   0870	PRINTR   0887	PSGST    08a9	PRTRDY   08bb	
WAITLP   08c4	ACCOUT   08d9	ACCDIS   08de	ACCOL1   08ef	
ACCOL2   08f6	CTRLM?   0902	PAGE02   0908	SCRLC1   090f	
PAGE04   0915	SCRLC2   091f	CURSE?   092b	CURSET   0934	
ADRCAL   0938	ADRCA2   093b	PAGE05   0946	GACPRT   094f	
ROMACP   095b	GACPR1   0960	GACPRL   0981	SCRLUP   0991	
PAGE11   09b2	BCLDIR   09be	BCLDL1   09c6	BCLDL2   09ce	
BCLDL3   09e1	SCRLDW   09ea	PAGE12   09ee	PAGE14   09f8	
CHRLE2   09fc	PAGE16   0a01	PAGE17   0a07	BCLDDR   0a13	
BCLDD1   0a1b	BCLDD2   0a23	BCLDD3   0a36	BCOUTA   0a3f	
BCOTOK   0a57	SEMIOT   0a63	CTRLSB   0a81	DELETE   0a8e	
DELLP1   0aa9	DELLP2   0acb	CLR2     0ad5	CHRSTA   0ad6	
CLRLP    0add	ATRSTA   0ae6	CHRLEN   0ae9	ATRCLS   0af1	
LINEFR   0afa	PAGE23   0afc	LINCLS   0afe	HOME     0b03	
INST     0b09	INSTL1   0b2a	LOCK     0b3f	LOCKST   0b41	
UNLOCK   0b45	LEFT     0b48	UPCUR    0b53	CTRLM    0b62	
RIGHT    0b6b	DOWNLB   0b76	CURST2   0b83	UP       0b87	
DOWN     0b8c	CTRLG    0b91	CTRLB    0b9c	CTRLB1   0ba5	
CTRLB2   0bab	CTRLF    0bb4	CTRLF1   0bbd	CTRLF2   0bc3	
CBFCEK   0bca	CTRLBF   0bd2	L0BEC    0bec	L0BF4    0bf4	
CTRLY    0bf7	CTRLT    0bfb	CTRLYT   0bfd	CTRLI    0c08	
CTRLE    0c1d	CTRLZ    0c25	CTRLZ1   0c2d	CTRLEZ   0c35	
CTRLZE   0c4c	BRKEY    0c5b	ASCGET   0c62	BUFCEK   0c6c	
GETRET   0c7a	BUFSET   0c7e	FLASHF   0c7f	BRKGTR   0c8b	
KEYGT    0c92	ZERORT   0ca1	ZEROR2   0ca4	FLGET    0ca7	
REPETS   0cb7	KEYBFA   0cbb	KEYBFD   0cbe	NEWKYS   0cc5	
REPTSW   0cc9	KEYST2   0ccb	SETLP1   0cd5	SETPL2   0cdc	
SETPL3   0ce5	SETPL4   0ce9	KYBFSR   0ced	FLASHS   0cf8	
FLASHG   0d14	FLASHA   0d15	FLASHD   0d18	FLASHC   0d1f	
L0D28    0d28	FLASHO   0d2a	FLASHE   0d32	FLSHGT   0d3c	
FLGTLP   0d42	REPETF   0d57	FLSHL3   0d65	FLGTL2   0d68	
FLSHRT   0d71	KEYSEN   0d7a	KEYSN0   0d7d	KEYSN1   0d7f	
KEYSN2   0d8c	KEYSN3   0d96	L0D9D    0d9d	L0DA5    0da5	
L0DB1    0db1	L0DB9    0db9	NEWCEK   0dbb	NEWPL1   0dc3	
SAMECK   0dd1	SAMELP   0dd9	NEWFLG   0de1	FLGLP1   0de9	
FLGLP2   0dff	FLGLP4   0e0c	FLGLP3   0e0e	FLGLP5   0e13	
FLGLP6   0e17	FLGLP9   0e21	FLGLP7   0e25	FLGLP8   0e2c	
KYBFST   0e35	L0E4C    0e4c	CTRLNO   0e5c	SETKY    0e69	
NONKEY   0e6c	NONKE?   0e6f	SETKY2   0e7a	FUNCTN   0e95	
FUNCLP   0ea8	BFSTSB   0eb1	NONSET   0eca	NORET    0ecc	
MUSIC    0ecd	MUSL1    0ece	MUSL2    0ed8	MUSL4    0eda	
MUSL3    0ede	MUSL6    0ee6	MUSL7    0ee9	MUSL5    0eec	
MUSLOP   0eed	SOUSET   0f2e	SOUST2   0f32	VOLST2   0f57	
VOLST    0f59	VOLOK    0f6b	OCTOK    0f7e	OCTOK2   0f81	
OCTNO    0f8d	OCTNOP   0f90	L0F9A    0f9a	OCTNOM   0f9c	
NUMOK    0fa8	OCTDVL   0fc5	OCTDIV   0fcf	SOUON    0fe6	
SOUOFF   100e	SOUOFE   1021	SOUOFS   1029	SOUSTP   103b	
BRKRET   1042	ENDCHK   1052	DELAYS   1077	DELAY1   107a	
DELAY2   107d	LENGSB   1088	XTEMPO   1095	SOUNDS   1099	
SOUND1   10a9	SOUND3   10b9	SOUND5   10cb	SOUND4   10d2	
SOUND2   10ee	MSDT32   10fe	MUSNUL   1100	LENGTB   1101	
LEN?A    110b	DATA?A   110d	OCT?A    1110	LENG?A   1111	
LEN?B    1113	DATA?B   1115	OCT?B    1118	LENG?B   1119	
LEN?C    111b	DATA?C   111d	OCT?C    1120	LENG?C   1121	
NUMTBL   1123	UPTBL    1131	CTRLTB   113f	BELLFG   117f	
COLORF   1180	GCOLOR   1181	SCRLBF   1182	LINEF    11a2	
CKSMF1   11e3	CKSMF2   11e5	MKLEN    11e7	IO6000   11e9	
IO2000   11ea	DISFLG   11eb	PRINTN   11ec	CURX     11ed	
CURY     11ee	OLDBUF   11ef	NEWBUF   11f9	NEWMOD   1202	
LOCKMD   1203	POINT1   1204	POINT2   1205	INKYBF   1206	
TABBUF   1246	FUNBUF   1266	KEYDT1   1306	KEYDT2   134e	
FILMOD   1396	FILNAM   1397	MTBYTE   13a8	MTADRS   13aa	
MTEXEC   13ac	PROTCT   13ae	COLDST   1418	$BASIC   1418	
MESOFF   141d	L0014    142a	L001E    1434	START    143d	
HOTENT   1446	OK       1462	CONTDS   147c	NMESOK   1488	
AUTOBK   148b	KEYINP   1492	MERGEV   1499	LODVEC   149d	
BLNKSK   14a2	L00A5    14bb	ONELIN   14db	SPCCUT   14df	
BREAKJ   14f7	PAUSEP   14fa	LETDA'   14ff	LETDAI   150e	
DAINUE   1514	DAINV'   151b	DAIMID   152f	DAITRS   1531	
DAIRET   1538	INTDAI   153c	DAISTR   1546	STRMDM   1552	
ESKTRS   156e	INPENT   1571	DAIMD'   158a	LININP   1593	
ZEROMK   159d	KBCLLP   15a8	ENDTXT   15af	OKFVC    15b3	
RUN      15c3	RUNBOT   160b	RUNMID   160e	NXLINE   1611	
NXTLPT   1612	TRACEF   1629	DEBUGR   1631	NXSPL0   1655	
NXSPL1   1665	NXSPL2   1679	NXSPL3   168b	DEBGHL   169f	
BREAK$   16a0	BREAK    16a2	BRDRCT   16b0	LNOPRT   16cb	
LNOBUF   16cc	FIVEPR   16e5	SKIPFZ   16ee	LSTODP   16f6	
PRTNUM   16fc	BREAKM   1705	INMES    170a	CVDSAD   170e	
STMNTS   1720	TYPEMS   1732	IFCALL   1736	SERROR   173a	
ERJUMP   173c	FUNCTN1  173f	MEMDAI   1745	MEMDSE   1747	
SKMDAI   1771	NOMDAI   177c	MIDDAI   177e	MIDRAL   17b5	
MDTLLD   17d4	RPSTSW   17ee	SKIOMR   17fc	LSTRPL   1804	
NOEFT2   181c	RETNOE   181d	NOEFT1   1821	DFLTCL   1824	
REM      183a	FILEER   183e	PRTSTR   1843	RGPRMT   1851	
PRINT    1855	PRDVSW   1874	PRTERM   188a	PRINT'   1891	
PRSCRV   1893	RGPRM'   18ca	SKIPP    18d6	PRTYUI   18d8	
SEMIS    18ea	DISCLR   18f4	CRLFR'   18fa	CRLFRT   18fc	
DECBCL   1902	TABOPR   1912	CRTTAS   192a	TSUBLS   192d	
TABPPP   1932	TABPPT   1933	NOTABO   1939	SPCOPR   1940	
CLR      1951	FOR      196f	FTSKIP   1985	NXTSFT   19a5	
FORPUS   19ad	STEPON   19db	FVTYPE   19f1	FLJPVC   19f9	
NXFVAR   19fb	NXWFOR   1a05	NEXT     1a0a	NEXTAG   1a16	
AGINCV   1a1b	SKSTKS   1a27	NXTNXT   1a4d	NXFPOR   1a5a	
DFLTNX   1a62	FPCOMP   1aa3	OMODED   1aaa	NEXTRT   1ab3	
INTFOR   1ac1	MNIFOR   1aec	INTCMP   1af4	INTCPM   1afd	
ICHMNS   1b04	CPRTMY   1b0b	NCICMT   1b10	ERTEST   1b14	
ERRTST   1b19	LET      1b1c	POKE     1b23	POKELP   1b28	
RETIRQ   1b39	CLS      1b42	CLSSB    1b4c	CLS1LP   1b51	
SCREEN   1b59	GRAPHI   1b93	GRAPH    1b95	GM2345   1bab	
GRAPOK   1bb8	GSAVES   1bea	GSAVEL   1bf3	GSAVEP   1bf5	
GMODEF   1c06	SCRTAB   1c07	LOCATE   1c25	LCTIFC   1c32	
READ     1c45	DATASK   1c5f	DATAPO   1c60	DATAS'   1c62	
MIDDAR   1c78	DATAFD   1c8a	RESLBL   1c92	RESTOR   1ca5	
RESTTT   1cc2	DATA     1cc8	DATALZ   1cc9	LINCIN   1cd4	
LINE     1ce7	LINPOL   1d05	PMTOUE   1d14	LINPNP   1d1c	
LINVEC   1d30	LINESR   1d38	ESLINE   1d40	IBREAK   1d49	
IBREKH   1d4c	CINP'#   1d51	CIRPUT   1d6c	INPUT    1d74	
PMTOUL   1da4	NPASK?   1db3	PMTASK   1dc2	PMASVC   1dc3	
LINEKB   1dc5	NOPPMT   1dcd	INPLOP   1ddf	DATAV1   1de2	
DASKIO   1de8	DATAFV   1dfc	INNMOK   1e2e	NXTIN?   1e49	
PMTERM   1e59	READVC   1e5a	INITDI   1e5c	STRINP   1e69	
SRINPL   1e79	DATAV2   1e81	ESCINS   1e87	ESCIN'   1e88	
DATA22   1e98	DATADN   1e9c	INSDC    1ea8	INPSDC   1ea9	
HMEMCK   1eab	MEMCHK   1eb0	MCHKMD   1eb6	MCHCKR   1ecf	
GETVAC   1ed3	GETVAB   1ed7	GETVAR   1eda	VARCLP   1eeb	
GVARRT   1f01	SKIPUS   1f04	SKIPVT   1f18	SKIPVU   1f19	
SKIPVV   1f1a	CRNVAR   1f23	LZFIL1   1f2e	ARRAY    1f41	
TSALOP   1f4a	TSFARY   1f6a	ASLOP    1f79	ARSKFN   1f84	
ARYATA   1f8c	MIDNAM   1f9b	NXTVR    1fa1	NXTVR1   1fa2	
ARMSN1   1fa7	ADRCL    1fca	ARBCBF   1ff1	CHALNM   1ff5	
DIM      2003	DASLOP   2020	DRSKFN   202a	DRYATA   2032	
DIDNAM   2042	DXTVR1   2047	DXTVR    2048	MOPDIM   204c	
DIMFDD   205d	ARGLOP   2063	DEFARY   2074	AREPUT   208c	
ARYCLL   20c0	OFF      20da	OFFOFF   20e7	BREAKL   20eb	
SORERR   20f5	NIERRO   20f7	NINS     20fa	VSRTST   20fe	
SKIPDM   2115	CHKTYP   211d	DFLTER   2141	IMUL     214b	
IMADL1   2154	IMNADD   215a	IMADL2   2166	IMNAD1   216c	
IMRET    2172	ERROPR   2175	CURTXT   217b	ERRORV   2183	
OMERRE   2188	OMERR    2188	ERROR    2196	ERRSML   21b7	
ERRTCO   21cb	UNPERR   21d7	ERRLOP   21da	UNPMES   21e5	
OKMES    21f7	SETSSP   21f9	CONT     2207	CONTFG   2208	
OKCONT   2211	BLNOBF   2216	BNXTLP   221c	BTEXTP   2222	
SPBUF    2225	AUTOFF   222a	AUTOVC   2237	AUTOLN   2239	
AUTOST   2245	RESUME   224f	ERRORF   2250	ERNLPT   225f	
ERRLNO   2265	THISLN   2289	RESTXT   228a	RESERR   228d	
ERRCOD   2295	FLEXPR   2299	FLEXP'   229c	MOTEST   22ac	
STEXPR   22b2	STEXP'   22b5	HLEXP    22c7	IHLEXP   22cc	
MDLHLE   22cf	BYTE     22d5	HCHECK   22d8	IBYTE    22df	
TYPECS   22e4	TOOCMP   22ed	EXPRSN   22f2	MEMFAC   22f4	
XORAGN   22ff	EXPPH3   2326	ORAGN    2329	EXPPH4   2350	
ANDAGN   2353	EXPPH5   237b	EXPPH6   239d	LOGLP    23a0	
LDGTCM   23b8	TRUE     23bc	LGBACK   23c9	FALSE    23cc	
GTTHAN   23d7	PORTRU   23dd	EQUALG   23e0	ALGLOG   23eb	
GTEQLG   2403	NOTEQU   2407	EXPR1    240e	EXPR'    2411	
EXPRBK   241d	EXPRBK1  2421	EXADD    2426	TERM     2433	
TERM'    2436	TERMBK   2446	TMDIV    244b	MFACT    245b	
MFACT'   245e	MFACBK   246e	TMMOD    2473	POWZRR   2480	
POWAGN   2489	FACT     248f	MIDFAP   2492	MPOWER   24ac	
POWER    24c6	RPOWER   24dd	IPOWER   24ef	PWCLLP   250c	
PWCLL1   252b	NEXTPL   2537	PSWAP    2542	FACT''   255f	
INUSE    2585	KAKKO    2596	CONDSB   25b1	MOCHCK   25b7	
MOPRND   25bf	BCFTCH   25c4	CONST    25cc	FLTHXB   25db	
BCKFTR   25e3	HXORFL   25e6	LDELNO   25f2	LNOCON   25fa	
FLTPNT   2603	VARFUN   2624	FUNCNS   262f	VARFNE   2637	
VARTR#   2651	RTVARI   2657	STRVAR   265c	INTVAR   2664	
FUNGVR   2673	NFCVAR   2682	EFCT1    2687	VRFLOP   2697	
CPIMDP   26ad	LSTCMP   26b7	CPIMDQ   26ba	FVRFND   26c2	
FNBCPT   26c3	FNLVRS   26d3	FVRFDD   26d6	TSTARG   26e4	
FNCGS    26ec	SNXT2C   2708	SK2C2C   2710	S2C2CL   2716	
SK2829   271e	SK2BLO   2728	SKPSBL   272d	SKSBER   2731	
HEXSKS   2745	DWNERG   274d	DQSKCM   2755	FCTION   2761	
FTRMER   276c	FLFNRT   2781	FNCCON   2789	FUNCT1   278c	
SRFNRT   2797	FUNCT2   279c	SRSRRT   27ba	OTHERF   27c5	
LENSUB   27cb	ASCSUB   27d6	MIDERL   27e8	VALSUB   27f9	
VALTRL   280e	MIDVAL   2814	ZRVALR   2820	NULSDC   2825	
INKEY    2828	NORGET   2854	LSTGET   285c	INKMID   2862	
NLINKY   2865	INKBCK   286c	CHRMIS   286f	CHRSUB   2874	
CHRMID   287c	GETFJP   289c	GETJPA   289f	CLRFAC   28a9	
CLFCLP   28ad	STRFAC   28b5	STRSL    28c3	LENOKS   28cd	
CONDSR   28d9	OKSTTH   28e5	CONDFL   28eb	STFLMK   28fd	
STDBL    28fe	FLTHEX   2902	NORFLH   2919	SFL      291b	
FLHXRT   2926	DEFINT   2930	DEFSTR   2934	DEFSNG   2938	
DEFDBL   293c	CONTDF   293e	CDEFTP   2953	STRMDM2  2968	
DFFIL1   296c	CALLUP   2974	CALUPR   2981	INCHLF   2986	
HLFTCH   2987	INTG     298d	MNINTR   29b6	STRING   29b8	
SPCSU'   29e3	SPCSUB   29e8	SPCSME   29f6	SPCFLL   29fe	
FILLCH   29ff	NULRET   2a03	FRACSB   2a0e	PEEK     2a14	
HEXD     2a26	MIDOCT   2a35	OCTD     2a42	STRSUB   2a53	
MIDHEX   2a5a	MK1      2a75	MKS      2a88	MKD      2a8e	
MKHILS   2a92	INDRCT   2aa3	CVI      2aaa	CVD      2aca	
CVS      2acf	CVMIDE   2ad2	CVTRLP   2ae9	PARI     2af5	
SKIMPL   2b0f	ENTSTR   2b1a	CDBL     2b21	CSNG     2b26	
EPREST   2b4b	CINT     2b5a	INRETY   2b7b	LEFT1    2b80	
LFTOLM   2ba9	LMIDET   2bae	NOLENE   2bc5	RIGHT1   2bd4	
NOLSRD   2bfd	MID      2c0f	MIDALL   2c52	KMIJL    2c70	
MNULIS   2c71	MIDNUL   2c74	INSTR    2c7a	SINSEX   2ca6	
INCPL1   2cd9	INSCPL   2cef	INMTCH   2cf9	INSRET   2d00	
INSZR    2d05	BCPOTR   2d11	INSZR1   2d19	INSZR2   2d1a	
INSZR3   2d1b	FRE      2d1e	FREMID   2d35	VARPTR   2d40	
CH28H    2d58	SERVED   2d5e	CH2CH    2d61	CH29H    2d66	
MEM$     2d6b	HLFLTO   2d97	GETSTR   2d9e	STRTRL   2dd0	
NULBCK   2dd7	NULSTR   2de3	MEMPUR   2de8	MEPDEB   2e1d	
PURGE    2e37	PURAGN   2e41	SPBLTF   2e50	STKBLT   2e55	
MIDMPR   2ea0	BLTAJL   2eaa	BLTRET   2ec0	BLTHLB   2ec1	
BLTDEB   2ec4	BLTBCB   2ec7	BLTRTA   2eca	STRPRG   2ecc	
FSTRTP   2ed2	FDSRTP   2ee5	SPRGLP   2ee8	ESCSPR   2efb	
SHORTN   2eff	SHRTNL   2f00	STRNST   2f14	ADRSFL   2f3d	
SREDCK   2f59	OVERST   2f64	SJPTBL   2f68	FJPTBL   3006	
DFTABL   3088	USRTBL   30a2	ADHLHL   30b6	OVERFL   30b8	
CVBCAS   30bd	CVBABS   30c6	INCRTM   30ce	HEXCUL   30d0	
LNOCLP   30d3	EDITOR   30f2	RSFGLP   310b	DELMIK   3119	
IMLSTP   312f	ENOSLP   3144	IMDENS   3148	EAPEND   315e	
RELPTR   3196	DELETE1  31a5	FSTLOP   31ae	RTDLTE   31b6	
POPDLR   31bb	FDDLST   31be	LNOTBF   31d3	SNDDLP   31dc	
DLEFD'   31f2	DLSTRT   31f4	DRNLOP   3218	SEARCH   322b	
SEARC'   323c	SERVEC   3258	MARDEB   325c	MATLEN   3262	
SERRTT   326d	SERNMT   3272	MATLIS   3277	SERDIS   3278	
SERLPP   327a	ESSRSP   3284	SER0DH   3289	SERINT   328f	
SERLEN   3290	SERDEB   3295	TRACE    329b	TRLTPR   32b9	
TRACL0   32c0	TRACL1   32c6	TRACL2   32cc	TRACL3   32d2	
TRACL4   32d8	TRACLP   32de	TRCOFF   32e4	RTTRAC   32e7	
TROFF    32ea	SWAP     32ef	SWTRL1   3312	NXTSAS   3348	
SWAPHL   3349	NXTSAW   3365	OUT      3367	OPORT    337a	
CLOSE    3382	FILEFG   3383	CLSINP   339d	CLEAR    33ab	
MEMSET   33e9	USING    3410	OKLIOP   3420	USGIFC   3423	
IUSGLP   343b	USNGLP   3442	PUTCHS   346f	USINED   3474	
PRTEDF   3475	ESPUVC   3481	URTVEC   3482	PESCCH   3484	
PSFRST   3488	CHCKRV   34a2	USGCON   34b3	MGFDXZ   34bd	
PTPURV   34c2	USGCMN   34c7	PUCHRA   34d1	PULSC#   34d7	
PUSEMR   34dd	CRRTIR   34e3	PSMIDL   34e9	COUUSP   34eb	
ESCCSP   34f9	ZRPRUS   3506	USGMDL   350b	RETIOE   3512	
PRSPNE   351c	USGMD'   3525	SPACPT   352d	ASTRSK   3534	
KIUYTJ   354e	VENUSG   3559	PLUSUS   356b	PRLEN?   3579	
PFLENG   3581	PULSLS   3589	MIDFUS   358c	PUGTFC   359f	
PUCOMP   35b1	PUAFMO   35c1	PUAFQO   35cb	PUPOIT   35d3	
PUPOFC   35da	PUCOPP   35eb	BEGUSG   35f1	CHEXPU   35f8	
NEXPPU   3609	FRCLEN   3621	PUEXPF   3624	PUCOMF   3631	
COMN3D   3643	COMSK3   3645	PURTJM   3655	ESCPUC   365c	
INTLEN   365d	COMTPU   366d	LADJS1   3674	PUAFMF   3675	
NPUSGN   3677	RPLUSF   367b	FPLUSF   3680	FPUTER   3693	
PUPTML   3694	THISLN1  369f	PTPLS1   36a2	USGSGN   36a3	
LADJS2   36ad	PUYENF   36ae	LSDQW1   36b8	LADJS3   36c4	
PUASTF   36c5	ASTFIL   36ca	LADJ4'   36d5	LADJS4   36d6	
LSDVZR   36ea	PULSTX   36ee	TST2DH   36f3	RETPU$   3701	
USGBCB   3702	USGDEB   3705	AUTO     370f	EDLINE   372a	
AUTONE   3732	AUTNER   3735	AUTOES   3743	LPOS     374a	
POS      374f	POSMID   3752	ERR      3758	MIDERS   375e	
ERL      3772	ADJERL   3778	FLMXD0   3786	DEL      378e	
RENUM    37aa	SKIRE1   37d4	SKMRNU   37e8	RNSTRT   37fa	
BEGRNS   3816	STLNO    3823	BEGREN   3830	NEWNO    3834	
REKUML   3836	ADDNO    3842	RNUMED'  384c	RENOVR   3851	
CROPEN   3865	LODIFC   388d	LDFNTR   3895	LOADST   389e	
LFDFNL   38b3	FLFPRE   38be	LOADFN   38c3	FNCMPL   38cd	
LFNLCP   38d9	LFNOK    38dd	ROPEN    38f4	VERIFY   38fc	
MERGE    3919	LOAD     392c	MRGEVC   3949	TPRDER   3969	
BLOAD    3978	RTBLOD   39a1	MLLOAD   39a4	NEW      39ac	
CVLOAD   39b9	CVLDLP   39bf	ESCCVL   39d1	CVSAVE   39de	
CVSVLP   39e4	CINPUT   39f8	CLDLP1   3a04	MIDCIP   3a09	
ABORT    3a1c	CBREAK   3a26	NRLDED   3a30	LFOUM    3a43	
LDINGM   3a49	WOPEN    3a51	CWOPEN   3a5d	NULSAV   3a7f	
WOPIFC   3a81	SAVEFT   3a92	NULFNM   3a98	SAVE$    3abb	
BSAVE    3af6	CBREA'   3b0b	CBRSHM   3b0e	SAVEM    3b13	
SVMNEA   3b3c	DEFFN    3b4d	FNSERR   3b51	DUPDEF   3b8b	
ERJVDE   3b8d	ILDRCH   3b90	UNDEFN   3b9d	GETFUN   3ba1	
GFNLP1   3bb3	SKIPN1   3bd1	SKIPN2   3be4	SKIPFN   3be6	
FNNOTF   3bee	FNOPR    3bf4	STRFNC   3c06	ARGFUN   3c09	
DFLTUF   3c3c	DEFUSR   3c40	DFLTZR   3c51	USERSE   3c71	
USRDFZ   3c74	USROPR   3c78	USRDZE   3c87	USRBCK   3cbc	
TIME$    3cc1	SCRN$    3cc4	SCRNER   3ccf	SCRIFC   3cd7	
SCRNTL   3d0e	L2900    3d16	DUMP     3d2f	STDPDV   3d3b	
DMPLOP   3d42	ARYSKP   3d54	ARDSLP   3d61	ONLYVR   3d82	
STRDMP   3da9	RALDMP   3dbb	NXTDMP   3dc9	DUMPRT   3de4	
PRDMVR   3deb	NTNULD   3df8	PTVSBL   3e0f	CONSOL   3e1b	
KLIST    3e1e	KLSTLP   3e24	KLTEN    3e30	KLTAB    3e39	
KLLP1    3e46	KLESC    3e4d	CTRLPR   3e59	KEYON    3e6f	
KEYOFF   3e72	KEY      3e75	KIFCVX   3e94	KLNLMT   3eaa	
KYPTLP   3eb6	INDRCT1  3eb9	ESCKPT   3ebc	KBUFST   3ebf	
KBUFSL   3ed0	KBUFLP   3ed2	KEYBCL   3eda	CSRLIN   3ee8	
LNOADR   3efd	RETLNR   3f07	RETLNO   3f0a	MIDRLN   3f12	
RTLLOP   3f16	RETSTL   3f24	CVRTLN   3f32	RETLNV   3f33	
RELNVC   3f35	CVLNAD   3f39	RTLSHM   3f4d	ADRNVC   3f4f	
RTRNAD   3f68	RENNTF   3f6a	UDLBUF   3f82	LNOSER   3f8e	
LNOSLP   3f97	TMPUYS   3f99	NTFRET   3fb8	NOMTCH   3fbb	
LMIDET1  3fc4	GTSTED   3fc7	FSTNUB   3fe7	GSESER   3fe9	
NX2C2D   3ff0	GTNXNM   4005	GTEDNO   4018	EDIT     4022	
EDBKLP   4046	SLIST    4050	CLIST    405e	SDXSET   406a	
LIST#    4072	LIST##   407a	LIST     407e	LIST#E   407f	
CLISTM   4091	LISTLP   409f	LISTSN   40ae	LISTL'   40b9	
LISTRT   40bb	LISTEN   40bc	LISTE'   40c5	LOKJMN   40c7	
LZSKL    40e3	LTSKZR   40eb	LIST0L   40f1	SAVEVC   40f6	
COUTCH   40f8	CRTVEC   40fd	CTIRTR   4100	ESCLOT   4103	
LSCRVC   4104	COUT0D   4106	CRTCR2   410e	LISCRC   4111	
LSTCR'   4112	LISTED   411f	ONELST   4128	ONLZLP   4131	
ONLSRT   413c	UNTIL    413e	UNWTRP   4142	UNTILM   415c	
ESCUTL   4170	RETURN   4178	RTAGPO   417a	RTWGOS   419d	
FPOPRT   41a3	WHILE    41b2	WHNLPT   41d1	WHNLBF   41d7	
WEND     41df	WENDER   41e3	SKIPWH   420b	SKWHEL   421d	
REPTON   4236	REPOFF   423b	REPTST   423e	REPEAT   4244	
GOSUB    4263	GOSNDQ   4280	GOSMID   4284	OGSJMP   429b	
LBLGOT   42ab	LBLLNO   42b7	LBLSER   42be	LBLSLP   42d2	
LBLNXT   42d3	NOTLBL   42ec	LBLLEN   42fd	LBLDEB   430c	
LBLMTL   430f	LBLNMT   4319	ONERRG   431d	OEROF'   4342	
ONERDQ   4349	CURLPT   4353	DQOENB   4360	OEROFF   4366	
ON       4372	OGOSUB   438d	ONLNOS   439e	ODATA    43ab	
GOTO     43b1	IFGOTO   43b4	MIDLAG   43b5	LNSGOT   43bc	
SERGOT   43c3	UDFLNO   43dc	ONGDQT   43e1	LNRGCK   43eb	
HLFVEC   43fb	IF       4401	ELSEMD   4412	IFALSE   4423	
IFSKIP   442d	IFSKMD   443a	IFSKSB   4440	FUNCRQ   4457	
ISKFLT   4459	IFDQSK   4464	VPUSH    446d	PUSHAG   4476	
PUTSTRL  4499	PUSHL1   44aa	RETVCP   44b0	PUSHJV   44b2	
VPOP     44b4	POPLOP   44bd	POPTRL   44da	INTPOR   44e1	
HEXCUL1  44e6	STKEMP   44f2	INTPOP   44f7	BUFCLR   4511	
CTINP    4521	ADRES    4524	LNG      4527	CTINP1   4547	
CTRETN   4551	CTRET'   4552	CTERR    4554	CTOUT    4558	
CTOUT1   457c	CTCLOS   4586	STREXZ   459b	STREXX   459d	
CTBUF    45b1	USINGB   46b1	DEFCHR   46cb	DEFCHL   4717	
SOUND    4722	BEEPOP   4748	BEEPA    4772	BEEP     4778	
PLAY     478c	KBSTMS   47af	ESCPLY   47bc	TEMPO    47bf	
COLOR    47e9	PRESET   47fa	PSET     4803	L33F0    4806	
PSETSB   480c	CULTBL   481b	CULADR   4823	SCRNYE   4824	
SCRNXE   482c	CULERR   4831	CALADR   4833	CALAD0   4836	
CULAD0   484e	L3445    485b	L344A    4860	CALAD1   4875	
CALA21   487c	CULAD1   4893	L348A    48a0	L348F    48a5	
L349F    48b5	PRESOK   48c0	CALAD2   48ca	CALAD3   48ca	
CULAD3   48da	CALA31   48e6	CALAD5   48f3	CALAD4   48f3	
CULAD5   4905	L34F6    490c	L34FB    4911	PSTRES   491b	
PSETXY   4924	COLFSL   4944	COLFST   4948	SETXY3   494d	
SETXY2   4961	BCFTC2   4967	EDCEKL   496e	EDCEK    496f	
LINE@    4979	NOMLIN   4992	ENDLIN   49a0	LIMODE   49b0	
CHRMD1   49c3	L35B4    49ca	MDST2    49d3	MDST3    49d7	
MDST22   49fa	BBFLMD   4a12	LINE1    4a1f	LINES1   4a2b	
LINEXS   4a3f	LINEXE   4a44	LINEL0   4a56	LINEYS   4a5c	
LINEYE   4a61	LINEL1   4a73	LNBOXF   4a7a	LINESB   4a7d	
LINEL4   4a9d	LINEL2   4aa4	XMOD     4aa6	YMOD     4aa9	
LINELP   4ab5	LINEMD   4ab8	YINC3    4abe	YINC2    4ac3	
YINC1    4aca	XINC0    4ad1	LINEL3   4ade	LINEL5   4af8	
BOX      4b01	BOXYAD   4b0a	BOXXAD   4b2c	LINEY    4b45	
BOXLOP   4b4b	BOXMD    4b4e	BOXDEC   4b54	XBOXAD   4b55	
LINEX    4b56	BOXFUL   4b5b	FULAD1   4b62	FULAD2   4b6c	
FULLOP   4b7e	LINEBC   4b80	FULINC   4b88	DIVH$D   4b90	
DIVLP    4b9e	DIV01    4bae	TEXTSB   4bc7	CHRCOD   4bd9	
CIRCLE   4bde	CIRRST   4c06	CRRROK   4c0c	SKPCOL   4c3d	
POLYE1   4c60	POLYE2   4c63	POLYE3   4c69	POLYE4   4c6f	
POLYE5   4c72	POLYLN   4c8e	SINSTA   4ca5	CIRCLP   4cac	
SIND     4cb9	SINEND   4cc2	SINXYS   4cd5	L38C6    4cdc	
SIN!     4ce1	L38CE    4ce4	SINOK    4ceb	SIN45    4d10	
SIN135   4d18	SIN225   4d1e	SINOK1   4d24	SINXOK   4d41	
SINYOK   4d59	XMULHI   4d5c	XMULLO   4d60	YMULHI   4d6a	
YMULLO   4d6e	SIN00    4d7a	SIN90    4d7f	SIN180   4d84	
SIN270   4d89	SINJST   4d8c	SINXAD   4d9a	WIDTH3   4d9d	
SINSX    4d9e	SINSY    4da5	SINYAD   4da8	RMULAY   4db0	
RMULAX   4dbb	RMULXY   4dc4	DEHLMX   4dca	SINRX    4dcb	
DEHLMY   4dd0	SINRY    4dd1	DEHLMS   4dd4	MULOP1   4ddd	
MULOP2   4df6	MULOP3   4e01	SINTBL   4e0b	COSTBL   4ebf	
PAINT    4ec1	PACINT   4eda	PACOSL   4ee4	L3AD1    4ee7	
PACOLS   4f03	PACEND   4f1c	PAINTS   4f1f	PAIN01   4f25	
PAIN02   4f31	PAIN03   4f37	PAIN11   4f45	PAIN06   4f58	
PAIN05   4f5c	PAIN07   4f5e	PAIN09   4f6d	PAIN08   4f71	
PAIN10   4f73	PAIN04   4f77	POICEK   4f87	POIZER   4f99	
POINRT   4f9a	POITBL   4f9e	POIST0   4fa6	BTTST1   4fb5	
POINCK   4fc1	POINC1   4fc6	POICKR   4fcc	POIST1   4fcf	
BTTST2   4fde	POIST3   4ff4	POIS3L   4ffc	POIS33   5003	
POIST5   500c	POIS5L   5014	POIS55   5019	PACOLB   501f	
PATTEN   5028	PATOK1   5059	PATSUB   5071	PATX     5072	
PATY     5078	L3C81    5097	PATYLN   509c	PATLP1   509f	
PATYAD   50a5	PATEND   50b8	PATST    50ba	PATSTL   50bf	
L3CB2    50c8	L3CB7    50cd	HCOPY    50d3	COPYGM   50f6	
COPYM4   50ff	HCOPY1   5108	HCOPY2   510d	COPYM2   510f	
HCOPY3   5114	L3D07    511d	L3D0F    5125	L3D17    512d	
L3D1F    5135	COPYM3   514c	COPYGA   516b	COPYTA   516f	
COPYTL   5170	PRTESC   517e	COPYGR   5195	COPYTX   51aa	
SUB3L    51bf	LGR23L   51c9	L3DB7    51cd	LGR223   51cf	
LGR22    51d7	SUB3L1   51d8	LGR232   51ea	ROMTX    51f5	
L3DE7    51fd	RAMTX    5211	TXCULC   5226	SUB3L2   5227	
RRCHAS   523d	L3E2E    5244	CGCHR    524a	$CGBUF   554a	
ADDDEG   5b4a	OCTLER   5b52	HEXPZM   5b5f	MID&OP   5b6b	
LOP&OP   5b74	CHKVEC   5b7b	VECSWT   5b88	MULVEC   5b89	
RET&OP   5b96	CHCKOC   5ba1	CHCKHX   5ba8	OVFLAG   5bb8	
ZRSKIP   5bd6	L008F    5bd9	SKIP2D   5bdf	CHCK26   5be5	
FTCHL    5bfd	MDLAG    5c00	POINTS   5c27	POINT    5c2b	
KMYSET   5c49	PESC     5c51	TST23H   5c59	TST21H   5c70	
DGTUPQ   5c78	SNGCL1   5c84	TST25H   5c91	TSTPRC   5c9d	
EXPON?   5ca8	EXPON!   5caf	DEXPON   5cb6	EXPON    5cbc	
EXPCLM   5cc0	FTREPT   5cce	CBEGIN   5ce1	CLMIDL   5ce4	
ESCPER   5d04	EMLLPO   5d1a	MULLKM   5d1d	EXJPVC   5d22	
DIVTEN   5d27	ADDECK   5d34	ADHLCK   5d38	OVERF'   5d3a	
MULDEC   5d3d	DEFTCH   5d51	CVNMFL   5d58	ONLYZ#   5d62	
PLUS     5d68	ENORLP   5d71	ENORL'   5d74	NORRES   5d7f	
NORRE'   5d86	OKOMTR   5d90	PUTEMK   5d99	EXPPLS   5daa	
EXPASC   5dbe	PUTEXP   5de7	INTPAR   5df2	FRSTCH   5dff	
BEGTRS   5e07	MIDTRS   5e08	CVASFL   5e1a	DBLLCH   5e31	
NOEXP    5e3a	CVCONT   5e67	ESTST'   5e71	DWNERC   5e77	
FRACDG   5e7a	FRCAGN   5e80	BCKSER   5e99	INTDIS   5ea5	
LSTASA   5eae	ASZERO   5eb4	ASCONE   5eba	FRCADM   5ebd	
FRCASL   5ec2	ADDLOP   5ec8	ESCADD   5ed4	USGNCV   5ed6	
RPSPAC   5ee3	EXPUSG   5eee	USNRIW   5ef9	AGNEXP   5f0e	
NGPUDS   5f2a	EXPUBC   5f2d	EXPUHL   5f30	WRITEL1  5f37	
NTPT2E   5f3e	USGC''   5f46	USGCV'   5f4a	USG'''   5f4f	
STFLBL   5f5e	STDGUS   5f69	FRACUS   5f77	AGINFR   5f87	
OVERRD   5f9d	FOVER    5fa6	NOFRAC   5fab	GTESTB   5fbb	
GNXDGT   5fbd	MIDSGN   5fc0	INTGDL   5fca	CPSHIF   5fdd	
CONDSF   5fec	CONDDG   5ffa	INTZRR   6005	INTBCK   600c	
B_FIX    6010	INT      6010	INTSFL   6029	INTSBL   6035	
INTBC'   603d	INTDBL   6042	INDSFL   6054	IDSFBL   606a	
MIDERF   607f	STHLBC   6088	RCHLBC   608e	FRAC     6095	
FRAC'    60a7	FRCSBL   60c0	FRCSB'   60d2	ENDSFR   60df	
FRCDBL   60e7	IDFRBL   60f7	DSFL1'   611a	ESCDFS   6131	
MULTEN   6142	MOD      614f	HEXFLT   615d	HXZRRT   6162	
DLTEN    6167	HLFLT    6167	NORHLC   6177	TSTRNG   617e	
HXFLSL   618b	STRCMP   6195	NOIV0    61b2	SCMPLP   61c1	
SCMPLN   61c9	PCMPRT   61cf	ONECMP   61d3	CMP      61d6	
TSTCMP2  61e6	TSTCMP   61ec	DCMPLO   61f2	CMPRET   61fa	
HMISN    61fe	CMPRE'   6207	CMPR''   620c	ZFILL    6210	
FILL     6211	FILLOP   6212	FLMAX    6218	CONTBL   6220	
SNGMXO   6268	FLTEN    6290	FLONE    6298	FLLAST   62a0	
ASCHL    62a8	CONV1    62d1	CONV2    62d3	DHLMT    62e6	
SHLMT    62ee	ZFAC     62f2	ZFAC1    62fa	DGBUF    6304	
SMALL    631b	$EDIT    631b	SMALL'   631c	CVIMTX   6325	
CPILLP   6327	NUMJMP   6350	PRTCDE   6355	BACKLP   6357	
TREND'   635b	TREND    635c	STRING1  6360	REMOPR   6367	
RMTRLP   636a	RMTRMD   636d	BACK     6371	STORE'   6374	
STORE    6375	NOSLOP   6382	BACK1    6392	STATE    6395	
GETHX    63be	LNOSLP1  63e3	COMSTR   63f7	LBLGOT1  63fc	
LISTER   6412	LISTRM   6415	AFNUM    642f	ELSEST   6434	
DATAST1  643c	DATAS    6444	DQSTL    644d	LSIT#?   6455	
MATCH    6461	MSTART   6467	TESTMT   646e	SKIPTB   6480	
MTCHOK   6487	NOMTCH1  648c	SHORTN1  6490	NO2EH    6499	
DQTSTR   649d	DQTST'   64a0	SPSTRE   64ad	NUMBER   64b6	
SKIPHX   64d5	NOT26H   64e0	BCKSPS   6504	HEX2     650c	
HEX1     6510	PPOLNO   6513	FLOAT    651b	TSTNDE   652d	
TSTNAC   652e	TREN'    6535	CVTXIM   653a	CVTMLP   6541	
CVCPPT   654a	BCEG     656b	MDLBK    656d	TRASIM   6570	
FUNCTR   6589	TRNUMB   6593	IMHORN   65a0	IMHEX    65a5	
IMMID    65b5	SKZRLP   65c2	ESSKZR   65ca	ZTRLW    65ce	
RFLOAT   65d8	FLTRDL   65e9	PUT23H   6604	PUT21H   6606	
TSTED    6608	FLTRP'   6612	NTPT21   6618	FLTR''   6625	
NTPT23   6627	IMLNO    662d	DTARCL   663d	MIDDST   6642	
DTA22S   6650	DQUAT    665d	DQUATL   6662	REM1     6670	
CORON    6674	INVS     6684	SKIPTR   668a	ASSTR#   6694	
OCTALD   66a0	HEXOCT   66ae	SKHEXP   66be	ESHEXR   66c6	
ZTRLWH   66d1	OCTHL    66db	OCTCOV   66e1	OCTSTO   670b	
HEXHL    6712	HEXCOV   671a	HEXACC   671f	HEXHLF   672c	
SKIUTO   6734	CTBL1    6737	CTBL2    68d3	FIVEBF   69ab	
ERRTXT   69b2	$ERTXT   69b2	UDLMES   6a1f	RESNHL   6bc0	
$FLOAT   6bc0	B_ABS    6bc0	STROMT   6bc5	ONESUB   6bce	
SUB      6bd1	ZERO3    6be5	TOGLE    6beb	CONDM'   6bf2	
CONDMZ   6bf6	RTCDMZ   6c01	MTCHPO   6c04	MIDCMZ   6c05	
STROVF   6c1d	STRADE   6c22	SRADE'   6c44	STRADD   6c47	
FSTTRL   6c83	NXTADS   6c89	SNDTRL   6c97	STRADS   6c9d	
ADD      6ca6	HMINS    6cc3	MINCR    6cd1	MZRT     6cd9	
HMDP     6cdb	DMINS    6ce7	ZRO      6cf2	OKM      6cf5	
FADD     6cfc	ANSHIF   6d1e	FADDS    6d26	STORE1   6d66	
HLBUF    6d6a	FLEXIT   6d78	INST1    6d7c	FADD1    6d7f	
JPVEC    6d99	FADDL1   6d9d	CLR5     6dcd	CLR4     6dce	
CLR3     6dcf	CLR2$    6dd0	CLR1     6dd1	SHIFST   6deb	
JPVEC2   6df1	FSUB     6e04	FSUB1    6e0b	SNSHIF   6e25	
DSUB1    6e2d	CMPCON   6e41	CMPL     6e45	NE       6e51	
DSSFL2   6e86	MINUS    6ea2	NEGTIV   6ece	TRANS    6ecf	
ZERO     6ed8	ZERO'    6edb	ZFILL0   6edf	OVERFL1  6ee4	
SFADD    6eea	SNSH     6f01	SADD1    6f09	SJVEC    6f21	
SCL1     6f36	SCL0     6f37	SSIFST   6f4e	SJVEC2   6f50	
SSTRE    6f74	SHLBUF   6f79	SSUB     6f83	NSSUB0   6f8a	
OSETER   6fa0	ZFSSUB   6faa	ZFSSU1   6fbb	MUL      6fe0	
SML1     7026	SML2     702f	SMSF     703f	EXPCUL   704c	
SPBF     705b	SMSTS    706e	SMULTS   7077	SMULTP   7079	
SMLP1    7094	UNDRFL   70ab	DVBYZR   70b8	DIV      70bd	
SDLOP2   70ee	SDLOP1   70f2	SDCNT    7129	ADLP     7140	
NOSDLP   7153	SDEXPC   7159	DDTRL    717c	SDTRL    717f	
SDMIN    718b	DMUL     718e	DMULLP   71bf	DMSFL    71d9	
DMNOSH   71df	SMSKP1   7207	DMTRL    7209	BLCKAD   7213	
BLCKA1   7216	BLADLP   721b	DMSKIP   7254	DDIV     7289	
DDLOP2   72ab	DDLOP1   72ae	DDCNT    7328	DDADLP   7352	
DDNSLP   7363	DDEXPC   7369	WRKFC    7393	WRKFC1   739b	
LDIR1    73a3	LDIR8    73a6	ONEADD   73ac	L073B2H  73b2	
B_SQR    73b9	L073D1H  73d1	L073E2H  73e2	L073E4H  73e4	
L07401H  7401	B_SUM    7409	B_FACG   742b	L07437H  7437	
L0743FH  743f	L0745EH  745e	L07473H  7473	L07475H  7475	
B_ATN    7477	L07488H  7488	L074ADH  74ad	L074E1H  74e1	
L07501H  7501	L07509H  7509	B_COS    7545	B_SIN    7557	
L0758EH  758e	L0759EH  759e	L075C8H  75c8	L075D5H  75d5	
L075DAH  75da	L075E2H  75e2	L075F2H  75f2	L07602H  7602	
L07613H  7613	L07617H  7617	L0761BH  761b	L07644H  7644	
B_TAN    7646	L07662H  7662	L0766DH  766d	SINTBL1  767a	
SINTBL2  76ba	L076FAH  76fa	SINTBL3  774a	B_SGN    7752	
L0775BH  775b	L07764H  7764	B_RAD    776a	B_PAI    776f	
L07772H  7772	PAITBL   7778	B_INP    7788	B_RND    7799	
L077C8H  77c8	B_EXP    77ca	L07809H  7809	L07817H  7817	
L07840H  7840	L07869H  7869	L07876H  7876	L0787AH  787a	
L07885H  7885	L0788BH  788b	L07896H  7896	L078ADH  78ad	
L078B7H  78b7	B_LOG    78bd	L078D8H  78d8	L078EEH  78ee	
L0790BH  790b	L07913H  7913	L0793CH  793c	L07940H  7940	
L07943H  7943	LOGTBL   798f	LOGTBL0  7997	LOGTBL1  799f	
L07A1FH  7a1f	L07A27H  7a27	L07A37H  7a37	VSTART   7a3b	
STRPTR   7a3d	STKLMT   7a3f	STRTOP   7a41	INTSSP   7a43	
STRBTM   7a45	MEMEND   7a47	MEMMAX   7a49	INTFAC   7a4b	
KEYBUF   7a4f	IMDBUF   7b4e	TEXTST   7c4e	L0E7CFH  e7cf	
ENTRY    fb00	

No undefined symbol.
